{
    "version": "https://jsonfeed.org/version/1",
    "title": "ç™½éª¨ç”ŸèŠ± â€¢ All posts by \"ner\" category",
    "description": "åŒè¡Œè€…ï¼Œæ‹¿èµ·ç«æŠŠï¼",
    "home_page_url": "http://qiji5211.com",
    "items": [
        {
            "id": "http://qiji5211.com/2024/02/07/NER/pytorch%E5%AE%89%E8%A3%85%E7%8E%AF%E5%A2%83%E9%97%AE%E9%A2%98/",
            "url": "http://qiji5211.com/2024/02/07/NER/pytorch%E5%AE%89%E8%A3%85%E7%8E%AF%E5%A2%83%E9%97%AE%E9%A2%98/",
            "title": "pytorchå®‰è£…ç¯å¢ƒé—®é¢˜",
            "date_published": "2024-02-07T09:30:58.000Z",
            "content_html": "<h1 id=\"è‡ªå·±å®‰\"><a class=\"anchor\" href=\"#è‡ªå·±å®‰\">#</a> è‡ªå·±å®‰</h1>\n<p>çªç„¶å…´èµ·æƒ³é‡è£… Anaconda å’Œ Pycharm, å¥½å®¶ä¼™ï¼Œæ•´æ•´ä¸¤å¤©æ‰ç»™å…¨éƒ¨æ•´æ˜ç™½ï¼Œæœ€å¤§çš„åŸå› è§æ–‡æœ«ï¼Œåœ¨æ­¤è®°å½•ä¸€ä¸‹æˆ‘è¸©çš„å‘ã€‚</p>\n<p>å‚è€ƒã€PyTorch æ·±åº¦å­¦ä¹ å¿«é€Ÿå…¥é—¨æ•™ç¨‹ï¼ˆç»å¯¹é€šä¿—æ˜“æ‡‚ï¼ï¼‰ã€å°åœŸå †ã€‘ã€‘ <span class=\"exturl\" data-url=\"aHR0cHM6Ly93d3cuYmlsaWJpbGkuY29tL3ZpZGVvL0JWMWhFNDExdDdSTi8/c2hhcmVfc291cmNlPWNvcHlfd2ViJmFtcDt2ZF9zb3VyY2U9NGJkODUyZjgzNGYyZDlhNmE4Y2UwNjA5YTM2MDAxZDQ=\">https://www.bilibili.com/video/BV1hE411t7RN/?share_source=copy_web&amp;vd_source=4bd852f834f2d9a6a8ce0609a36001d4</span></p>\n<p>Anacondaï¼ˆ <code>Anaconda3-2023.09-0-Windows-x86 64.exe</code> ï¼‰,pycharmï¼Œpytorch å·²ä¸‹å¥½ä¸” pytorchï¼ˆæœ¬æœºæ²¡æœ‰æ»¡è¶³è¦æ±‚çš„ GPUï¼Œé€‰çš„ CPUï¼‰å¯æ­£å¸¸æ¿€æ´»ï¼Œä¸­æ–‡è·¯å¾„é—®é¢˜å¯å‚è€ƒ CSDN é€šè¿‡é…ç½®ç¯å¢ƒå˜é‡è§£å†³ï¼Œä»…æœ€åä¸€æ­¥ä¸å¯¹ã€‚</p>\n<figure class=\"highlight raw\"><figcaption data-lang=\"\"></figcaption><table><tr><td data-num=\"1\"></td><td><pre>(pytorch) PS C:\\Users\\ ç‹è¶Šæ´‹ &gt; python</pre></td></tr><tr><td data-num=\"2\"></td><td><pre>Python 3.6.13 |Anaconda, Inc.| (default, Mar 16 2021, 11:37:27) [MSC v.1916 64 bit (AMD64)] on win32</pre></td></tr><tr><td data-num=\"3\"></td><td><pre>Type &quot;help&quot;, &quot;copyright&quot;, &quot;credits&quot; or &quot;license&quot; for more information.</pre></td></tr><tr><td data-num=\"4\"></td><td><pre>&gt;&gt;&gt; import torch</pre></td></tr><tr><td data-num=\"5\"></td><td><pre>&gt;&gt;&gt;</pre></td></tr></table></figure><p>ä½†é…ç½®æ—¶æŠ¥é”™å¦‚ä¸‹ï¼š</p>\n<figure class=\"highlight raw\"><figcaption data-lang=\"\"></figcaption><table><tr><td data-num=\"1\"></td><td><pre>D:\\ruanjian\\Pycharm\\PyCharm 2023.3.2\\plugins\\python\\helpers\\pydev\\_pydev_bundle\\pydev_import_hook.py:21: UserWarning: mkl-service package failed to import, therefore Intel (R) MKL initialization ensuring its correct out-of-the box operation under condition when Gnu OpenMP had already been loaded by Python process is not assured. Please install mkl-service package, see http:&#x2F;&#x2F;github.com&#x2F;IntelPython&#x2F;mkl-service</pre></td></tr><tr><td data-num=\"2\"></td><td><pre>  module &#x3D; self._system_import (name, *args, **kwargs)</pre></td></tr><tr><td data-num=\"3\"></td><td><pre>Traceback (most recent call last):</pre></td></tr><tr><td data-num=\"4\"></td><td><pre>  File &quot;C:\\Users\\ ç‹è¶Šæ´‹ \\.conda\\envs\\pytorch\\lib\\site-packages\\numpy\\core\\__init__.py&quot;, line 22, in &lt;module&gt;</pre></td></tr><tr><td data-num=\"5\"></td><td><pre>    from . import multiarray</pre></td></tr><tr><td data-num=\"6\"></td><td><pre>  File &quot;D:\\ruanjian\\Pycharm\\PyCharm 2023.3.2\\plugins\\python\\helpers\\pydev\\_pydev_bundle\\pydev_import_hook.py&quot;, line 21, in do_import</pre></td></tr><tr><td data-num=\"7\"></td><td><pre>    module &#x3D; self._system_import (name, *args, **kwargs)</pre></td></tr><tr><td data-num=\"8\"></td><td><pre>  File &quot;C:\\Users\\ ç‹è¶Šæ´‹ \\.conda\\envs\\pytorch\\lib\\site-packages\\numpy\\core\\multiarray.py&quot;, line 12, in &lt;module&gt;</pre></td></tr><tr><td data-num=\"9\"></td><td><pre>    from . import overrides</pre></td></tr><tr><td data-num=\"10\"></td><td><pre>  File &quot;D:\\ruanjian\\Pycharm\\PyCharm 2023.3.2\\plugins\\python\\helpers\\pydev\\_pydev_bundle\\pydev_import_hook.py&quot;, line 21, in do_import</pre></td></tr><tr><td data-num=\"11\"></td><td><pre>    module &#x3D; self._system_import (name, *args, **kwargs)</pre></td></tr><tr><td data-num=\"12\"></td><td><pre>  File &quot;C:\\Users\\ ç‹è¶Šæ´‹ \\.conda\\envs\\pytorch\\lib\\site-packages\\numpy\\core\\overrides.py&quot;, line 7, in &lt;module&gt;</pre></td></tr><tr><td data-num=\"13\"></td><td><pre>    from numpy.core._multiarray_umath import (</pre></td></tr><tr><td data-num=\"14\"></td><td><pre>  File &quot;D:\\ruanjian\\Pycharm\\PyCharm 2023.3.2\\plugins\\python\\helpers\\pydev\\_pydev_bundle\\pydev_import_hook.py&quot;, line 21, in do_import</pre></td></tr><tr><td data-num=\"15\"></td><td><pre>    module &#x3D; self._system_import (name, *args, **kwargs)</pre></td></tr><tr><td data-num=\"16\"></td><td><pre>ImportError: DLL load failed: æ‰¾ä¸åˆ°æŒ‡å®šçš„æ¨¡å—ã€‚</pre></td></tr><tr><td data-num=\"17\"></td><td><pre>During handling of the above exception, another exception occurred:</pre></td></tr><tr><td data-num=\"18\"></td><td><pre>Traceback (most recent call last):</pre></td></tr><tr><td data-num=\"19\"></td><td><pre>  File &quot;C:\\Users\\ ç‹è¶Šæ´‹ \\.conda\\envs\\pytorch\\lib\\code.py&quot;, line 91, in runcode</pre></td></tr><tr><td data-num=\"20\"></td><td><pre>    exec (code, self.locals)</pre></td></tr><tr><td data-num=\"21\"></td><td><pre>  File &quot;&lt;input&gt;&quot;, line 1, in &lt;module&gt;</pre></td></tr><tr><td data-num=\"22\"></td><td><pre>  File &quot;D:\\ruanjian\\Pycharm\\PyCharm 2023.3.2\\plugins\\python\\helpers\\pydev\\_pydev_bundle\\pydev_import_hook.py&quot;, line 21, in do_import</pre></td></tr><tr><td data-num=\"23\"></td><td><pre>    module &#x3D; self._system_import (name, *args, **kwargs)</pre></td></tr><tr><td data-num=\"24\"></td><td><pre>  File &quot;C:\\Users\\ ç‹è¶Šæ´‹ \\.conda\\envs\\pytorch\\lib\\site-packages\\torch\\__init__.py&quot;, line 613, in &lt;module&gt;</pre></td></tr><tr><td data-num=\"25\"></td><td><pre>    _C._initExtension (manager_path ())</pre></td></tr><tr><td data-num=\"26\"></td><td><pre>  File &quot;D:\\ruanjian\\Pycharm\\PyCharm 2023.3.2\\plugins\\python\\helpers\\pydev\\_pydev_bundle\\pydev_import_hook.py&quot;, line 21, in do_import</pre></td></tr><tr><td data-num=\"27\"></td><td><pre>    module &#x3D; self._system_import (name, *args, **kwargs)</pre></td></tr><tr><td data-num=\"28\"></td><td><pre>  File &quot;C:\\Users\\ ç‹è¶Šæ´‹ \\.conda\\envs\\pytorch\\lib\\site-packages\\torch\\cuda\\__init__.py&quot;, line 685, in &lt;module&gt;</pre></td></tr><tr><td data-num=\"29\"></td><td><pre>    from . import amp</pre></td></tr><tr><td data-num=\"30\"></td><td><pre>  File &quot;D:\\ruanjian\\Pycharm\\PyCharm 2023.3.2\\plugins\\python\\helpers\\pydev\\_pydev_bundle\\pydev_import_hook.py&quot;, line 21, in do_import</pre></td></tr><tr><td data-num=\"31\"></td><td><pre>    module &#x3D; self._system_import (name, *args, **kwargs)</pre></td></tr><tr><td data-num=\"32\"></td><td><pre>  File &quot;C:\\Users\\ ç‹è¶Šæ´‹ \\.conda\\envs\\pytorch\\lib\\site-packages\\torch\\cuda\\amp\\__init__.py&quot;, line 1, in &lt;module&gt;</pre></td></tr><tr><td data-num=\"33\"></td><td><pre>    from .autocast_mode import autocast, custom_fwd, custom_bwd  # noqa: F401</pre></td></tr><tr><td data-num=\"34\"></td><td><pre>  File &quot;D:\\ruanjian\\Pycharm\\PyCharm 2023.3.2\\plugins\\python\\helpers\\pydev\\_pydev_bundle\\pydev_import_hook.py&quot;, line 21, in do_import</pre></td></tr><tr><td data-num=\"35\"></td><td><pre>    module &#x3D; self._system_import (name, *args, **kwargs)</pre></td></tr><tr><td data-num=\"36\"></td><td><pre>  File &quot;C:\\Users\\ ç‹è¶Šæ´‹ \\.conda\\envs\\pytorch\\lib\\site-packages\\torch\\cuda\\amp\\autocast_mode.py&quot;, line 5, in &lt;module&gt;</pre></td></tr><tr><td data-num=\"37\"></td><td><pre>    import numpy as np</pre></td></tr><tr><td data-num=\"38\"></td><td><pre>  File &quot;D:\\ruanjian\\Pycharm\\PyCharm 2023.3.2\\plugins\\python\\helpers\\pydev\\_pydev_bundle\\pydev_import_hook.py&quot;, line 21, in do_import</pre></td></tr><tr><td data-num=\"39\"></td><td><pre>    module &#x3D; self._system_import (name, *args, **kwargs)</pre></td></tr><tr><td data-num=\"40\"></td><td><pre>  File &quot;C:\\Users\\ ç‹è¶Šæ´‹ \\.conda\\envs\\pytorch\\lib\\site-packages\\numpy\\__init__.py&quot;, line 140, in &lt;module&gt;</pre></td></tr><tr><td data-num=\"41\"></td><td><pre>    from . import core</pre></td></tr><tr><td data-num=\"42\"></td><td><pre>  File &quot;D:\\ruanjian\\Pycharm\\PyCharm 2023.3.2\\plugins\\python\\helpers\\pydev\\_pydev_bundle\\pydev_import_hook.py&quot;, line 21, in do_import</pre></td></tr><tr><td data-num=\"43\"></td><td><pre>    module &#x3D; self._system_import (name, *args, **kwargs)</pre></td></tr><tr><td data-num=\"44\"></td><td><pre>  File &quot;C:\\Users\\ ç‹è¶Šæ´‹ \\.conda\\envs\\pytorch\\lib\\site-packages\\numpy\\core\\__init__.py&quot;, line 48, in &lt;module&gt;</pre></td></tr><tr><td data-num=\"45\"></td><td><pre>    raise ImportError (msg)</pre></td></tr><tr><td data-num=\"46\"></td><td><pre>ImportError: </pre></td></tr><tr><td data-num=\"47\"></td><td><pre>IMPORTANT: PLEASE READ THIS FOR ADVICE ON HOW TO SOLVE THIS ISSUE!</pre></td></tr><tr><td data-num=\"48\"></td><td><pre>Importing the numpy C-extensions failed. This error can happen for</pre></td></tr><tr><td data-num=\"49\"></td><td><pre>many reasons, often due to issues with your setup or how NumPy was</pre></td></tr><tr><td data-num=\"50\"></td><td><pre>installed.</pre></td></tr><tr><td data-num=\"51\"></td><td><pre>We have compiled some common reasons and troubleshooting tips at:</pre></td></tr><tr><td data-num=\"52\"></td><td><pre>    https:&#x2F;&#x2F;numpy.org&#x2F;devdocs&#x2F;user&#x2F;troubleshooting-importerror.html</pre></td></tr><tr><td data-num=\"53\"></td><td><pre>Please note and check the following:</pre></td></tr><tr><td data-num=\"54\"></td><td><pre>  * The Python version is: Python3.6 from &quot;C:\\Users\\ ç‹è¶Šæ´‹ \\.conda\\envs\\pytorch\\python.exe&quot;</pre></td></tr><tr><td data-num=\"55\"></td><td><pre>  * The NumPy version is: &quot;1.19.2&quot;</pre></td></tr><tr><td data-num=\"56\"></td><td><pre>and make sure that they are the versions you expect.</pre></td></tr><tr><td data-num=\"57\"></td><td><pre>Please carefully study the documentation linked above for further help.</pre></td></tr><tr><td data-num=\"58\"></td><td><pre>Original error was: DLL load failed: æ‰¾ä¸åˆ°æŒ‡å®šçš„æ¨¡å—ã€‚</pre></td></tr></table></figure><p><s>åˆæ­¥æ€€ç–‘é—®é¢˜åœ¨äº</s>ï¼ˆæ˜¯å°ç™½æ²¡é”™äº†ï¼Œåé¢äººå®¶è¯´å’Œè¿™ä¸ªæ²¡å…³ç³»ï¼Œçœ‹åˆ°è¿™ä¸ªæŠ¥é”™çš„ uu ä¸è¦æƒŠæ…Œï¼‰</p>\n<p>ä½†å½“æ—¶æˆ‘ä¸çŸ¥é“å•Šï¼Œé‚è¿è¡Œæç¤ºå‘½ä»¤ï¼Œæ— æœï¼Œçº¦åŠå°æ—¶åæç¤ºæŸæ–‡ä»¶æ²¡æœ‰ admissionï¼ŒCSDN æœ‰æ–‡æŒ‡å‡ºè¯¥é—®é¢˜å¯ä»¥é‡æ–°æ›´æ–° condaï¼Œä¸‹è½½ä¸€å°æ—¶æ²¡ä¸‹å®Œã€‚ä¸¤ä¸ªéƒ½è¿è¡Œäº†ä¸¤æ¬¡å·¦å³ï¼Œå„ç§é‡è£… Anacondaï¼Œç»“æœäººå®¶è¾“å‡ºæˆ‘æ²¡æœ‰ admissionï¼Œå¦‚æœä½ å’Œæˆ‘ä¸€æ ·è£… Anaconda æ—¶é€‰çš„ <code>ç»™æ‰€æœ‰äººè£…</code> çš„é€‰é¡¹ï¼Œè®°å¾—åœ¨æƒé™é‡Œè®¾ç½® <code>æ‰€æœ‰äººå¯ä¿®æ”¹</code> å³å¯è§£å†³ã€‚å½“ç„¶ï¼Œä¸è®¾ç½®ä¹Ÿå¯ä»¥ã€‚</p>\n<p>æœ€åï¼Œè¿™ä¸ªé”™æ— ä¼¤å¤§é›…ï¼Œé‡ç‚¹ä¸åœ¨è¿™ï¼Œä¸è¦è¿è¡Œ <code>conda update -n base -c defaults conda</code>  å°±æ˜¯äº†ã€‚</p>\n<figure class=\"highlight raw\"><figcaption data-lang=\"\"></figcaption><table><tr><td data-num=\"1\"></td><td><pre>(pytorch) PS C:\\Users\\ ç‹è¶Šæ´‹ &gt; conda install pytorch torchvision torchaudio cpuonly -c pytorch</pre></td></tr><tr><td data-num=\"2\"></td><td><pre>Collecting package metadata (current_repodata.json): done</pre></td></tr><tr><td data-num=\"3\"></td><td><pre>Solving environment: done</pre></td></tr><tr><td data-num=\"4\"></td><td><pre></pre></td></tr><tr><td data-num=\"5\"></td><td><pre></pre></td></tr><tr><td data-num=\"6\"></td><td><pre>&#x3D;&#x3D;&gt; WARNING: A newer version of conda exists. &lt;&#x3D;&#x3D;</pre></td></tr><tr><td data-num=\"7\"></td><td><pre>  current version: 23.7.4</pre></td></tr><tr><td data-num=\"8\"></td><td><pre>  latest version: 24.1.0</pre></td></tr><tr><td data-num=\"9\"></td><td><pre></pre></td></tr><tr><td data-num=\"10\"></td><td><pre>Please update conda by running</pre></td></tr><tr><td data-num=\"11\"></td><td><pre></pre></td></tr><tr><td data-num=\"12\"></td><td><pre>    $ conda update -n base -c defaults conda</pre></td></tr><tr><td data-num=\"13\"></td><td><pre></pre></td></tr><tr><td data-num=\"14\"></td><td><pre>Or to minimize the number of packages updated during conda update use</pre></td></tr><tr><td data-num=\"15\"></td><td><pre></pre></td></tr><tr><td data-num=\"16\"></td><td><pre>     conda install conda&#x3D;24.1.0</pre></td></tr><tr><td data-num=\"17\"></td><td><pre></pre></td></tr><tr><td data-num=\"18\"></td><td><pre># All requested packages already installed.</pre></td></tr></table></figure><p>è¿™ä¸ªæŠ¥é”™çš„æ„æ€æ˜¯ä½ æœ‰åº“å®‰äº†ï¼Œä½†æ˜¯æ²¡å®‰å…¨ã€‚</p>\n<h1 id=\"æ·±å¤œå¯»æ±‚æŸå®\"><a class=\"anchor\" href=\"#æ·±å¤œå¯»æ±‚æŸå®\">#</a> æ·±å¤œå¯»æ±‚æŸå®</h1>\n<p>å‡Œæ™¨ 00:23ï¼Œè§£å†³æ— æœï¼Œé‚é¢å‘æŸå®è§£å†³ï¼ˆcost20ï¿¥ï¼‰ï¼Œæ¬¡æ—¥æ—©ï¼ŒæŸé˜¿é‡Œå‘˜å·¥ç»™æˆ‘ä¸€æ³¢å„ç§æ“ä½œï¼Œä¸¤å°æ—¶åå‘Šè¯‰æˆ‘é—®é¢˜æ˜¯ numpy åº“æ²¡å®‰å…¨ï¼Œç„¶åå„ç§è°ƒè¯•ï¼Œæ‰¾ç‰ˆæœ¬ï¼Œç„¶åå®‰ï¼Œè§£å†³ï¼</p>\n<p>ä¸‹åˆï¼Œæ„Ÿè§‰è‡ªå·±åˆè¡Œäº†ï¼Œäºæ˜¯è‡ªå·±é‡æ–°å»ºäº†ä¸€ä¸ªè™šæ‹Ÿç¯å¢ƒï¼ŒæŠŠäººå®¶å»ºçš„åˆ äº†ï¼ŒæŠ¥é”™ä¾æ—§ï¼Œé‡è£… numpy æ— æœï¼Œ<s>å‘ç–¯å‘ç–¯</s>ï¼Œæ„Ÿè§‰è¿™ä¸ªäººè§£å†³é—®é¢˜ä¸èƒ½ä¸€åŠ³æ°¸é€¸ï¼ˆå…¶å®æ˜¯æˆ‘æ²¡å­¦ä¼šã€‚ã€‚ã€‚äººå®¶è¿˜æ˜¯å¾ˆå‰å®³æ»´ï¼‰~</p>\n<h1 id=\"æ™šä¸Šå¯»æ±‚æ‹¼å¤•å¤•\"><a class=\"anchor\" href=\"#æ™šä¸Šå¯»æ±‚æ‹¼å¤•å¤•\">#</a> æ™šä¸Šå¯»æ±‚æ‹¼å¤•å¤•ğŸŒŸ</h1>\n<p>å·²æ˜¯æ™š 10ï¼š20, ç»§ç¬¬ 10 æ¬¡å·¦å³é‡æ–°å®‰è£…è°ƒè¯•åï¼Œéšä¾¿æäº†ä¸ªèƒ½å®‰çš„äººï¼ˆcost15ï¿¥ï¼‰ï¼Œçœ‹å¾—å‡ºæ¥ä»–ä¹Ÿå¾ˆç„¦ç¼ï¼Œç”šè‡³è¿˜å‡ºç°äº†æ–°é”™è¯¯:</p>\n<p>(1) Environment åˆ›å»ºå¤±è´¥ï¼ˆè¿™ä¸ªå’Œåº“æ²¡å…³ç³»ï¼Œæ˜¯è¯´ä½ çš„æºæˆ–è€…ç½‘ç»œé—®é¢˜ï¼Œå»ºè®®æ¢æºå³å¯ï¼‰</p>\n<p>(2) ç³»ç»Ÿæ‰¾ä¸åˆ°æŒ‡å®šè·¯å¾„ã€‚è¿™ä¸ªå°±æ¯”è¾ƒæ£˜æ‰‹äº†ï¼Œäººå®¶é…äº†ç¯å¢ƒå˜é‡ï¼Œå„ç§è°ƒè¯•ï¼Œæ— æœã€‚é€šè¿‡è£… <code>Anaconda3-2020.11 Windows-x86 64.exe</code> ï¼Œå†æ¥ä¸€é pip é…ç½®ï¼ŒæˆåŠŸï¼ï¼ï¼</p>\n<p>é€šè¿‡ pip å®‰è£…å°±ä¸ä¼šåƒé€šè¿‡ conda å®‰è£…æŠ¥é”™ï¼ŒæˆåŠŸè§£å†³ï¼ï¼ï¼</p>\n<p>å°é—®é¢˜ï¼šconda å®‰è£…çš„è™šæ‹Ÿç¯å¢ƒä½ç½®åœ¨ <code>C:/User/XXX/.conda/env/</code>  ä¸‹çš„ï¼Œä½†è¿™ç§æ–¹å¼å®‰è£…çš„è™šæ‹Ÿç¯å¢ƒä½ç½®åœ¨ Anaconda3 çš„å®‰è£…ç›®å½•ä¸‹ï¼Œå…¶ä»–è¿è¡Œå‡æ­£å¸¸ï¼Œè™½ç„¶è¿˜æ˜¯ä¼šæŠ¥ç‰ˆæœ¬ä¸ä¸€è‡´çš„é”™ï¼Œä½†æ— ç¢ã€‚æœ¬æ¬¡é…ç½®ç»ˆäºå®Œæˆï¼ï¼</p>\n<h1 id=\"ç»“æœ\"><a class=\"anchor\" href=\"#ç»“æœ\">#</a> ç»“æœ</h1>\n<p>ç»¼ä¸Šï¼Œå‡ºç°æ­¤ç±»é”™è¯¯çš„äººå»ºè®®è£…ä½ç‰ˆæœ¬ä¸€ç‚¹çš„ Anaconda (å¸çš„æ—¶å€™è®°å¾—ç”¨è‡ªå¸¦çš„å·¥å…·å¸ï¼Œå†™å®Œæ£€æŸ¥ç¯å¢ƒå˜é‡åˆ å¹²å‡€æ²¡)ï¼Œå®‰è£…æ—¶è®°å¾—æŠŠ PATH é€‰é¡¹å‹¾ä¸Šï¼ˆè¦ä¸ç„¶è¦è‡ªå·±é…ï¼Œå®¹æ˜“é…é”™ï¼‰ï¼Œæœ€æ–°ç‰ˆçš„ Anaconda åº”è¯¥æ˜¯æœ‰å°æ¯›ç—…ï¼ˆåº“ä¸å…¨ï¼‰ï¼Œ<span class=\"red\">è°¨æ…å®‰è£…ï¼ï¼ï¼</span></p>\n<p>ç¥çœ‹åˆ°è¿™é‡Œçš„å„ä½ PyTorch å­¦ä¹ é¡ºåˆ©ï¼ğŸŒŸ</p>\n",
            "tags": [
                "pytorch"
            ]
        },
        {
            "id": "http://qiji5211.com/2024/02/07/NER/%E6%96%87%E6%9C%AC%E9%A2%84%E5%A4%84%E7%90%86/",
            "url": "http://qiji5211.com/2024/02/07/NER/%E6%96%87%E6%9C%AC%E9%A2%84%E5%A4%84%E7%90%86/",
            "title": "æ–‡æœ¬é¢„å¤„ç†",
            "date_published": "2024-02-07T09:30:58.000Z",
            "content_html": "<h1 id=\"æ–‡æœ¬å¤„ç†çš„åŸºæœ¬æ–¹æ³•\"><a class=\"anchor\" href=\"#æ–‡æœ¬å¤„ç†çš„åŸºæœ¬æ–¹æ³•\">#</a> æ–‡æœ¬å¤„ç†çš„åŸºæœ¬æ–¹æ³•</h1>\n<h2 id=\"åˆ†è¯\"><a class=\"anchor\" href=\"#åˆ†è¯\">#</a> åˆ†è¯</h2>\n<h3 id=\"ä»€ä¹ˆæ˜¯åˆ†è¯\"><a class=\"anchor\" href=\"#ä»€ä¹ˆæ˜¯åˆ†è¯\">#</a> ä»€ä¹ˆæ˜¯åˆ†è¯ï¼Ÿ</h3>\n<blockquote>\n<p>åˆ†è¯å°±æ˜¯å°†è¿ç»­çš„å­—åºåˆ—æŒ‰ç…§ä¸€å®šçš„è§„èŒƒé‡æ–°ç»„åˆæˆè¯åºåˆ—çš„è¿‡ç¨‹ã€‚æˆ‘ä»¬çŸ¥é“ï¼Œåœ¨è‹±æ–‡çš„<br />\nè¡Œæ–‡ä¸­ï¼Œå•è¯ä¹‹é—´æ˜¯ä»¥ç©ºæ ¼ä½œä¸ºè‡ªç„¶åˆ†ç•Œç¬¦çš„ï¼Œè€Œä¸­æ–‡åªæ˜¯å­—ã€å¥å’Œæ®µèƒ½é€šè¿‡æ˜æ˜¾çš„åˆ†ç•Œ<br />\nç¬¦æ¥ç®€å•åˆ’ç•Œï¼Œå”¯ç‹¬è¯æ²¡æœ‰ä¸€ä¸ªå½¢å¼ä¸Šçš„åˆ†ç•Œç¬¦ï¼Œåˆ†è¯è¿‡ç¨‹å°±æ˜¯æ‰¾åˆ°è¿™æ ·åˆ†ç•Œç¬¦çš„è¿‡ç¨‹ï¼Œ</p>\n</blockquote>\n<ul>\n<li>ä¸¾ä¾‹ï¼š</li>\n</ul>\n<figure class=\"highlight python\"><figcaption data-lang=\"python\"></figcaption><table><tr><td data-num=\"1\"></td><td><pre>å¥³å¹²äº‹æ¯æœˆç»è¿‡ä¸‹å±ç§‘å®¤éƒ½</pre></td></tr><tr><td data-num=\"2\"></td><td><pre><span class=\"token operator\">==</span><span class=\"token operator\">></span></pre></td></tr><tr><td data-num=\"3\"></td><td><pre><span class=\"token punctuation\">[</span><span class=\"token string\">'å¥³å¹²äº‹'</span>ï¼Œ<span class=\"token string\">'æ¯æœˆ'</span>ï¼Œ<span class=\"token string\">'ç»è¿‡'</span>ï¼Œ<span class=\"token string\">'ä¸‹å±'</span>ï¼Œ<span class=\"token string\">'ç§‘å®¤'</span>ï¼Œ<span class=\"token string\">'éƒ½'</span><span class=\"token punctuation\">]</span></pre></td></tr></table></figure><h3 id=\"åˆ†è¯çš„ä½œç”¨\"><a class=\"anchor\" href=\"#åˆ†è¯çš„ä½œç”¨\">#</a> åˆ†è¯çš„ä½œç”¨</h3>\n<ul>\n<li>è¯ä½œä¸ºè¯­è¨€è¯­ä¹‰ç†è§£çš„æœ€å°å•å…ƒï¼Œæ˜¯äººç±»ç†è§£æ–‡æœ¬è¯­è¨€çš„åŸºç¡€ã€‚å› æ­¤ä¹Ÿæ˜¯ AI è§£å†³ NLP é¢†åŸŸé«˜é˜¶ä»»åŠ¡ï¼Œå¦‚è‡ªåŠ¨é—®ç­”ï¼Œæœºå™¨ç¿»è¯‘ï¼Œæ–‡æœ¬ç”Ÿæˆçš„é‡è¦åŸºç¡€ç¯èŠ‚ã€‚</li>\n</ul>\n<h3 id=\"æµè¡Œä¸­æ–‡åˆ†è¯å·¥å…·jieba\"><a class=\"anchor\" href=\"#æµè¡Œä¸­æ–‡åˆ†è¯å·¥å…·jieba\">#</a> æµè¡Œä¸­æ–‡åˆ†è¯å·¥å…· jieba</h3>\n<blockquote>\n<p>&quot;ç»“å·´&quot; ä¸­æ–‡åˆ†è¯ï¼Œåšæœ€å¥½çš„ Python ä¸­æ–‡åˆ†è¯ç»„ä»¶ã€‚</p>\n</blockquote>\n<ul>\n<li>\n<p>jiebal çš„ç‰¹æ€§ï¼š</p>\n<ul>\n<li>æ”¯æŒå¤šç§åˆ†è¯æ¨¡å¼</li>\n<li>ç²¾ç¡®æ¨¡å¼</li>\n<li>å…¨æ¨¡å¼</li>\n<li>æœç´¢å¼•æ“æ‘¸å¼</li>\n<li>æ”¯æŒä¸­æ–‡ç¹ä½“åˆ†è¯</li>\n<li>æ”¯æŒç”¨æˆ·è‡ªå®šä¹‰è¯å…¸</li>\n</ul>\n</li>\n<li>\n<p>jieba ä½¿ç”¨</p>\n</li>\n</ul>\n<blockquote>\n<p>ç²¾ç¡®æ¨¡å¼åˆ†è¯ï¼šè¯•å›¾å°†å¥å­æœ€ç²¾ç¡®åœ°åˆ‡å¼€ï¼Œé€‚åˆæ–‡æœ¬åˆ†æ</p>\n</blockquote>\n<figure class=\"highlight python\"><figcaption data-lang=\"python\"></figcaption><table><tr><td data-num=\"1\"></td><td><pre><span class=\"token operator\">>></span><span class=\"token operator\">></span> <span class=\"token keyword\">import</span> jieba</pre></td></tr><tr><td data-num=\"2\"></td><td><pre><span class=\"token operator\">>></span><span class=\"token operator\">></span> content <span class=\"token operator\">=</span> <span class=\"token string\">\"å¥³å¹²äº‹æ¯æœˆç»è¿‡ä¸‹å±ç§‘å®¤éƒ½\"</span></pre></td></tr><tr><td data-num=\"3\"></td><td><pre><span class=\"token operator\">>></span><span class=\"token operator\">></span> jieba<span class=\"token punctuation\">.</span>cut<span class=\"token punctuation\">(</span>content<span class=\"token punctuation\">,</span>cut_all<span class=\"token operator\">=</span><span class=\"token boolean\">False</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">(</span>é»˜è®¤ä¸º<span class=\"token boolean\">False</span><span class=\"token punctuation\">)</span></pre></td></tr><tr><td data-num=\"4\"></td><td><pre></pre></td></tr><tr><td data-num=\"5\"></td><td><pre><span class=\"token comment\">#ç”Ÿæˆå™¨å¯¹è±¡</span></pre></td></tr><tr><td data-num=\"6\"></td><td><pre><span class=\"token operator\">&lt;</span>generator <span class=\"token builtin\">object</span> Tokenizer<span class=\"token punctuation\">.</span>cut at <span class=\"token number\">0x000001ED13237350</span><span class=\"token operator\">></span></pre></td></tr><tr><td data-num=\"7\"></td><td><pre></pre></td></tr><tr><td data-num=\"8\"></td><td><pre><span class=\"token operator\">>></span><span class=\"token operator\">></span> jieba<span class=\"token punctuation\">.</span>lcut<span class=\"token punctuation\">(</span>content<span class=\"token punctuation\">,</span>cut_all<span class=\"token operator\">=</span><span class=\"token boolean\">False</span><span class=\"token punctuation\">)</span></pre></td></tr><tr><td data-num=\"9\"></td><td><pre></pre></td></tr><tr><td data-num=\"10\"></td><td><pre><span class=\"token comment\">#åˆ—è¡¨å†…å®¹</span></pre></td></tr><tr><td data-num=\"11\"></td><td><pre>Building prefix <span class=\"token builtin\">dict</span> <span class=\"token keyword\">from</span> the default dictionary <span class=\"token punctuation\">.</span><span class=\"token punctuation\">.</span><span class=\"token punctuation\">.</span></pre></td></tr><tr><td data-num=\"12\"></td><td><pre>Dumping model to <span class=\"token builtin\">file</span> cache C<span class=\"token punctuation\">:</span>\\WINDOWS\\TEMP\\jieba<span class=\"token punctuation\">.</span>cache</pre></td></tr><tr><td data-num=\"13\"></td><td><pre>Loading model cost <span class=\"token number\">0.607</span> seconds<span class=\"token punctuation\">.</span></pre></td></tr><tr><td data-num=\"14\"></td><td><pre>Prefix <span class=\"token builtin\">dict</span> has been built successfully<span class=\"token punctuation\">.</span></pre></td></tr><tr><td data-num=\"15\"></td><td><pre>Out<span class=\"token punctuation\">[</span><span class=\"token number\">9</span><span class=\"token punctuation\">]</span><span class=\"token punctuation\">:</span> <span class=\"token punctuation\">[</span><span class=\"token string\">'å¥³å¹²äº‹'</span><span class=\"token punctuation\">,</span> <span class=\"token string\">'æ¯æœˆ'</span><span class=\"token punctuation\">,</span> <span class=\"token string\">'ç»è¿‡'</span><span class=\"token punctuation\">,</span> <span class=\"token string\">'ä¸‹å±'</span><span class=\"token punctuation\">,</span> <span class=\"token string\">'ç§‘å®¤'</span><span class=\"token punctuation\">,</span> <span class=\"token string\">'éƒ½'</span><span class=\"token punctuation\">]</span></pre></td></tr></table></figure><blockquote>\n<p>å…¨æ¨¡å¼åˆ†è¯ï¼šæŠŠå¥å­ä¸­æ‰€æœ‰çš„å¯ä»¥æˆè¯çš„è¯è¯­éƒ½æ‰«æå‡ºæ¥ï¼Œé€Ÿåº¦éå¸¸å¿«ï¼Œä½†æ˜¯ä¸èƒ½æ¶ˆé™¤æ­§ä¹‰ã€‚</p>\n</blockquote>\n<figure class=\"highlight python\"><figcaption data-lang=\"python\"></figcaption><table><tr><td data-num=\"1\"></td><td><pre><span class=\"token operator\">>></span><span class=\"token operator\">></span> content <span class=\"token operator\">=</span> <span class=\"token string\">\"å¥³å¹²äº‹æ¯æœˆç»è¿‡ä¸‹å±ç§‘å®¤éƒ½\"</span></pre></td></tr><tr><td data-num=\"2\"></td><td><pre><span class=\"token operator\">>></span><span class=\"token operator\">></span> jieba<span class=\"token punctuation\">.</span>cut<span class=\"token punctuation\">(</span>content<span class=\"token punctuation\">,</span>cut_all<span class=\"token operator\">=</span><span class=\"token boolean\">True</span><span class=\"token punctuation\">)</span></pre></td></tr><tr><td data-num=\"3\"></td><td><pre> <span class=\"token operator\">&lt;</span>generator <span class=\"token builtin\">object</span> Tokenizer<span class=\"token punctuation\">.</span>cut at <span class=\"token number\">0x000001ED13237D60</span><span class=\"token operator\">></span></pre></td></tr><tr><td data-num=\"4\"></td><td><pre><span class=\"token operator\">>></span><span class=\"token operator\">></span> jieba<span class=\"token punctuation\">.</span>lcut<span class=\"token punctuation\">(</span>content<span class=\"token punctuation\">,</span>cut_all<span class=\"token operator\">=</span><span class=\"token boolean\">True</span><span class=\"token punctuation\">)</span></pre></td></tr><tr><td data-num=\"5\"></td><td><pre> <span class=\"token punctuation\">[</span><span class=\"token string\">'å¥³å¹²äº‹'</span><span class=\"token punctuation\">,</span> <span class=\"token string\">'å¹²äº‹'</span><span class=\"token punctuation\">,</span> <span class=\"token string\">'æ¯æœˆ'</span><span class=\"token punctuation\">,</span> <span class=\"token string\">'æœˆç»'</span><span class=\"token punctuation\">,</span> <span class=\"token string\">'ç»è¿‡'</span><span class=\"token punctuation\">,</span> <span class=\"token string\">'ä¸‹å±'</span><span class=\"token punctuation\">,</span> <span class=\"token string\">'ç§‘å®¤'</span><span class=\"token punctuation\">,</span> <span class=\"token string\">'éƒ½'</span><span class=\"token punctuation\">]</span></pre></td></tr></table></figure><blockquote>\n<p>æœç´¢å¼•æ“æ¨¡å¼åˆ†è¯ï¼šåœ¨ç²¾ç¡®æ¨¡å¼çš„åŸºç¡€ä¸Šï¼Œå¯¹é•¿è¯å†æ¬¡åˆ‡åˆ†ï¼Œæé«˜å¬å›ç‡ï¼Œé€‚åˆç”¨äºæœç´¢å¼•æ“åˆ†è¯ã€‚</p>\n</blockquote>\n<figure class=\"highlight python\"><figcaption data-lang=\"python\"></figcaption><table><tr><td data-num=\"1\"></td><td><pre><span class=\"token operator\">>></span><span class=\"token operator\">></span> content <span class=\"token operator\">=</span> <span class=\"token string\">\"å¥³å¹²äº‹æ¯æœˆç»è¿‡ä¸‹å±ç§‘å®¤éƒ½\"</span></pre></td></tr><tr><td data-num=\"2\"></td><td><pre><span class=\"token operator\">>></span><span class=\"token operator\">></span> jieba<span class=\"token punctuation\">.</span>cut_for_search<span class=\"token punctuation\">(</span>content<span class=\"token punctuation\">)</span></pre></td></tr><tr><td data-num=\"3\"></td><td><pre> <span class=\"token operator\">&lt;</span>generator <span class=\"token builtin\">object</span> Tokenizer<span class=\"token punctuation\">.</span>cut_for_search at <span class=\"token number\">0x000001ED14A014A0</span><span class=\"token operator\">></span></pre></td></tr><tr><td data-num=\"4\"></td><td><pre><span class=\"token operator\">>></span><span class=\"token operator\">></span> jieba<span class=\"token punctuation\">.</span>lcut_for_search<span class=\"token punctuation\">(</span>content<span class=\"token punctuation\">)</span></pre></td></tr><tr><td data-num=\"5\"></td><td><pre><span class=\"token punctuation\">[</span><span class=\"token string\">'å¹²äº‹'</span><span class=\"token punctuation\">,</span> <span class=\"token string\">'å¥³å¹²äº‹'</span><span class=\"token punctuation\">,</span> <span class=\"token string\">'æ¯æœˆ'</span><span class=\"token punctuation\">,</span> <span class=\"token string\">'ç»è¿‡'</span><span class=\"token punctuation\">,</span> <span class=\"token string\">'ä¸‹å±'</span><span class=\"token punctuation\">,</span> <span class=\"token string\">'ç§‘å®¤'</span><span class=\"token punctuation\">,</span> <span class=\"token string\">'éƒ½'</span><span class=\"token punctuation\">]</span></pre></td></tr></table></figure><blockquote>\n<p>ä¸­æ–‡ç¹ä½“åˆ†è¯ï¼šé’ˆå¯¹ä¸­å›½é¦™æ¸¯ï¼Œå°æ¹¾åœ°åŒºçš„ç¹ä½“æ–‡æœ¬è¿›è¡Œåˆ†è¯</p>\n</blockquote>\n<figure class=\"highlight python\"><figcaption data-lang=\"python\"></figcaption><table><tr><td data-num=\"1\"></td><td><pre><span class=\"token operator\">>></span><span class=\"token operator\">></span> content <span class=\"token operator\">=</span> <span class=\"token string\">\"çƒ¦æƒ±å³æ˜¯è©æï¼Œæˆ‘æš‚ä¸”ä¸æ\"</span></pre></td></tr><tr><td data-num=\"2\"></td><td><pre><span class=\"token operator\">>></span><span class=\"token operator\">></span> jieba<span class=\"token punctuation\">.</span>lcut_for_search<span class=\"token punctuation\">(</span>content<span class=\"token punctuation\">)</span></pre></td></tr><tr><td data-num=\"3\"></td><td><pre> <span class=\"token punctuation\">[</span><span class=\"token string\">'çƒ¦æƒ±'</span><span class=\"token punctuation\">,</span> <span class=\"token string\">'å³'</span><span class=\"token punctuation\">,</span> <span class=\"token string\">'æ˜¯'</span><span class=\"token punctuation\">,</span> <span class=\"token string\">'è©æ'</span><span class=\"token punctuation\">,</span> <span class=\"token string\">'ï¼Œ'</span><span class=\"token punctuation\">,</span> <span class=\"token string\">'æˆ‘'</span><span class=\"token punctuation\">,</span> <span class=\"token string\">'æš‚ä¸”'</span><span class=\"token punctuation\">,</span> <span class=\"token string\">'ä¸æ'</span><span class=\"token punctuation\">]</span></pre></td></tr></table></figure><blockquote>\n<p>ä½¿ç”¨ç”¨æˆ·è‡ªå®šä¹‰è¯å…¸</p>\n</blockquote>\n<ul>\n<li>æ·»åŠ è‡ªå®šä¹‰è¯å…¸åï¼Œjieba èƒ½å¤Ÿå‡†ç¡®è¯†åˆ«è¯å…¸ä¸­å‡ºç°çš„è¯æ±‡ï¼Œæå‡æ•´ä½“çš„è¯†åˆ«å‡†ç¡®ç‡ï¼Œ</li>\n<li>è¯å…¸æ ¼å¼ï¼šæ¯ä¸€è¡Œåˆ†ä¸‰éƒ¨åˆ†ï¼šè¯è¯­ã€è¯é¢‘ï¼ˆå¯çœç•¥ï¼‰ã€è¯æ€§ï¼ˆå¯çœç•¥ï¼‰ï¼Œç”¨ç©ºæ ¼éš”å¼€<br />\né¡ºåºä¸å¯é¢ å€’</li>\n<li>è¯å…¸æ ·å¼å¦‚ä¸‹ï¼Œå…·ä½“è¯æ€§å«ä¹‰è¯·å‚ç…§é™„å½•ï¼šjieba è¯æ€§å¯¹ç…§è¡¨ï¼Œå°†è¯¥è¯å…¸å­˜ userdict.txt, æ–¹ä¾¿ä¹‹ååŠ è½½ä½¿ç”¨ã€‚</li>\n</ul>\n<figure class=\"highlight python\"><figcaption data-lang=\"python\"></figcaption><table><tr><td data-num=\"1\"></td><td><pre>äº‘è®¡ç®—5n</pre></td></tr><tr><td data-num=\"2\"></td><td><pre>æå°ç¦2nr</pre></td></tr><tr><td data-num=\"3\"></td><td><pre>easy_install <span class=\"token number\">3</span> eng</pre></td></tr><tr><td data-num=\"4\"></td><td><pre>å¥½ç”¨<span class=\"token number\">300</span></pre></td></tr><tr><td data-num=\"5\"></td><td><pre>éŸ©ç‰èµé‰´3nZ</pre></td></tr><tr><td data-num=\"6\"></td><td><pre>å…«ä¸€åŒé¹¿3nz</pre></td></tr></table></figure><hr />\n<figure class=\"highlight python\"><figcaption data-lang=\"python\"></figcaption><table><tr><td data-num=\"1\"></td><td><pre><span class=\"token operator\">>></span> <span class=\"token keyword\">import</span> jieba</pre></td></tr><tr><td data-num=\"2\"></td><td><pre><span class=\"token operator\">>></span><span class=\"token operator\">></span> jieba<span class=\"token punctuation\">.</span>1cut<span class=\"token punctuation\">(</span><span class=\"token string\">\"å…«ä¸€åŒé¹¿æ›´åä¸ºå…«ä¸€å—æ˜Œç¯®çƒé˜Ÿï¼\"</span><span class=\"token punctuation\">)</span></pre></td></tr><tr><td data-num=\"3\"></td><td><pre></pre></td></tr><tr><td data-num=\"4\"></td><td><pre><span class=\"token comment\">#æ²¡æœ‰ä½¿ç”¨ç”¨æˆ·è‡ªå®šä¹‰è¯å…¸å‰çš„ç»“æœï¼š</span></pre></td></tr><tr><td data-num=\"5\"></td><td><pre><span class=\"token operator\">>></span><span class=\"token operator\">></span><span class=\"token punctuation\">[</span><span class=\"token string\">'å…«ä¸€åŒé¹¿'</span>ï¼Œ<span class=\"token string\">'æ›´å'</span>ï¼Œ<span class=\"token string\">'ä¸º'</span>ï¼Œ<span class=\"token string\">'å…«ä¸€'</span>ï¼Œ<span class=\"token string\">'å—æ˜Œ'</span>ï¼Œ<span class=\"token string\">'ç¯®çƒé˜Ÿ'</span>ï¼Œ<span class=\"token string\">'!'</span><span class=\"token punctuation\">]</span></pre></td></tr><tr><td data-num=\"6\"></td><td><pre></pre></td></tr><tr><td data-num=\"7\"></td><td><pre><span class=\"token operator\">>></span>jieba<span class=\"token punctuation\">.</span>load_userdict<span class=\"token punctuation\">(</span><span class=\"token string\">\"./userdict.txt\"</span><span class=\"token punctuation\">)</span></pre></td></tr><tr><td data-num=\"8\"></td><td><pre><span class=\"token comment\">#ä½¿ç”¨äº†ç”¨æˆ·è‡ªå®šä¹‰è¯å…¸åçš„ç»“æœï¼š</span></pre></td></tr><tr><td data-num=\"9\"></td><td><pre><span class=\"token punctuation\">[</span><span class=\"token string\">'å…«ä¸€åŒé¹¿'</span>ï¼Œ<span class=\"token string\">'æ›´å'</span>ï¼Œ<span class=\"token string\">'ä¸º'</span><span class=\"token punctuation\">,</span><span class=\"token string\">'å…«ä¸€'</span><span class=\"token punctuation\">,</span><span class=\"token string\">'å—æ˜Œ'</span>ï¼Œ<span class=\"token string\">'ç¯®çƒé˜Ÿ'</span>ï¼Œ<span class=\"token string\">'!'</span><span class=\"token punctuation\">]</span></pre></td></tr></table></figure><h2 id=\"å‘½åå®ä½“è¯†åˆ«\"><a class=\"anchor\" href=\"#å‘½åå®ä½“è¯†åˆ«\">#</a> å‘½åå®ä½“è¯†åˆ«</h2>\n<p>é¡¾åæ€ä¹‰ï¼Œå‘½åå®ä½“è¯†åˆ« (Named Entity Recognition, ç®€ç§° NER) å°±æ˜¯è¯†åˆ«å‡ºä¸€æ®µæ–‡æœ¬ä¸­å¯èƒ½å­˜åœ¨çš„å‘½åå®ä½“ã€‚</p>\n<ul>\n<li>å‘½åå®ä½“è¯†åˆ«çš„ä½œç”¨ï¼š</li>\n</ul>\n<p>åŒè¯æ±‡ä¸€æ ·ï¼Œå‘½åå®ä½“ä¹Ÿæ˜¯äººç±»ç†è§£æ–‡æœ¬çš„åŸºç¡€å•å…ƒï¼Œå› æ­¤ä¹Ÿæ˜¯ A è§£å†³ NLP é¢†åŸŸé«˜é˜¶ä»»åŠ¡çš„é‡è¦åŸºç¡€ç¯èŠ‚</p>\n<h2 id=\"è¯æ€§æ ‡æ³¨\"><a class=\"anchor\" href=\"#è¯æ€§æ ‡æ³¨\">#</a> è¯æ€§æ ‡æ³¨</h2>\n<blockquote>\n<p>è¯æ€§ï¼šè¯­è¨€ä¸­å¯¹è¯çš„ä¸€ç§åˆ†ç±»æ–¹æ³•ï¼Œä»¥è¯­æ³•ç‰¹å¾ä¸ºä¸»è¦ä¾æ®ã€å…¼é¡¾è¯æ±‡æ„ä¹‰å¯¹è¯è¿›è¡Œåˆ’åˆ†çš„ç»“æœï¼Œå¸¸è§çš„è¯æ€§æœ‰ 143 å¦‚ï¼šåè¯ï¼ŒåŠ¨è¯ï¼Œå½¢å®¹è¯ç­‰</p>\n</blockquote>\n<p>é¡¾åæ€ä¹‰ï¼Œè¯æ€§æ ‡æ³¨ (Part-Of-Speech tagging, ç®€ç§° POS) å°±æ˜¯æ ‡æ³¨å‡ºä¸€æ®µæ–‡æœ¬ä¸­æ¯ä¸ªè¯æ±‡çš„è¯æ€§ã€‚</p>\n<ul>\n<li>è¯æ€§æ ‡æ³¨çš„ä½œç”¨</li>\n</ul>\n<p>è¯æ€§æ ‡æ³¨ä»¥åˆ†è¯ä¸ºåŸºç¡€ï¼Œæ˜¯å¯¹æ–‡æœ¬è¯­è¨€çš„å¦ä¸€ä¸ªè§’åº¦çš„ç†è§£ï¼Œå› æ­¤ä¹Ÿå¸¸å¸¸æˆä¸º A è§£å†³ NLP é¢†åŸŸé«˜é˜¶ä»»åŠ¡çš„é‡è¦åŸºç¡€ç¯èŠ‚ã€‚</p>\n<ul>\n<li>ä½¿ç”¨ jieba è¿›è¡Œä¸­æ–‡è¯æ€§æ ‡æ³¨</li>\n</ul>\n<figure class=\"highlight python\"><figcaption data-lang=\"python\"></figcaption><table><tr><td data-num=\"1\"></td><td><pre><span class=\"token operator\">>></span><span class=\"token operator\">></span> <span class=\"token keyword\">import</span> jieba<span class=\"token punctuation\">.</span>posseg <span class=\"token keyword\">as</span> pseg</pre></td></tr><tr><td data-num=\"2\"></td><td><pre><span class=\"token operator\">>></span><span class=\"token operator\">></span> pseg<span class=\"token punctuation\">.</span>lcut<span class=\"token punctuation\">(</span><span class=\"token string\">\"æˆ‘çˆ±åŒ—äº¬å¤©å®‰é—¨\"</span><span class=\"token punctuation\">)</span></pre></td></tr><tr><td data-num=\"3\"></td><td><pre><span class=\"token punctuation\">[</span>pair<span class=\"token punctuation\">(</span><span class=\"token string\">'æˆ‘'</span><span class=\"token punctuation\">,</span> <span class=\"token string\">'r'</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">,</span> pair<span class=\"token punctuation\">(</span><span class=\"token string\">'çˆ±'</span><span class=\"token punctuation\">,</span> <span class=\"token string\">'v'</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">,</span> pair<span class=\"token punctuation\">(</span><span class=\"token string\">'åŒ—äº¬'</span><span class=\"token punctuation\">,</span> <span class=\"token string\">'ns'</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">,</span> pair<span class=\"token punctuation\">(</span><span class=\"token string\">'å¤©å®‰é—¨'</span><span class=\"token punctuation\">,</span> <span class=\"token string\">'ns'</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">]</span></pre></td></tr><tr><td data-num=\"4\"></td><td><pre></pre></td></tr><tr><td data-num=\"5\"></td><td><pre>rr<span class=\"token punctuation\">:</span>äººç§°ä»£è¯</pre></td></tr><tr><td data-num=\"6\"></td><td><pre>v<span class=\"token punctuation\">:</span>åŠ¨è¯</pre></td></tr><tr><td data-num=\"7\"></td><td><pre>n<span class=\"token punctuation\">:</span>åè¯</pre></td></tr><tr><td data-num=\"8\"></td><td><pre>vn<span class=\"token punctuation\">:</span>åŠ¨åè¯</pre></td></tr></table></figure><h1 id=\"æ–‡æœ¬å¼ é‡è¡¨ç¤ºæ–¹æ³•\"><a class=\"anchor\" href=\"#æ–‡æœ¬å¼ é‡è¡¨ç¤ºæ–¹æ³•\">#</a> æ–‡æœ¬å¼ é‡è¡¨ç¤ºæ–¹æ³•</h1>\n<ul>\n<li>ä»€ä¹ˆæ˜¯æ–‡æœ¬å¼ é‡è¡¨ç¤º</li>\n</ul>\n<p>å°†ä¸€æ®µæ–‡æœ¬ä½¿ç”¨å¼ é‡è¿›è¡Œè¡¨ç¤ºï¼Œå…¶ä¸­ä¸€èˆ¬å°†è¯æ±‡ä¸ºè¡¨ç¤ºæˆå‘é‡ï¼Œç§°ä½œè¯å‘é‡ï¼Œå†ç”±å„ä¸ªè¯å‘é‡æŒ‰é¡ºåºç»„æˆçŸ©é˜µå½¢æˆæ–‡æœ¬è¡¨ç¤ºã€‚</p>\n<p>ä¸¾ä¸ªæ —å­</p>\n<figure class=\"highlight python\"><figcaption data-lang=\"python\"></figcaption><table><tr><td data-num=\"1\"></td><td><pre><span class=\"token punctuation\">[</span><span class=\"token string\">\"äººç”Ÿ\"</span>ï¼Œ<span class=\"token string\">\"è¯¥\"</span>ï¼Œ<span class=\"token string\">\"å¦‚ä½•\"</span>ï¼Œ<span class=\"token string\">\"èµ·å¤´\"</span><span class=\"token punctuation\">]</span></pre></td></tr><tr><td data-num=\"2\"></td><td><pre></pre></td></tr><tr><td data-num=\"3\"></td><td><pre><span class=\"token operator\">==</span><span class=\"token operator\">></span></pre></td></tr><tr><td data-num=\"4\"></td><td><pre></pre></td></tr><tr><td data-num=\"5\"></td><td><pre><span class=\"token comment\">#æ¯ä¸ªè¯å¯¹åº”çŸ©é˜µä¸­çš„ä¸€ä¸ªå‘é‡</span></pre></td></tr><tr><td data-num=\"6\"></td><td><pre><span class=\"token punctuation\">[</span><span class=\"token punctuation\">[</span><span class=\"token number\">1.32</span><span class=\"token punctuation\">,</span><span class=\"token number\">4</span><span class=\"token punctuation\">,</span><span class=\"token number\">32</span><span class=\"token punctuation\">,</span><span class=\"token number\">6</span><span class=\"token punctuation\">,</span><span class=\"token number\">32</span><span class=\"token punctuation\">,</span><span class=\"token number\">5.2</span><span class=\"token punctuation\">]</span><span class=\"token punctuation\">,</span></pre></td></tr><tr><td data-num=\"7\"></td><td><pre><span class=\"token punctuation\">[</span><span class=\"token number\">3.1</span><span class=\"token punctuation\">,</span><span class=\"token number\">5.43</span><span class=\"token punctuation\">,</span><span class=\"token number\">0.34</span><span class=\"token punctuation\">,</span><span class=\"token number\">3.2</span><span class=\"token punctuation\">]</span><span class=\"token punctuation\">,</span></pre></td></tr><tr><td data-num=\"8\"></td><td><pre><span class=\"token punctuation\">[</span><span class=\"token number\">3.21</span><span class=\"token punctuation\">,</span><span class=\"token number\">5.32</span><span class=\"token punctuation\">,</span><span class=\"token number\">2</span><span class=\"token punctuation\">,</span><span class=\"token number\">4.32</span><span class=\"token punctuation\">]</span><span class=\"token punctuation\">,</span></pre></td></tr><tr><td data-num=\"9\"></td><td><pre><span class=\"token punctuation\">[</span><span class=\"token number\">2.54</span><span class=\"token punctuation\">,</span><span class=\"token number\">7.32</span><span class=\"token punctuation\">,</span><span class=\"token number\">5.12</span><span class=\"token punctuation\">,</span><span class=\"token number\">9.54</span><span class=\"token punctuation\">]</span><span class=\"token punctuation\">]</span></pre></td></tr></table></figure><ul>\n<li>æ–‡æœ¬å¼ é‡è¡¨ç¤ºçš„ä½œç”¨</li>\n</ul>\n<p>å°†æ–‡æœ¬è¡¨ç¤ºæˆå¼ é‡ï¼ˆçŸ©é˜µï¼‰å½¢å¼ï¼Œèƒ½å¤Ÿä½¿è¯­è¨€æ–‡æœ¬å¯ä»¥ä½œä¸ºè®¡ç®—æœºå¤„ç†ç¨‹åºçš„è¾“å…¥ï¼Œè¿›è¡Œæ¥ä¸‹æ¥ä¸€ç³»åˆ—çš„è§£æå·¥ä½œã€‚</p>\n<blockquote>\n<ul>\n<li>æ–‡æœ¬å¼ é‡è¡¨ç¤ºçš„æ–¹æ³•ï¼š\n<ul>\n<li>one-hot ç¼–ç </li>\n<li>Word2vec</li>\n<li>Word Embedding</li>\n</ul>\n</li>\n</ul>\n</blockquote>\n<h2 id=\"one-hotç‹¬çƒ­ç¼–ç \"><a class=\"anchor\" href=\"#one-hotç‹¬çƒ­ç¼–ç \">#</a> one-hot (ç‹¬çƒ­ç¼–ç )</h2>\n<ul>\n<li>ä»€ä¹ˆæ˜¯ one-hot (ç‹¬çƒ­ç¼–ç ) è¯å‘é‡è¡¨ç¤º</li>\n</ul>\n<p>åˆç§°ç‹¬çƒ­ç¼–ç ï¼Œå°†æ¯ä¸ªè¯è¡¨ç¤ºæˆå…·æœ‰ä¸ªå…ƒç´ çš„å‘é‡ï¼Œè¿™ä¸ªè¯å‘é‡ä¸­åªæœ‰ä¸€ä¸ªå…ƒç´ æ˜¯ 1ï¼Œå…¶ä»–å…ƒç´ éƒ½æ˜¯ 0ï¼Œä¸åŒè¯æ±‡å…ƒç´ ä¸º 0 çš„ä½ç½®ä¸åŒï¼Œå…¶ä¸­çš„å¤§å°æ˜¯æ•´ä¸ªè¯­æ–™ä¸­ä¸åŒè¯æ±‡çš„æ€»æ•°ã€‚</p>\n<p>ä¸¾ä¸ªæ —å­</p>\n<figure class=\"highlight python\"><figcaption data-lang=\"python\"></figcaption><table><tr><td data-num=\"1\"></td><td><pre><span class=\"token punctuation\">[</span><span class=\"token string\">\"æ”¹å˜\"</span>ï¼Œ<span class=\"token string\">\"è¦\"</span>ï¼Œ<span class=\"token string\">\"å¦‚ä½•\"</span>ï¼Œ<span class=\"token string\">\"èµ·æ‰‹\"</span><span class=\"token punctuation\">]</span></pre></td></tr><tr><td data-num=\"2\"></td><td><pre></pre></td></tr><tr><td data-num=\"3\"></td><td><pre><span class=\"token operator\">==</span><span class=\"token operator\">></span></pre></td></tr><tr><td data-num=\"4\"></td><td><pre></pre></td></tr><tr><td data-num=\"5\"></td><td><pre><span class=\"token punctuation\">[</span><span class=\"token punctuation\">[</span><span class=\"token number\">1</span><span class=\"token punctuation\">,</span><span class=\"token number\">0</span><span class=\"token punctuation\">,</span><span class=\"token number\">6</span><span class=\"token punctuation\">,</span><span class=\"token number\">0</span><span class=\"token punctuation\">]</span><span class=\"token punctuation\">,</span></pre></td></tr><tr><td data-num=\"6\"></td><td><pre><span class=\"token punctuation\">[</span><span class=\"token number\">6</span><span class=\"token punctuation\">,</span><span class=\"token number\">1</span><span class=\"token punctuation\">,</span><span class=\"token number\">6</span><span class=\"token punctuation\">,</span><span class=\"token number\">0</span><span class=\"token punctuation\">]</span><span class=\"token punctuation\">,</span></pre></td></tr><tr><td data-num=\"7\"></td><td><pre><span class=\"token punctuation\">[</span><span class=\"token number\">6</span><span class=\"token punctuation\">,</span><span class=\"token number\">0</span><span class=\"token punctuation\">,</span><span class=\"token number\">1</span><span class=\"token punctuation\">,</span><span class=\"token number\">6</span><span class=\"token punctuation\">]</span><span class=\"token punctuation\">,</span></pre></td></tr><tr><td data-num=\"8\"></td><td><pre><span class=\"token punctuation\">[</span><span class=\"token number\">6</span><span class=\"token punctuation\">,</span><span class=\"token number\">0</span><span class=\"token punctuation\">,</span><span class=\"token number\">0</span><span class=\"token punctuation\">,</span><span class=\"token number\">1</span><span class=\"token punctuation\">]</span><span class=\"token punctuation\">]</span></pre></td></tr></table></figure><ul>\n<li>å®ç°</li>\n</ul>\n<ol>\n<li>è¿›è¡Œ one-hot (ç‹¬çƒ­ç¼–ç )</li>\n</ol>\n<figure class=\"highlight python\"><figcaption data-lang=\"python\"></figcaption><table><tr><td data-num=\"1\"></td><td><pre><span class=\"token comment\">#å¯¼å…¥ç”¨äºå¯¹è±¡ä¿å­˜ä¸åŠ è½½çš„ job11b</span></pre></td></tr><tr><td data-num=\"2\"></td><td><pre><span class=\"token keyword\">from</span> sklearn<span class=\"token punctuation\">.</span>externals <span class=\"token keyword\">import</span> joblib</pre></td></tr><tr><td data-num=\"3\"></td><td><pre><span class=\"token comment\">#å¯¼å…¥ keras ä¸­çš„è¯æ±‡æ˜ å°„å™¨ Tokenizer</span></pre></td></tr><tr><td data-num=\"4\"></td><td><pre><span class=\"token keyword\">from</span> keras<span class=\"token punctuation\">.</span>preprocessing<span class=\"token punctuation\">.</span>text <span class=\"token keyword\">import</span> Tokenizer</pre></td></tr><tr><td data-num=\"5\"></td><td><pre><span class=\"token comment\">#å‡å®š vocab ä¸ºè¯­æ–™é›†æ‰€æœ‰ä¸åŒè¯æ±‡é›†åˆ</span></pre></td></tr><tr><td data-num=\"6\"></td><td><pre>vocab <span class=\"token operator\">=</span> <span class=\"token punctuation\">&#123;</span><span class=\"token string\">\"å‘¨æ°ä¼¦\"</span><span class=\"token punctuation\">,</span><span class=\"token string\">\"é™ˆå¥•è¿…\"</span><span class=\"token punctuation\">,</span><span class=\"token string\">\"ç‹åŠ›å®\"</span><span class=\"token punctuation\">,</span><span class=\"token string\">\"æå®—ç››\"</span><span class=\"token punctuation\">,</span><span class=\"token string\">\"å´äº¦å‡¡\"</span><span class=\"token punctuation\">,</span><span class=\"token string\">\"é¹¿æ™—\"</span><span class=\"token punctuation\">&#125;</span></pre></td></tr><tr><td data-num=\"7\"></td><td><pre><span class=\"token comment\">#å®ä¾‹åŒ–ä¸€ä¸ªè¯æ±‡æ˜ å°„å™¨å¯¹è±¡</span></pre></td></tr><tr><td data-num=\"8\"></td><td><pre>t <span class=\"token operator\">=</span> Tokenizer<span class=\"token punctuation\">(</span>num_words<span class=\"token operator\">=</span><span class=\"token boolean\">None</span><span class=\"token punctuation\">,</span>char_level<span class=\"token operator\">=</span><span class=\"token boolean\">False</span><span class=\"token punctuation\">)</span></pre></td></tr><tr><td data-num=\"9\"></td><td><pre><span class=\"token comment\">#ä½¿ç”¨æ˜ å°„å™¨æ‹Ÿåˆç°æœ‰æ–‡æœ¬æ•°æ®</span></pre></td></tr><tr><td data-num=\"10\"></td><td><pre>t<span class=\"token punctuation\">.</span>fit_on_texts<span class=\"token punctuation\">(</span>vocab<span class=\"token punctuation\">)</span></pre></td></tr><tr><td data-num=\"11\"></td><td><pre></pre></td></tr><tr><td data-num=\"12\"></td><td><pre><span class=\"token keyword\">for</span> token <span class=\"token keyword\">in</span> vocab<span class=\"token punctuation\">:</span></pre></td></tr><tr><td data-num=\"13\"></td><td><pre>    zero_list <span class=\"token operator\">=</span> <span class=\"token punctuation\">[</span><span class=\"token number\">0</span><span class=\"token punctuation\">]</span><span class=\"token operator\">*</span><span class=\"token builtin\">len</span><span class=\"token punctuation\">(</span>vocab<span class=\"token punctuation\">)</span></pre></td></tr><tr><td data-num=\"14\"></td><td><pre>    <span class=\"token comment\">#ä½¿ç”¨æ˜ å°„å™¨è½¬åŒ–ç°æœ‰æ–‡æœ¬æ•°æ®ï¼Œ** æ¯ä¸ªè¯æ±‡å¯¹åº”ä» 1 å¼€å§‹çš„è‡ªç„¶æ•°</span></pre></td></tr><tr><td data-num=\"15\"></td><td><pre>    <span class=\"token comment\">#è¿”å›æ ·å¼å¦‚ï¼š[[2]]ï¼Œå–å‡ºå…¶ä¸­çš„æ•°å­—éœ€è¦ä½¿ç”¨ [0][0]</span></pre></td></tr><tr><td data-num=\"16\"></td><td><pre>    token_index <span class=\"token operator\">=</span> t<span class=\"token punctuation\">.</span>texts_to_sequences<span class=\"token punctuation\">(</span><span class=\"token punctuation\">[</span>token<span class=\"token punctuation\">]</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">[</span><span class=\"token number\">0</span><span class=\"token punctuation\">]</span><span class=\"token punctuation\">[</span><span class=\"token number\">0</span><span class=\"token punctuation\">]</span> <span class=\"token operator\">-</span> <span class=\"token number\">1</span></pre></td></tr><tr><td data-num=\"17\"></td><td><pre>    zero_list<span class=\"token punctuation\">[</span>token_index<span class=\"token punctuation\">]</span> <span class=\"token operator\">=</span> <span class=\"token number\">1</span></pre></td></tr><tr><td data-num=\"18\"></td><td><pre>    <span class=\"token keyword\">print</span><span class=\"token punctuation\">(</span>token<span class=\"token punctuation\">,</span><span class=\"token string\">\"çš„one-hotç¼–ç ä¸ºï¼š\"</span><span class=\"token punctuation\">,</span>zero_list<span class=\"token punctuation\">)</span></pre></td></tr><tr><td data-num=\"19\"></td><td><pre></pre></td></tr><tr><td data-num=\"20\"></td><td><pre>æå®—ç›› çš„one<span class=\"token operator\">-</span>hotç¼–ç ä¸ºï¼š <span class=\"token punctuation\">[</span><span class=\"token number\">1</span><span class=\"token punctuation\">,</span> <span class=\"token number\">0</span><span class=\"token punctuation\">,</span> <span class=\"token number\">0</span><span class=\"token punctuation\">,</span> <span class=\"token number\">0</span><span class=\"token punctuation\">,</span> <span class=\"token number\">0</span><span class=\"token punctuation\">,</span> <span class=\"token number\">0</span><span class=\"token punctuation\">]</span></pre></td></tr><tr><td data-num=\"21\"></td><td><pre>ç‹åŠ›å® çš„one<span class=\"token operator\">-</span>hotç¼–ç ä¸ºï¼š <span class=\"token punctuation\">[</span><span class=\"token number\">0</span><span class=\"token punctuation\">,</span> <span class=\"token number\">1</span><span class=\"token punctuation\">,</span> <span class=\"token number\">0</span><span class=\"token punctuation\">,</span> <span class=\"token number\">0</span><span class=\"token punctuation\">,</span> <span class=\"token number\">0</span><span class=\"token punctuation\">,</span> <span class=\"token number\">0</span><span class=\"token punctuation\">]</span></pre></td></tr><tr><td data-num=\"22\"></td><td><pre>é¹¿æ™— çš„one<span class=\"token operator\">-</span>hotç¼–ç ä¸ºï¼š <span class=\"token punctuation\">[</span><span class=\"token number\">0</span><span class=\"token punctuation\">,</span> <span class=\"token number\">0</span><span class=\"token punctuation\">,</span> <span class=\"token number\">1</span><span class=\"token punctuation\">,</span> <span class=\"token number\">0</span><span class=\"token punctuation\">,</span> <span class=\"token number\">0</span><span class=\"token punctuation\">,</span> <span class=\"token number\">0</span><span class=\"token punctuation\">]</span></pre></td></tr><tr><td data-num=\"23\"></td><td><pre>å´äº¦å‡¡ çš„one<span class=\"token operator\">-</span>hotç¼–ç ä¸ºï¼š <span class=\"token punctuation\">[</span><span class=\"token number\">0</span><span class=\"token punctuation\">,</span> <span class=\"token number\">0</span><span class=\"token punctuation\">,</span> <span class=\"token number\">0</span><span class=\"token punctuation\">,</span> <span class=\"token number\">1</span><span class=\"token punctuation\">,</span> <span class=\"token number\">0</span><span class=\"token punctuation\">,</span> <span class=\"token number\">0</span><span class=\"token punctuation\">]</span></pre></td></tr><tr><td data-num=\"24\"></td><td><pre>é™ˆå¥•è¿… çš„one<span class=\"token operator\">-</span>hotç¼–ç ä¸ºï¼š <span class=\"token punctuation\">[</span><span class=\"token number\">0</span><span class=\"token punctuation\">,</span> <span class=\"token number\">0</span><span class=\"token punctuation\">,</span> <span class=\"token number\">0</span><span class=\"token punctuation\">,</span> <span class=\"token number\">0</span><span class=\"token punctuation\">,</span> <span class=\"token number\">1</span><span class=\"token punctuation\">,</span> <span class=\"token number\">0</span><span class=\"token punctuation\">]</span></pre></td></tr><tr><td data-num=\"25\"></td><td><pre>å‘¨æ°ä¼¦ çš„one<span class=\"token operator\">-</span>hotç¼–ç ä¸ºï¼š <span class=\"token punctuation\">[</span><span class=\"token number\">0</span><span class=\"token punctuation\">,</span> <span class=\"token number\">0</span><span class=\"token punctuation\">,</span> <span class=\"token number\">0</span><span class=\"token punctuation\">,</span> <span class=\"token number\">0</span><span class=\"token punctuation\">,</span> <span class=\"token number\">0</span><span class=\"token punctuation\">,</span> <span class=\"token number\">1</span><span class=\"token punctuation\">]</span></pre></td></tr><tr><td data-num=\"26\"></td><td><pre></pre></td></tr><tr><td data-num=\"27\"></td><td><pre><span class=\"token comment\">#ä½¿ç”¨ jobl1b å·¥å…·ä¿å­˜æ˜ å°„å™¨ï¼Œä»¥ä¾¿ä¹‹åä½¿ç”¨</span></pre></td></tr><tr><td data-num=\"28\"></td><td><pre>tokenizer_path <span class=\"token string\">\"./Tokenizer\"</span></pre></td></tr><tr><td data-num=\"29\"></td><td><pre>joblib<span class=\"token punctuation\">.</span>dump<span class=\"token punctuation\">(</span>t<span class=\"token punctuation\">,</span>tokenizer_path<span class=\"token punctuation\">)</span></pre></td></tr></table></figure><div class=\"note danger\">\n<p>æ³¨æ„ï¼ï¼ï¼ åŠ¡å¿…ç”¨ conda å®‰è£… tensorflow, ä¼šè‡ªåŠ¨åŒ¹é…å¯¹åº”çš„ç‰ˆæœ¬ï¼Œpip ä¼šæœ‰ä¸å…¼å®¹é—®é¢˜ã€‚<br />\ncpu çš„ç›´æ¥ <code>conda install tensorflow</code>  å³å¯ï¼Œä¸è¦æŒ‡å®šç‰ˆæœ¬ï¼Œä¼šæ‰¾ä¸åˆ°åŒ…ã€‚ç„¶åæ ¹æ®å¯¹åº”çš„æŠ¥é”™è¿›è¡Œ <code>conda install chardet</code> , å¤§åŠŸå‘Šæˆï¼</p>\n</div>\n<ol start=\"2\">\n<li>ä½¿ç”¨</li>\n</ol>\n<figure class=\"highlight python\"><figcaption data-lang=\"python\"></figcaption><table><tr><td data-num=\"1\"></td><td><pre><span class=\"token comment\">#å¯¼å…¥ç”¨äºå¯¹è±¡ä¿å­˜ä¸åŠ è½½çš„ job11b</span></pre></td></tr><tr><td data-num=\"2\"></td><td><pre><span class=\"token keyword\">from</span> sklearn<span class=\"token punctuation\">.</span>externals <span class=\"token keyword\">import</span> joblib</pre></td></tr><tr><td data-num=\"3\"></td><td><pre><span class=\"token comment\">#åŠ è½½ä¹‹å‰ä¿å­˜çš„ Tokenizer, å®ä¾‹åŒ–ä¸€ä¸ª t å¯¹è±¡</span></pre></td></tr><tr><td data-num=\"4\"></td><td><pre>t <span class=\"token operator\">=</span> joblib<span class=\"token punctuation\">.</span>load<span class=\"token punctuation\">(</span>tokenizer_path<span class=\"token punctuation\">)</span></pre></td></tr><tr><td data-num=\"5\"></td><td><pre></pre></td></tr><tr><td data-num=\"6\"></td><td><pre><span class=\"token comment\">#ç¼–ç  token ä¸º \"æå®—ç››\"</span></pre></td></tr><tr><td data-num=\"7\"></td><td><pre>token<span class=\"token operator\">=</span><span class=\"token string\">\"æå®—ç››\"</span></pre></td></tr><tr><td data-num=\"8\"></td><td><pre><span class=\"token comment\">#ä½¿ç”¨ t è·å¾— token-index</span></pre></td></tr><tr><td data-num=\"9\"></td><td><pre>token_index <span class=\"token operator\">=</span> t<span class=\"token punctuation\">.</span>texts_to_sequences<span class=\"token punctuation\">(</span><span class=\"token punctuation\">[</span>token<span class=\"token punctuation\">]</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">[</span><span class=\"token number\">0</span><span class=\"token punctuation\">]</span><span class=\"token punctuation\">[</span><span class=\"token number\">0</span><span class=\"token punctuation\">]</span> <span class=\"token operator\">-</span> <span class=\"token number\">1</span></pre></td></tr><tr><td data-num=\"10\"></td><td><pre><span class=\"token comment\">#åˆå§‹åŒ–ä¸€ä¸ª zero-11st</span></pre></td></tr><tr><td data-num=\"11\"></td><td><pre>zero_list <span class=\"token operator\">=</span> <span class=\"token punctuation\">[</span><span class=\"token number\">0</span><span class=\"token punctuation\">]</span><span class=\"token operator\">*</span><span class=\"token builtin\">len</span><span class=\"token punctuation\">(</span>vocab<span class=\"token punctuation\">)</span></pre></td></tr><tr><td data-num=\"12\"></td><td><pre><span class=\"token comment\">#ä»¤ zero-L1st çš„å¯¹åº”ç´¢å¼•ä¸º 1</span></pre></td></tr><tr><td data-num=\"13\"></td><td><pre>zero_list<span class=\"token punctuation\">[</span>token_index<span class=\"token punctuation\">]</span> <span class=\"token operator\">=</span> <span class=\"token number\">1</span></pre></td></tr><tr><td data-num=\"14\"></td><td><pre><span class=\"token keyword\">print</span><span class=\"token punctuation\">(</span>token<span class=\"token punctuation\">,</span><span class=\"token string\">\"çš„one-hotç¼–ç ä¸ºï¼š\"</span>ï¼Œzero_list<span class=\"token punctuation\">)</span></pre></td></tr></table></figure><ol start=\"3\">\n<li>è¾“å‡ºæ•ˆæœ</li>\n</ol>\n<figure class=\"highlight python\"><figcaption data-lang=\"python\"></figcaption><table><tr><td data-num=\"1\"></td><td><pre>æå®—ç››çš„one<span class=\"token operator\">-</span>hotç¼–ç ä¸ºï¼š<span class=\"token punctuation\">[</span><span class=\"token number\">1</span><span class=\"token punctuation\">,</span><span class=\"token number\">0</span><span class=\"token punctuation\">,</span><span class=\"token number\">0</span><span class=\"token punctuation\">,</span><span class=\"token number\">0</span><span class=\"token punctuation\">,</span><span class=\"token number\">0</span><span class=\"token punctuation\">,</span><span class=\"token number\">6</span><span class=\"token punctuation\">]</span></pre></td></tr></table></figure><ol start=\"4\">\n<li>one-hot ç¼–ç çš„ä¼˜åŠ£åŠ¿ï¼š</li>\n</ol>\n<p>ä¼˜åŠ¿ï¼šæ‘„ä½œç®€å•ï¼Œå®¹æ˜“ç†è§£ã€‚</p>\n<p>åŠ£åŠ¿ï¼šå®Œå…¨å‰²è£‚äº†è¯ä¸è¯ä¹‹é—´çš„è”ç³»ï¼Œè€Œä¸”åœ¨å¤§è¯­æ–™é›†ä¸‹ï¼Œæ¯ä¸ªå‘é‡çš„é•¿åº¦è¿‡å¤§ï¼Œå æ®å¤§é‡å†…å­˜ã€‚</p>\n<p><span class=\"label danger\">è¯´æ˜</span></p>\n<p>æ­£å› ä¸º one-hot ç¼–ç æ˜æ˜¾çš„åŠ£åŠ¿ï¼Œè¿™ç§ç¼–ç æ–¹å¼è¢«åº”ç”¨çš„åœ°æ–¹è¶Šæ¥è¶Šå°‘ï¼Œå–è€Œä»£ä¹‹çš„æ˜¯<br />\næ¥ä¸‹æ¥æˆ‘ä»¬è¦å­¦ä¹ çš„ç¨ å¯†å‘é‡çš„è¡¨ç¤ºæ–¹æ³• word2vec å’Œ word embeddingã€‚</p>\n<h2 id=\"word2vec\"><a class=\"anchor\" href=\"#word2vec\">#</a> Word2vec</h2>\n<p>æ˜¯ä¸€ç§æµè¡Œçš„å°†è¯æ±‡è¡¨ç¤ºæˆå‘é‡çš„æ— ç›‘ç£è®­ç»ƒæ–¹æ³•ï¼Œè¯¥è¿‡ç¨‹å°†æ„å»ºç¥ç»ç½‘ç»œæ¨¡å‹ï¼Œå°†ç½‘ç»œå‚<br />\næ•°ä½œä¸ºè¯æ±‡çš„å‘é‡è¡¨ç¤ºï¼Œå®ƒåŒ…å« CBOW å’Œ skipgram ä¸¤ç§è®­ç»ƒæ¨¡å¼ã€‚</p>\n<h3 id=\"cbowcontinuous-bag-of-wordsæ¨¡å¼\"><a class=\"anchor\" href=\"#cbowcontinuous-bag-of-wordsæ¨¡å¼\">#</a> CBOW (Continuous bag of words) æ¨¡å¼</h3>\n<p>ç»™å®šä¸€æ®µç”¨äºè®­ç»ƒçš„æ–‡æœ¬è¯­æ–™ï¼Œå†é€‰å®šæŸæ®µé•¿åº¦ï¼ˆçª—å£ï¼‰ä½œä¸ºç ”ç©¶å¯¹è±¡ï¼Œä½¿ç”¨ä¸Šä¸‹æ–‡è¯æ±‡é¢„æµ‹ç›®æ ‡è¯æ±‡ã€‚</p>\n<p><img data-src=\"https://i0.imgs.ovh/2024/02/13/olDK3.png\" alt=\"tu\" title=\"CBOWæ¨¡å¼\" /></p>\n<p>å›¾ä¸­çª—å£å¤§å°ä¸º 9ï¼Œä½¿ç”¨å‰å 4 ä¸ªè¯æ±‡å¯¹ç›®æ ‡è¯æ±‡è¿›è¡Œé¢„æµ‹ã€‚</p>\n<h4 id=\"word2vecè¿‡ç¨‹\"><a class=\"anchor\" href=\"#word2vecè¿‡ç¨‹\">#</a> Word2vec è¿‡ç¨‹</h4>\n<p>å‡è®¾æˆ‘ä»¬ç»™å®šçš„è®­ç»ƒè¯­æ–™åªæœ‰ä¸€å¥è¯ï¼š <code>Hope can set you free</code>  (æ„¿ä½ è‡ªç”±æˆé•¿)ï¼Œçª—å£å¤§å°ä¸º<br />\n 3, å› æ­¤æ¨¡å‹çš„ç¬¬ä¸€ä¸ªè®­ç»ƒæ ·æœ¬æ¥è‡ª <code>Hope can set</code> , å› ä¸ºæ˜¯ CBOW æ¨¡å¼ï¼Œæ‰€ä»¥å°†ä½¿ç”¨ <code>Hope</code>  å’Œ<br />\n <code>set</code>  ä½œä¸ºè¾“å…¥ï¼Œ <code>can</code>  ä½œä¸ºè¾“å‡ºï¼Œåœ¨æ¨¡å‹è®­ç»ƒæ—¶ï¼Œ <code>Hope</code> , <code>can</code> , <code>set</code>  ç­‰è¯æ±‡éƒ½ä½¿ç”¨å®ƒä»¬çš„ one-hot ç¼–ç ã€‚å¦‚å›¾æ‰€ç¤ºï¼šæ¯ä¸ª one-hot ç¼–ç çš„å•è¯ä¸å„è‡ªçš„å˜æ¢çŸ©é˜µ (å³å‚æ•°çŸ©é˜µ 3x5, è¿™é‡Œçš„ 3 æ˜¯æŒ‡æœ€åå¾—åˆ°çš„è¯å‘é‡ç»´åº¦) ç›¸ä¹˜ä¹‹åå†ç›¸åŠ ï¼Œå¾—åˆ°ä¸Šä¸‹æ–‡è¡¨ç¤ºçŸ©é˜µ (3x1)ã€‚</p>\n<p><img data-src=\"https://i0.imgs.ovh/2024/02/13/ol8Ze.png\" alt=\"tu\" title=\"CBOWæ¨¡å¼\" /></p>\n<p>æ¥ç€ï¼Œå°†ä¸Šä¸‹æ–‡è¡¨ç¤ºçŸ©é˜µä¸å˜æ¢çŸ©é˜µï¼ˆå‚æ•°çŸ©é˜µ 5x3, æ‰€æœ‰çš„å˜æ¢çŸ©é˜µå…±äº«å‚æ•°ï¼‰ç›¸ä¹˜ï¼Œå¾—åˆ° 5x1 çš„ç»“æœçŸ©é˜µï¼Œå®ƒå°†ä¸æˆ‘ä»¬çœŸæ­£çš„ç›®æ ‡çŸ©é˜µå³ can çš„ one-hot ç¼–ç çŸ©é˜µ (5x1) è¿›è¡ŒæŸå¤±çš„è®¡ç®—ï¼Œç„¶åæ›´æ–°ç½‘ç»œå‚æ•°å®Œæˆä¸€æ¬¡æ¨¡å‹è¿­ä»£ã€‚</p>\n<p><img data-src=\"https://i0.imgs.ovh/2024/02/13/olEj9.png\" alt=\"tu\" title=\"CBOWæ¨¡å¼\" /></p>\n",
            "tags": [
                "NER"
            ]
        },
        {
            "id": "http://qiji5211.com/2024/02/07/NER/Pre-training-language-model-main/%E7%AC%AC%E4%B8%80%E7%AF%87%20Transformer%E3%80%81GPT%E3%80%81BERT%EF%BC%8C%E9%A2%84%E8%AE%AD%E7%BB%83%E8%AF%AD%E8%A8%80%E6%A8%A1%E5%9E%8B%E7%9A%84%E5%89%8D%E4%B8%96%E4%BB%8A%E7%94%9F%EF%BC%88%E7%90%86%E8%AE%BA%EF%BC%89/03%20%E4%BB%80%E4%B9%88%E6%98%AF%E9%A2%84%E8%AE%AD%E7%BB%83%EF%BC%88Transformer%20%E5%89%8D%E5%A5%8F%EF%BC%89/",
            "url": "http://qiji5211.com/2024/02/07/NER/Pre-training-language-model-main/%E7%AC%AC%E4%B8%80%E7%AF%87%20Transformer%E3%80%81GPT%E3%80%81BERT%EF%BC%8C%E9%A2%84%E8%AE%AD%E7%BB%83%E8%AF%AD%E8%A8%80%E6%A8%A1%E5%9E%8B%E7%9A%84%E5%89%8D%E4%B8%96%E4%BB%8A%E7%94%9F%EF%BC%88%E7%90%86%E8%AE%BA%EF%BC%89/03%20%E4%BB%80%E4%B9%88%E6%98%AF%E9%A2%84%E8%AE%AD%E7%BB%83%EF%BC%88Transformer%20%E5%89%8D%E5%A5%8F%EF%BC%89/",
            "title": "ä»€ä¹ˆæ˜¯é¢„è®­ç»ƒï¼ˆTransformer å‰å¥ï¼‰",
            "date_published": "2024-02-07T09:30:58.000Z",
            "content_html": "<h1 id=\"é¢„è®­ç»ƒæœ‰ä»€ä¹ˆç”¨\"><a class=\"anchor\" href=\"#é¢„è®­ç»ƒæœ‰ä»€ä¹ˆç”¨\">#</a> é¢„è®­ç»ƒæœ‰ä»€ä¹ˆç”¨</h1>\n<p>æœºå™¨å­¦ä¹ ï¼šåæ•°å­¦ï¼ˆã€Šç»Ÿè®¡å­¦ä¹ æ–¹æ³•ã€‹- æèˆªï¼‰</p>\n<p>æ·±åº¦å­¦ä¹ ï¼ˆäººå·¥æ™ºèƒ½ï¼‰çš„é¡¹ç›®ï¼šå¤§æ•°æ®æ”¯æŒï¼ˆä¸»æµï¼‰</p>\n<p>æˆ‘ä»¬å¾ˆå¤šé¡¹ç›®æ²¡æœ‰å¤§æ•°æ®æ”¯æŒï¼ˆå°æ•°æ®ï¼‰</p>\n<p>çŒ«ç‹—åˆ†ç±»ä»»åŠ¡ï¼š100 å¼ çŒ«å’Œç‹—çš„å›¾ç‰‡ --ã€‹ç»™ä½ ä¸€å¼ å›¾ç‰‡ï¼Œåˆ†å‡ºæ˜¯çŒ«è¿˜æ˜¯ç‹—ï¼ˆæ— æ³•è§£å†³çš„ä¸€ä¸ªé—®é¢˜ï¼Œç²¾åº¦å¾ˆä½ï¼‰</p>\n<p>100000 å¼ é¹…å’Œé¸­çš„å›¾ç‰‡ï¼ˆå·²çŸ¥ï¼Œæœ‰äººåšè¿‡çš„ï¼Œé€šè¿‡è¿™ 10w å¼ å›¾ç‰‡åšäº†ä¸€ä¸ªæ¨¡å‹ Aï¼‰</p>\n<p><img data-src=\"https://imgmd.oss-cn-shanghai.aliyuncs.com/BERT_IMG/%E5%9B%BE%E5%83%8F%E9%A2%84%E8%AE%AD%E7%BB%83%E7%A4%BA%E4%BE%8B.jpg\" alt=\"img\" /></p>\n<p>æœ‰äººå‘ç°ï¼Œæµ…å±‚é€šç”¨çš„ï¼ˆæ¨ªç«–æ’‡æºï¼‰</p>\n<p>æˆ‘é€šè¿‡ 10w ä¸ªé¹…å’Œé¸­è®­ç»ƒäº†ä¸€ä¸ªæ¨¡å‹ Aï¼Œ100 å±‚çš„ CNN</p>\n<p>ä»»åŠ¡ Bï¼š100 å¼ çŒ«å’Œç‹—çš„å›¾ç‰‡ï¼Œåˆ†ç±» --ã€‹ è®­ç»ƒå¤„ 100 å±‚çš„ CNNï¼Œä¸å¯èƒ½å®ç°çš„</p>\n<p>å°è¯•ä½¿ç”¨ A çš„å‰ 50 å±‚ï¼Œä½¿ç”¨ 100 å±‚å»å®Œæˆä»»åŠ¡ B</p>\n<p><img data-src=\"https://imgmd.oss-cn-shanghai.aliyuncs.com/BERT_IMG/%E9%A2%84%E8%AE%AD%E7%BB%83%E7%9A%84%E5%BA%94%E7%94%A8.jpg\" alt=\"img\" /></p>\n<ol>\n<li>å†»ç»“ï¼šæµ…å±‚å‚æ•°ä¸å˜</li>\n<li>å¾®è°ƒï¼šæµ…å±‚å‚æ•°ä¼šè·Ÿç€ä»»åŠ¡ B è®­ç»ƒè€Œæ”¹å˜</li>\n</ol>\n<h1 id=\"é¢„è®­ç»ƒæ˜¯ä»€ä¹ˆ\"><a class=\"anchor\" href=\"#é¢„è®­ç»ƒæ˜¯ä»€ä¹ˆ\">#</a> é¢„è®­ç»ƒæ˜¯ä»€ä¹ˆ</h1>\n<p>é€šè¿‡ä¸€ä¸ªå·²ç»è®­ç»ƒå¥½çš„æ¨¡å‹ Aï¼Œå»å®Œæˆä¸€ä¸ªå°æ•°æ®é‡çš„ä»»åŠ¡ Bï¼ˆä½¿ç”¨äº†æ¨¡å‹ A çš„æµ…å±‚å‚æ•°ï¼‰</p>\n<p>ä»»åŠ¡ A å’Œä»»åŠ¡ B æå…¶ç›¸ä¼¼</p>\n<h1 id=\"é¢„è®­ç»ƒæ€ä¹ˆç”¨\"><a class=\"anchor\" href=\"#é¢„è®­ç»ƒæ€ä¹ˆç”¨\">#</a> é¢„è®­ç»ƒæ€ä¹ˆç”¨</h1>\n<p>fairseq ã€transformers åº“</p>\n<h1 id=\"æ€»ç»“\"><a class=\"anchor\" href=\"#æ€»ç»“\">#</a> æ€»ç»“</h1>\n<p>ä¸€ä¸ªä»»åŠ¡ Aï¼Œä¸€ä¸ªä»»åŠ¡ Bï¼Œä¸¤è€…æå…¶ç›¸ä¼¼ï¼Œä»»åŠ¡ A å·²ç»è®­ç»ƒå¤„ä¸€ä¸ªæ¨¡å‹ Aï¼Œä½¿ç”¨æ¨¡å‹ A çš„æµ…å±‚å‚æ•°å»è®­ç»ƒä»»åŠ¡ Bï¼Œå¾—åˆ°æ¨¡å‹ Bï¼Œ1.</p>\n",
            "tags": [
                "NER"
            ]
        },
        {
            "id": "http://qiji5211.com/2024/02/07/NER/Pre-training-language-model-main/%E7%AC%AC%E4%B8%80%E7%AF%87%20Transformer%E3%80%81GPT%E3%80%81BERT%EF%BC%8C%E9%A2%84%E8%AE%AD%E7%BB%83%E8%AF%AD%E8%A8%80%E6%A8%A1%E5%9E%8B%E7%9A%84%E5%89%8D%E4%B8%96%E4%BB%8A%E7%94%9F%EF%BC%88%E7%90%86%E8%AE%BA%EF%BC%89/04%20%E7%BB%9F%E8%AE%A1%E8%AF%AD%E8%A8%80%E6%A8%A1%E5%9E%8B%EF%BC%88n%E5%85%83%E8%AF%AD%E8%A8%80%E6%A8%A1%E5%9E%8B%EF%BC%89/",
            "url": "http://qiji5211.com/2024/02/07/NER/Pre-training-language-model-main/%E7%AC%AC%E4%B8%80%E7%AF%87%20Transformer%E3%80%81GPT%E3%80%81BERT%EF%BC%8C%E9%A2%84%E8%AE%AD%E7%BB%83%E8%AF%AD%E8%A8%80%E6%A8%A1%E5%9E%8B%E7%9A%84%E5%89%8D%E4%B8%96%E4%BB%8A%E7%94%9F%EF%BC%88%E7%90%86%E8%AE%BA%EF%BC%89/04%20%E7%BB%9F%E8%AE%A1%E8%AF%AD%E8%A8%80%E6%A8%A1%E5%9E%8B%EF%BC%88n%E5%85%83%E8%AF%AD%E8%A8%80%E6%A8%A1%E5%9E%8B%EF%BC%89/",
            "title": "ç»Ÿè®¡è¯­è¨€æ¨¡å‹ï¼ˆnå…ƒè¯­è¨€æ¨¡å‹ï¼‰",
            "date_published": "2024-02-07T09:30:58.000Z",
            "content_html": "<h1 id=\"é¢„è®­ç»ƒ\"><a class=\"anchor\" href=\"#é¢„è®­ç»ƒ\">#</a> é¢„è®­ç»ƒ</h1>\n<p>é¢„å…ˆè®­ç»ƒ</p>\n<p>æˆ‘ä»¬æœ‰ä¸¤ä¸ªç›¸ä¼¼çš„ä»»åŠ¡ A å’Œ Bï¼Œä»»åŠ¡ A å·²ç»å®Œæˆäº†å¾—åˆ°äº†ä¸€ä¸ªæ¨¡å‹ A</p>\n<p>ä»»åŠ¡ Bï¼ˆæ•°æ®é‡å°ï¼‰</p>\n<p>ç”¨åˆ°äº†ä¸€ä¸ªç‰¹æ€§ï¼šCNN æµ…å±‚å‚æ•°é€šç”¨</p>\n<p>ä»»åŠ¡ B å°±å¯ä»¥ä½¿ç”¨æ¨¡å‹ A çš„æµ…å±‚å‚æ•°ï¼Œåé¢çš„å‚æ•°é€šè¿‡ä»»åŠ¡ B è®­ç»ƒ --ã€‹1. å†»ç»“ï¼ˆæµ…å±‚å‚æ•°ä¸å˜ï¼‰2. å¾®è°ƒï¼ˆå˜ï¼‰</p>\n<p>ä»»åŠ¡ Bï¼ˆå¤§æ•°æ®ï¼‰å¯ä»¥è®­ç»ƒå‡ºæ¨¡å‹ Bï¼ˆæˆ‘è¿˜å¯ä»¥ä½¿ç”¨æ¨¡å‹ A çš„æµ…å±‚å‚æ•°ï¼ŒèŠ‚çœè®­ç»ƒæ—¶é—´ï¼ŒèŠ‚çœæˆæœ¬ï¼‰</p>\n<h1 id=\"ç»Ÿè®¡è¯­è¨€æ¨¡å‹\"><a class=\"anchor\" href=\"#ç»Ÿè®¡è¯­è¨€æ¨¡å‹\">#</a> ç»Ÿè®¡è¯­è¨€æ¨¡å‹</h1>\n<h2 id=\"è¯­è¨€æ¨¡å‹\"><a class=\"anchor\" href=\"#è¯­è¨€æ¨¡å‹\">#</a> è¯­è¨€æ¨¡å‹</h2>\n<p>è¯­è¨€ï¼ˆäººè¯´çš„è¯ï¼‰+ æ¨¡å‹ï¼ˆè¡¨ç¤ºæŸä¸ªä¸œè¥¿ï¼Œå®ŒæˆæŸä¸ªä»»åŠ¡ï¼‰</p>\n<ol>\n<li>P (â€œåˆ¤æ–­è¿™ä¸ªè¯çš„è¯æ€§â€)ï¼ŒP (â€œåˆ¤æ–­è¿™ä¸ªè¯çš„ç£æ€§â€)</li>\n<li>â€œåˆ¤æ–­è¿™ä¸ªè¯çš„ <code>______</code> â€</li>\n</ol>\n<h2 id=\"ç»Ÿè®¡è¯­è¨€æ¨¡å‹-2\"><a class=\"anchor\" href=\"#ç»Ÿè®¡è¯­è¨€æ¨¡å‹-2\">#</a> ç»Ÿè®¡è¯­è¨€æ¨¡å‹</h2>\n<p>ç”¨ç»Ÿè®¡çš„æ–¹æ³•å»è§£å†³ä¸Šè¿°ä¸¤ä¸ªé—®é¢˜</p>\n<p>â€œåˆ¤æ–­è¿™ä¸ªè¯çš„è¯æ€§â€ = â€œåˆ¤æ–­â€ï¼Œâ€œè¿™ä¸ªâ€ï¼Œâ€œè¯â€ï¼Œâ€œçš„â€ï¼Œâ€œè¯æ€§â€</p>\n<p>è¿™å¥è¯æ˜¯åºåˆ—ï¼ˆæœ‰é¡ºåºçš„ï¼‰</p>\n<p>ç”¨äº†ä¸€ä¸ªæ¡ä»¶æ¦‚ç‡çš„é“¾å¼æ³•åˆ™ï¼ˆæ¦‚ç‡è®ºï¼‰</p>\n<p>![image-20220611203051818](../../Library/Application Support/typora-user-images/image-20220611203051818.png)</p>\n<p>é€šè¿‡è¿™ä¸ªæ³•åˆ™ï¼Œæˆ‘ä»¬å¯ä»¥æ±‚å‡ºæ¯ä¸€ä¸ªè¯å‡ºç°çš„æ¦‚ç‡ï¼Œç„¶åè¿ä¹˜ï¼Œå°±æ˜¯è¿™å¥è¯å‡ºç°çš„æ¦‚ç‡</p>\n<p>è§£å†³ç¬¬äºŒä¸ªé—®é¢˜ï¼š</p>\n<p>â€œåˆ¤æ–­è¿™ä¸ªè¯çš„ <code>__</code> â€</p>\n<p>P (w_next | â€œåˆ¤æ–­â€ï¼Œâ€œè¿™ä¸ªâ€ï¼Œâ€œè¯â€ï¼Œâ€œçš„â€)  ï¼ˆ1ï¼‰</p>\n<p>è¯åº“ï¼ˆè¯å…¸ï¼‰V--ã€‹æ–°åå­—å…¸ï¼Œé«˜å¤„ä¸€ä¸ªé›†åˆï¼ŒæŠŠæ‰€æœ‰è¯è£…åˆ°é›†åˆ V é‡Œ</p>\n<p>æŠŠé›†åˆé‡Œçš„æ¯ä¸€ä¸ªè¯ï¼Œéƒ½è¿›è¡Œä¸Šä¸€æ­¥ï¼ˆ1ï¼‰çš„è®¡ç®—</p>\n<p â€œè¯æ€§â€ï¼Œ=\"\" â€œç«æ˜Ÿâ€=\"\">è¯åº“ V =</p>\n<p>P (è¯æ€§ | â€œåˆ¤æ–­â€ï¼Œâ€œè¿™ä¸ªâ€ï¼Œâ€œè¯â€ï¼Œâ€œçš„â€)</p>\n<p>P (ç«æ˜Ÿ | â€œåˆ¤æ–­â€ï¼Œâ€œè¿™ä¸ªâ€ï¼Œâ€œè¯â€ï¼Œâ€œçš„â€)</p>\n<p>P (è¯æ€§ | â€œåˆ¤æ–­â€ï¼Œâ€œè¿™ä¸ªâ€ï¼Œâ€œè¯â€ï¼Œâ€œçš„â€ï¼Œâ€¦â€¦ï¼Œ â€œâ€¦â€¦â€)</p>\n<p>![image-20220611203813910](../../Library/Application Support/typora-user-images/image-20220611203813910.png)</p>\n<h2 id=\"n-å…ƒç»Ÿè®¡è¯­è¨€æ¨¡å‹\"><a class=\"anchor\" href=\"#n-å…ƒç»Ÿè®¡è¯­è¨€æ¨¡å‹\">#</a> n å…ƒç»Ÿè®¡è¯­è¨€æ¨¡å‹</h2>\n<p>P (è¯æ€§ |â€œè¿™ä¸ªâ€ï¼Œâ€œè¯â€ï¼Œâ€œçš„â€)</p>\n<p>P (ç«æ˜Ÿ | â€œè¿™ä¸ªâ€ï¼Œâ€œè¯â€ï¼Œâ€œçš„â€)</p>\n<p>P (è¯æ€§ |â€œè¯â€ï¼Œâ€œçš„â€)</p>\n<p>P (ç«æ˜Ÿ |â€œè¯â€ï¼Œâ€œçš„â€)</p>\n<p>P (è¯æ€§ |â€œçš„â€)</p>\n<p>P (ç«æ˜Ÿ |â€œçš„â€)</p>\n<p>æŠŠ n ä¸ªè¯ï¼Œå– 2 ä¸ªè¯ï¼ˆ2 å…ƒï¼‰ï¼Œå– 3 ä¸ªè¯ï¼ˆ3 å…ƒï¼‰</p>\n<h1 id=\"å¦‚ä½•å»è®¡ç®—\"><a class=\"anchor\" href=\"#å¦‚ä½•å»è®¡ç®—\">#</a> å¦‚ä½•å»è®¡ç®—</h1>\n<figure class=\"highlight basic\"><figcaption data-lang=\"BASIC\"></figcaption><table><tr><td data-num=\"1\"></td><td><pre>â€œè¯æ€§æ˜¯åŠ¨è¯â€</pre></td></tr><tr><td data-num=\"2\"></td><td><pre>â€œåˆ¤æ–­å•è¯çš„è¯æ€§â€</pre></td></tr><tr><td data-num=\"3\"></td><td><pre>â€œç£æ€§å¾ˆå¼ºçš„ç£é“â€</pre></td></tr><tr><td data-num=\"4\"></td><td><pre>â€œåŒ—äº¬çš„è¯æ€§æ˜¯åè¯â€</pre></td></tr></table></figure><p 3=\"\">ğ‘ƒ(è¯æ€§ | çš„) = <span class=\"katex\"><span class=\"katex-mathml\"><math xmlns=\"http://www.w3.org/1998/Math/MathML\"><semantics><mrow><mfrac><mrow><mi>c</mi><mi>o</mi><mi>u</mi><mi>t</mi><mo stretchy=\"false\">(</mo><mtext>è¯æ€§ï¼Œçš„</mtext><mo stretchy=\"false\">)</mo></mrow><mrow><mi>c</mi><mi>o</mi><mi>u</mi><mi>n</mi><mi>t</mi><mo stretchy=\"false\">(</mo><mtext>çš„</mtext><mo stretchy=\"false\">)</mo></mrow></mfrac></mrow><annotation encoding=\"application/x-tex\">\\frac{cout(è¯æ€§ï¼Œçš„)}{count(çš„)}</annotation></semantics></math></span><span class=\"katex-html\" aria-hidden=\"true\"><span class=\"base\"><span class=\"strut\" style=\"height:1.53em;vertical-align:-0.52em;\"></span><span class=\"mord\"><span class=\"mopen nulldelimiter\"></span><span class=\"mfrac\"><span class=\"vlist-t vlist-t2\"><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:1.01em;\"><span style=\"top:-2.655em;\"><span class=\"pstrut\" style=\"height:3em;\"></span><span class=\"sizing reset-size6 size3 mtight\"><span class=\"mord mtight\"><span class=\"mord mathnormal mtight\">c</span><span class=\"mord mathnormal mtight\">o</span><span class=\"mord mathnormal mtight\">u</span><span class=\"mord mathnormal mtight\">n</span><span class=\"mord mathnormal mtight\">t</span><span class=\"mopen mtight\">(</span><span class=\"mord cjk_fallback mtight\">çš„</span><span class=\"mclose mtight\">)</span></span></span></span><span style=\"top:-3.23em;\"><span class=\"pstrut\" style=\"height:3em;\"></span><span class=\"frac-line\" style=\"border-bottom-width:0.04em;\"></span></span><span style=\"top:-3.485em;\"><span class=\"pstrut\" style=\"height:3em;\"></span><span class=\"sizing reset-size6 size3 mtight\"><span class=\"mord mtight\"><span class=\"mord mathnormal mtight\">c</span><span class=\"mord mathnormal mtight\">o</span><span class=\"mord mathnormal mtight\">u</span><span class=\"mord mathnormal mtight\">t</span><span class=\"mopen mtight\">(</span><span class=\"mord cjk_fallback mtight\">è¯</span><span class=\"mord cjk_fallback mtight\">æ€§</span><span class=\"mord cjk_fallback mtight\">ï¼Œ</span><span class=\"mord cjk_fallback mtight\">çš„</span><span class=\"mclose mtight\">)</span></span></span></span></span><span class=\"vlist-s\">â€‹</span></span><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.52em;\"><span></span></span></span></span></span><span class=\"mclose nulldelimiter\"></span></span></span></span></span> = \\frac{2}</p>\n<h1 id=\"å¹³æ»‘ç­–ç•¥\"><a class=\"anchor\" href=\"#å¹³æ»‘ç­–ç•¥\">#</a> å¹³æ»‘ç­–ç•¥</h1>\n<p 0=\"\">P (ç­–ç•¥ | å¹³æ»‘) = \\frac{0}</p>\n<p>![image-20220611204401168](../../Library/Application Support/typora-user-images/image-20220611204401168.png)</p>\n<h1 id=\"ç»Ÿè®¡è¯­è¨€æ¨¡å‹-3\"><a class=\"anchor\" href=\"#ç»Ÿè®¡è¯­è¨€æ¨¡å‹-3\">#</a> ç»Ÿè®¡è¯­è¨€æ¨¡å‹</h1>\n<p>è¯­è¨€æ¨¡å‹ï¼šè®¡ç®—ä¸€å¥è¯çš„æ¦‚ç‡ï¼Œè®¡ç®—ä¸‹ä¸€ä¸ªè¯å¯èƒ½æ˜¯ä»€ä¹ˆ</p>\n<p>ç»Ÿè®¡è¯­è¨€æ¨¡å‹ï¼šç»Ÿè®¡çš„æ–¹æ³•å»è§£å†³è¯­è¨€æ¨¡å‹çš„é—®é¢˜ï¼ˆæ¡ä»¶æ¦‚ç‡ï¼‰</p>\n<p>a å…ƒè¯­è¨€æ¨¡å‹ï¼šåªå– a ä¸ªè¯ï¼ˆé©¬å°”ç§‘å¤«é“¾ï¼‰</p>\n<p>å¹³æ»‘ç­–ç•¥ï¼š</p>\n<h1 id=\"ä¸‹èŠ‚è¯¾ç¥ç»ç½‘ç»œè¯­è¨€æ¨¡å‹\"><a class=\"anchor\" href=\"#ä¸‹èŠ‚è¯¾ç¥ç»ç½‘ç»œè¯­è¨€æ¨¡å‹\">#</a> ä¸‹èŠ‚è¯¾ï¼šç¥ç»ç½‘ç»œè¯­è¨€æ¨¡å‹</h1>\n<p>ç»Ÿè®¡è¯­è¨€æ¨¡å‹ï¼šç¥ç»ç½‘ç»œçš„æ–¹æ³•å»è§£å†³è¯­è¨€æ¨¡å‹çš„é—®é¢˜</p>\n",
            "tags": [
                "NER"
            ]
        },
        {
            "id": "http://qiji5211.com/2024/02/07/NER/Pre-training-language-model-main/%E7%AC%AC%E4%B8%80%E7%AF%87%20Transformer%E3%80%81GPT%E3%80%81BERT%EF%BC%8C%E9%A2%84%E8%AE%AD%E7%BB%83%E8%AF%AD%E8%A8%80%E6%A8%A1%E5%9E%8B%E7%9A%84%E5%89%8D%E4%B8%96%E4%BB%8A%E7%94%9F%EF%BC%88%E7%90%86%E8%AE%BA%EF%BC%89/05%20%E7%A5%9E%E7%BB%8F%E7%BD%91%E7%BB%9C%E8%AF%AD%E8%A8%80%E6%A8%A1%E5%9E%8B%EF%BC%88%E7%8B%AC%E7%83%AD%E7%BC%96%E7%A0%81+%E8%AF%8D%E5%90%91%E9%87%8F%E7%9A%84%E8%B5%B7%E6%BA%90%EF%BC%89/",
            "url": "http://qiji5211.com/2024/02/07/NER/Pre-training-language-model-main/%E7%AC%AC%E4%B8%80%E7%AF%87%20Transformer%E3%80%81GPT%E3%80%81BERT%EF%BC%8C%E9%A2%84%E8%AE%AD%E7%BB%83%E8%AF%AD%E8%A8%80%E6%A8%A1%E5%9E%8B%E7%9A%84%E5%89%8D%E4%B8%96%E4%BB%8A%E7%94%9F%EF%BC%88%E7%90%86%E8%AE%BA%EF%BC%89/05%20%E7%A5%9E%E7%BB%8F%E7%BD%91%E7%BB%9C%E8%AF%AD%E8%A8%80%E6%A8%A1%E5%9E%8B%EF%BC%88%E7%8B%AC%E7%83%AD%E7%BC%96%E7%A0%81+%E8%AF%8D%E5%90%91%E9%87%8F%E7%9A%84%E8%B5%B7%E6%BA%90%EF%BC%89/",
            "title": "ç¥ç»ç½‘ç»œè¯­è¨€æ¨¡å‹ï¼ˆç‹¬çƒ­ç¼–ç +è¯å‘é‡çš„èµ·æºï¼‰",
            "date_published": "2024-02-07T09:30:58.000Z",
            "content_html": "<h1 id=\"ç»Ÿè®¡è¯­è¨€æ¨¡å‹\"><a class=\"anchor\" href=\"#ç»Ÿè®¡è¯­è¨€æ¨¡å‹\">#</a> ç»Ÿè®¡è¯­è¨€æ¨¡å‹</h1>\n<p>ç»Ÿè®¡ + è¯­è¨€æ¨¡å‹ --ã€‹ç”¨ç»Ÿè®¡çš„æ–¹æ³•å»å®Œæˆä»¥ä¸‹ä¸¤ä¸ªå’Œäººè¯´çš„è¯ç›¸å…³çš„ä»»åŠ¡</p>\n<p>è¯­è¨€æ¨¡å‹ = è¯­è¨€ï¼ˆäººè¯´çš„è¯ï¼‰ + æ¨¡å‹ï¼ˆå»å®Œæˆä¸¤ä¸ªä»»åŠ¡ï¼‰</p>\n<ol>\n<li>æ¯”è¾ƒï¼Œâ€œè¯æ€§â€ï¼Œâ€œç£æ€§â€</li>\n<li>é¢„æµ‹ä¸‹ä¸€ä¸ªå•è¯ï¼ˆå¡«ç©ºï¼‰</li>\n</ol>\n<h2 id=\"n-å…ƒè¯­è¨€æ¨¡å‹\"><a class=\"anchor\" href=\"#n-å…ƒè¯­è¨€æ¨¡å‹\">#</a> n å…ƒè¯­è¨€æ¨¡å‹</h2>\n<p>å– aï¼ˆ2ï¼Œ3ï¼Œ4ï¼‰ ä¸ªè¯</p>\n<h1 id=\"ç¥ç»ç½‘ç»œè¯­è¨€æ¨¡å‹\"><a class=\"anchor\" href=\"#ç¥ç»ç½‘ç»œè¯­è¨€æ¨¡å‹\">#</a> ç¥ç»ç½‘ç»œè¯­è¨€æ¨¡å‹</h1>\n<p>ç¥ç»ç½‘ç»œ + è¯­è¨€æ¨¡å‹ --ã€‹ç”¨ç¥ç»ç½‘ç»œçš„æ–¹æ³•å»å®Œæˆä»¥ä¸‹ä¸¤ä¸ªå’Œäººè¯´çš„è¯ç›¸å…³çš„ä»»åŠ¡ã€‚</p>\n<p>ç¬¬äºŒä¸ªä»»åŠ¡ï¼š</p>\n<p>â€œåˆ¤æ–­â€ï¼Œâ€œä¸€ä¸ªâ€ï¼Œâ€œè¯â€ï¼Œâ€œçš„â€ï¼Œâ€œ <code>___</code> â€</p>\n<p>å‡è®¾è¯åº“é‡Œæœ‰ â€œè¯æ€§â€ å’Œ â€œç«æ˜Ÿâ€</p>\n<p>P( <code>__</code> |â€œåˆ¤æ–­â€ï¼Œâ€œä¸€ä¸ªâ€ï¼Œâ€œè¯â€ï¼Œâ€œçš„â€)</p>\n<p>è¯æ€§</p>\n<p>&lt;img src=&quot;<span class=\"exturl\" data-url=\"aHR0cHM6Ly9pbWdtZC5vc3MtY24tc2hhbmdoYWkuYWxpeXVuY3MuY29tL0JFUlRfSU1HLyVFNyVBNSU5RSVFNyVCQiU4RiVFNyVCRCU5MSVFNyVCQiU5QyVFOCVBRiVBRCVFOCVBOCU4MCVFNiVBOCVBMSVFNSU5RSU4Qi5qcGc=\">https://imgmd.oss-cn-shanghai.aliyuncs.com/BERT_IMG/ ç¥ç»ç½‘ç»œè¯­è¨€æ¨¡å‹.jpg</span>&quot; alt=&quot;img&quot; style=&quot;zoom:67%;&quot; /&gt;</p>\n<p>w1,w2,w3,w4ï¼ˆä¸Šè¿° 4 ä¸ªå•è¯çš„ç‹¬çƒ­ç¼–ç ï¼‰</p>\n<pre><code>w1*Q=c1,\nw2*Q=c2,\nw3*Q=c3,\nw4*Q=c4,\n\nC=[c1,c2,c3,c4]\nQå°±æ˜¯ä¸€ä¸ªéšæœºçŸ©é˜µï¼Œæ˜¯ä¸€ä¸ªå‚æ•°ï¼ˆå¯å­¦ä¹ ï¼‰\n</code></pre>\n<p>â€œåˆ¤æ–­â€ï¼Œâ€œè¿™ä¸ªâ€ï¼Œâ€œè¯â€ï¼Œâ€œçš„â€ï¼Œâ€œè¯æ€§â€</p>\n<p>softmaxï¼ˆU[tanh(WC+b1)]+b2ï¼‰== [0.1, 0.1, 0.2, 0.2, 0.4] <span class=\"katex\"><span class=\"katex-mathml\"><math xmlns=\"http://www.w3.org/1998/Math/MathML\"><semantics><mrow><mo>âˆˆ</mo><mo stretchy=\"false\">[</mo><mn>1</mn><mo separator=\"true\">,</mo><msub><mi>V</mi><mi>L</mi></msub><mo stretchy=\"false\">]</mo></mrow><annotation encoding=\"application/x-tex\">\\in[1,V_L]</annotation></semantics></math></span><span class=\"katex-html\" aria-hidden=\"true\"><span class=\"base\"><span class=\"strut\" style=\"height:0.5782em;vertical-align:-0.0391em;\"></span><span class=\"mrel\">âˆˆ</span><span class=\"mspace\" style=\"margin-right:0.2777777777777778em;\"></span></span><span class=\"base\"><span class=\"strut\" style=\"height:1em;vertical-align:-0.25em;\"></span><span class=\"mopen\">[</span><span class=\"mord\">1</span><span class=\"mpunct\">,</span><span class=\"mspace\" style=\"margin-right:0.16666666666666666em;\"></span><span class=\"mord\"><span class=\"mord mathnormal\" style=\"margin-right:0.22222em;\">V</span><span class=\"msupsub\"><span class=\"vlist-t vlist-t2\"><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.32833099999999993em;\"><span style=\"top:-2.5500000000000003em;margin-left:-0.22222em;margin-right:0.05em;\"><span class=\"pstrut\" style=\"height:2.7em;\"></span><span class=\"sizing reset-size6 size3 mtight\"><span class=\"mord mathnormal mtight\">L</span></span></span></span><span class=\"vlist-s\">â€‹</span></span><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.15em;\"><span></span></span></span></span></span></span><span class=\"mclose\">]</span></span></span></span></p>\n<h2 id=\"ç‹¬çƒ­ç¼–ç -one-hot-ç¼–ç \"><a class=\"anchor\" href=\"#ç‹¬çƒ­ç¼–ç -one-hot-ç¼–ç \">#</a> ç‹¬çƒ­ç¼–ç  ï¼ˆone-hot ç¼–ç ï¼‰</h2>\n<p>ç‹¬çƒ­ç¼–ç ï¼šè®©è®¡ç®—æœºè®¤è¯†å•è¯</p>\n<p>&lt;img src=&quot;<span class=\"exturl\" data-url=\"aHR0cHM6Ly9pbWdtZC5vc3MtY24tc2hhbmdoYWkuYWxpeXVuY3MuY29tL0JFUlRfSU1HLyVFNSU4RCU5NSVFOCVBRiU4RCVFNyU5QSU4NCVFNyU4QiVBQyVFNyU4MyVBRCVFOCVBMSVBOCVFNyVBNCVCQS5qcGc=\">https://imgmd.oss-cn-shanghai.aliyuncs.com/BERT_IMG/ å•è¯çš„ç‹¬çƒ­è¡¨ç¤º.jpg</span>&quot; alt=&quot;img&quot; style=&quot;zoom:50%;&quot; /&gt;</p>\n<p>è¯å…¸ Vï¼ˆæ–°åå­—å…¸é‡Œé¢æŠŠæ‰€æœ‰è¯é›†åˆæˆä¸€ä¸ªé›†åˆ Vï¼‰</p>\n<p>å‡è®¾è¯å…¸é‡Œé¢åªæœ‰ 8 ä¸ªå•è¯</p>\n<p>è®¡ç®—æœºä¸è®¤è¯†å•è¯çš„</p>\n<p>ä½†æ˜¯æˆ‘ä»¬è¦è®¡ç®—æœºè®¤è¯†å•è¯</p>\n<p>â€œfruitâ€</p>\n<p>ç‹¬çƒ­ç¼–ç ï¼šç»™å‡ºä¸€ä¸ª 8*8 çš„çŸ©é˜µ</p>\n<p>â€œtimeâ€ --ã€‹ 10000000</p>\n<p>â€œfruitâ€ --ã€‹ 01000000</p>\n<p>â€œbananaâ€ --ã€‹ 00000001</p>\n<p>ä½™å¼¦ç›¸ä¼¼åº¦ å»è®¡ç®—ä¸¤è€…çš„ç›¸ä¼¼åº¦ï¼ˆ0ï¼‰-- è¯å‘é‡ï¼ˆçŸ©é˜µä¹˜æ³•ï¼‰</p>\n<h1 id=\"è¯å‘é‡ç¥ç»ç½‘ç»œè¯­è¨€æ¨¡å‹çš„å‰¯äº§å“-q\"><a class=\"anchor\" href=\"#è¯å‘é‡ç¥ç»ç½‘ç»œè¯­è¨€æ¨¡å‹çš„å‰¯äº§å“-q\">#</a> è¯å‘é‡ï¼ˆç¥ç»ç½‘ç»œè¯­è¨€æ¨¡å‹çš„å‰¯äº§å“ Qï¼‰</h1>\n<p>ç»™æˆ‘ä»»ä½•ä¸€ä¸ªè¯ï¼Œ</p>\n<p>â€œåˆ¤æ–­â€ --ã€‹ ç‹¬çƒ­ç¼–ç  w1 [1,0,0,0,0]</p>\n<p>w1*Q =c1  ï¼ˆâ€œåˆ¤æ–­â€ è¿™ä¸ªè¯çš„è¯å‘é‡ï¼‰</p>\n<p>è¯å‘é‡ï¼šå°±æ˜¯ç”¨ä¸€ä¸ªå‘é‡æ¥è¡¨ç¤ºä¸€ä¸ªå•è¯</p>\n<p>å¯ä»¥æ§åˆ¶è¯å‘é‡çš„ç»´åº¦ï¼ˆå¤§å°ï¼‰</p>\n<p>å¦‚æœæˆ‘ä»¬å¾—åˆ°çš„è¯å‘é‡ï¼Œç¬¬ä¸€ä¸ªé—®é¢˜ä¹Ÿè¢«è§£å†³äº†ï¼Œï¼ˆä¸‹æ¸¸ä»»åŠ¡ï¼‰</p>\n<h1 id=\"æ€»ç»“\"><a class=\"anchor\" href=\"#æ€»ç»“\">#</a> æ€»ç»“</h1>\n<p>ç¥ç»ç½‘ç»œè¯­è¨€æ¨¡å‹ï¼šé€šè¿‡ç¥ç»ç½‘ç»œè§£å†³ä¸¤ä¸ªäººè¯´çš„è¯çš„é—®é¢˜</p>\n<p>æœ‰ä¸€ä¸ªå‰¯äº§å“ï¼šQ çŸ©é˜µ --ã€‹æ–°çš„è¯å‘é‡ï¼ˆè¯å‘é‡å¯ä»¥é€‰æ‹©è¯å‘é‡çš„ç»´åº¦ï¼Œå¯ä»¥æ±‚ä¸¤ä¸ªè¯ä¹‹é—´çš„ç›¸ä¼¼ç¨‹åº¦ï¼‰</p>\n<p>ä¸‹æ¸¸ä»»åŠ¡</p>\n",
            "tags": [
                "NER"
            ]
        },
        {
            "id": "http://qiji5211.com/2024/02/07/NER/Pre-training-language-model-main/%E7%AC%AC%E4%B8%80%E7%AF%87%20Transformer%E3%80%81GPT%E3%80%81BERT%EF%BC%8C%E9%A2%84%E8%AE%AD%E7%BB%83%E8%AF%AD%E8%A8%80%E6%A8%A1%E5%9E%8B%E7%9A%84%E5%89%8D%E4%B8%96%E4%BB%8A%E7%94%9F%EF%BC%88%E7%90%86%E8%AE%BA%EF%BC%89/06%20Word2Vec%E6%A8%A1%E5%9E%8B%EF%BC%88%E7%AC%AC%E4%B8%80%E4%B8%AA%E4%B8%93%E9%97%A8%E5%81%9A%E8%AF%8D%E5%90%91%E9%87%8F%E7%9A%84%E6%A8%A1%E5%9E%8B%EF%BC%8CCBOW%E5%92%8CSkip-gram%EF%BC%89/",
            "url": "http://qiji5211.com/2024/02/07/NER/Pre-training-language-model-main/%E7%AC%AC%E4%B8%80%E7%AF%87%20Transformer%E3%80%81GPT%E3%80%81BERT%EF%BC%8C%E9%A2%84%E8%AE%AD%E7%BB%83%E8%AF%AD%E8%A8%80%E6%A8%A1%E5%9E%8B%E7%9A%84%E5%89%8D%E4%B8%96%E4%BB%8A%E7%94%9F%EF%BC%88%E7%90%86%E8%AE%BA%EF%BC%89/06%20Word2Vec%E6%A8%A1%E5%9E%8B%EF%BC%88%E7%AC%AC%E4%B8%80%E4%B8%AA%E4%B8%93%E9%97%A8%E5%81%9A%E8%AF%8D%E5%90%91%E9%87%8F%E7%9A%84%E6%A8%A1%E5%9E%8B%EF%BC%8CCBOW%E5%92%8CSkip-gram%EF%BC%89/",
            "title": "Word2Vecæ¨¡å‹ï¼ˆç¬¬ä¸€ä¸ªä¸“é—¨åšè¯å‘é‡çš„æ¨¡å‹ï¼ŒCBOWå’ŒSkip-gramï¼‰",
            "date_published": "2024-02-07T09:30:58.000Z",
            "content_html": "<h1 id=\"ç¥ç»ç½‘ç»œè¯­è¨€æ¨¡å‹nnlm-ä¸ºäº†é¢„æµ‹ä¸‹ä¸€ä¸ªè¯\"><a class=\"anchor\" href=\"#ç¥ç»ç½‘ç»œè¯­è¨€æ¨¡å‹nnlm-ä¸ºäº†é¢„æµ‹ä¸‹ä¸€ä¸ªè¯\">#</a> ç¥ç»ç½‘ç»œè¯­è¨€æ¨¡å‹ï¼ˆNNLMï¼‰--ã€‹ä¸ºäº†é¢„æµ‹ä¸‹ä¸€ä¸ªè¯</h1>\n<p>NNLMï¼ˆï¼‰--ã€‹é¢„æµ‹ä¸‹ä¸€ä¸ªè¯</p>\n<p>ç¥ç»ç½‘ç»œ + è¯­è¨€æ¨¡å‹ï¼šç”¨ç¥ç»ç½‘ç»œå»è§£å†³å’Œäººè¯´è¯æœ‰å…³çš„ä¸¤ä¸ªä»»åŠ¡çš„ä¸€ä¸ªä¸œè¥¿</p>\n<p>softmax(w2(tanh(ï¼ˆw1x+b1ï¼‰))+b2)</p>\n<p>å¾—åˆ°ä¸€ä¸ªå‰¯äº§å“ï¼ˆè¯å‘é‡ï¼‰</p>\n<p>Q çŸ©é˜µï¼Œå¯¹äºä»»ä½•ä¸€ä¸ªç‹¬çƒ­ç¼–ç çš„è¯å‘é‡éƒ½å¯ä»¥é€šè¿‡ Q çŸ©é˜µå¾—åˆ°æ–°çš„è¯å‘é‡</p>\n<ol>\n<li>å¯ä»¥è½¬æ¢ç»´åº¦</li>\n<li>ç›¸ä¼¼è¯ä¹‹é—´çš„è¯å‘é‡ä¹‹é—´ä¹Ÿæœ‰äº†å…³ç³»</li>\n</ol>\n<h1 id=\"word2vec-ä¸ºäº†å¾—åˆ°è¯å‘é‡\"><a class=\"anchor\" href=\"#word2vec-ä¸ºäº†å¾—åˆ°è¯å‘é‡\">#</a> Word2Vec --ã€‹ ä¸ºäº†å¾—åˆ°è¯å‘é‡</h1>\n<p>ç¥ç»ç½‘ç»œè¯­è¨€æ¨¡å‹ --ã€‹ä¸»è¦ç›®çš„å°±æ˜¯ä¸ºäº†å¾—åˆ°è¯å‘é‡</p>\n<p><img data-src=\"https://imgmd.oss-cn-shanghai.aliyuncs.com/BERT_IMG/%E7%A5%9E%E7%BB%8F%E7%BD%91%E7%BB%9C%E8%AF%AD%E8%A8%80%E6%A8%A1%E5%9E%8B.jpg\" alt=\"img\" /></p>\n<p><img data-src=\"https://imgmd.oss-cn-shanghai.aliyuncs.com/BERT_IMG/word2vec.jpg\" alt=\"img\" /></p>\n<p>NNLM å’Œ Word2Vec åŸºæœ¬ä¸€è‡´ï¼ˆä¸€æ¨¡ä¸€æ ·ï¼‰ï¼Œä¸è€ƒè™‘ç»†èŠ‚ï¼Œç½‘ç»œæ¶æ„å°±æ˜¯ä¸€æ¨¡ä¸€æ ·</p>\n<h2 id=\"cbow\"><a class=\"anchor\" href=\"#cbow\">#</a> CBOW</h2>\n<p>ç»™å‡ºä¸€ä¸ªè¯çš„<mark>ä¸Šä¸‹æ–‡</mark>ï¼Œå¾—åˆ°è¿™ä¸ªè¯</p>\n<p>â€œæˆ‘æ˜¯æœ€ <code>_</code> çš„ Nickâ€</p>\n<p>â€œå¸…â€ <span class=\"katex\"><span class=\"katex-mathml\"><math xmlns=\"http://www.w3.org/1998/Math/MathML\"><semantics><mrow><msub><mi>w</mi><mi>t</mi></msub></mrow><annotation encoding=\"application/x-tex\">w_t</annotation></semantics></math></span><span class=\"katex-html\" aria-hidden=\"true\"><span class=\"base\"><span class=\"strut\" style=\"height:0.58056em;vertical-align:-0.15em;\"></span><span class=\"mord\"><span class=\"mord mathnormal\" style=\"margin-right:0.02691em;\">w</span><span class=\"msupsub\"><span class=\"vlist-t vlist-t2\"><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.2805559999999999em;\"><span style=\"top:-2.5500000000000003em;margin-left:-0.02691em;margin-right:0.05em;\"><span class=\"pstrut\" style=\"height:2.7em;\"></span><span class=\"sizing reset-size6 size3 mtight\"><span class=\"mord mathnormal mtight\">t</span></span></span></span><span class=\"vlist-s\">â€‹</span></span><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.15em;\"><span></span></span></span></span></span></span></span></span></span></p>\n<h2 id=\"skip-gram\"><a class=\"anchor\" href=\"#skip-gram\">#</a> Skip-gram</h2>\n<p>ç»™å‡ºä¸€ä¸ªè¯ï¼Œå¾—åˆ°è¿™ä¸ªè¯çš„ä¸Šä¸‹æ–‡</p>\n<p>â€œå¸…â€</p>\n<p>â€œæˆ‘æ˜¯ <code>_</code> çš„ Nickâ€</p>\n<h1 id=\"nnlm-å’Œ-word2vec-çš„åŒºåˆ«\"><a class=\"anchor\" href=\"#nnlm-å’Œ-word2vec-çš„åŒºåˆ«\">#</a> NNLM å’Œ Word2Vec çš„åŒºåˆ«</h1>\n<p>NNNL --ã€‹ é‡ç‚¹æ˜¯é¢„æµ‹ä¸‹ä¸€è¯ï¼ŒåŒå±‚æ„ŸçŸ¥æœº softmax (w2 (tanh (ï¼ˆw1 (xQ)+b1ï¼‰))+b2)</p>\n<p>Word2Vec --ã€‹ CBOW å’Œ Skip-gram çš„ä¸¤ç§æ¶æ„çš„é‡ç‚¹éƒ½æ˜¯å¾—åˆ°ä¸€ä¸ª Q çŸ©é˜µï¼Œsoftmax (w1 (xQ) +b1)</p>\n<ol>\n<li>CBOWï¼šä¸€ä¸ªè€å¸ˆå‘Šè¯‰å¤šä¸ªå­¦ç”Ÿï¼ŒQ çŸ©é˜µæ€ä¹ˆå˜</li>\n<li>Skipï¼šå¤šä¸ªè€å¸ˆå‘Šè¯‰ä¸€ä¸ªå­¦ç”Ÿï¼ŒQ çŸ©é˜µæ€ä¹ˆå˜</li>\n</ol>\n<h1 id=\"word2vecçš„ç¼ºç‚¹\"><a class=\"anchor\" href=\"#word2vecçš„ç¼ºç‚¹\">#</a> Word2Vec çš„ç¼ºç‚¹</h1>\n<p>Q çŸ©é˜µçš„è®¾è®¡</p>\n<p>![image-20220614193540503](../../Library/Application Support/typora-user-images/image-20220614193540503.png)</p>\n<p>00010 ä»£è¡¨ apple Ã— Q = 10ï¼Œ12ï¼Œ19</p>\n<p>appleï¼ˆè‹¹æœï¼Œï£¿ï¼‰</p>\n<p>å‡è®¾æ•°æ®é›†é‡Œé¢çš„ apple åªæœ‰è‹¹æœè¿™ä¸ªæ„æ€ï¼Œæ²¡æœ‰ï£¿è¿™ä¸ªæ„æ€ï¼ˆè®­ç»ƒï¼‰</p>\n<p>ï¼ˆæµ‹è¯•ï¼Œåº”ç”¨ï¼‰10ï¼Œ12ï¼Œ19 apple, æ— æ³•è¡¨ç¤ºï£¿è¿™ä¸ªæ„æ€</p>\n<p>è¯å‘é‡ä¸èƒ½è¿›è¡Œå¤šæ„ ---ã€‹ ELMO</p>\n",
            "tags": [
                "NER"
            ]
        },
        {
            "id": "http://qiji5211.com/2024/02/07/NER/Pre-training-language-model-main/%E7%AC%AC%E4%B8%80%E7%AF%87%20Transformer%E3%80%81GPT%E3%80%81BERT%EF%BC%8C%E9%A2%84%E8%AE%AD%E7%BB%83%E8%AF%AD%E8%A8%80%E6%A8%A1%E5%9E%8B%E7%9A%84%E5%89%8D%E4%B8%96%E4%BB%8A%E7%94%9F%EF%BC%88%E7%90%86%E8%AE%BA%EF%BC%89/00%20%E9%A2%84%E8%AE%AD%E7%BB%83%E8%AF%AD%E8%A8%80%E6%A8%A1%E5%9E%8B%E7%9A%84%E5%89%8D%E4%B8%96%E4%BB%8A%E7%94%9F%EF%BC%88%E5%85%A8%E6%96%87%2024854%20%E4%B8%AA%E8%AF%8D%EF%BC%89/",
            "url": "http://qiji5211.com/2024/02/07/NER/Pre-training-language-model-main/%E7%AC%AC%E4%B8%80%E7%AF%87%20Transformer%E3%80%81GPT%E3%80%81BERT%EF%BC%8C%E9%A2%84%E8%AE%AD%E7%BB%83%E8%AF%AD%E8%A8%80%E6%A8%A1%E5%9E%8B%E7%9A%84%E5%89%8D%E4%B8%96%E4%BB%8A%E7%94%9F%EF%BC%88%E7%90%86%E8%AE%BA%EF%BC%89/00%20%E9%A2%84%E8%AE%AD%E7%BB%83%E8%AF%AD%E8%A8%80%E6%A8%A1%E5%9E%8B%E7%9A%84%E5%89%8D%E4%B8%96%E4%BB%8A%E7%94%9F%EF%BC%88%E5%85%A8%E6%96%87%2024854%20%E4%B8%AA%E8%AF%8D%EF%BC%89/",
            "title": "é¢„è®­ç»ƒè¯­è¨€æ¨¡å‹çš„å‰ä¸–ä»Šç”Ÿ",
            "date_published": "2024-02-07T09:30:58.000Z",
            "content_html": "<p>&lt;h1 style='text-align:center;'&gt; é¢„è®­ç»ƒè¯­è¨€æ¨¡å‹çš„å‰ä¸–ä»Šç”Ÿ - ä» Word Embedding åˆ° BERT&lt;/h1&gt;</p>\n<p>æœ¬ç¯‡æ–‡ç« å…± 25027 ä¸ªè¯ï¼Œä¸€ä¸ªå­—ä¸€ä¸ªå­—æ‰‹ç çš„ä¸å®¹æ˜“ï¼Œè½¬è½½è¯·æ ‡æ˜å‡ºå¤„ï¼š<br />\n&lt;a href='<span class=\"exturl\" data-url=\"aHR0cHM6Ly93d3cuY25ibG9ncy5jb20vbmlja2NoZW4xMjEvcC8xNTEwNTA0OC5odG1s\">https://www.cnblogs.com/nickchen121/p/15105048.html</span>'&gt; é¢„è®­ç»ƒè¯­è¨€æ¨¡å‹çš„å‰ä¸–ä»Šç”Ÿ - ä» Word Embedding åˆ° BERT - äºŒåä¸‰å²çš„æœ‰å¾· &lt;/a&gt;</p>\n<p>[TOC]</p>\n<p>Bert æœ€è¿‘å¾ˆç«ï¼Œåº”è¯¥æ˜¯æœ€è¿‘æœ€ç«çˆ†çš„ AI è¿›å±•ï¼Œç½‘ä¸Šçš„è¯„ä»·å¾ˆé«˜ï¼Œä»æ¨¡å‹åˆ›æ–°è§’åº¦çœ‹ä¸€èˆ¬ï¼Œåˆ›æ–°ä¸ç®—å¤§ã€‚ä½†æ˜¯æ¶ä¸ä½æ•ˆæœå¤ªå¥½äº†ï¼ŒåŸºæœ¬åˆ·æ–°äº†å¾ˆå¤š NLP çš„ä»»åŠ¡çš„æœ€å¥½æ€§èƒ½ï¼Œæœ‰äº›ä»»åŠ¡è¿˜è¢«åˆ·çˆ†äº†ï¼Œè¿™ä¸ªæ‰æ˜¯å…³é”®ã€‚å¦å¤–ä¸€ç‚¹æ˜¯ Bert å…·å¤‡å¹¿æ³›çš„é€šç”¨æ€§ï¼Œå°±æ˜¯è¯´ç»å¤§éƒ¨åˆ† NLP ä»»åŠ¡éƒ½å¯ä»¥é‡‡ç”¨ç±»ä¼¼çš„ä¸¤é˜¶æ®µæ¨¡å¼ç›´æ¥å»æå‡æ•ˆæœï¼Œè¿™ä¸ªç¬¬äºŒå…³é”®ã€‚å®¢è§‚çš„è¯´ï¼ŒæŠŠ Bert å½“åšæœ€è¿‘ä¸¤å¹´ NLP é‡å¤§è¿›å±•çš„é›†å¤§æˆè€…æ›´ç¬¦åˆäº‹å®ã€‚</p>\n<p>æœ¬æ–‡çš„ä¸»é¢˜æ˜¯é¢„è®­ç»ƒè¯­è¨€æ¨¡å‹çš„å‰ä¸–ä»Šç”Ÿï¼Œä¼šå¤§è‡´è¯´ä¸‹ NLP ä¸­çš„é¢„è®­ç»ƒæŠ€æœ¯æ˜¯ä¸€æ­¥ä¸€æ­¥å¦‚ä½•å‘å±•åˆ° Bert æ¨¡å‹çš„ï¼Œä»ä¸­å¯ä»¥å¾ˆè‡ªç„¶åœ°çœ‹åˆ° Bert çš„æ€è·¯æ˜¯å¦‚ä½•é€æ¸å½¢æˆçš„ï¼ŒBert çš„å†å²æ²¿é©æ˜¯ä»€ä¹ˆï¼Œç»§æ‰¿äº†ä»€ä¹ˆï¼Œåˆ›æ–°äº†ä»€ä¹ˆï¼Œä¸ºä»€ä¹ˆæ•ˆæœé‚£ä¹ˆå¥½ï¼Œä¸»è¦åŸå› æ˜¯ä»€ä¹ˆï¼Œä»¥åŠä¸ºä½•è¯´æ¨¡å‹åˆ›æ–°ä¸ç®—å¤ªå¤§ï¼Œä¸ºä½•è¯´ Bert æ˜¯è¿‘å¹´æ¥ NLP é‡å¤§è¿›å±•çš„é›†å¤§æˆè€…ã€‚</p>\n<p>é¢„è®­ç»ƒè¯­è¨€æ¨¡å‹çš„å‘å±•å¹¶ä¸æ˜¯ä¸€è¹´è€Œå°±çš„ï¼Œè€Œæ˜¯ä¼´éšç€è¯¸å¦‚è¯åµŒå…¥ã€åºåˆ—åˆ°åºåˆ—æ¨¡å‹åŠ Attention çš„å‘å±•è€Œäº§ç”Ÿçš„ã€‚</p>\n<p>DeepMind çš„è®¡ç®—æœºç§‘å­¦å®¶ Sebastian Ruder ç»™å‡ºäº† 21 ä¸–çºªä»¥æ¥ï¼Œä»ç¥ç»ç½‘ç»œæŠ€æœ¯çš„è§’åº¦åˆ†æï¼Œè‡ªç„¶è¯­è¨€å¤„ç†çš„é‡Œç¨‹ç¢‘å¼è¿›å±•ï¼Œå¦‚ä¸‹è¡¨æ‰€ç¤ºï¼š</p>\n<table>\n<thead>\n<tr>\n<th>å¹´ä»½</th>\n<th>2013 å¹´</th>\n<th>2014 å¹´</th>\n<th>2015 å¹´</th>\n<th>2016 å¹´</th>\n<th>2017 å¹´</th>\n</tr>\n</thead>\n<tbody>\n<tr>\n<td>æŠ€æœ¯</td>\n<td>word2vec</td>\n<td>GloVe</td>\n<td>LSTM/Attention</td>\n<td>Self-Attention</td>\n<td>Transformer</td>\n</tr>\n</tbody>\n<tbody>\n<tr>\n<td>å¹´ä»½</td>\n<td>2018 å¹´</td>\n<td>2019 å¹´</td>\n<td>2020 å¹´</td>\n</tr>\n<tr>\n<td>----</td>\n<td>-----------------</td>\n<td>----------------------------</td>\n<td>--------------------</td>\n</tr>\n<tr>\n<td>æŠ€æœ¯</td>\n<td>GPT/ELMo/BERT/GNN</td>\n<td>XLNet/BoBERTa/GPT-2/ERNIE/T5</td>\n<td>GPT-3/ELECTRA/ALBERT</td>\n</tr>\n</tbody>\n</table>\n<p>æœ¬ç¯‡æ–‡ç« å°†ä¼šé€šè¿‡ä¸Šè¡¨æ˜¾ç¤ºçš„ NLP ä¸­æŠ€æœ¯çš„å‘å±•å²ä¸€ä¸€å™è¿°ï¼Œç”±äº 19 å¹´åçš„æŠ€æœ¯å¤§éƒ½æ˜¯ BERT çš„å˜ä½“ï¼Œåœ¨è¿™é‡Œä¸ä¼šå¤šåŠ å™è¿°ï¼Œè¯»è€…å¯ä»¥è‡ªè¡ŒåŠ ä»¥äº†è§£ã€‚</p>\n<h1 id=\"ä¸€-é¢„è®­ç»ƒ\"><a class=\"anchor\" href=\"#ä¸€-é¢„è®­ç»ƒ\">#</a> ä¸€ã€é¢„è®­ç»ƒ</h1>\n<h2 id=\"11-å›¾åƒé¢†åŸŸçš„é¢„è®­ç»ƒ\"><a class=\"anchor\" href=\"#11-å›¾åƒé¢†åŸŸçš„é¢„è®­ç»ƒ\">#</a> 1.1 å›¾åƒé¢†åŸŸçš„é¢„è®­ç»ƒ</h2>\n<p>åœ¨ä»‹ç»å›¾åƒé¢†åŸŸçš„é¢„è®­ç»ƒä¹‹å‰ï¼Œæˆ‘ä»¬é¦–å…ˆä»‹ç»ä¸‹å·ç§¯ç¥ç»ç½‘ç»œï¼ˆCNNï¼‰ï¼ŒCNN ä¸€èˆ¬ç”¨äºå›¾ç‰‡åˆ†ç±»ä»»åŠ¡ï¼Œå¹¶ä¸” CNN ç”±å¤šä¸ªå±‚çº§ç»“æ„ç»„æˆï¼Œä¸åŒå±‚å­¦åˆ°çš„å›¾åƒç‰¹å¾ä¹Ÿä¸åŒï¼Œ<strong>è¶Šæµ…çš„å±‚å­¦åˆ°çš„ç‰¹å¾è¶Šé€šç”¨ï¼ˆæ¨ªç«–æ’‡æºï¼‰ï¼Œè¶Šæ·±çš„å±‚å­¦åˆ°çš„ç‰¹å¾å’Œå…·ä½“ä»»åŠ¡çš„å…³è”æ€§è¶Šå¼ºï¼ˆäººè„¸ - äººè„¸è½®å»“ã€æ±½è½¦ - æ±½è½¦è½®å»“ï¼‰</strong>ï¼Œå¦‚ä¸‹å›¾æ‰€ç¤ºï¼š</p>\n<p>&lt;img src=&quot;<span class=\"exturl\" data-url=\"aHR0cHM6Ly9pbWdtZC5vc3MtY24tc2hhbmdoYWkuYWxpeXVuY3MuY29tL0JFUlRfSU1HLyVFNSU5QiVCRSVFNSU4MyU4RiVFOSVBMiU4NCVFOCVBRSVBRCVFNyVCQiU4MyVFNyVBNCVCQSVFNCVCRSU4Qi5qcGc=\">https://imgmd.oss-cn-shanghai.aliyuncs.com/BERT_IMG/ å›¾åƒé¢„è®­ç»ƒç¤ºä¾‹.jpg</span>&quot; style=&quot;zoom:50%;&quot; /&gt;</p>\n<p>ç”±æ­¤ï¼Œå½“é¢†å¯¼ç»™æˆ‘ä»¬ä¸€ä¸ªä»»åŠ¡ï¼šé˜¿çŒ«ã€é˜¿ç‹—ã€é˜¿è™çš„å›¾ç‰‡å„åå¼ ï¼Œç„¶åè®©æˆ‘ä»¬è®¾è®¡ä¸€ä¸ªæ·±åº¦ç¥ç»ç½‘ç»œï¼Œé€šè¿‡è¯¥ç½‘ç»œæŠŠå®ƒä»¬ä¸‰è€…çš„å›¾ç‰‡è¿›è¡Œåˆ†ç±»ã€‚</p>\n<p>å¯¹äºä¸Šè¿°ä»»åŠ¡ï¼Œå¦‚æœæˆ‘ä»¬äº²æ‰‹è®¾è®¡ä¸€ä¸ªæ·±åº¦ç¥ç»ç½‘ç»œåŸºæœ¬æ˜¯ä¸å¯èƒ½çš„ï¼Œ<strong>å› ä¸ºæ·±åº¦å­¦ä¹ ä¸€ä¸ªå¼±é¡¹å°±æ˜¯åœ¨è®­ç»ƒé˜¶æ®µå¯¹äºæ•°æ®é‡çš„éœ€æ±‚ç‰¹åˆ«å¤§</strong>ï¼Œè€Œé¢†å¯¼åªç»™æˆ‘ä»¬åˆè®¡ä¸‰åå¼ å›¾ç‰‡ï¼Œæ˜¾ç„¶è¿™æ˜¯ä¸å¤Ÿçš„ã€‚</p>\n<p>è™½ç„¶é¢†å¯¼ç»™æˆ‘ä»¬çš„æ•°æ®é‡å¾ˆå°‘ï¼Œ<strong>ä½†æ˜¯æˆ‘ä»¬æ˜¯å¦å¯ä»¥åˆ©ç”¨ç½‘ä¸Šç°æœ‰çš„å¤§é‡å·²åšå¥½åˆ†ç±»æ ‡æ³¨çš„å›¾ç‰‡</strong>ã€‚æ¯”å¦‚ ImageNet ä¸­æœ‰ 1400 ä¸‡å¼ å›¾ç‰‡ï¼Œå¹¶ä¸”è¿™äº›å›¾ç‰‡éƒ½å·²ç»åšå¥½äº†åˆ†ç±»æ ‡æ³¨ã€‚</p>\n<p>&lt;img src=&quot;<span class=\"exturl\" data-url=\"aHR0cHM6Ly9pbWdtZC5vc3MtY24tc2hhbmdoYWkuYWxpeXVuY3MuY29tL0JFUlRfSU1HLyVFOSVBMiU4NCVFOCVBRSVBRCVFNyVCQiU4MyVFNyU5QSU4NCVFNSVCQSU5NCVFNyU5NCVBOC5qcGc=\">https://imgmd.oss-cn-shanghai.aliyuncs.com/BERT_IMG/ é¢„è®­ç»ƒçš„åº”ç”¨.jpg</span>&quot; style=&quot;zoom:50%;&quot; /&gt;</p>\n<p>ä¸Šè¿°åˆ©ç”¨ç½‘ç»œä¸Šç°æœ‰å›¾ç‰‡çš„æ€æƒ³å°±æ˜¯é¢„è®­ç»ƒçš„æ€æƒ³ï¼Œå…·ä½“åšæ³•å°±æ˜¯ï¼š</p>\n<ol>\n<li>é€šè¿‡ ImageNet æ•°æ®é›†æˆ‘ä»¬è®­ç»ƒå‡ºä¸€ä¸ªæ¨¡å‹ A</li>\n<li>ç”±äºä¸Šé¢æåˆ° CNN çš„æµ…å±‚å­¦åˆ°çš„ç‰¹å¾é€šç”¨æ€§ç‰¹åˆ«å¼ºï¼Œæˆ‘ä»¬å¯ä»¥å¯¹æ¨¡å‹ A åšå‡ºä¸€éƒ¨åˆ†æ”¹è¿›å¾—åˆ°æ¨¡å‹ Bï¼ˆä¸¤ç§æ–¹æ³•ï¼‰ï¼š\n<ol>\n<li>å†»ç»“ï¼šæµ…å±‚å‚æ•°ä½¿ç”¨æ¨¡å‹ A çš„å‚æ•°ï¼Œé«˜å±‚å‚æ•°éšæœºåˆå§‹åŒ–ï¼Œ<strong>æµ…å±‚å‚æ•°ä¸€ç›´ä¸å˜</strong>ï¼Œç„¶ååˆ©ç”¨é¢†å¯¼ç»™å‡ºçš„ 30 å¼ å›¾ç‰‡è®­ç»ƒå‚æ•°</li>\n<li>å¾®è°ƒï¼šæµ…å±‚å‚æ•°ä½¿ç”¨æ¨¡å‹ A çš„å‚æ•°ï¼Œé«˜å±‚å‚æ•°éšæœºåˆå§‹åŒ–ï¼Œç„¶ååˆ©ç”¨é¢†å¯¼ç»™å‡ºçš„ 30 å¼ å›¾ç‰‡è®­ç»ƒå‚æ•°ï¼Œ<strong>ä½†æ˜¯åœ¨è¿™é‡Œæµ…å±‚å‚æ•°ä¼šéšç€ä»»åŠ¡çš„è®­ç»ƒä¸æ–­å‘ç”Ÿå˜åŒ–</strong></li>\n</ol>\n</li>\n</ol>\n<p>&lt;img src=&quot;<span class=\"exturl\" data-url=\"aHR0cHM6Ly9pbWdtZC5vc3MtY24tc2hhbmdoYWkuYWxpeXVuY3MuY29tL0JFUlRfSU1HLyVFOSVBMiU4NCVFOCVBRSVBRCVFNyVCQiU4MyVFNSU5QyVBOCVFNSU5QiVCRSVFNSU4MyU4RiVFOSVBMiU4NiVFNSU5RiU5RiVFNyU5QSU4NCVFNSVCQSU5NCVFNyU5NCVBOC5qcGc=\">https://imgmd.oss-cn-shanghai.aliyuncs.com/BERT_IMG/ é¢„è®­ç»ƒåœ¨å›¾åƒé¢†åŸŸçš„åº”ç”¨.jpg</span>&quot; style=&quot;zoom:50%;&quot; /&gt;</p>\n<p>é€šè¿‡ä¸Šè¿°çš„è®²è§£ï¼Œå¯¹å›¾åƒé¢„è®­ç»ƒåšä¸ªæ€»ç»“ï¼ˆå¯å‚ç…§ä¸Šå›¾ï¼‰ï¼šå¯¹äºä¸€ä¸ªå…·æœ‰å°‘é‡æ•°æ®çš„ä»»åŠ¡ Aï¼Œé¦–å…ˆé€šè¿‡ä¸€ä¸ªç°æœ‰çš„å¤§é‡æ•°æ®æ­å»ºä¸€ä¸ª CNN æ¨¡å‹ Aï¼Œç”±äº CNN çš„æµ…å±‚å­¦åˆ°çš„ç‰¹å¾é€šç”¨æ€§ç‰¹åˆ«å¼ºï¼Œå› æ­¤åœ¨æ­å»ºä¸€ä¸ª CNN æ¨¡å‹ Bï¼Œå…¶ä¸­æ¨¡å‹ B çš„æµ…å±‚å‚æ•°ä½¿ç”¨æ¨¡å‹ A çš„æµ…å±‚å‚æ•°ï¼Œæ¨¡å‹ B çš„é«˜å±‚å‚æ•°éšæœºåˆå§‹åŒ–ï¼Œç„¶åé€šè¿‡å†»ç»“æˆ–å¾®è°ƒçš„æ–¹å¼åˆ©ç”¨ä»»åŠ¡ A çš„æ•°æ®è®­ç»ƒæ¨¡å‹ Bï¼Œæ¨¡å‹ B å°±æ˜¯å¯¹åº”ä»»åŠ¡ A çš„æ¨¡å‹ã€‚</p>\n<h2 id=\"12-é¢„è®­ç»ƒçš„æ€æƒ³\"><a class=\"anchor\" href=\"#12-é¢„è®­ç»ƒçš„æ€æƒ³\">#</a> 1.2 é¢„è®­ç»ƒçš„æ€æƒ³</h2>\n<p>æœ‰äº†å›¾åƒé¢†åŸŸé¢„è®­ç»ƒçš„å¼•å…¥ï¼Œæˆ‘ä»¬åœ¨æ­¤ç»™å‡ºé¢„è®­ç»ƒçš„æ€æƒ³ï¼šä»»åŠ¡ A å¯¹åº”çš„æ¨¡å‹ A çš„å‚æ•°ä¸å†æ˜¯éšæœºåˆå§‹åŒ–çš„ï¼Œè€Œæ˜¯é€šè¿‡ä»»åŠ¡ B è¿›è¡Œé¢„å…ˆè®­ç»ƒå¾—åˆ°æ¨¡å‹ Bï¼Œç„¶ååˆ©ç”¨æ¨¡å‹ B çš„å‚æ•°å¯¹æ¨¡å‹ A è¿›è¡Œåˆå§‹åŒ–ï¼Œå†é€šè¿‡ä»»åŠ¡ A çš„æ•°æ®å¯¹æ¨¡å‹ A è¿›è¡Œè®­ç»ƒã€‚æ³¨ï¼šæ¨¡å‹ B çš„å‚æ•°æ˜¯éšæœºåˆå§‹åŒ–çš„ã€‚</p>\n<h1 id=\"äºŒ-è¯­è¨€æ¨¡å‹\"><a class=\"anchor\" href=\"#äºŒ-è¯­è¨€æ¨¡å‹\">#</a> äºŒã€è¯­è¨€æ¨¡å‹</h1>\n<p>æƒ³äº†è§£é¢„è®­ç»ƒè¯­è¨€æ¨¡å‹ï¼Œé¦–å…ˆå¾—äº†è§£ä»€ä¹ˆæ˜¯è¯­è¨€æ¨¡å‹ã€‚</p>\n<p>è¯­è¨€æ¨¡å‹é€šä¿—ç‚¹è®²å°±æ˜¯ ** è®¡ç®—ä¸€ä¸ªå¥å­çš„æ¦‚ç‡ã€‚** ä¹Ÿå°±æ˜¯è¯´ï¼Œå¯¹äºè¯­è¨€åºåˆ— <span class=\"katex\"><span class=\"katex-mathml\"><math xmlns=\"http://www.w3.org/1998/Math/MathML\"><semantics><mrow><msub><mi>w</mi><mn>1</mn></msub><mo separator=\"true\">,</mo><msub><mi>w</mi><mn>2</mn></msub><mo separator=\"true\">,</mo><mo>â‹¯</mo><mtext>â€‰</mtext><mo separator=\"true\">,</mo><msub><mi>w</mi><mi>n</mi></msub></mrow><annotation encoding=\"application/x-tex\">w_1,w_2,\\cdots,w_n</annotation></semantics></math></span><span class=\"katex-html\" aria-hidden=\"true\"><span class=\"base\"><span class=\"strut\" style=\"height:0.625em;vertical-align:-0.19444em;\"></span><span class=\"mord\"><span class=\"mord mathnormal\" style=\"margin-right:0.02691em;\">w</span><span class=\"msupsub\"><span class=\"vlist-t vlist-t2\"><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.30110799999999993em;\"><span style=\"top:-2.5500000000000003em;margin-left:-0.02691em;margin-right:0.05em;\"><span class=\"pstrut\" style=\"height:2.7em;\"></span><span class=\"sizing reset-size6 size3 mtight\"><span class=\"mord mtight\">1</span></span></span></span><span class=\"vlist-s\">â€‹</span></span><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.15em;\"><span></span></span></span></span></span></span><span class=\"mpunct\">,</span><span class=\"mspace\" style=\"margin-right:0.16666666666666666em;\"></span><span class=\"mord\"><span class=\"mord mathnormal\" style=\"margin-right:0.02691em;\">w</span><span class=\"msupsub\"><span class=\"vlist-t vlist-t2\"><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.30110799999999993em;\"><span style=\"top:-2.5500000000000003em;margin-left:-0.02691em;margin-right:0.05em;\"><span class=\"pstrut\" style=\"height:2.7em;\"></span><span class=\"sizing reset-size6 size3 mtight\"><span class=\"mord mtight\">2</span></span></span></span><span class=\"vlist-s\">â€‹</span></span><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.15em;\"><span></span></span></span></span></span></span><span class=\"mpunct\">,</span><span class=\"mspace\" style=\"margin-right:0.16666666666666666em;\"></span><span class=\"minner\">â‹¯</span><span class=\"mspace\" style=\"margin-right:0.16666666666666666em;\"></span><span class=\"mspace\" style=\"margin-right:0.16666666666666666em;\"></span><span class=\"mpunct\">,</span><span class=\"mspace\" style=\"margin-right:0.16666666666666666em;\"></span><span class=\"mord\"><span class=\"mord mathnormal\" style=\"margin-right:0.02691em;\">w</span><span class=\"msupsub\"><span class=\"vlist-t vlist-t2\"><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.151392em;\"><span style=\"top:-2.5500000000000003em;margin-left:-0.02691em;margin-right:0.05em;\"><span class=\"pstrut\" style=\"height:2.7em;\"></span><span class=\"sizing reset-size6 size3 mtight\"><span class=\"mord mathnormal mtight\">n</span></span></span></span><span class=\"vlist-s\">â€‹</span></span><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.15em;\"><span></span></span></span></span></span></span></span></span></span>ï¼Œè¯­è¨€æ¨¡å‹å°±æ˜¯è®¡ç®—è¯¥åºåˆ—çš„æ¦‚ç‡ï¼Œå³ <span class=\"katex\"><span class=\"katex-mathml\"><math xmlns=\"http://www.w3.org/1998/Math/MathML\"><semantics><mrow><mi>P</mi><mo stretchy=\"false\">(</mo><msub><mi>w</mi><mn>1</mn></msub><mo separator=\"true\">,</mo><msub><mi>w</mi><mn>2</mn></msub><mo separator=\"true\">,</mo><mo>â‹¯</mo><mtext>â€‰</mtext><mo separator=\"true\">,</mo><msub><mi>w</mi><mi>n</mi></msub><mo stretchy=\"false\">)</mo></mrow><annotation encoding=\"application/x-tex\">P(w_1,w_2,\\cdots,w_n)</annotation></semantics></math></span><span class=\"katex-html\" aria-hidden=\"true\"><span class=\"base\"><span class=\"strut\" style=\"height:1em;vertical-align:-0.25em;\"></span><span class=\"mord mathnormal\" style=\"margin-right:0.13889em;\">P</span><span class=\"mopen\">(</span><span class=\"mord\"><span class=\"mord mathnormal\" style=\"margin-right:0.02691em;\">w</span><span class=\"msupsub\"><span class=\"vlist-t vlist-t2\"><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.30110799999999993em;\"><span style=\"top:-2.5500000000000003em;margin-left:-0.02691em;margin-right:0.05em;\"><span class=\"pstrut\" style=\"height:2.7em;\"></span><span class=\"sizing reset-size6 size3 mtight\"><span class=\"mord mtight\">1</span></span></span></span><span class=\"vlist-s\">â€‹</span></span><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.15em;\"><span></span></span></span></span></span></span><span class=\"mpunct\">,</span><span class=\"mspace\" style=\"margin-right:0.16666666666666666em;\"></span><span class=\"mord\"><span class=\"mord mathnormal\" style=\"margin-right:0.02691em;\">w</span><span class=\"msupsub\"><span class=\"vlist-t vlist-t2\"><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.30110799999999993em;\"><span style=\"top:-2.5500000000000003em;margin-left:-0.02691em;margin-right:0.05em;\"><span class=\"pstrut\" style=\"height:2.7em;\"></span><span class=\"sizing reset-size6 size3 mtight\"><span class=\"mord mtight\">2</span></span></span></span><span class=\"vlist-s\">â€‹</span></span><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.15em;\"><span></span></span></span></span></span></span><span class=\"mpunct\">,</span><span class=\"mspace\" style=\"margin-right:0.16666666666666666em;\"></span><span class=\"minner\">â‹¯</span><span class=\"mspace\" style=\"margin-right:0.16666666666666666em;\"></span><span class=\"mspace\" style=\"margin-right:0.16666666666666666em;\"></span><span class=\"mpunct\">,</span><span class=\"mspace\" style=\"margin-right:0.16666666666666666em;\"></span><span class=\"mord\"><span class=\"mord mathnormal\" style=\"margin-right:0.02691em;\">w</span><span class=\"msupsub\"><span class=\"vlist-t vlist-t2\"><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.151392em;\"><span style=\"top:-2.5500000000000003em;margin-left:-0.02691em;margin-right:0.05em;\"><span class=\"pstrut\" style=\"height:2.7em;\"></span><span class=\"sizing reset-size6 size3 mtight\"><span class=\"mord mathnormal mtight\">n</span></span></span></span><span class=\"vlist-s\">â€‹</span></span><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.15em;\"><span></span></span></span></span></span></span><span class=\"mclose\">)</span></span></span></span>ã€‚</p>\n<p>ä¸‹é¢é€šè¿‡ä¸¤ä¸ªå®ä¾‹å…·ä½“äº†è§£ä¸Šè¿°æ‰€æè¿°çš„æ„æ€ï¼š</p>\n<ol>\n<li>å‡è®¾ç»™å®šä¸¤å¥è¯ â€œåˆ¤æ–­è¿™ä¸ªè¯çš„ç£æ€§â€ å’Œ â€œåˆ¤æ–­è¿™ä¸ªè¯çš„è¯æ€§â€ï¼Œè¯­è¨€æ¨¡å‹ä¼šè®¤ä¸ºåè€…æ›´è‡ªç„¶ã€‚è½¬åŒ–æˆæ•°å­¦è¯­è¨€ä¹Ÿå°±æ˜¯ï¼š<span class=\"katex\"><span class=\"katex-mathml\"><math xmlns=\"http://www.w3.org/1998/Math/MathML\"><semantics><mrow><mi>P</mi><mo stretchy=\"false\">(</mo><mtext>åˆ¤æ–­ï¼Œè¿™ä¸ªï¼Œè¯ï¼Œçš„ï¼Œè¯æ€§</mtext><mo stretchy=\"false\">)</mo><mo>&gt;</mo><mi>P</mi><mo stretchy=\"false\">(</mo><mtext>åˆ¤æ–­ï¼Œè¿™ä¸ªï¼Œè¯ï¼Œçš„ï¼Œç£æ€§</mtext><mo stretchy=\"false\">)</mo></mrow><annotation encoding=\"application/x-tex\">P(åˆ¤æ–­ï¼Œè¿™ä¸ªï¼Œè¯ï¼Œçš„ï¼Œè¯æ€§) \\gt P(åˆ¤æ–­ï¼Œè¿™ä¸ªï¼Œè¯ï¼Œçš„ï¼Œç£æ€§)</annotation></semantics></math></span><span class=\"katex-html\" aria-hidden=\"true\"><span class=\"base\"><span class=\"strut\" style=\"height:1em;vertical-align:-0.25em;\"></span><span class=\"mord mathnormal\" style=\"margin-right:0.13889em;\">P</span><span class=\"mopen\">(</span><span class=\"mord cjk_fallback\">åˆ¤</span><span class=\"mord cjk_fallback\">æ–­</span><span class=\"mord cjk_fallback\">ï¼Œ</span><span class=\"mord cjk_fallback\">è¿™</span><span class=\"mord cjk_fallback\">ä¸ª</span><span class=\"mord cjk_fallback\">ï¼Œ</span><span class=\"mord cjk_fallback\">è¯</span><span class=\"mord cjk_fallback\">ï¼Œ</span><span class=\"mord cjk_fallback\">çš„</span><span class=\"mord cjk_fallback\">ï¼Œ</span><span class=\"mord cjk_fallback\">è¯</span><span class=\"mord cjk_fallback\">æ€§</span><span class=\"mclose\">)</span><span class=\"mspace\" style=\"margin-right:0.2777777777777778em;\"></span><span class=\"mrel\">&gt;</span><span class=\"mspace\" style=\"margin-right:0.2777777777777778em;\"></span></span><span class=\"base\"><span class=\"strut\" style=\"height:1em;vertical-align:-0.25em;\"></span><span class=\"mord mathnormal\" style=\"margin-right:0.13889em;\">P</span><span class=\"mopen\">(</span><span class=\"mord cjk_fallback\">åˆ¤</span><span class=\"mord cjk_fallback\">æ–­</span><span class=\"mord cjk_fallback\">ï¼Œ</span><span class=\"mord cjk_fallback\">è¿™</span><span class=\"mord cjk_fallback\">ä¸ª</span><span class=\"mord cjk_fallback\">ï¼Œ</span><span class=\"mord cjk_fallback\">è¯</span><span class=\"mord cjk_fallback\">ï¼Œ</span><span class=\"mord cjk_fallback\">çš„</span><span class=\"mord cjk_fallback\">ï¼Œ</span><span class=\"mord cjk_fallback\">ç£</span><span class=\"mord cjk_fallback\">æ€§</span><span class=\"mclose\">)</span></span></span></span></li>\n<li>å‡è®¾ç»™å®šä¸€å¥è¯åšå¡«ç©º â€œåˆ¤æ–­è¿™ä¸ªè¯çš„____â€ï¼Œåˆ™é—®é¢˜å°±å˜æˆäº†ç»™å®šå‰é¢çš„è¯ï¼Œæ‰¾å‡ºåé¢çš„ä¸€ä¸ªè¯æ˜¯ä»€ä¹ˆï¼Œè½¬åŒ–æˆæ•°å­¦è¯­è¨€å°±æ˜¯ï¼š<span class=\"katex\"><span class=\"katex-mathml\"><math xmlns=\"http://www.w3.org/1998/Math/MathML\"><semantics><mrow><mi>P</mi><mo stretchy=\"false\">(</mo><mtext>è¯æ€§</mtext><mi mathvariant=\"normal\">âˆ£</mi><mtext>åˆ¤æ–­ï¼Œè¿™ä¸ªï¼Œè¯ï¼Œçš„</mtext><mo stretchy=\"false\">)</mo><mo>&gt;</mo><mi>P</mi><mo stretchy=\"false\">(</mo><mtext>ç£æ€§</mtext><mi mathvariant=\"normal\">âˆ£</mi><mtext>åˆ¤æ–­ï¼Œè¿™ä¸ªï¼Œè¯ï¼Œçš„</mtext><mo stretchy=\"false\">)</mo></mrow><annotation encoding=\"application/x-tex\">P(è¯æ€§|åˆ¤æ–­ï¼Œè¿™ä¸ªï¼Œè¯ï¼Œçš„) \\gt P(ç£æ€§|åˆ¤æ–­ï¼Œè¿™ä¸ªï¼Œè¯ï¼Œçš„)</annotation></semantics></math></span><span class=\"katex-html\" aria-hidden=\"true\"><span class=\"base\"><span class=\"strut\" style=\"height:1em;vertical-align:-0.25em;\"></span><span class=\"mord mathnormal\" style=\"margin-right:0.13889em;\">P</span><span class=\"mopen\">(</span><span class=\"mord cjk_fallback\">è¯</span><span class=\"mord cjk_fallback\">æ€§</span><span class=\"mord\">âˆ£</span><span class=\"mord cjk_fallback\">åˆ¤</span><span class=\"mord cjk_fallback\">æ–­</span><span class=\"mord cjk_fallback\">ï¼Œ</span><span class=\"mord cjk_fallback\">è¿™</span><span class=\"mord cjk_fallback\">ä¸ª</span><span class=\"mord cjk_fallback\">ï¼Œ</span><span class=\"mord cjk_fallback\">è¯</span><span class=\"mord cjk_fallback\">ï¼Œ</span><span class=\"mord cjk_fallback\">çš„</span><span class=\"mclose\">)</span><span class=\"mspace\" style=\"margin-right:0.2777777777777778em;\"></span><span class=\"mrel\">&gt;</span><span class=\"mspace\" style=\"margin-right:0.2777777777777778em;\"></span></span><span class=\"base\"><span class=\"strut\" style=\"height:1em;vertical-align:-0.25em;\"></span><span class=\"mord mathnormal\" style=\"margin-right:0.13889em;\">P</span><span class=\"mopen\">(</span><span class=\"mord cjk_fallback\">ç£</span><span class=\"mord cjk_fallback\">æ€§</span><span class=\"mord\">âˆ£</span><span class=\"mord cjk_fallback\">åˆ¤</span><span class=\"mord cjk_fallback\">æ–­</span><span class=\"mord cjk_fallback\">ï¼Œ</span><span class=\"mord cjk_fallback\">è¿™</span><span class=\"mord cjk_fallback\">ä¸ª</span><span class=\"mord cjk_fallback\">ï¼Œ</span><span class=\"mord cjk_fallback\">è¯</span><span class=\"mord cjk_fallback\">ï¼Œ</span><span class=\"mord cjk_fallback\">çš„</span><span class=\"mclose\">)</span></span></span></span></li>\n</ol>\n<p>é€šè¿‡ä¸Šè¿°ä¸¤ä¸ªå®ä¾‹ï¼Œå¯ä»¥ç»™å‡ºè¯­è¨€æ¨¡å‹æ›´åŠ å…·ä½“çš„æè¿°ï¼šç»™å®šä¸€å¥ç”± <span class=\"katex\"><span class=\"katex-mathml\"><math xmlns=\"http://www.w3.org/1998/Math/MathML\"><semantics><mrow><mi>n</mi></mrow><annotation encoding=\"application/x-tex\">n</annotation></semantics></math></span><span class=\"katex-html\" aria-hidden=\"true\"><span class=\"base\"><span class=\"strut\" style=\"height:0.43056em;vertical-align:0em;\"></span><span class=\"mord mathnormal\">n</span></span></span></span> ä¸ªè¯ç»„æˆçš„å¥å­ <span class=\"katex\"><span class=\"katex-mathml\"><math xmlns=\"http://www.w3.org/1998/Math/MathML\"><semantics><mrow><mi>W</mi><mo>=</mo><msub><mi>w</mi><mn>1</mn></msub><mo separator=\"true\">,</mo><msub><mi>w</mi><mn>2</mn></msub><mo separator=\"true\">,</mo><mo>â‹¯</mo><mtext>â€‰</mtext><mo separator=\"true\">,</mo><msub><mi>w</mi><mi>n</mi></msub></mrow><annotation encoding=\"application/x-tex\">W=w_1,w_2,\\cdots,w_n</annotation></semantics></math></span><span class=\"katex-html\" aria-hidden=\"true\"><span class=\"base\"><span class=\"strut\" style=\"height:0.68333em;vertical-align:0em;\"></span><span class=\"mord mathnormal\" style=\"margin-right:0.13889em;\">W</span><span class=\"mspace\" style=\"margin-right:0.2777777777777778em;\"></span><span class=\"mrel\">=</span><span class=\"mspace\" style=\"margin-right:0.2777777777777778em;\"></span></span><span class=\"base\"><span class=\"strut\" style=\"height:0.625em;vertical-align:-0.19444em;\"></span><span class=\"mord\"><span class=\"mord mathnormal\" style=\"margin-right:0.02691em;\">w</span><span class=\"msupsub\"><span class=\"vlist-t vlist-t2\"><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.30110799999999993em;\"><span style=\"top:-2.5500000000000003em;margin-left:-0.02691em;margin-right:0.05em;\"><span class=\"pstrut\" style=\"height:2.7em;\"></span><span class=\"sizing reset-size6 size3 mtight\"><span class=\"mord mtight\">1</span></span></span></span><span class=\"vlist-s\">â€‹</span></span><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.15em;\"><span></span></span></span></span></span></span><span class=\"mpunct\">,</span><span class=\"mspace\" style=\"margin-right:0.16666666666666666em;\"></span><span class=\"mord\"><span class=\"mord mathnormal\" style=\"margin-right:0.02691em;\">w</span><span class=\"msupsub\"><span class=\"vlist-t vlist-t2\"><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.30110799999999993em;\"><span style=\"top:-2.5500000000000003em;margin-left:-0.02691em;margin-right:0.05em;\"><span class=\"pstrut\" style=\"height:2.7em;\"></span><span class=\"sizing reset-size6 size3 mtight\"><span class=\"mord mtight\">2</span></span></span></span><span class=\"vlist-s\">â€‹</span></span><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.15em;\"><span></span></span></span></span></span></span><span class=\"mpunct\">,</span><span class=\"mspace\" style=\"margin-right:0.16666666666666666em;\"></span><span class=\"minner\">â‹¯</span><span class=\"mspace\" style=\"margin-right:0.16666666666666666em;\"></span><span class=\"mspace\" style=\"margin-right:0.16666666666666666em;\"></span><span class=\"mpunct\">,</span><span class=\"mspace\" style=\"margin-right:0.16666666666666666em;\"></span><span class=\"mord\"><span class=\"mord mathnormal\" style=\"margin-right:0.02691em;\">w</span><span class=\"msupsub\"><span class=\"vlist-t vlist-t2\"><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.151392em;\"><span style=\"top:-2.5500000000000003em;margin-left:-0.02691em;margin-right:0.05em;\"><span class=\"pstrut\" style=\"height:2.7em;\"></span><span class=\"sizing reset-size6 size3 mtight\"><span class=\"mord mathnormal mtight\">n</span></span></span></span><span class=\"vlist-s\">â€‹</span></span><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.15em;\"><span></span></span></span></span></span></span></span></span></span>ï¼Œè®¡ç®—è¿™ä¸ªå¥å­çš„æ¦‚ç‡ <span class=\"katex\"><span class=\"katex-mathml\"><math xmlns=\"http://www.w3.org/1998/Math/MathML\"><semantics><mrow><mi>P</mi><mo stretchy=\"false\">(</mo><msub><mi>w</mi><mn>1</mn></msub><mo separator=\"true\">,</mo><msub><mi>w</mi><mn>2</mn></msub><mo separator=\"true\">,</mo><mo>â‹¯</mo><mtext>â€‰</mtext><mo separator=\"true\">,</mo><msub><mi>w</mi><mi>n</mi></msub><mo stretchy=\"false\">)</mo></mrow><annotation encoding=\"application/x-tex\">P(w_1,w_2,\\cdots,w_n)</annotation></semantics></math></span><span class=\"katex-html\" aria-hidden=\"true\"><span class=\"base\"><span class=\"strut\" style=\"height:1em;vertical-align:-0.25em;\"></span><span class=\"mord mathnormal\" style=\"margin-right:0.13889em;\">P</span><span class=\"mopen\">(</span><span class=\"mord\"><span class=\"mord mathnormal\" style=\"margin-right:0.02691em;\">w</span><span class=\"msupsub\"><span class=\"vlist-t vlist-t2\"><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.30110799999999993em;\"><span style=\"top:-2.5500000000000003em;margin-left:-0.02691em;margin-right:0.05em;\"><span class=\"pstrut\" style=\"height:2.7em;\"></span><span class=\"sizing reset-size6 size3 mtight\"><span class=\"mord mtight\">1</span></span></span></span><span class=\"vlist-s\">â€‹</span></span><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.15em;\"><span></span></span></span></span></span></span><span class=\"mpunct\">,</span><span class=\"mspace\" style=\"margin-right:0.16666666666666666em;\"></span><span class=\"mord\"><span class=\"mord mathnormal\" style=\"margin-right:0.02691em;\">w</span><span class=\"msupsub\"><span class=\"vlist-t vlist-t2\"><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.30110799999999993em;\"><span style=\"top:-2.5500000000000003em;margin-left:-0.02691em;margin-right:0.05em;\"><span class=\"pstrut\" style=\"height:2.7em;\"></span><span class=\"sizing reset-size6 size3 mtight\"><span class=\"mord mtight\">2</span></span></span></span><span class=\"vlist-s\">â€‹</span></span><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.15em;\"><span></span></span></span></span></span></span><span class=\"mpunct\">,</span><span class=\"mspace\" style=\"margin-right:0.16666666666666666em;\"></span><span class=\"minner\">â‹¯</span><span class=\"mspace\" style=\"margin-right:0.16666666666666666em;\"></span><span class=\"mspace\" style=\"margin-right:0.16666666666666666em;\"></span><span class=\"mpunct\">,</span><span class=\"mspace\" style=\"margin-right:0.16666666666666666em;\"></span><span class=\"mord\"><span class=\"mord mathnormal\" style=\"margin-right:0.02691em;\">w</span><span class=\"msupsub\"><span class=\"vlist-t vlist-t2\"><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.151392em;\"><span style=\"top:-2.5500000000000003em;margin-left:-0.02691em;margin-right:0.05em;\"><span class=\"pstrut\" style=\"height:2.7em;\"></span><span class=\"sizing reset-size6 size3 mtight\"><span class=\"mord mathnormal mtight\">n</span></span></span></span><span class=\"vlist-s\">â€‹</span></span><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.15em;\"><span></span></span></span></span></span></span><span class=\"mclose\">)</span></span></span></span>ï¼Œæˆ–è€…è®¡ç®—æ ¹æ®ä¸Šæ–‡è®¡ç®—ä¸‹ä¸€ä¸ªè¯çš„æ¦‚ç‡ <span class=\"katex\"><span class=\"katex-mathml\"><math xmlns=\"http://www.w3.org/1998/Math/MathML\"><semantics><mrow><mi>P</mi><mo stretchy=\"false\">(</mo><msub><mi>w</mi><mi>n</mi></msub><mi mathvariant=\"normal\">âˆ£</mi><msub><mi>w</mi><mn>1</mn></msub><mo separator=\"true\">,</mo><msub><mi>w</mi><mn>2</mn></msub><mo separator=\"true\">,</mo><mo>â‹¯</mo><mtext>â€‰</mtext><mo separator=\"true\">,</mo><msub><mi>w</mi><mrow><mi>n</mi><mo>âˆ’</mo><mn>1</mn></mrow></msub><mo stretchy=\"false\">)</mo></mrow><annotation encoding=\"application/x-tex\">P(w_n|w_1,w_2,\\cdots,w_{n-1})</annotation></semantics></math></span><span class=\"katex-html\" aria-hidden=\"true\"><span class=\"base\"><span class=\"strut\" style=\"height:1em;vertical-align:-0.25em;\"></span><span class=\"mord mathnormal\" style=\"margin-right:0.13889em;\">P</span><span class=\"mopen\">(</span><span class=\"mord\"><span class=\"mord mathnormal\" style=\"margin-right:0.02691em;\">w</span><span class=\"msupsub\"><span class=\"vlist-t vlist-t2\"><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.151392em;\"><span style=\"top:-2.5500000000000003em;margin-left:-0.02691em;margin-right:0.05em;\"><span class=\"pstrut\" style=\"height:2.7em;\"></span><span class=\"sizing reset-size6 size3 mtight\"><span class=\"mord mathnormal mtight\">n</span></span></span></span><span class=\"vlist-s\">â€‹</span></span><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.15em;\"><span></span></span></span></span></span></span><span class=\"mord\">âˆ£</span><span class=\"mord\"><span class=\"mord mathnormal\" style=\"margin-right:0.02691em;\">w</span><span class=\"msupsub\"><span class=\"vlist-t vlist-t2\"><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.30110799999999993em;\"><span style=\"top:-2.5500000000000003em;margin-left:-0.02691em;margin-right:0.05em;\"><span class=\"pstrut\" style=\"height:2.7em;\"></span><span class=\"sizing reset-size6 size3 mtight\"><span class=\"mord mtight\">1</span></span></span></span><span class=\"vlist-s\">â€‹</span></span><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.15em;\"><span></span></span></span></span></span></span><span class=\"mpunct\">,</span><span class=\"mspace\" style=\"margin-right:0.16666666666666666em;\"></span><span class=\"mord\"><span class=\"mord mathnormal\" style=\"margin-right:0.02691em;\">w</span><span class=\"msupsub\"><span class=\"vlist-t vlist-t2\"><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.30110799999999993em;\"><span style=\"top:-2.5500000000000003em;margin-left:-0.02691em;margin-right:0.05em;\"><span class=\"pstrut\" style=\"height:2.7em;\"></span><span class=\"sizing reset-size6 size3 mtight\"><span class=\"mord mtight\">2</span></span></span></span><span class=\"vlist-s\">â€‹</span></span><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.15em;\"><span></span></span></span></span></span></span><span class=\"mpunct\">,</span><span class=\"mspace\" style=\"margin-right:0.16666666666666666em;\"></span><span class=\"minner\">â‹¯</span><span class=\"mspace\" style=\"margin-right:0.16666666666666666em;\"></span><span class=\"mspace\" style=\"margin-right:0.16666666666666666em;\"></span><span class=\"mpunct\">,</span><span class=\"mspace\" style=\"margin-right:0.16666666666666666em;\"></span><span class=\"mord\"><span class=\"mord mathnormal\" style=\"margin-right:0.02691em;\">w</span><span class=\"msupsub\"><span class=\"vlist-t vlist-t2\"><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.301108em;\"><span style=\"top:-2.5500000000000003em;margin-left:-0.02691em;margin-right:0.05em;\"><span class=\"pstrut\" style=\"height:2.7em;\"></span><span class=\"sizing reset-size6 size3 mtight\"><span class=\"mord mtight\"><span class=\"mord mathnormal mtight\">n</span><span class=\"mbin mtight\">âˆ’</span><span class=\"mord mtight\">1</span></span></span></span></span><span class=\"vlist-s\">â€‹</span></span><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.208331em;\"><span></span></span></span></span></span></span><span class=\"mclose\">)</span></span></span></span>ã€‚</p>\n<p>ä¸‹é¢å°†ä»‹ç»è¯­è¨€æ¨¡å‹çš„ä¸¤ä¸ªåˆ†æ”¯ï¼Œç»Ÿè®¡è¯­è¨€æ¨¡å‹å’Œç¥ç»ç½‘ç»œè¯­è¨€æ¨¡å‹ã€‚</p>\n<h2 id=\"21-ç»Ÿè®¡è¯­è¨€æ¨¡å‹\"><a class=\"anchor\" href=\"#21-ç»Ÿè®¡è¯­è¨€æ¨¡å‹\">#</a> 2.1 ç»Ÿè®¡è¯­è¨€æ¨¡å‹</h2>\n<p>ç»Ÿè®¡è¯­è¨€æ¨¡å‹çš„åŸºæœ¬æ€æƒ³å°±æ˜¯<strong>è®¡ç®—æ¡ä»¶æ¦‚ç‡</strong>ã€‚</p>\n<p>ç»™å®šä¸€å¥ç”± <span class=\"katex\"><span class=\"katex-mathml\"><math xmlns=\"http://www.w3.org/1998/Math/MathML\"><semantics><mrow><mi>n</mi></mrow><annotation encoding=\"application/x-tex\">n</annotation></semantics></math></span><span class=\"katex-html\" aria-hidden=\"true\"><span class=\"base\"><span class=\"strut\" style=\"height:0.43056em;vertical-align:0em;\"></span><span class=\"mord mathnormal\">n</span></span></span></span> ä¸ªè¯ç»„æˆçš„å¥å­ <span class=\"katex\"><span class=\"katex-mathml\"><math xmlns=\"http://www.w3.org/1998/Math/MathML\"><semantics><mrow><mi>W</mi><mo>=</mo><msub><mi>w</mi><mn>1</mn></msub><mo separator=\"true\">,</mo><msub><mi>w</mi><mn>2</mn></msub><mo separator=\"true\">,</mo><mo>â‹¯</mo><mtext>â€‰</mtext><mo separator=\"true\">,</mo><msub><mi>w</mi><mi>n</mi></msub></mrow><annotation encoding=\"application/x-tex\">W=w_1,w_2,\\cdots,w_n</annotation></semantics></math></span><span class=\"katex-html\" aria-hidden=\"true\"><span class=\"base\"><span class=\"strut\" style=\"height:0.68333em;vertical-align:0em;\"></span><span class=\"mord mathnormal\" style=\"margin-right:0.13889em;\">W</span><span class=\"mspace\" style=\"margin-right:0.2777777777777778em;\"></span><span class=\"mrel\">=</span><span class=\"mspace\" style=\"margin-right:0.2777777777777778em;\"></span></span><span class=\"base\"><span class=\"strut\" style=\"height:0.625em;vertical-align:-0.19444em;\"></span><span class=\"mord\"><span class=\"mord mathnormal\" style=\"margin-right:0.02691em;\">w</span><span class=\"msupsub\"><span class=\"vlist-t vlist-t2\"><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.30110799999999993em;\"><span style=\"top:-2.5500000000000003em;margin-left:-0.02691em;margin-right:0.05em;\"><span class=\"pstrut\" style=\"height:2.7em;\"></span><span class=\"sizing reset-size6 size3 mtight\"><span class=\"mord mtight\">1</span></span></span></span><span class=\"vlist-s\">â€‹</span></span><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.15em;\"><span></span></span></span></span></span></span><span class=\"mpunct\">,</span><span class=\"mspace\" style=\"margin-right:0.16666666666666666em;\"></span><span class=\"mord\"><span class=\"mord mathnormal\" style=\"margin-right:0.02691em;\">w</span><span class=\"msupsub\"><span class=\"vlist-t vlist-t2\"><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.30110799999999993em;\"><span style=\"top:-2.5500000000000003em;margin-left:-0.02691em;margin-right:0.05em;\"><span class=\"pstrut\" style=\"height:2.7em;\"></span><span class=\"sizing reset-size6 size3 mtight\"><span class=\"mord mtight\">2</span></span></span></span><span class=\"vlist-s\">â€‹</span></span><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.15em;\"><span></span></span></span></span></span></span><span class=\"mpunct\">,</span><span class=\"mspace\" style=\"margin-right:0.16666666666666666em;\"></span><span class=\"minner\">â‹¯</span><span class=\"mspace\" style=\"margin-right:0.16666666666666666em;\"></span><span class=\"mspace\" style=\"margin-right:0.16666666666666666em;\"></span><span class=\"mpunct\">,</span><span class=\"mspace\" style=\"margin-right:0.16666666666666666em;\"></span><span class=\"mord\"><span class=\"mord mathnormal\" style=\"margin-right:0.02691em;\">w</span><span class=\"msupsub\"><span class=\"vlist-t vlist-t2\"><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.151392em;\"><span style=\"top:-2.5500000000000003em;margin-left:-0.02691em;margin-right:0.05em;\"><span class=\"pstrut\" style=\"height:2.7em;\"></span><span class=\"sizing reset-size6 size3 mtight\"><span class=\"mord mathnormal mtight\">n</span></span></span></span><span class=\"vlist-s\">â€‹</span></span><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.15em;\"><span></span></span></span></span></span></span></span></span></span>ï¼Œè®¡ç®—è¿™ä¸ªå¥å­çš„æ¦‚ç‡ <span class=\"katex\"><span class=\"katex-mathml\"><math xmlns=\"http://www.w3.org/1998/Math/MathML\"><semantics><mrow><mi>P</mi><mo stretchy=\"false\">(</mo><msub><mi>w</mi><mn>1</mn></msub><mo separator=\"true\">,</mo><msub><mi>w</mi><mn>2</mn></msub><mo separator=\"true\">,</mo><mo>â‹¯</mo><mtext>â€‰</mtext><mo separator=\"true\">,</mo><msub><mi>w</mi><mi>n</mi></msub><mo stretchy=\"false\">)</mo></mrow><annotation encoding=\"application/x-tex\">P(w_1,w_2,\\cdots,w_n)</annotation></semantics></math></span><span class=\"katex-html\" aria-hidden=\"true\"><span class=\"base\"><span class=\"strut\" style=\"height:1em;vertical-align:-0.25em;\"></span><span class=\"mord mathnormal\" style=\"margin-right:0.13889em;\">P</span><span class=\"mopen\">(</span><span class=\"mord\"><span class=\"mord mathnormal\" style=\"margin-right:0.02691em;\">w</span><span class=\"msupsub\"><span class=\"vlist-t vlist-t2\"><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.30110799999999993em;\"><span style=\"top:-2.5500000000000003em;margin-left:-0.02691em;margin-right:0.05em;\"><span class=\"pstrut\" style=\"height:2.7em;\"></span><span class=\"sizing reset-size6 size3 mtight\"><span class=\"mord mtight\">1</span></span></span></span><span class=\"vlist-s\">â€‹</span></span><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.15em;\"><span></span></span></span></span></span></span><span class=\"mpunct\">,</span><span class=\"mspace\" style=\"margin-right:0.16666666666666666em;\"></span><span class=\"mord\"><span class=\"mord mathnormal\" style=\"margin-right:0.02691em;\">w</span><span class=\"msupsub\"><span class=\"vlist-t vlist-t2\"><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.30110799999999993em;\"><span style=\"top:-2.5500000000000003em;margin-left:-0.02691em;margin-right:0.05em;\"><span class=\"pstrut\" style=\"height:2.7em;\"></span><span class=\"sizing reset-size6 size3 mtight\"><span class=\"mord mtight\">2</span></span></span></span><span class=\"vlist-s\">â€‹</span></span><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.15em;\"><span></span></span></span></span></span></span><span class=\"mpunct\">,</span><span class=\"mspace\" style=\"margin-right:0.16666666666666666em;\"></span><span class=\"minner\">â‹¯</span><span class=\"mspace\" style=\"margin-right:0.16666666666666666em;\"></span><span class=\"mspace\" style=\"margin-right:0.16666666666666666em;\"></span><span class=\"mpunct\">,</span><span class=\"mspace\" style=\"margin-right:0.16666666666666666em;\"></span><span class=\"mord\"><span class=\"mord mathnormal\" style=\"margin-right:0.02691em;\">w</span><span class=\"msupsub\"><span class=\"vlist-t vlist-t2\"><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.151392em;\"><span style=\"top:-2.5500000000000003em;margin-left:-0.02691em;margin-right:0.05em;\"><span class=\"pstrut\" style=\"height:2.7em;\"></span><span class=\"sizing reset-size6 size3 mtight\"><span class=\"mord mathnormal mtight\">n</span></span></span></span><span class=\"vlist-s\">â€‹</span></span><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.15em;\"><span></span></span></span></span></span></span><span class=\"mclose\">)</span></span></span></span> çš„å…¬å¼å¦‚ä¸‹ï¼ˆæ¡ä»¶æ¦‚ç‡ä¹˜æ³•å…¬å¼çš„æ¨å¹¿ï¼Œé“¾å¼æ³•åˆ™ï¼‰ï¼š</p>\n\\begin{align*}\nP(w_1,w_2,\\cdots,w_n) \n& =  P(w_1)P(w_2|w_1)P(w_3|w_1,w_2)\\cdots p(w_n|w_1,w_2,\\cdots,w_{n-1}) \\\\\n& = \\prod_i P(w_i|w1,w_2,\\cdots,w_{i-1})\n\\end{align*}\n\n<p>å¯¹äºä¸Šä¸€èŠ‚æåˆ°çš„ â€œåˆ¤æ–­è¿™ä¸ªè¯çš„è¯æ€§â€ è¿™å¥è¯ï¼Œåˆ©ç”¨ä¸Šè¿°çš„å…¬å¼ï¼Œå¯ä»¥å¾—åˆ°ï¼š</p>\n\\begin{align*}\n& P(åˆ¤æ–­ï¼Œè¿™ä¸ªï¼Œè¯ï¼Œçš„ï¼Œè¯æ€§) = \\\\\n& P(åˆ¤æ–­)P(è¿™ä¸ª|åˆ¤æ–­)P(è¯|åˆ¤æ–­ï¼Œè¿™ä¸ª) \\\\\n& P(çš„|åˆ¤æ–­ï¼Œè¿™ä¸ªï¼Œè¯)P(è¯æ€§|åˆ¤æ–­ï¼Œè¿™ä¸ªï¼Œè¯ï¼Œçš„)P(åˆ¤æ–­ï¼Œè¿™ä¸ªï¼Œè¯ï¼Œçš„ï¼Œè¯æ€§)\n\\end{align*}\n\n<p>å¯¹äºä¸Šä¸€èŠ‚æåˆ°çš„å¦å¤–ä¸€ä¸ªé—®é¢˜ï¼Œå½“ç»™å®šå‰é¢è¯çš„åºåˆ— â€œåˆ¤æ–­ï¼Œè¿™ä¸ªï¼Œè¯ï¼Œçš„â€ æ—¶ï¼Œæƒ³è¦çŸ¥é“ä¸‹ä¸€ä¸ªè¯æ˜¯ä»€ä¹ˆï¼Œå¯ä»¥ç›´æ¥è®¡ç®—å¦‚ä¸‹æ¦‚ç‡ï¼š</p>\n<p><span class=\"katex-display\"><span class=\"katex\"><span class=\"katex-mathml\"><math xmlns=\"http://www.w3.org/1998/Math/MathML\" display=\"block\"><semantics><mrow><mi>P</mi><mo stretchy=\"false\">(</mo><msub><mi>w</mi><mrow><mi>n</mi><mi>e</mi><mi>x</mi><mi>t</mi></mrow></msub><mi mathvariant=\"normal\">âˆ£</mi><mtext>åˆ¤æ–­ï¼Œè¿™ä¸ªï¼Œè¯ï¼Œçš„</mtext><mo stretchy=\"false\">)</mo><mspace width=\"1em\"/><mtext>å…¬å¼(1)</mtext></mrow><annotation encoding=\"application/x-tex\">P(w_{next}|åˆ¤æ–­ï¼Œè¿™ä¸ªï¼Œè¯ï¼Œçš„)\\quad\\text{å…¬å¼(1)}\n</annotation></semantics></math></span><span class=\"katex-html\" aria-hidden=\"true\"><span class=\"base\"><span class=\"strut\" style=\"height:1em;vertical-align:-0.25em;\"></span><span class=\"mord mathnormal\" style=\"margin-right:0.13889em;\">P</span><span class=\"mopen\">(</span><span class=\"mord\"><span class=\"mord mathnormal\" style=\"margin-right:0.02691em;\">w</span><span class=\"msupsub\"><span class=\"vlist-t vlist-t2\"><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.2805559999999999em;\"><span style=\"top:-2.5500000000000003em;margin-left:-0.02691em;margin-right:0.05em;\"><span class=\"pstrut\" style=\"height:2.7em;\"></span><span class=\"sizing reset-size6 size3 mtight\"><span class=\"mord mtight\"><span class=\"mord mathnormal mtight\">n</span><span class=\"mord mathnormal mtight\">e</span><span class=\"mord mathnormal mtight\">x</span><span class=\"mord mathnormal mtight\">t</span></span></span></span></span><span class=\"vlist-s\">â€‹</span></span><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.15em;\"><span></span></span></span></span></span></span><span class=\"mord\">âˆ£</span><span class=\"mord cjk_fallback\">åˆ¤</span><span class=\"mord cjk_fallback\">æ–­</span><span class=\"mord cjk_fallback\">ï¼Œ</span><span class=\"mord cjk_fallback\">è¿™</span><span class=\"mord cjk_fallback\">ä¸ª</span><span class=\"mord cjk_fallback\">ï¼Œ</span><span class=\"mord cjk_fallback\">è¯</span><span class=\"mord cjk_fallback\">ï¼Œ</span><span class=\"mord cjk_fallback\">çš„</span><span class=\"mclose\">)</span><span class=\"mspace\" style=\"margin-right:1em;\"></span><span class=\"mord text\"><span class=\"mord cjk_fallback\">å…¬å¼</span><span class=\"mord\">(1)</span></span></span></span></span></span></p>\n<p>å…¶ä¸­ï¼Œ<span class=\"katex\"><span class=\"katex-mathml\"><math xmlns=\"http://www.w3.org/1998/Math/MathML\"><semantics><mrow><msub><mi>w</mi><mrow><mi>n</mi><mi>e</mi><mi>x</mi><mi>t</mi></mrow></msub><mo>âˆˆ</mo><mi>V</mi></mrow><annotation encoding=\"application/x-tex\">w_{next} \\in V</annotation></semantics></math></span><span class=\"katex-html\" aria-hidden=\"true\"><span class=\"base\"><span class=\"strut\" style=\"height:0.6891em;vertical-align:-0.15em;\"></span><span class=\"mord\"><span class=\"mord mathnormal\" style=\"margin-right:0.02691em;\">w</span><span class=\"msupsub\"><span class=\"vlist-t vlist-t2\"><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.2805559999999999em;\"><span style=\"top:-2.5500000000000003em;margin-left:-0.02691em;margin-right:0.05em;\"><span class=\"pstrut\" style=\"height:2.7em;\"></span><span class=\"sizing reset-size6 size3 mtight\"><span class=\"mord mtight\"><span class=\"mord mathnormal mtight\">n</span><span class=\"mord mathnormal mtight\">e</span><span class=\"mord mathnormal mtight\">x</span><span class=\"mord mathnormal mtight\">t</span></span></span></span></span><span class=\"vlist-s\">â€‹</span></span><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.15em;\"><span></span></span></span></span></span></span><span class=\"mspace\" style=\"margin-right:0.2777777777777778em;\"></span><span class=\"mrel\">âˆˆ</span><span class=\"mspace\" style=\"margin-right:0.2777777777777778em;\"></span></span><span class=\"base\"><span class=\"strut\" style=\"height:0.68333em;vertical-align:0em;\"></span><span class=\"mord mathnormal\" style=\"margin-right:0.22222em;\">V</span></span></span></span> è¡¨ç¤ºè¯åºåˆ—çš„ä¸‹ä¸€ä¸ªè¯ï¼Œ<span class=\"katex\"><span class=\"katex-mathml\"><math xmlns=\"http://www.w3.org/1998/Math/MathML\"><semantics><mrow><mi>V</mi></mrow><annotation encoding=\"application/x-tex\">V</annotation></semantics></math></span><span class=\"katex-html\" aria-hidden=\"true\"><span class=\"base\"><span class=\"strut\" style=\"height:0.68333em;vertical-align:0em;\"></span><span class=\"mord mathnormal\" style=\"margin-right:0.22222em;\">V</span></span></span></span> æ˜¯ä¸€ä¸ªå…·æœ‰ <span class=\"katex\"><span class=\"katex-mathml\"><math xmlns=\"http://www.w3.org/1998/Math/MathML\"><semantics><mrow><mi mathvariant=\"normal\">âˆ£</mi><mi>V</mi><mi mathvariant=\"normal\">âˆ£</mi></mrow><annotation encoding=\"application/x-tex\">|V|</annotation></semantics></math></span><span class=\"katex-html\" aria-hidden=\"true\"><span class=\"base\"><span class=\"strut\" style=\"height:1em;vertical-align:-0.25em;\"></span><span class=\"mord\">âˆ£</span><span class=\"mord mathnormal\" style=\"margin-right:0.22222em;\">V</span><span class=\"mord\">âˆ£</span></span></span></span> ä¸ªè¯çš„è¯å…¸ï¼ˆè¯é›†åˆï¼‰ã€‚</p>\n<p>å¯¹äºå…¬å¼ï¼ˆ1ï¼‰ï¼Œå¯ä»¥å±•å¼€æˆå¦‚ä¸‹å½¢å¼ï¼š</p>\n<p><span class=\"katex-display\"><span class=\"katex\"><span class=\"katex-mathml\"><math xmlns=\"http://www.w3.org/1998/Math/MathML\" display=\"block\"><semantics><mrow><mi>P</mi><mo stretchy=\"false\">(</mo><msub><mi>w</mi><mrow><mi>n</mi><mi>e</mi><mi>x</mi><mi>t</mi></mrow></msub><mi mathvariant=\"normal\">âˆ£</mi><mtext>åˆ¤æ–­ï¼Œè¿™ä¸ªï¼Œè¯ï¼Œçš„</mtext><mo stretchy=\"false\">)</mo><mo>=</mo><mfrac><mrow><mi>c</mi><mi>o</mi><mi>u</mi><mi>n</mi><mi>t</mi><mo stretchy=\"false\">(</mo><msub><mi>w</mi><mrow><mi>n</mi><mi>e</mi><mi>x</mi><mi>t</mi></mrow></msub><mtext>ï¼Œåˆ¤æ–­ï¼Œè¿™ä¸ªï¼Œè¯ï¼Œçš„</mtext><mo stretchy=\"false\">)</mo></mrow><mrow><mi>c</mi><mi>o</mi><mi>u</mi><mi>n</mi><mi>t</mi><mo stretchy=\"false\">(</mo><mtext>åˆ¤æ–­ï¼Œè¿™ä¸ªï¼Œè¯ï¼Œçš„</mtext><mo stretchy=\"false\">)</mo></mrow></mfrac><mspace width=\"1em\"/><mtext>å…¬å¼(2)</mtext></mrow><annotation encoding=\"application/x-tex\">P(w_{next}|åˆ¤æ–­ï¼Œè¿™ä¸ªï¼Œè¯ï¼Œçš„) = \\frac{count(w_{next}ï¼Œåˆ¤æ–­ï¼Œè¿™ä¸ªï¼Œè¯ï¼Œçš„)}{count(åˆ¤æ–­ï¼Œè¿™ä¸ªï¼Œè¯ï¼Œçš„)} \\quad\\text{å…¬å¼(2)}\n</annotation></semantics></math></span><span class=\"katex-html\" aria-hidden=\"true\"><span class=\"base\"><span class=\"strut\" style=\"height:1em;vertical-align:-0.25em;\"></span><span class=\"mord mathnormal\" style=\"margin-right:0.13889em;\">P</span><span class=\"mopen\">(</span><span class=\"mord\"><span class=\"mord mathnormal\" style=\"margin-right:0.02691em;\">w</span><span class=\"msupsub\"><span class=\"vlist-t vlist-t2\"><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.2805559999999999em;\"><span style=\"top:-2.5500000000000003em;margin-left:-0.02691em;margin-right:0.05em;\"><span class=\"pstrut\" style=\"height:2.7em;\"></span><span class=\"sizing reset-size6 size3 mtight\"><span class=\"mord mtight\"><span class=\"mord mathnormal mtight\">n</span><span class=\"mord mathnormal mtight\">e</span><span class=\"mord mathnormal mtight\">x</span><span class=\"mord mathnormal mtight\">t</span></span></span></span></span><span class=\"vlist-s\">â€‹</span></span><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.15em;\"><span></span></span></span></span></span></span><span class=\"mord\">âˆ£</span><span class=\"mord cjk_fallback\">åˆ¤</span><span class=\"mord cjk_fallback\">æ–­</span><span class=\"mord cjk_fallback\">ï¼Œ</span><span class=\"mord cjk_fallback\">è¿™</span><span class=\"mord cjk_fallback\">ä¸ª</span><span class=\"mord cjk_fallback\">ï¼Œ</span><span class=\"mord cjk_fallback\">è¯</span><span class=\"mord cjk_fallback\">ï¼Œ</span><span class=\"mord cjk_fallback\">çš„</span><span class=\"mclose\">)</span><span class=\"mspace\" style=\"margin-right:0.2777777777777778em;\"></span><span class=\"mrel\">=</span><span class=\"mspace\" style=\"margin-right:0.2777777777777778em;\"></span></span><span class=\"base\"><span class=\"strut\" style=\"height:2.363em;vertical-align:-0.936em;\"></span><span class=\"mord\"><span class=\"mopen nulldelimiter\"></span><span class=\"mfrac\"><span class=\"vlist-t vlist-t2\"><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:1.427em;\"><span style=\"top:-2.314em;\"><span class=\"pstrut\" style=\"height:3em;\"></span><span class=\"mord\"><span class=\"mord mathnormal\">c</span><span class=\"mord mathnormal\">o</span><span class=\"mord mathnormal\">u</span><span class=\"mord mathnormal\">n</span><span class=\"mord mathnormal\">t</span><span class=\"mopen\">(</span><span class=\"mord cjk_fallback\">åˆ¤</span><span class=\"mord cjk_fallback\">æ–­</span><span class=\"mord cjk_fallback\">ï¼Œ</span><span class=\"mord cjk_fallback\">è¿™</span><span class=\"mord cjk_fallback\">ä¸ª</span><span class=\"mord cjk_fallback\">ï¼Œ</span><span class=\"mord cjk_fallback\">è¯</span><span class=\"mord cjk_fallback\">ï¼Œ</span><span class=\"mord cjk_fallback\">çš„</span><span class=\"mclose\">)</span></span></span><span style=\"top:-3.23em;\"><span class=\"pstrut\" style=\"height:3em;\"></span><span class=\"frac-line\" style=\"border-bottom-width:0.04em;\"></span></span><span style=\"top:-3.677em;\"><span class=\"pstrut\" style=\"height:3em;\"></span><span class=\"mord\"><span class=\"mord mathnormal\">c</span><span class=\"mord mathnormal\">o</span><span class=\"mord mathnormal\">u</span><span class=\"mord mathnormal\">n</span><span class=\"mord mathnormal\">t</span><span class=\"mopen\">(</span><span class=\"mord\"><span class=\"mord mathnormal\" style=\"margin-right:0.02691em;\">w</span><span class=\"msupsub\"><span class=\"vlist-t vlist-t2\"><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.2805559999999999em;\"><span style=\"top:-2.5500000000000003em;margin-left:-0.02691em;margin-right:0.05em;\"><span class=\"pstrut\" style=\"height:2.7em;\"></span><span class=\"sizing reset-size6 size3 mtight\"><span class=\"mord mtight\"><span class=\"mord mathnormal mtight\">n</span><span class=\"mord mathnormal mtight\">e</span><span class=\"mord mathnormal mtight\">x</span><span class=\"mord mathnormal mtight\">t</span></span></span></span></span><span class=\"vlist-s\">â€‹</span></span><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.15em;\"><span></span></span></span></span></span></span><span class=\"mord cjk_fallback\">ï¼Œ</span><span class=\"mord cjk_fallback\">åˆ¤</span><span class=\"mord cjk_fallback\">æ–­</span><span class=\"mord cjk_fallback\">ï¼Œ</span><span class=\"mord cjk_fallback\">è¿™</span><span class=\"mord cjk_fallback\">ä¸ª</span><span class=\"mord cjk_fallback\">ï¼Œ</span><span class=\"mord cjk_fallback\">è¯</span><span class=\"mord cjk_fallback\">ï¼Œ</span><span class=\"mord cjk_fallback\">çš„</span><span class=\"mclose\">)</span></span></span></span><span class=\"vlist-s\">â€‹</span></span><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.936em;\"><span></span></span></span></span></span><span class=\"mclose nulldelimiter\"></span></span><span class=\"mspace\" style=\"margin-right:1em;\"></span><span class=\"mord text\"><span class=\"mord cjk_fallback\">å…¬å¼</span><span class=\"mord\">(2)</span></span></span></span></span></span></p>\n<p>å¯¹äºå…¬å¼ï¼ˆ2ï¼‰ï¼Œå¯ä»¥æŠŠå­—å…¸ <span class=\"katex\"><span class=\"katex-mathml\"><math xmlns=\"http://www.w3.org/1998/Math/MathML\"><semantics><mrow><mi>V</mi></mrow><annotation encoding=\"application/x-tex\">V</annotation></semantics></math></span><span class=\"katex-html\" aria-hidden=\"true\"><span class=\"base\"><span class=\"strut\" style=\"height:0.68333em;vertical-align:0em;\"></span><span class=\"mord mathnormal\" style=\"margin-right:0.22222em;\">V</span></span></span></span> ä¸­çš„å¤šæœ‰å•è¯ï¼Œé€ä¸€ä½œä¸º <span class=\"katex\"><span class=\"katex-mathml\"><math xmlns=\"http://www.w3.org/1998/Math/MathML\"><semantics><mrow><msub><mi>w</mi><mrow><mi>n</mi><mi>e</mi><mi>x</mi><mi>t</mi></mrow></msub></mrow><annotation encoding=\"application/x-tex\">w_{next}</annotation></semantics></math></span><span class=\"katex-html\" aria-hidden=\"true\"><span class=\"base\"><span class=\"strut\" style=\"height:0.58056em;vertical-align:-0.15em;\"></span><span class=\"mord\"><span class=\"mord mathnormal\" style=\"margin-right:0.02691em;\">w</span><span class=\"msupsub\"><span class=\"vlist-t vlist-t2\"><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.2805559999999999em;\"><span style=\"top:-2.5500000000000003em;margin-left:-0.02691em;margin-right:0.05em;\"><span class=\"pstrut\" style=\"height:2.7em;\"></span><span class=\"sizing reset-size6 size3 mtight\"><span class=\"mord mtight\"><span class=\"mord mathnormal mtight\">n</span><span class=\"mord mathnormal mtight\">e</span><span class=\"mord mathnormal mtight\">x</span><span class=\"mord mathnormal mtight\">t</span></span></span></span></span><span class=\"vlist-s\">â€‹</span></span><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.15em;\"><span></span></span></span></span></span></span></span></span></span>ï¼Œå¸¦å…¥è®¡ç®—ï¼Œæœ€åå–æœ€å¤§æ¦‚ç‡çš„è¯ä½œä¸º <span class=\"katex\"><span class=\"katex-mathml\"><math xmlns=\"http://www.w3.org/1998/Math/MathML\"><semantics><mrow><msub><mi>w</mi><mrow><mi>n</mi><mi>e</mi><mi>x</mi><mi>t</mi></mrow></msub></mrow><annotation encoding=\"application/x-tex\">w_{next}</annotation></semantics></math></span><span class=\"katex-html\" aria-hidden=\"true\"><span class=\"base\"><span class=\"strut\" style=\"height:0.58056em;vertical-align:-0.15em;\"></span><span class=\"mord\"><span class=\"mord mathnormal\" style=\"margin-right:0.02691em;\">w</span><span class=\"msupsub\"><span class=\"vlist-t vlist-t2\"><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.2805559999999999em;\"><span style=\"top:-2.5500000000000003em;margin-left:-0.02691em;margin-right:0.05em;\"><span class=\"pstrut\" style=\"height:2.7em;\"></span><span class=\"sizing reset-size6 size3 mtight\"><span class=\"mord mtight\"><span class=\"mord mathnormal mtight\">n</span><span class=\"mord mathnormal mtight\">e</span><span class=\"mord mathnormal mtight\">x</span><span class=\"mord mathnormal mtight\">t</span></span></span></span></span><span class=\"vlist-s\">â€‹</span></span><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.15em;\"><span></span></span></span></span></span></span></span></span></span> çš„å€™é€‰è¯ã€‚</p>\n<p>å¦‚æœ <span class=\"katex\"><span class=\"katex-mathml\"><math xmlns=\"http://www.w3.org/1998/Math/MathML\"><semantics><mrow><mi mathvariant=\"normal\">âˆ£</mi><mi>V</mi><mi mathvariant=\"normal\">âˆ£</mi></mrow><annotation encoding=\"application/x-tex\">|V|</annotation></semantics></math></span><span class=\"katex-html\" aria-hidden=\"true\"><span class=\"base\"><span class=\"strut\" style=\"height:1em;vertical-align:-0.25em;\"></span><span class=\"mord\">âˆ£</span><span class=\"mord mathnormal\" style=\"margin-right:0.22222em;\">V</span><span class=\"mord\">âˆ£</span></span></span></span> ç‰¹åˆ«å¤§ï¼Œå…¬å¼ï¼ˆ2ï¼‰çš„è®¡ç®—å°†ä¼šéå¸¸å›°éš¾ï¼Œä½†æ˜¯æˆ‘ä»¬å¯ä»¥å¼•å…¥é©¬å°”ç§‘å¤«é“¾çš„æ¦‚å¿µï¼ˆå½“ç„¶ï¼Œåœ¨è¿™é‡Œåªæ˜¯ç®€å•è®²è®²å¦‚ä½•åšï¼Œå…³äºé©¬å°”ç§‘å¤«é“¾çš„æ•°å­¦ç†è®ºçŸ¥è¯†å¯ä»¥è‡ªè¡ŒæŸ¥çœ‹å…¶ä»–å‚è€ƒèµ„æ–™ï¼‰ã€‚</p>\n<p>å‡è®¾å­—å…¸ <span class=\"katex\"><span class=\"katex-mathml\"><math xmlns=\"http://www.w3.org/1998/Math/MathML\"><semantics><mrow><mi>V</mi></mrow><annotation encoding=\"application/x-tex\">V</annotation></semantics></math></span><span class=\"katex-html\" aria-hidden=\"true\"><span class=\"base\"><span class=\"strut\" style=\"height:0.68333em;vertical-align:0em;\"></span><span class=\"mord mathnormal\" style=\"margin-right:0.22222em;\">V</span></span></span></span> ä¸­æœ‰ â€œç«æ˜Ÿâ€ ä¸€è¯ï¼Œå¯ä»¥æ˜æ˜¾å‘ç° â€œç«æ˜Ÿâ€ ä¸å¯èƒ½å‡ºç°åœ¨ â€œåˆ¤æ–­è¿™ä¸ªè¯çš„â€ åé¢ï¼Œå› æ­¤ï¼ˆç«æ˜Ÿï¼Œåˆ¤æ–­ï¼Œè¿™ä¸ªï¼Œè¯ï¼Œçš„ï¼‰è¿™ä¸ªç»„åˆæ˜¯ä¸å­˜åœ¨çš„ï¼Œå¹¶ä¸”è¯å…¸ä¸­ä¼šå­˜åœ¨å¾ˆå¤šç±»ä¼¼äº â€œç«æ˜Ÿâ€ è¿™æ ·çš„è¯ã€‚</p>\n<p>è¿›ä¸€æ­¥ï¼Œå¯ä»¥å‘ç°æˆ‘ä»¬æŠŠï¼ˆç«æ˜Ÿï¼Œåˆ¤æ–­ï¼Œè¿™ä¸ªï¼Œè¯ï¼Œçš„ï¼‰è¿™ä¸ªç»„åˆåˆ¤æ–­ä¸ºä¸å­˜åœ¨ï¼Œæ˜¯å› ä¸º â€œç«æ˜Ÿâ€ ä¸å¯èƒ½å‡ºç°åœ¨ â€œè¯çš„â€ åé¢ï¼Œä¹Ÿå°±æ˜¯è¯´æˆ‘ä»¬å¯ä»¥è€ƒè™‘æ˜¯å¦æŠŠå…¬å¼ï¼ˆ1ï¼‰è½¬åŒ–ä¸º</p>\n<p><span class=\"katex-display\"><span class=\"katex\"><span class=\"katex-mathml\"><math xmlns=\"http://www.w3.org/1998/Math/MathML\" display=\"block\"><semantics><mrow><mi>P</mi><mo stretchy=\"false\">(</mo><msub><mi>w</mi><mrow><mi>n</mi><mi>e</mi><mi>x</mi><mi>t</mi></mrow></msub><mi mathvariant=\"normal\">âˆ£</mi><mtext>åˆ¤æ–­ï¼Œè¿™ä¸ªï¼Œè¯ï¼Œçš„</mtext><mo stretchy=\"false\">)</mo><mo>â‰ˆ</mo><mi>P</mi><mo stretchy=\"false\">(</mo><msub><mi>w</mi><mrow><mi>n</mi><mi>e</mi><mi>x</mi><mi>t</mi></mrow></msub><mi mathvariant=\"normal\">âˆ£</mi><mtext>è¯ï¼Œçš„</mtext><mo stretchy=\"false\">)</mo><mspace width=\"1em\"/><mtext>å…¬å¼(3)</mtext></mrow><annotation encoding=\"application/x-tex\">P(w_{next}|åˆ¤æ–­ï¼Œè¿™ä¸ªï¼Œè¯ï¼Œçš„) \\approx P(w_{next}|è¯ï¼Œçš„)\\quad\\text{å…¬å¼(3)}\n</annotation></semantics></math></span><span class=\"katex-html\" aria-hidden=\"true\"><span class=\"base\"><span class=\"strut\" style=\"height:1em;vertical-align:-0.25em;\"></span><span class=\"mord mathnormal\" style=\"margin-right:0.13889em;\">P</span><span class=\"mopen\">(</span><span class=\"mord\"><span class=\"mord mathnormal\" style=\"margin-right:0.02691em;\">w</span><span class=\"msupsub\"><span class=\"vlist-t vlist-t2\"><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.2805559999999999em;\"><span style=\"top:-2.5500000000000003em;margin-left:-0.02691em;margin-right:0.05em;\"><span class=\"pstrut\" style=\"height:2.7em;\"></span><span class=\"sizing reset-size6 size3 mtight\"><span class=\"mord mtight\"><span class=\"mord mathnormal mtight\">n</span><span class=\"mord mathnormal mtight\">e</span><span class=\"mord mathnormal mtight\">x</span><span class=\"mord mathnormal mtight\">t</span></span></span></span></span><span class=\"vlist-s\">â€‹</span></span><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.15em;\"><span></span></span></span></span></span></span><span class=\"mord\">âˆ£</span><span class=\"mord cjk_fallback\">åˆ¤</span><span class=\"mord cjk_fallback\">æ–­</span><span class=\"mord cjk_fallback\">ï¼Œ</span><span class=\"mord cjk_fallback\">è¿™</span><span class=\"mord cjk_fallback\">ä¸ª</span><span class=\"mord cjk_fallback\">ï¼Œ</span><span class=\"mord cjk_fallback\">è¯</span><span class=\"mord cjk_fallback\">ï¼Œ</span><span class=\"mord cjk_fallback\">çš„</span><span class=\"mclose\">)</span><span class=\"mspace\" style=\"margin-right:0.2777777777777778em;\"></span><span class=\"mrel\">â‰ˆ</span><span class=\"mspace\" style=\"margin-right:0.2777777777777778em;\"></span></span><span class=\"base\"><span class=\"strut\" style=\"height:1em;vertical-align:-0.25em;\"></span><span class=\"mord mathnormal\" style=\"margin-right:0.13889em;\">P</span><span class=\"mopen\">(</span><span class=\"mord\"><span class=\"mord mathnormal\" style=\"margin-right:0.02691em;\">w</span><span class=\"msupsub\"><span class=\"vlist-t vlist-t2\"><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.2805559999999999em;\"><span style=\"top:-2.5500000000000003em;margin-left:-0.02691em;margin-right:0.05em;\"><span class=\"pstrut\" style=\"height:2.7em;\"></span><span class=\"sizing reset-size6 size3 mtight\"><span class=\"mord mtight\"><span class=\"mord mathnormal mtight\">n</span><span class=\"mord mathnormal mtight\">e</span><span class=\"mord mathnormal mtight\">x</span><span class=\"mord mathnormal mtight\">t</span></span></span></span></span><span class=\"vlist-s\">â€‹</span></span><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.15em;\"><span></span></span></span></span></span></span><span class=\"mord\">âˆ£</span><span class=\"mord cjk_fallback\">è¯</span><span class=\"mord cjk_fallback\">ï¼Œ</span><span class=\"mord cjk_fallback\">çš„</span><span class=\"mclose\">)</span><span class=\"mspace\" style=\"margin-right:1em;\"></span><span class=\"mord text\"><span class=\"mord cjk_fallback\">å…¬å¼</span><span class=\"mord\">(3)</span></span></span></span></span></span></p>\n<p>å…¬å¼ï¼ˆ3ï¼‰å°±æ˜¯é©¬å°”ç§‘å¤«é“¾çš„æ€æƒ³ï¼šå‡è®¾ <span class=\"katex\"><span class=\"katex-mathml\"><math xmlns=\"http://www.w3.org/1998/Math/MathML\"><semantics><mrow><msub><mi>w</mi><mrow><mi>n</mi><mi>e</mi><mi>x</mi><mi>t</mi></mrow></msub></mrow><annotation encoding=\"application/x-tex\">w_{next}</annotation></semantics></math></span><span class=\"katex-html\" aria-hidden=\"true\"><span class=\"base\"><span class=\"strut\" style=\"height:0.58056em;vertical-align:-0.15em;\"></span><span class=\"mord\"><span class=\"mord mathnormal\" style=\"margin-right:0.02691em;\">w</span><span class=\"msupsub\"><span class=\"vlist-t vlist-t2\"><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.2805559999999999em;\"><span style=\"top:-2.5500000000000003em;margin-left:-0.02691em;margin-right:0.05em;\"><span class=\"pstrut\" style=\"height:2.7em;\"></span><span class=\"sizing reset-size6 size3 mtight\"><span class=\"mord mtight\"><span class=\"mord mathnormal mtight\">n</span><span class=\"mord mathnormal mtight\">e</span><span class=\"mord mathnormal mtight\">x</span><span class=\"mord mathnormal mtight\">t</span></span></span></span></span><span class=\"vlist-s\">â€‹</span></span><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.15em;\"><span></span></span></span></span></span></span></span></span></span> åªå’Œå®ƒä¹‹å‰çš„ <strong><span class=\"katex\"><span class=\"katex-mathml\"><math xmlns=\"http://www.w3.org/1998/Math/MathML\"><semantics><mrow><mi>k</mi></mrow><annotation encoding=\"application/x-tex\">k</annotation></semantics></math></span><span class=\"katex-html\" aria-hidden=\"true\"><span class=\"base\"><span class=\"strut\" style=\"height:0.69444em;vertical-align:0em;\"></span><span class=\"mord mathnormal\" style=\"margin-right:0.03148em;\">k</span></span></span></span> ä¸ªè¯æœ‰ç›¸å…³æ€§</strong>ï¼Œ<span class=\"katex\"><span class=\"katex-mathml\"><math xmlns=\"http://www.w3.org/1998/Math/MathML\"><semantics><mrow><mi>k</mi><mo>=</mo><mn>1</mn></mrow><annotation encoding=\"application/x-tex\">k=1</annotation></semantics></math></span><span class=\"katex-html\" aria-hidden=\"true\"><span class=\"base\"><span class=\"strut\" style=\"height:0.69444em;vertical-align:0em;\"></span><span class=\"mord mathnormal\" style=\"margin-right:0.03148em;\">k</span><span class=\"mspace\" style=\"margin-right:0.2777777777777778em;\"></span><span class=\"mrel\">=</span><span class=\"mspace\" style=\"margin-right:0.2777777777777778em;\"></span></span><span class=\"base\"><span class=\"strut\" style=\"height:0.64444em;vertical-align:0em;\"></span><span class=\"mord\">1</span></span></span></span> æ—¶ç§°ä½œä¸€ä¸ªå•å…ƒè¯­è¨€æ¨¡å‹ï¼Œ<span class=\"katex\"><span class=\"katex-mathml\"><math xmlns=\"http://www.w3.org/1998/Math/MathML\"><semantics><mrow><mi>k</mi><mo>=</mo><mn>2</mn></mrow><annotation encoding=\"application/x-tex\">k=2</annotation></semantics></math></span><span class=\"katex-html\" aria-hidden=\"true\"><span class=\"base\"><span class=\"strut\" style=\"height:0.69444em;vertical-align:0em;\"></span><span class=\"mord mathnormal\" style=\"margin-right:0.03148em;\">k</span><span class=\"mspace\" style=\"margin-right:0.2777777777777778em;\"></span><span class=\"mrel\">=</span><span class=\"mspace\" style=\"margin-right:0.2777777777777778em;\"></span></span><span class=\"base\"><span class=\"strut\" style=\"height:0.64444em;vertical-align:0em;\"></span><span class=\"mord\">2</span></span></span></span> æ—¶ç§°ä¸ºäºŒå…ƒè¯­è¨€æ¨¡å‹ã€‚</p>\n<p>å¯ä»¥å‘ç°é€šè¿‡é©¬å°”ç§‘å¤«é“¾åæ”¹å†™çš„å…¬å¼è®¡ç®—èµ·æ¥å°†ä¼šç®€å•å¾ˆå¤šï¼Œä¸‹é¢æˆ‘ä»¬ä¸¾ä¸ªç®€å•çš„ä¾‹å­ä»‹ç»ä¸‹å¦‚ä½•è®¡ç®—ä¸€ä¸ªäºŒå…ƒè¯­è¨€æ¨¡å‹çš„æ¦‚ç‡ã€‚</p>\n<p>å…¶ä¸­äºŒå…ƒè¯­è¨€æ¨¡å‹çš„å…¬å¼ä¸ºï¼š</p>\n<p><span class=\"katex-display\"><span class=\"katex\"><span class=\"katex-mathml\"><math xmlns=\"http://www.w3.org/1998/Math/MathML\" display=\"block\"><semantics><mrow><mi>P</mi><mo stretchy=\"false\">(</mo><msub><mi>w</mi><mi>i</mi></msub><mi mathvariant=\"normal\">âˆ£</mi><msub><mi>w</mi><mrow><mi>i</mi><mo>âˆ’</mo><mn>1</mn></mrow></msub><mo stretchy=\"false\">)</mo><mo>=</mo><mfrac><mrow><mi>c</mi><mi>o</mi><mi>u</mi><mi>n</mi><mi>t</mi><mo stretchy=\"false\">(</mo><msub><mi>w</mi><mrow><mi>i</mi><mo>âˆ’</mo><mn>1</mn></mrow></msub><mo separator=\"true\">,</mo><msub><mi>w</mi><mi>i</mi></msub><mo stretchy=\"false\">)</mo></mrow><mrow><mi>c</mi><mi>o</mi><mi>u</mi><mi>n</mi><mi>t</mi><mo stretchy=\"false\">(</mo><msub><mi>w</mi><mrow><mi>i</mi><mo>âˆ’</mo><mn>1</mn></mrow></msub><mo stretchy=\"false\">)</mo></mrow></mfrac><mspace width=\"1em\"/><mtext>å…¬å¼(4)</mtext></mrow><annotation encoding=\"application/x-tex\">P(w_i|w_{i-1})=\\frac{count(w_{i-1},w_i)}{count(w_{i-1})}\\quad\\text{å…¬å¼(4)}\n</annotation></semantics></math></span><span class=\"katex-html\" aria-hidden=\"true\"><span class=\"base\"><span class=\"strut\" style=\"height:1em;vertical-align:-0.25em;\"></span><span class=\"mord mathnormal\" style=\"margin-right:0.13889em;\">P</span><span class=\"mopen\">(</span><span class=\"mord\"><span class=\"mord mathnormal\" style=\"margin-right:0.02691em;\">w</span><span class=\"msupsub\"><span class=\"vlist-t vlist-t2\"><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.31166399999999994em;\"><span style=\"top:-2.5500000000000003em;margin-left:-0.02691em;margin-right:0.05em;\"><span class=\"pstrut\" style=\"height:2.7em;\"></span><span class=\"sizing reset-size6 size3 mtight\"><span class=\"mord mathnormal mtight\">i</span></span></span></span><span class=\"vlist-s\">â€‹</span></span><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.15em;\"><span></span></span></span></span></span></span><span class=\"mord\">âˆ£</span><span class=\"mord\"><span class=\"mord mathnormal\" style=\"margin-right:0.02691em;\">w</span><span class=\"msupsub\"><span class=\"vlist-t vlist-t2\"><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.311664em;\"><span style=\"top:-2.5500000000000003em;margin-left:-0.02691em;margin-right:0.05em;\"><span class=\"pstrut\" style=\"height:2.7em;\"></span><span class=\"sizing reset-size6 size3 mtight\"><span class=\"mord mtight\"><span class=\"mord mathnormal mtight\">i</span><span class=\"mbin mtight\">âˆ’</span><span class=\"mord mtight\">1</span></span></span></span></span><span class=\"vlist-s\">â€‹</span></span><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.208331em;\"><span></span></span></span></span></span></span><span class=\"mclose\">)</span><span class=\"mspace\" style=\"margin-right:0.2777777777777778em;\"></span><span class=\"mrel\">=</span><span class=\"mspace\" style=\"margin-right:0.2777777777777778em;\"></span></span><span class=\"base\"><span class=\"strut\" style=\"height:2.363em;vertical-align:-0.936em;\"></span><span class=\"mord\"><span class=\"mopen nulldelimiter\"></span><span class=\"mfrac\"><span class=\"vlist-t vlist-t2\"><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:1.427em;\"><span style=\"top:-2.314em;\"><span class=\"pstrut\" style=\"height:3em;\"></span><span class=\"mord\"><span class=\"mord mathnormal\">c</span><span class=\"mord mathnormal\">o</span><span class=\"mord mathnormal\">u</span><span class=\"mord mathnormal\">n</span><span class=\"mord mathnormal\">t</span><span class=\"mopen\">(</span><span class=\"mord\"><span class=\"mord mathnormal\" style=\"margin-right:0.02691em;\">w</span><span class=\"msupsub\"><span class=\"vlist-t vlist-t2\"><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.311664em;\"><span style=\"top:-2.5500000000000003em;margin-left:-0.02691em;margin-right:0.05em;\"><span class=\"pstrut\" style=\"height:2.7em;\"></span><span class=\"sizing reset-size6 size3 mtight\"><span class=\"mord mtight\"><span class=\"mord mathnormal mtight\">i</span><span class=\"mbin mtight\">âˆ’</span><span class=\"mord mtight\">1</span></span></span></span></span><span class=\"vlist-s\">â€‹</span></span><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.208331em;\"><span></span></span></span></span></span></span><span class=\"mclose\">)</span></span></span><span style=\"top:-3.23em;\"><span class=\"pstrut\" style=\"height:3em;\"></span><span class=\"frac-line\" style=\"border-bottom-width:0.04em;\"></span></span><span style=\"top:-3.677em;\"><span class=\"pstrut\" style=\"height:3em;\"></span><span class=\"mord\"><span class=\"mord mathnormal\">c</span><span class=\"mord mathnormal\">o</span><span class=\"mord mathnormal\">u</span><span class=\"mord mathnormal\">n</span><span class=\"mord mathnormal\">t</span><span class=\"mopen\">(</span><span class=\"mord\"><span class=\"mord mathnormal\" style=\"margin-right:0.02691em;\">w</span><span class=\"msupsub\"><span class=\"vlist-t vlist-t2\"><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.311664em;\"><span style=\"top:-2.5500000000000003em;margin-left:-0.02691em;margin-right:0.05em;\"><span class=\"pstrut\" style=\"height:2.7em;\"></span><span class=\"sizing reset-size6 size3 mtight\"><span class=\"mord mtight\"><span class=\"mord mathnormal mtight\">i</span><span class=\"mbin mtight\">âˆ’</span><span class=\"mord mtight\">1</span></span></span></span></span><span class=\"vlist-s\">â€‹</span></span><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.208331em;\"><span></span></span></span></span></span></span><span class=\"mpunct\">,</span><span class=\"mspace\" style=\"margin-right:0.16666666666666666em;\"></span><span class=\"mord\"><span class=\"mord mathnormal\" style=\"margin-right:0.02691em;\">w</span><span class=\"msupsub\"><span class=\"vlist-t vlist-t2\"><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.31166399999999994em;\"><span style=\"top:-2.5500000000000003em;margin-left:-0.02691em;margin-right:0.05em;\"><span class=\"pstrut\" style=\"height:2.7em;\"></span><span class=\"sizing reset-size6 size3 mtight\"><span class=\"mord mathnormal mtight\">i</span></span></span></span><span class=\"vlist-s\">â€‹</span></span><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.15em;\"><span></span></span></span></span></span></span><span class=\"mclose\">)</span></span></span></span><span class=\"vlist-s\">â€‹</span></span><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.936em;\"><span></span></span></span></span></span><span class=\"mclose nulldelimiter\"></span></span><span class=\"mspace\" style=\"margin-right:1em;\"></span><span class=\"mord text\"><span class=\"mord cjk_fallback\">å…¬å¼</span><span class=\"mord\">(4)</span></span></span></span></span></span></p>\n<p>å‡è®¾æœ‰ä¸€ä¸ªæ–‡æœ¬é›†åˆï¼š</p>\n<figure class=\"highlight basic\"><figcaption data-lang=\"BASIC\"></figcaption><table><tr><td data-num=\"1\"></td><td><pre>â€œè¯æ€§æ˜¯åŠ¨è¯â€</pre></td></tr><tr><td data-num=\"2\"></td><td><pre>â€œåˆ¤æ–­å•è¯çš„è¯æ€§â€</pre></td></tr><tr><td data-num=\"3\"></td><td><pre>â€œç£æ€§å¾ˆå¼ºçš„ç£é“â€</pre></td></tr><tr><td data-num=\"4\"></td><td><pre>â€œåŒ—äº¬çš„è¯æ€§æ˜¯åè¯â€</pre></td></tr></table></figure><p>å¯¹äºä¸Šè¿°æ–‡æœ¬ï¼Œå¦‚æœè¦è®¡ç®— <span class=\"katex\"><span class=\"katex-mathml\"><math xmlns=\"http://www.w3.org/1998/Math/MathML\"><semantics><mrow><mi>P</mi><mo stretchy=\"false\">(</mo><mtext>è¯æ€§</mtext><mi mathvariant=\"normal\">âˆ£</mi><mtext>çš„</mtext><mo stretchy=\"false\">)</mo></mrow><annotation encoding=\"application/x-tex\">P(è¯æ€§|çš„)</annotation></semantics></math></span><span class=\"katex-html\" aria-hidden=\"true\"><span class=\"base\"><span class=\"strut\" style=\"height:1em;vertical-align:-0.25em;\"></span><span class=\"mord mathnormal\" style=\"margin-right:0.13889em;\">P</span><span class=\"mopen\">(</span><span class=\"mord cjk_fallback\">è¯</span><span class=\"mord cjk_fallback\">æ€§</span><span class=\"mord\">âˆ£</span><span class=\"mord cjk_fallback\">çš„</span><span class=\"mclose\">)</span></span></span></span> çš„æ¦‚ç‡ï¼Œé€šè¿‡å…¬å¼ï¼ˆ4ï¼‰ï¼Œéœ€è¦ç»Ÿè®¡ â€œçš„ï¼Œè¯æ€§â€ åŒæ—¶æŒ‰åºå‡ºç°çš„æ¬¡æ•°ï¼Œå†é™¤ä»¥ â€œçš„â€ å‡ºç°çš„æ¬¡æ•°ï¼š</p>\n<p><span class=\"katex-display\"><span class=\"katex\"><span class=\"katex-mathml\"><math xmlns=\"http://www.w3.org/1998/Math/MathML\" display=\"block\"><semantics><mrow><mi>P</mi><mo stretchy=\"false\">(</mo><mtext>è¯æ€§</mtext><mi mathvariant=\"normal\">âˆ£</mi><mtext>çš„</mtext><mo stretchy=\"false\">)</mo><mo>=</mo><mfrac><mrow><mi>c</mi><mi>o</mi><mi>u</mi><mi>n</mi><mi>t</mi><mo stretchy=\"false\">(</mo><mtext>çš„ï¼Œè¯æ€§</mtext><mo stretchy=\"false\">)</mo></mrow><mrow><mi>c</mi><mi>o</mi><mi>u</mi><mi>n</mi><mi>t</mi><mo stretchy=\"false\">(</mo><mtext>çš„</mtext><mo stretchy=\"false\">)</mo></mrow></mfrac><mo>=</mo><mfrac><mn>2</mn><mn>3</mn></mfrac><mspace width=\"1em\"/><mtext>å…¬å¼(5)</mtext></mrow><annotation encoding=\"application/x-tex\">P(è¯æ€§|çš„) = \\frac{count(çš„ï¼Œè¯æ€§)}{count(çš„)} = \\frac{2}{3}\\quad\\text{å…¬å¼(5)}\n</annotation></semantics></math></span><span class=\"katex-html\" aria-hidden=\"true\"><span class=\"base\"><span class=\"strut\" style=\"height:1em;vertical-align:-0.25em;\"></span><span class=\"mord mathnormal\" style=\"margin-right:0.13889em;\">P</span><span class=\"mopen\">(</span><span class=\"mord cjk_fallback\">è¯</span><span class=\"mord cjk_fallback\">æ€§</span><span class=\"mord\">âˆ£</span><span class=\"mord cjk_fallback\">çš„</span><span class=\"mclose\">)</span><span class=\"mspace\" style=\"margin-right:0.2777777777777778em;\"></span><span class=\"mrel\">=</span><span class=\"mspace\" style=\"margin-right:0.2777777777777778em;\"></span></span><span class=\"base\"><span class=\"strut\" style=\"height:2.363em;vertical-align:-0.936em;\"></span><span class=\"mord\"><span class=\"mopen nulldelimiter\"></span><span class=\"mfrac\"><span class=\"vlist-t vlist-t2\"><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:1.427em;\"><span style=\"top:-2.314em;\"><span class=\"pstrut\" style=\"height:3em;\"></span><span class=\"mord\"><span class=\"mord mathnormal\">c</span><span class=\"mord mathnormal\">o</span><span class=\"mord mathnormal\">u</span><span class=\"mord mathnormal\">n</span><span class=\"mord mathnormal\">t</span><span class=\"mopen\">(</span><span class=\"mord cjk_fallback\">çš„</span><span class=\"mclose\">)</span></span></span><span style=\"top:-3.23em;\"><span class=\"pstrut\" style=\"height:3em;\"></span><span class=\"frac-line\" style=\"border-bottom-width:0.04em;\"></span></span><span style=\"top:-3.677em;\"><span class=\"pstrut\" style=\"height:3em;\"></span><span class=\"mord\"><span class=\"mord mathnormal\">c</span><span class=\"mord mathnormal\">o</span><span class=\"mord mathnormal\">u</span><span class=\"mord mathnormal\">n</span><span class=\"mord mathnormal\">t</span><span class=\"mopen\">(</span><span class=\"mord cjk_fallback\">çš„</span><span class=\"mord cjk_fallback\">ï¼Œ</span><span class=\"mord cjk_fallback\">è¯</span><span class=\"mord cjk_fallback\">æ€§</span><span class=\"mclose\">)</span></span></span></span><span class=\"vlist-s\">â€‹</span></span><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.936em;\"><span></span></span></span></span></span><span class=\"mclose nulldelimiter\"></span></span><span class=\"mspace\" style=\"margin-right:0.2777777777777778em;\"></span><span class=\"mrel\">=</span><span class=\"mspace\" style=\"margin-right:0.2777777777777778em;\"></span></span><span class=\"base\"><span class=\"strut\" style=\"height:2.00744em;vertical-align:-0.686em;\"></span><span class=\"mord\"><span class=\"mopen nulldelimiter\"></span><span class=\"mfrac\"><span class=\"vlist-t vlist-t2\"><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:1.32144em;\"><span style=\"top:-2.314em;\"><span class=\"pstrut\" style=\"height:3em;\"></span><span class=\"mord\"><span class=\"mord\">3</span></span></span><span style=\"top:-3.23em;\"><span class=\"pstrut\" style=\"height:3em;\"></span><span class=\"frac-line\" style=\"border-bottom-width:0.04em;\"></span></span><span style=\"top:-3.677em;\"><span class=\"pstrut\" style=\"height:3em;\"></span><span class=\"mord\"><span class=\"mord\">2</span></span></span></span><span class=\"vlist-s\">â€‹</span></span><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.686em;\"><span></span></span></span></span></span><span class=\"mclose nulldelimiter\"></span></span><span class=\"mspace\" style=\"margin-right:1em;\"></span><span class=\"mord text\"><span class=\"mord cjk_fallback\">å…¬å¼</span><span class=\"mord\">(5)</span></span></span></span></span></span></p>\n<p>ä¸Šè¿°æ–‡æœ¬é›†åˆæ˜¯æˆ‘ä»¬è‡ªå®šåˆ¶çš„ï¼Œç„¶è€Œå¯¹äºç»å¤§å¤šæ•°å…·æœ‰ç°å®æ„ä¹‰çš„æ–‡æœ¬ï¼Œä¼šå‡ºç°æ•°æ®ç¨€ç–çš„æƒ…å†µï¼Œä¾‹å¦‚<strong>è®­ç»ƒæ—¶æœªå‡ºç°ï¼Œæµ‹è¯•æ—¶å‡ºç°äº†çš„æœªç™»å½•å•è¯</strong>ã€‚</p>\n<p>ç”±äºæ•°æ®ç¨€ç–é—®é¢˜ï¼Œåˆ™ä¼šå‡ºç°æ¦‚ç‡å€¼ä¸º 0 çš„æƒ…å†µï¼ˆå¡«ç©ºé¢˜å°†æ— æ³•ä»è¯å…¸ä¸­é€‰æ‹©ä¸€ä¸ªè¯å¡«å…¥ï¼‰ï¼Œä¸ºäº†é¿å… 0 å€¼çš„å‡ºç°ï¼Œä¼šä½¿ç”¨ä¸€ç§å¹³æ»‘çš„ç­–ç•¥ â€”â€” åˆ†å­å’Œåˆ†æ¯éƒ½åŠ å…¥ä¸€ä¸ªé 0 æ­£æ•°ï¼Œä¾‹å¦‚å¯ä»¥æŠŠå…¬å¼ï¼ˆ4ï¼‰æ”¹ä¸ºï¼š</p>\n<p><span class=\"katex-display\"><span class=\"katex\"><span class=\"katex-mathml\"><math xmlns=\"http://www.w3.org/1998/Math/MathML\" display=\"block\"><semantics><mrow><mi>P</mi><mo stretchy=\"false\">(</mo><msub><mi>w</mi><mi>i</mi></msub><mi mathvariant=\"normal\">âˆ£</mi><msub><mi>w</mi><mrow><mi>i</mi><mo>âˆ’</mo><mn>1</mn></mrow></msub><mo stretchy=\"false\">)</mo><mo>=</mo><mfrac><mrow><mi>c</mi><mi>o</mi><mi>u</mi><mi>n</mi><mi>t</mi><mo stretchy=\"false\">(</mo><msub><mi>w</mi><mrow><mi>i</mi><mo>âˆ’</mo><mn>1</mn></mrow></msub><mo separator=\"true\">,</mo><msub><mi>w</mi><mi>i</mi></msub><mo stretchy=\"false\">)</mo><mo>+</mo><mn>1</mn></mrow><mrow><mi>c</mi><mi>o</mi><mi>u</mi><mi>n</mi><mi>t</mi><mo stretchy=\"false\">(</mo><msub><mi>w</mi><mrow><mi>i</mi><mo>âˆ’</mo><mn>1</mn></mrow></msub><mo stretchy=\"false\">)</mo><mo>+</mo><mi mathvariant=\"normal\">âˆ£</mi><mi>V</mi><mi mathvariant=\"normal\">âˆ£</mi></mrow></mfrac><mspace width=\"1em\"/><mtext>å…¬å¼(6)</mtext></mrow><annotation encoding=\"application/x-tex\">P(w_i|w_{i-1}) = \\frac{count(w_{i-1},w_i)+1}{count(w_{i-1})+|V|}\\quad\\text{å…¬å¼(6)}\n</annotation></semantics></math></span><span class=\"katex-html\" aria-hidden=\"true\"><span class=\"base\"><span class=\"strut\" style=\"height:1em;vertical-align:-0.25em;\"></span><span class=\"mord mathnormal\" style=\"margin-right:0.13889em;\">P</span><span class=\"mopen\">(</span><span class=\"mord\"><span class=\"mord mathnormal\" style=\"margin-right:0.02691em;\">w</span><span class=\"msupsub\"><span class=\"vlist-t vlist-t2\"><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.31166399999999994em;\"><span style=\"top:-2.5500000000000003em;margin-left:-0.02691em;margin-right:0.05em;\"><span class=\"pstrut\" style=\"height:2.7em;\"></span><span class=\"sizing reset-size6 size3 mtight\"><span class=\"mord mathnormal mtight\">i</span></span></span></span><span class=\"vlist-s\">â€‹</span></span><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.15em;\"><span></span></span></span></span></span></span><span class=\"mord\">âˆ£</span><span class=\"mord\"><span class=\"mord mathnormal\" style=\"margin-right:0.02691em;\">w</span><span class=\"msupsub\"><span class=\"vlist-t vlist-t2\"><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.311664em;\"><span style=\"top:-2.5500000000000003em;margin-left:-0.02691em;margin-right:0.05em;\"><span class=\"pstrut\" style=\"height:2.7em;\"></span><span class=\"sizing reset-size6 size3 mtight\"><span class=\"mord mtight\"><span class=\"mord mathnormal mtight\">i</span><span class=\"mbin mtight\">âˆ’</span><span class=\"mord mtight\">1</span></span></span></span></span><span class=\"vlist-s\">â€‹</span></span><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.208331em;\"><span></span></span></span></span></span></span><span class=\"mclose\">)</span><span class=\"mspace\" style=\"margin-right:0.2777777777777778em;\"></span><span class=\"mrel\">=</span><span class=\"mspace\" style=\"margin-right:0.2777777777777778em;\"></span></span><span class=\"base\"><span class=\"strut\" style=\"height:2.363em;vertical-align:-0.936em;\"></span><span class=\"mord\"><span class=\"mopen nulldelimiter\"></span><span class=\"mfrac\"><span class=\"vlist-t vlist-t2\"><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:1.427em;\"><span style=\"top:-2.314em;\"><span class=\"pstrut\" style=\"height:3em;\"></span><span class=\"mord\"><span class=\"mord mathnormal\">c</span><span class=\"mord mathnormal\">o</span><span class=\"mord mathnormal\">u</span><span class=\"mord mathnormal\">n</span><span class=\"mord mathnormal\">t</span><span class=\"mopen\">(</span><span class=\"mord\"><span class=\"mord mathnormal\" style=\"margin-right:0.02691em;\">w</span><span class=\"msupsub\"><span class=\"vlist-t vlist-t2\"><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.311664em;\"><span style=\"top:-2.5500000000000003em;margin-left:-0.02691em;margin-right:0.05em;\"><span class=\"pstrut\" style=\"height:2.7em;\"></span><span class=\"sizing reset-size6 size3 mtight\"><span class=\"mord mtight\"><span class=\"mord mathnormal mtight\">i</span><span class=\"mbin mtight\">âˆ’</span><span class=\"mord mtight\">1</span></span></span></span></span><span class=\"vlist-s\">â€‹</span></span><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.208331em;\"><span></span></span></span></span></span></span><span class=\"mclose\">)</span><span class=\"mspace\" style=\"margin-right:0.2222222222222222em;\"></span><span class=\"mbin\">+</span><span class=\"mspace\" style=\"margin-right:0.2222222222222222em;\"></span><span class=\"mord\">âˆ£</span><span class=\"mord mathnormal\" style=\"margin-right:0.22222em;\">V</span><span class=\"mord\">âˆ£</span></span></span><span style=\"top:-3.23em;\"><span class=\"pstrut\" style=\"height:3em;\"></span><span class=\"frac-line\" style=\"border-bottom-width:0.04em;\"></span></span><span style=\"top:-3.677em;\"><span class=\"pstrut\" style=\"height:3em;\"></span><span class=\"mord\"><span class=\"mord mathnormal\">c</span><span class=\"mord mathnormal\">o</span><span class=\"mord mathnormal\">u</span><span class=\"mord mathnormal\">n</span><span class=\"mord mathnormal\">t</span><span class=\"mopen\">(</span><span class=\"mord\"><span class=\"mord mathnormal\" style=\"margin-right:0.02691em;\">w</span><span class=\"msupsub\"><span class=\"vlist-t vlist-t2\"><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.311664em;\"><span style=\"top:-2.5500000000000003em;margin-left:-0.02691em;margin-right:0.05em;\"><span class=\"pstrut\" style=\"height:2.7em;\"></span><span class=\"sizing reset-size6 size3 mtight\"><span class=\"mord mtight\"><span class=\"mord mathnormal mtight\">i</span><span class=\"mbin mtight\">âˆ’</span><span class=\"mord mtight\">1</span></span></span></span></span><span class=\"vlist-s\">â€‹</span></span><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.208331em;\"><span></span></span></span></span></span></span><span class=\"mpunct\">,</span><span class=\"mspace\" style=\"margin-right:0.16666666666666666em;\"></span><span class=\"mord\"><span class=\"mord mathnormal\" style=\"margin-right:0.02691em;\">w</span><span class=\"msupsub\"><span class=\"vlist-t vlist-t2\"><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.31166399999999994em;\"><span style=\"top:-2.5500000000000003em;margin-left:-0.02691em;margin-right:0.05em;\"><span class=\"pstrut\" style=\"height:2.7em;\"></span><span class=\"sizing reset-size6 size3 mtight\"><span class=\"mord mathnormal mtight\">i</span></span></span></span><span class=\"vlist-s\">â€‹</span></span><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.15em;\"><span></span></span></span></span></span></span><span class=\"mclose\">)</span><span class=\"mspace\" style=\"margin-right:0.2222222222222222em;\"></span><span class=\"mbin\">+</span><span class=\"mspace\" style=\"margin-right:0.2222222222222222em;\"></span><span class=\"mord\">1</span></span></span></span><span class=\"vlist-s\">â€‹</span></span><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.936em;\"><span></span></span></span></span></span><span class=\"mclose nulldelimiter\"></span></span><span class=\"mspace\" style=\"margin-right:1em;\"></span><span class=\"mord text\"><span class=\"mord cjk_fallback\">å…¬å¼</span><span class=\"mord\">(6)</span></span></span></span></span></span></p>\n<p>##2.2 ç¥ç»ç½‘ç»œè¯­è¨€æ¨¡å‹</p>\n<p>ä¸Šä¸€èŠ‚ç®€å•çš„ä»‹ç»äº†ç»Ÿè®¡è¯­è¨€æ¨¡å‹ï¼Œå¹¶ä¸”åœ¨ç»“å°¾å¤„è®²åˆ°ç»Ÿè®¡è¯­è¨€æ¨¡å‹å­˜åœ¨æ•°æ®ç¨€ç–é—®é¢˜ï¼Œé’ˆå¯¹è¯¥é—®é¢˜ï¼Œæˆ‘ä»¬ä¹Ÿæå‡ºäº†å¹³æ»‘æ–¹æ³•æ¥åº”å¯¹è¿™ä¸ªé—®é¢˜ã€‚</p>\n<p>ç¥ç»ç½‘ç»œè¯­è¨€æ¨¡å‹åˆ™å¼•å…¥ç¥ç»ç½‘ç»œæ¶æ„æ¥ä¼°è®¡å•è¯çš„åˆ†å¸ƒï¼Œ<strong>å¹¶ä¸”é€šè¿‡è¯å‘é‡çš„è·ç¦»è¡¡é‡å•è¯ä¹‹é—´çš„ç›¸ä¼¼åº¦ï¼Œå› æ­¤ï¼Œå¯¹äºæœªç™»å½•å•è¯ï¼Œä¹Ÿå¯ä»¥é€šè¿‡ç›¸ä¼¼è¯è¿›è¡Œä¼°è®¡ï¼Œè¿›è€Œé¿å…å‡ºç°æ•°æ®ç¨€ç–é—®é¢˜</strong>ã€‚</p>\n<p>&lt;img src=&quot;<span class=\"exturl\" data-url=\"aHR0cHM6Ly9pbWdtZC5vc3MtY24tc2hhbmdoYWkuYWxpeXVuY3MuY29tL0JFUlRfSU1HLyVFNyVBNSU5RSVFNyVCQiU4RiVFNyVCRCU5MSVFNyVCQiU5QyVFOCVBRiVBRCVFOCVBOCU4MCVFNiVBOCVBMSVFNSU5RSU4Qi5qcGc=\">https://imgmd.oss-cn-shanghai.aliyuncs.com/BERT_IMG/ ç¥ç»ç½‘ç»œè¯­è¨€æ¨¡å‹.jpg</span>&quot; style=&quot;zoom:50%;&quot; /&gt;</p>\n<p>ä¸Šå›¾ä¸ºç¥ç»ç½‘ç»œè¯­è¨€æ¨¡å‹ç»“æ„å›¾ï¼Œå®ƒçš„å­¦ä¹ ä»»åŠ¡æ˜¯è¾“å…¥æŸä¸ªå¥ä¸­å•è¯ <span class=\"katex\"><span class=\"katex-mathml\"><math xmlns=\"http://www.w3.org/1998/Math/MathML\"><semantics><mrow><msub><mi>w</mi><mi>t</mi></msub><mo>=</mo><mi>b</mi><mi>e</mi><mi>r</mi><mi>t</mi></mrow><annotation encoding=\"application/x-tex\">w_t = bert</annotation></semantics></math></span><span class=\"katex-html\" aria-hidden=\"true\"><span class=\"base\"><span class=\"strut\" style=\"height:0.58056em;vertical-align:-0.15em;\"></span><span class=\"mord\"><span class=\"mord mathnormal\" style=\"margin-right:0.02691em;\">w</span><span class=\"msupsub\"><span class=\"vlist-t vlist-t2\"><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.2805559999999999em;\"><span style=\"top:-2.5500000000000003em;margin-left:-0.02691em;margin-right:0.05em;\"><span class=\"pstrut\" style=\"height:2.7em;\"></span><span class=\"sizing reset-size6 size3 mtight\"><span class=\"mord mathnormal mtight\">t</span></span></span></span><span class=\"vlist-s\">â€‹</span></span><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.15em;\"><span></span></span></span></span></span></span><span class=\"mspace\" style=\"margin-right:0.2777777777777778em;\"></span><span class=\"mrel\">=</span><span class=\"mspace\" style=\"margin-right:0.2777777777777778em;\"></span></span><span class=\"base\"><span class=\"strut\" style=\"height:0.69444em;vertical-align:0em;\"></span><span class=\"mord mathnormal\">b</span><span class=\"mord mathnormal\">e</span><span class=\"mord mathnormal\" style=\"margin-right:0.02778em;\">r</span><span class=\"mord mathnormal\">t</span></span></span></span> å‰çš„ <span class=\"katex\"><span class=\"katex-mathml\"><math xmlns=\"http://www.w3.org/1998/Math/MathML\"><semantics><mrow><mi>t</mi><mo>âˆ’</mo><mn>1</mn></mrow><annotation encoding=\"application/x-tex\">t-1</annotation></semantics></math></span><span class=\"katex-html\" aria-hidden=\"true\"><span class=\"base\"><span class=\"strut\" style=\"height:0.69841em;vertical-align:-0.08333em;\"></span><span class=\"mord mathnormal\">t</span><span class=\"mspace\" style=\"margin-right:0.2222222222222222em;\"></span><span class=\"mbin\">âˆ’</span><span class=\"mspace\" style=\"margin-right:0.2222222222222222em;\"></span></span><span class=\"base\"><span class=\"strut\" style=\"height:0.64444em;vertical-align:0em;\"></span><span class=\"mord\">1</span></span></span></span> ä¸ªå•è¯ï¼Œè¦æ±‚ç½‘ç»œæ­£ç¡®é¢„æµ‹å•è¯ â€œbertâ€ï¼Œå³æœ€å¤§åŒ–ï¼š</p>\n<p><span class=\"katex-display\"><span class=\"katex\"><span class=\"katex-mathml\"><math xmlns=\"http://www.w3.org/1998/Math/MathML\" display=\"block\"><semantics><mrow><mi>P</mi><mo stretchy=\"false\">(</mo><msub><mi>w</mi><mi>t</mi></msub><mo>=</mo><mi>b</mi><mi>e</mi><mi>r</mi><mi>t</mi><mi mathvariant=\"normal\">âˆ£</mi><msub><mi>w</mi><mn>1</mn></msub><mo separator=\"true\">,</mo><msub><mi>w</mi><mn>2</mn></msub><mo separator=\"true\">,</mo><mo>â‹¯</mo><mtext>â€‰</mtext><mo separator=\"true\">,</mo><msub><mi>w</mi><mrow><mi>t</mi><mo>âˆ’</mo><mn>1</mn></mrow></msub><mo separator=\"true\">;</mo><mi>Î¸</mi><mo stretchy=\"false\">)</mo><mspace width=\"1em\"/><mtext>å…¬å¼(7)</mtext></mrow><annotation encoding=\"application/x-tex\">P(w_t=bert|w_1,w_2,\\cdots,w_{t-1};\\theta)\\quad\\text{å…¬å¼(7)}\n</annotation></semantics></math></span><span class=\"katex-html\" aria-hidden=\"true\"><span class=\"base\"><span class=\"strut\" style=\"height:1em;vertical-align:-0.25em;\"></span><span class=\"mord mathnormal\" style=\"margin-right:0.13889em;\">P</span><span class=\"mopen\">(</span><span class=\"mord\"><span class=\"mord mathnormal\" style=\"margin-right:0.02691em;\">w</span><span class=\"msupsub\"><span class=\"vlist-t vlist-t2\"><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.2805559999999999em;\"><span style=\"top:-2.5500000000000003em;margin-left:-0.02691em;margin-right:0.05em;\"><span class=\"pstrut\" style=\"height:2.7em;\"></span><span class=\"sizing reset-size6 size3 mtight\"><span class=\"mord mathnormal mtight\">t</span></span></span></span><span class=\"vlist-s\">â€‹</span></span><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.15em;\"><span></span></span></span></span></span></span><span class=\"mspace\" style=\"margin-right:0.2777777777777778em;\"></span><span class=\"mrel\">=</span><span class=\"mspace\" style=\"margin-right:0.2777777777777778em;\"></span></span><span class=\"base\"><span class=\"strut\" style=\"height:1em;vertical-align:-0.25em;\"></span><span class=\"mord mathnormal\">b</span><span class=\"mord mathnormal\">e</span><span class=\"mord mathnormal\" style=\"margin-right:0.02778em;\">r</span><span class=\"mord mathnormal\">t</span><span class=\"mord\">âˆ£</span><span class=\"mord\"><span class=\"mord mathnormal\" style=\"margin-right:0.02691em;\">w</span><span class=\"msupsub\"><span class=\"vlist-t vlist-t2\"><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.30110799999999993em;\"><span style=\"top:-2.5500000000000003em;margin-left:-0.02691em;margin-right:0.05em;\"><span class=\"pstrut\" style=\"height:2.7em;\"></span><span class=\"sizing reset-size6 size3 mtight\"><span class=\"mord mtight\">1</span></span></span></span><span class=\"vlist-s\">â€‹</span></span><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.15em;\"><span></span></span></span></span></span></span><span class=\"mpunct\">,</span><span class=\"mspace\" style=\"margin-right:0.16666666666666666em;\"></span><span class=\"mord\"><span class=\"mord mathnormal\" style=\"margin-right:0.02691em;\">w</span><span class=\"msupsub\"><span class=\"vlist-t vlist-t2\"><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.30110799999999993em;\"><span style=\"top:-2.5500000000000003em;margin-left:-0.02691em;margin-right:0.05em;\"><span class=\"pstrut\" style=\"height:2.7em;\"></span><span class=\"sizing reset-size6 size3 mtight\"><span class=\"mord mtight\">2</span></span></span></span><span class=\"vlist-s\">â€‹</span></span><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.15em;\"><span></span></span></span></span></span></span><span class=\"mpunct\">,</span><span class=\"mspace\" style=\"margin-right:0.16666666666666666em;\"></span><span class=\"minner\">â‹¯</span><span class=\"mspace\" style=\"margin-right:0.16666666666666666em;\"></span><span class=\"mspace\" style=\"margin-right:0.16666666666666666em;\"></span><span class=\"mpunct\">,</span><span class=\"mspace\" style=\"margin-right:0.16666666666666666em;\"></span><span class=\"mord\"><span class=\"mord mathnormal\" style=\"margin-right:0.02691em;\">w</span><span class=\"msupsub\"><span class=\"vlist-t vlist-t2\"><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.301108em;\"><span style=\"top:-2.5500000000000003em;margin-left:-0.02691em;margin-right:0.05em;\"><span class=\"pstrut\" style=\"height:2.7em;\"></span><span class=\"sizing reset-size6 size3 mtight\"><span class=\"mord mtight\"><span class=\"mord mathnormal mtight\">t</span><span class=\"mbin mtight\">âˆ’</span><span class=\"mord mtight\">1</span></span></span></span></span><span class=\"vlist-s\">â€‹</span></span><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.208331em;\"><span></span></span></span></span></span></span><span class=\"mpunct\">;</span><span class=\"mspace\" style=\"margin-right:0.16666666666666666em;\"></span><span class=\"mord mathnormal\" style=\"margin-right:0.02778em;\">Î¸</span><span class=\"mclose\">)</span><span class=\"mspace\" style=\"margin-right:1em;\"></span><span class=\"mord text\"><span class=\"mord cjk_fallback\">å…¬å¼</span><span class=\"mord\">(7)</span></span></span></span></span></span></p>\n<p>ä¸Šå›¾æ‰€ç¤ºçš„ç¥ç»ç½‘ç»œè¯­è¨€æ¨¡å‹åˆ†ä¸ºä¸‰å±‚ï¼Œæ¥ä¸‹æ¥æˆ‘ä»¬è¯¦ç»†è®²è§£è¿™ä¸‰å±‚çš„ä½œç”¨ï¼š</p>\n<ol>\n<li>ç¥ç»ç½‘ç»œè¯­è¨€æ¨¡å‹çš„ç¬¬ä¸€å±‚ï¼Œä¸ºè¾“å…¥å±‚ã€‚é¦–å…ˆå°†å‰ <span class=\"katex\"><span class=\"katex-mathml\"><math xmlns=\"http://www.w3.org/1998/Math/MathML\"><semantics><mrow><mi>n</mi><mo>âˆ’</mo><mn>1</mn></mrow><annotation encoding=\"application/x-tex\">n-1</annotation></semantics></math></span><span class=\"katex-html\" aria-hidden=\"true\"><span class=\"base\"><span class=\"strut\" style=\"height:0.66666em;vertical-align:-0.08333em;\"></span><span class=\"mord mathnormal\">n</span><span class=\"mspace\" style=\"margin-right:0.2222222222222222em;\"></span><span class=\"mbin\">âˆ’</span><span class=\"mspace\" style=\"margin-right:0.2222222222222222em;\"></span></span><span class=\"base\"><span class=\"strut\" style=\"height:0.64444em;vertical-align:0em;\"></span><span class=\"mord\">1</span></span></span></span> ä¸ªå•è¯ç”¨ Onehot ç¼–ç ï¼ˆä¾‹å¦‚ï¼š0001000ï¼‰ä½œä¸ºåŸå§‹å•è¯è¾“å…¥ï¼Œä¹‹åä¹˜ä»¥ä¸€ä¸ªéšæœºåˆå§‹åŒ–çš„çŸ©é˜µ Q åè·å¾—è¯å‘é‡ <span class=\"katex\"><span class=\"katex-mathml\"><math xmlns=\"http://www.w3.org/1998/Math/MathML\"><semantics><mrow><mi>C</mi><mo stretchy=\"false\">(</mo><msub><mi>w</mi><mi>i</mi></msub><mo stretchy=\"false\">)</mo></mrow><annotation encoding=\"application/x-tex\">C(w_i)</annotation></semantics></math></span><span class=\"katex-html\" aria-hidden=\"true\"><span class=\"base\"><span class=\"strut\" style=\"height:1em;vertical-align:-0.25em;\"></span><span class=\"mord mathnormal\" style=\"margin-right:0.07153em;\">C</span><span class=\"mopen\">(</span><span class=\"mord\"><span class=\"mord mathnormal\" style=\"margin-right:0.02691em;\">w</span><span class=\"msupsub\"><span class=\"vlist-t vlist-t2\"><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.31166399999999994em;\"><span style=\"top:-2.5500000000000003em;margin-left:-0.02691em;margin-right:0.05em;\"><span class=\"pstrut\" style=\"height:2.7em;\"></span><span class=\"sizing reset-size6 size3 mtight\"><span class=\"mord mathnormal mtight\">i</span></span></span></span><span class=\"vlist-s\">â€‹</span></span><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.15em;\"><span></span></span></span></span></span></span><span class=\"mclose\">)</span></span></span></span>ï¼Œå¯¹è¿™ <span class=\"katex\"><span class=\"katex-mathml\"><math xmlns=\"http://www.w3.org/1998/Math/MathML\"><semantics><mrow><mi>n</mi><mo>âˆ’</mo><mn>1</mn></mrow><annotation encoding=\"application/x-tex\">n-1</annotation></semantics></math></span><span class=\"katex-html\" aria-hidden=\"true\"><span class=\"base\"><span class=\"strut\" style=\"height:0.66666em;vertical-align:-0.08333em;\"></span><span class=\"mord mathnormal\">n</span><span class=\"mspace\" style=\"margin-right:0.2222222222222222em;\"></span><span class=\"mbin\">âˆ’</span><span class=\"mspace\" style=\"margin-right:0.2222222222222222em;\"></span></span><span class=\"base\"><span class=\"strut\" style=\"height:0.64444em;vertical-align:0em;\"></span><span class=\"mord\">1</span></span></span></span> ä¸ªè¯å‘é‡å¤„ç†åå¾—åˆ°è¾“å…¥ <span class=\"katex\"><span class=\"katex-mathml\"><math xmlns=\"http://www.w3.org/1998/Math/MathML\"><semantics><mrow><mi>x</mi></mrow><annotation encoding=\"application/x-tex\">x</annotation></semantics></math></span><span class=\"katex-html\" aria-hidden=\"true\"><span class=\"base\"><span class=\"strut\" style=\"height:0.43056em;vertical-align:0em;\"></span><span class=\"mord mathnormal\">x</span></span></span></span>ï¼Œè®°ä½œ <span class=\"katex\"><span class=\"katex-mathml\"><math xmlns=\"http://www.w3.org/1998/Math/MathML\"><semantics><mrow><mi>x</mi><mo>=</mo><mo stretchy=\"false\">(</mo><mi>C</mi><mo stretchy=\"false\">(</mo><msub><mi>w</mi><mn>1</mn></msub><mo stretchy=\"false\">)</mo><mo separator=\"true\">,</mo><mi>C</mi><mo stretchy=\"false\">(</mo><msub><mi>w</mi><mn>2</mn></msub><mo stretchy=\"false\">)</mo><mo separator=\"true\">,</mo><mo>â‹¯</mo><mtext>â€‰</mtext><mo separator=\"true\">,</mo><mi>C</mi><mo stretchy=\"false\">(</mo><msub><mi>w</mi><mrow><mi>t</mi><mo>âˆ’</mo><mn>1</mn></mrow></msub><mo stretchy=\"false\">)</mo><mo stretchy=\"false\">)</mo></mrow><annotation encoding=\"application/x-tex\">x=(C(w_1),C(w_2),\\cdots,C(w_{t-1}))</annotation></semantics></math></span><span class=\"katex-html\" aria-hidden=\"true\"><span class=\"base\"><span class=\"strut\" style=\"height:0.43056em;vertical-align:0em;\"></span><span class=\"mord mathnormal\">x</span><span class=\"mspace\" style=\"margin-right:0.2777777777777778em;\"></span><span class=\"mrel\">=</span><span class=\"mspace\" style=\"margin-right:0.2777777777777778em;\"></span></span><span class=\"base\"><span class=\"strut\" style=\"height:1em;vertical-align:-0.25em;\"></span><span class=\"mopen\">(</span><span class=\"mord mathnormal\" style=\"margin-right:0.07153em;\">C</span><span class=\"mopen\">(</span><span class=\"mord\"><span class=\"mord mathnormal\" style=\"margin-right:0.02691em;\">w</span><span class=\"msupsub\"><span class=\"vlist-t vlist-t2\"><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.30110799999999993em;\"><span style=\"top:-2.5500000000000003em;margin-left:-0.02691em;margin-right:0.05em;\"><span class=\"pstrut\" style=\"height:2.7em;\"></span><span class=\"sizing reset-size6 size3 mtight\"><span class=\"mord mtight\">1</span></span></span></span><span class=\"vlist-s\">â€‹</span></span><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.15em;\"><span></span></span></span></span></span></span><span class=\"mclose\">)</span><span class=\"mpunct\">,</span><span class=\"mspace\" style=\"margin-right:0.16666666666666666em;\"></span><span class=\"mord mathnormal\" style=\"margin-right:0.07153em;\">C</span><span class=\"mopen\">(</span><span class=\"mord\"><span class=\"mord mathnormal\" style=\"margin-right:0.02691em;\">w</span><span class=\"msupsub\"><span class=\"vlist-t vlist-t2\"><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.30110799999999993em;\"><span style=\"top:-2.5500000000000003em;margin-left:-0.02691em;margin-right:0.05em;\"><span class=\"pstrut\" style=\"height:2.7em;\"></span><span class=\"sizing reset-size6 size3 mtight\"><span class=\"mord mtight\">2</span></span></span></span><span class=\"vlist-s\">â€‹</span></span><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.15em;\"><span></span></span></span></span></span></span><span class=\"mclose\">)</span><span class=\"mpunct\">,</span><span class=\"mspace\" style=\"margin-right:0.16666666666666666em;\"></span><span class=\"minner\">â‹¯</span><span class=\"mspace\" style=\"margin-right:0.16666666666666666em;\"></span><span class=\"mspace\" style=\"margin-right:0.16666666666666666em;\"></span><span class=\"mpunct\">,</span><span class=\"mspace\" style=\"margin-right:0.16666666666666666em;\"></span><span class=\"mord mathnormal\" style=\"margin-right:0.07153em;\">C</span><span class=\"mopen\">(</span><span class=\"mord\"><span class=\"mord mathnormal\" style=\"margin-right:0.02691em;\">w</span><span class=\"msupsub\"><span class=\"vlist-t vlist-t2\"><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.301108em;\"><span style=\"top:-2.5500000000000003em;margin-left:-0.02691em;margin-right:0.05em;\"><span class=\"pstrut\" style=\"height:2.7em;\"></span><span class=\"sizing reset-size6 size3 mtight\"><span class=\"mord mtight\"><span class=\"mord mathnormal mtight\">t</span><span class=\"mbin mtight\">âˆ’</span><span class=\"mord mtight\">1</span></span></span></span></span><span class=\"vlist-s\">â€‹</span></span><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.208331em;\"><span></span></span></span></span></span></span><span class=\"mclose\">)</span><span class=\"mclose\">)</span></span></span></span></li>\n<li>ç¥ç»ç½‘ç»œè¯­è¨€æ¨¡å‹çš„ç¬¬äºŒå±‚ï¼Œä¸ºéšå±‚ï¼ŒåŒ…å« <span class=\"katex\"><span class=\"katex-mathml\"><math xmlns=\"http://www.w3.org/1998/Math/MathML\"><semantics><mrow><mi>h</mi></mrow><annotation encoding=\"application/x-tex\">h</annotation></semantics></math></span><span class=\"katex-html\" aria-hidden=\"true\"><span class=\"base\"><span class=\"strut\" style=\"height:0.69444em;vertical-align:0em;\"></span><span class=\"mord mathnormal\">h</span></span></span></span> ä¸ªéšå˜é‡ï¼Œ<span class=\"katex\"><span class=\"katex-mathml\"><math xmlns=\"http://www.w3.org/1998/Math/MathML\"><semantics><mrow><mi>H</mi></mrow><annotation encoding=\"application/x-tex\">H</annotation></semantics></math></span><span class=\"katex-html\" aria-hidden=\"true\"><span class=\"base\"><span class=\"strut\" style=\"height:0.68333em;vertical-align:0em;\"></span><span class=\"mord mathnormal\" style=\"margin-right:0.08125em;\">H</span></span></span></span> ä»£è¡¨æƒé‡çŸ©é˜µï¼Œå› æ­¤éšå±‚çš„è¾“å‡ºä¸º <span class=\"katex\"><span class=\"katex-mathml\"><math xmlns=\"http://www.w3.org/1998/Math/MathML\"><semantics><mrow><mi>H</mi><mi>x</mi><mo>+</mo><mi>d</mi></mrow><annotation encoding=\"application/x-tex\">Hx+d</annotation></semantics></math></span><span class=\"katex-html\" aria-hidden=\"true\"><span class=\"base\"><span class=\"strut\" style=\"height:0.76666em;vertical-align:-0.08333em;\"></span><span class=\"mord mathnormal\" style=\"margin-right:0.08125em;\">H</span><span class=\"mord mathnormal\">x</span><span class=\"mspace\" style=\"margin-right:0.2222222222222222em;\"></span><span class=\"mbin\">+</span><span class=\"mspace\" style=\"margin-right:0.2222222222222222em;\"></span></span><span class=\"base\"><span class=\"strut\" style=\"height:0.69444em;vertical-align:0em;\"></span><span class=\"mord mathnormal\">d</span></span></span></span>ï¼Œå…¶ä¸­ <span class=\"katex\"><span class=\"katex-mathml\"><math xmlns=\"http://www.w3.org/1998/Math/MathML\"><semantics><mrow><mi>d</mi></mrow><annotation encoding=\"application/x-tex\">d</annotation></semantics></math></span><span class=\"katex-html\" aria-hidden=\"true\"><span class=\"base\"><span class=\"strut\" style=\"height:0.69444em;vertical-align:0em;\"></span><span class=\"mord mathnormal\">d</span></span></span></span> ä¸ºåç½®é¡¹ã€‚å¹¶ä¸”åœ¨æ­¤ä¹‹åä½¿ç”¨ <span class=\"katex\"><span class=\"katex-mathml\"><math xmlns=\"http://www.w3.org/1998/Math/MathML\"><semantics><mrow><mi>t</mi><mi>a</mi><mi>n</mi><mi>h</mi></mrow><annotation encoding=\"application/x-tex\">tanh</annotation></semantics></math></span><span class=\"katex-html\" aria-hidden=\"true\"><span class=\"base\"><span class=\"strut\" style=\"height:0.69444em;vertical-align:0em;\"></span><span class=\"mord mathnormal\">t</span><span class=\"mord mathnormal\">a</span><span class=\"mord mathnormal\">n</span><span class=\"mord mathnormal\">h</span></span></span></span> ä½œä¸ºæ¿€æ´»å‡½æ•°ã€‚</li>\n<li>ç¥ç»ç½‘ç»œè¯­è¨€æ¨¡å‹çš„ç¬¬ä¸‰å±‚ï¼Œä¸ºè¾“å‡ºå±‚ï¼Œä¸€å…±æœ‰ <span class=\"katex\"><span class=\"katex-mathml\"><math xmlns=\"http://www.w3.org/1998/Math/MathML\"><semantics><mrow><mi mathvariant=\"normal\">âˆ£</mi><mi>V</mi><mi mathvariant=\"normal\">âˆ£</mi></mrow><annotation encoding=\"application/x-tex\">|V|</annotation></semantics></math></span><span class=\"katex-html\" aria-hidden=\"true\"><span class=\"base\"><span class=\"strut\" style=\"height:1em;vertical-align:-0.25em;\"></span><span class=\"mord\">âˆ£</span><span class=\"mord mathnormal\" style=\"margin-right:0.22222em;\">V</span><span class=\"mord\">âˆ£</span></span></span></span>  ä¸ªè¾“å‡ºèŠ‚ç‚¹ï¼ˆå­—å…¸å¤§å°ï¼‰ï¼Œç›´è§‚ä¸Šè®²ï¼Œæ¯ä¸ªè¾“å‡ºèŠ‚ç‚¹ <span class=\"katex\"><span class=\"katex-mathml\"><math xmlns=\"http://www.w3.org/1998/Math/MathML\"><semantics><mrow><msub><mi>y</mi><mi>i</mi></msub></mrow><annotation encoding=\"application/x-tex\">y_i</annotation></semantics></math></span><span class=\"katex-html\" aria-hidden=\"true\"><span class=\"base\"><span class=\"strut\" style=\"height:0.625em;vertical-align:-0.19444em;\"></span><span class=\"mord\"><span class=\"mord mathnormal\" style=\"margin-right:0.03588em;\">y</span><span class=\"msupsub\"><span class=\"vlist-t vlist-t2\"><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.31166399999999994em;\"><span style=\"top:-2.5500000000000003em;margin-left:-0.03588em;margin-right:0.05em;\"><span class=\"pstrut\" style=\"height:2.7em;\"></span><span class=\"sizing reset-size6 size3 mtight\"><span class=\"mord mathnormal mtight\">i</span></span></span></span><span class=\"vlist-s\">â€‹</span></span><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.15em;\"><span></span></span></span></span></span></span></span></span></span> æ˜¯è¯å…¸ä¸­æ¯ä¸€ä¸ªå•è¯æ¦‚ç‡å€¼ã€‚æœ€ç»ˆå¾—åˆ°çš„è®¡ç®—å…¬å¼ä¸ºï¼š<span class=\"katex\"><span class=\"katex-mathml\"><math xmlns=\"http://www.w3.org/1998/Math/MathML\"><semantics><mrow><mi>y</mi><mo>=</mo><mi>s</mi><mi>o</mi><mi>f</mi><mi>t</mi><mi>m</mi><mi>a</mi><mi>x</mi><mo stretchy=\"false\">(</mo><mi>b</mi><mo>+</mo><mi>W</mi><mi>x</mi><mo>+</mo><mi>U</mi><mi>tanh</mi><mo>â¡</mo><mo stretchy=\"false\">(</mo><mi>d</mi><mo>+</mo><mi>H</mi><mi>x</mi><mo stretchy=\"false\">)</mo><mo stretchy=\"false\">)</mo></mrow><annotation encoding=\"application/x-tex\">y = softmax(b+Wx+U\\tanh(d+Hx))</annotation></semantics></math></span><span class=\"katex-html\" aria-hidden=\"true\"><span class=\"base\"><span class=\"strut\" style=\"height:0.625em;vertical-align:-0.19444em;\"></span><span class=\"mord mathnormal\" style=\"margin-right:0.03588em;\">y</span><span class=\"mspace\" style=\"margin-right:0.2777777777777778em;\"></span><span class=\"mrel\">=</span><span class=\"mspace\" style=\"margin-right:0.2777777777777778em;\"></span></span><span class=\"base\"><span class=\"strut\" style=\"height:1em;vertical-align:-0.25em;\"></span><span class=\"mord mathnormal\">s</span><span class=\"mord mathnormal\">o</span><span class=\"mord mathnormal\" style=\"margin-right:0.10764em;\">f</span><span class=\"mord mathnormal\">t</span><span class=\"mord mathnormal\">m</span><span class=\"mord mathnormal\">a</span><span class=\"mord mathnormal\">x</span><span class=\"mopen\">(</span><span class=\"mord mathnormal\">b</span><span class=\"mspace\" style=\"margin-right:0.2222222222222222em;\"></span><span class=\"mbin\">+</span><span class=\"mspace\" style=\"margin-right:0.2222222222222222em;\"></span></span><span class=\"base\"><span class=\"strut\" style=\"height:0.76666em;vertical-align:-0.08333em;\"></span><span class=\"mord mathnormal\" style=\"margin-right:0.13889em;\">W</span><span class=\"mord mathnormal\">x</span><span class=\"mspace\" style=\"margin-right:0.2222222222222222em;\"></span><span class=\"mbin\">+</span><span class=\"mspace\" style=\"margin-right:0.2222222222222222em;\"></span></span><span class=\"base\"><span class=\"strut\" style=\"height:1em;vertical-align:-0.25em;\"></span><span class=\"mord mathnormal\" style=\"margin-right:0.10903em;\">U</span><span class=\"mspace\" style=\"margin-right:0.16666666666666666em;\"></span><span class=\"mop\">tanh</span><span class=\"mopen\">(</span><span class=\"mord mathnormal\">d</span><span class=\"mspace\" style=\"margin-right:0.2222222222222222em;\"></span><span class=\"mbin\">+</span><span class=\"mspace\" style=\"margin-right:0.2222222222222222em;\"></span></span><span class=\"base\"><span class=\"strut\" style=\"height:1em;vertical-align:-0.25em;\"></span><span class=\"mord mathnormal\" style=\"margin-right:0.08125em;\">H</span><span class=\"mord mathnormal\">x</span><span class=\"mclose\">)</span><span class=\"mclose\">)</span></span></span></span>ï¼Œå…¶ä¸­ <span class=\"katex\"><span class=\"katex-mathml\"><math xmlns=\"http://www.w3.org/1998/Math/MathML\"><semantics><mrow><mi>W</mi></mrow><annotation encoding=\"application/x-tex\">W</annotation></semantics></math></span><span class=\"katex-html\" aria-hidden=\"true\"><span class=\"base\"><span class=\"strut\" style=\"height:0.68333em;vertical-align:0em;\"></span><span class=\"mord mathnormal\" style=\"margin-right:0.13889em;\">W</span></span></span></span> æ˜¯ç›´æ¥ä»è¾“å…¥å±‚åˆ°è¾“å‡ºå±‚çš„æƒé‡çŸ©é˜µï¼Œ<span class=\"katex\"><span class=\"katex-mathml\"><math xmlns=\"http://www.w3.org/1998/Math/MathML\"><semantics><mrow><mi>U</mi></mrow><annotation encoding=\"application/x-tex\">U</annotation></semantics></math></span><span class=\"katex-html\" aria-hidden=\"true\"><span class=\"base\"><span class=\"strut\" style=\"height:0.68333em;vertical-align:0em;\"></span><span class=\"mord mathnormal\" style=\"margin-right:0.10903em;\">U</span></span></span></span> æ˜¯éšå±‚åˆ°è¾“å‡ºå±‚çš„å‚æ•°çŸ©é˜µã€‚</li>\n</ol>\n<h1 id=\"ä¸‰-è¯å‘é‡\"><a class=\"anchor\" href=\"#ä¸‰-è¯å‘é‡\">#</a> ä¸‰ã€è¯å‘é‡</h1>\n<p>åœ¨æè¿°ç¥ç»ç½‘ç»œè¯­è¨€æ¨¡å‹çš„æ—¶å€™ï¼Œæåˆ° Onehot ç¼–ç å’Œè¯å‘é‡ <span class=\"katex\"><span class=\"katex-mathml\"><math xmlns=\"http://www.w3.org/1998/Math/MathML\"><semantics><mrow><mi>C</mi><mo stretchy=\"false\">(</mo><msub><mi>w</mi><mi>i</mi></msub><mo stretchy=\"false\">)</mo></mrow><annotation encoding=\"application/x-tex\">C(w_i)</annotation></semantics></math></span><span class=\"katex-html\" aria-hidden=\"true\"><span class=\"base\"><span class=\"strut\" style=\"height:1em;vertical-align:-0.25em;\"></span><span class=\"mord mathnormal\" style=\"margin-right:0.07153em;\">C</span><span class=\"mopen\">(</span><span class=\"mord\"><span class=\"mord mathnormal\" style=\"margin-right:0.02691em;\">w</span><span class=\"msupsub\"><span class=\"vlist-t vlist-t2\"><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.31166399999999994em;\"><span style=\"top:-2.5500000000000003em;margin-left:-0.02691em;margin-right:0.05em;\"><span class=\"pstrut\" style=\"height:2.7em;\"></span><span class=\"sizing reset-size6 size3 mtight\"><span class=\"mord mathnormal mtight\">i</span></span></span></span><span class=\"vlist-s\">â€‹</span></span><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.15em;\"><span></span></span></span></span></span></span><span class=\"mclose\">)</span></span></span></span>ï¼Œä½†æ˜¯å¹¶æ²¡æœ‰å…·ä½“æåŠä»–ä»¬åˆ°åº•æ˜¯ä»€ä¹ˆç©æ„ã€‚</p>\n<p>ç”±äºä»–ä»¬å¯¹äºæœªæ¥ BERT çš„è®²è§£éå¸¸é‡è¦ï¼Œæ‰€ä»¥åœ¨è¿™é‡Œé‡å¼€ä¸€ç« æ¥æè¿°è¯å‘é‡åˆ°åº•æ˜¯ä»€ä¹ˆï¼Œå¦‚ä½•è¡¨ç¤ºã€‚</p>\n<h2 id=\"31-ç‹¬çƒ­onehotç¼–ç \"><a class=\"anchor\" href=\"#31-ç‹¬çƒ­onehotç¼–ç \">#</a> 3.1 ç‹¬çƒ­ï¼ˆOnehotï¼‰ç¼–ç </h2>\n<p><strong>æŠŠå•è¯ç”¨å‘é‡è¡¨ç¤ºï¼Œæ˜¯æŠŠæ·±åº¦ç¥ç»ç½‘ç»œè¯­è¨€æ¨¡å‹å¼•å…¥è‡ªç„¶è¯­è¨€å¤„ç†é¢†åŸŸçš„ä¸€ä¸ªæ ¸å¿ƒæŠ€æœ¯ã€‚</strong></p>\n<p>åœ¨è‡ªç„¶è¯­è¨€å¤„ç†ä»»åŠ¡ä¸­ï¼Œè®­ç»ƒé›†å¤§å¤šä¸ºä¸€ä¸ªå­—æˆ–è€…ä¸€ä¸ªè¯ï¼ŒæŠŠä»–ä»¬è½¬åŒ–ä¸ºè®¡ç®—æœºé€‚åˆå¤„ç†çš„æ•°å€¼ç±»æ•°æ®éå¸¸é‡è¦ã€‚</p>\n<p>æ—©æœŸï¼Œäººä»¬æƒ³åˆ°çš„æ–¹æ³•æ˜¯ä½¿ç”¨ç‹¬çƒ­ï¼ˆOnehotï¼‰ç¼–ç ï¼Œå¦‚ä¸‹å›¾æ‰€ç¤ºï¼š</p>\n<p>&lt;img src=&quot;<span class=\"exturl\" data-url=\"aHR0cHM6Ly9pbWdtZC5vc3MtY24tc2hhbmdoYWkuYWxpeXVuY3MuY29tL0JFUlRfSU1HLyVFNSU4RCU5NSVFOCVBRiU4RCVFNyU5QSU4NCVFNyU4QiVBQyVFNyU4MyVBRCVFOCVBMSVBOCVFNyVBNCVCQS5qcGc=\">https://imgmd.oss-cn-shanghai.aliyuncs.com/BERT_IMG/ å•è¯çš„ç‹¬çƒ­è¡¨ç¤º.jpg</span>&quot; style=&quot;zoom:50%;&quot; /&gt;</p>\n<p>å¯¹äºä¸Šå›¾çš„è§£é‡Šï¼Œå‡è®¾æœ‰ä¸€ä¸ªåŒ…å« 8 ä¸ªæ¬¡çš„å­—å…¸ <span class=\"katex\"><span class=\"katex-mathml\"><math xmlns=\"http://www.w3.org/1998/Math/MathML\"><semantics><mrow><mi>V</mi></mrow><annotation encoding=\"application/x-tex\">V</annotation></semantics></math></span><span class=\"katex-html\" aria-hidden=\"true\"><span class=\"base\"><span class=\"strut\" style=\"height:0.68333em;vertical-align:0em;\"></span><span class=\"mord mathnormal\" style=\"margin-right:0.22222em;\">V</span></span></span></span>ï¼Œâ€œtimeâ€ ä½äºå­—å…¸çš„ç¬¬ 1 ä¸ªä½ç½®ï¼Œâ€œbananaâ€ ä½äºå­—å…¸çš„ç¬¬ 8 ä¸ªä½ç½®ï¼Œå› æ­¤ï¼Œé‡‡ç”¨ç‹¬çƒ­è¡¨ç¤ºæ–¹æ³•ï¼Œå¯¹äº â€œtimeâ€ çš„å‘é‡æ¥è¯´ï¼Œé™¤äº†ç¬¬ 1 ä¸ªä½ç½®ä¸º 1ï¼Œå…¶ä½™ä½ç½®ä¸º 0ï¼›å¯¹äº â€œbananaâ€ çš„å‘é‡æ¥è¯´ï¼Œé™¤äº†ç¬¬ 8 ä¸ªä½ç½®ä¸º 1ï¼Œå…¶ä½™ä½ç½®ä¸º 0ã€‚</p>\n<p>ä½†æ˜¯ï¼Œå¯¹äºç‹¬çƒ­è¡¨ç¤ºçš„å‘é‡ï¼Œå¦‚æœé‡‡ç”¨ä½™å¼¦ç›¸ä¼¼åº¦è®¡ç®—å‘é‡é—´çš„ç›¸ä¼¼åº¦ï¼Œ<strong>å¯ä»¥æ˜æ˜¾çš„å‘ç°ä»»æ„ä¸¤è€…å‘é‡çš„ç›¸ä¼¼åº¦ç»“æœéƒ½ä¸º 0</strong>ï¼Œå³ä»»æ„äºŒè€…éƒ½ä¸ç›¸å…³ï¼Œä¹Ÿå°±æ˜¯è¯´ç‹¬çƒ­è¡¨ç¤ºæ— æ³•è§£å†³è¯ä¹‹é—´çš„ç›¸ä¼¼æ€§é—®é¢˜ã€‚</p>\n<h2 id=\"32-word-embedding\"><a class=\"anchor\" href=\"#32-word-embedding\">#</a> 3.2 Word Embedding</h2>\n<p>ç”±äºç‹¬çƒ­è¡¨ç¤ºæ— æ³•è§£å†³è¯ä¹‹é—´ç›¸ä¼¼æ€§é—®é¢˜ï¼Œè¿™ç§è¡¨ç¤ºå¾ˆå¿«å°±è¢«è¯å‘é‡è¡¨ç¤ºç»™æ›¿ä»£äº†ï¼Œè¿™ä¸ªæ—¶å€™èªæ˜çš„ä½ å¯èƒ½æƒ³åˆ°äº†åœ¨ç¥ç»ç½‘ç»œè¯­è¨€æ¨¡å‹ä¸­å‡ºç°çš„ä¸€ä¸ªè¯å‘é‡ <span class=\"katex\"><span class=\"katex-mathml\"><math xmlns=\"http://www.w3.org/1998/Math/MathML\"><semantics><mrow><mi>C</mi><mo stretchy=\"false\">(</mo><msub><mi>w</mi><mi>i</mi></msub><mo stretchy=\"false\">)</mo></mrow><annotation encoding=\"application/x-tex\">C(w_i)</annotation></semantics></math></span><span class=\"katex-html\" aria-hidden=\"true\"><span class=\"base\"><span class=\"strut\" style=\"height:1em;vertical-align:-0.25em;\"></span><span class=\"mord mathnormal\" style=\"margin-right:0.07153em;\">C</span><span class=\"mopen\">(</span><span class=\"mord\"><span class=\"mord mathnormal\" style=\"margin-right:0.02691em;\">w</span><span class=\"msupsub\"><span class=\"vlist-t vlist-t2\"><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.31166399999999994em;\"><span style=\"top:-2.5500000000000003em;margin-left:-0.02691em;margin-right:0.05em;\"><span class=\"pstrut\" style=\"height:2.7em;\"></span><span class=\"sizing reset-size6 size3 mtight\"><span class=\"mord mathnormal mtight\">i</span></span></span></span><span class=\"vlist-s\">â€‹</span></span><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.15em;\"><span></span></span></span></span></span></span><span class=\"mclose\">)</span></span></span></span>ï¼Œå¯¹çš„ï¼Œ<strong>è¿™ä¸ª <span class=\"katex\"><span class=\"katex-mathml\"><math xmlns=\"http://www.w3.org/1998/Math/MathML\"><semantics><mrow><mi>C</mi><mo stretchy=\"false\">(</mo><msub><mi>w</mi><mi>i</mi></msub><mo stretchy=\"false\">)</mo></mrow><annotation encoding=\"application/x-tex\">C(w_i)</annotation></semantics></math></span><span class=\"katex-html\" aria-hidden=\"true\"><span class=\"base\"><span class=\"strut\" style=\"height:1em;vertical-align:-0.25em;\"></span><span class=\"mord mathnormal\" style=\"margin-right:0.07153em;\">C</span><span class=\"mopen\">(</span><span class=\"mord\"><span class=\"mord mathnormal\" style=\"margin-right:0.02691em;\">w</span><span class=\"msupsub\"><span class=\"vlist-t vlist-t2\"><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.31166399999999994em;\"><span style=\"top:-2.5500000000000003em;margin-left:-0.02691em;margin-right:0.05em;\"><span class=\"pstrut\" style=\"height:2.7em;\"></span><span class=\"sizing reset-size6 size3 mtight\"><span class=\"mord mathnormal mtight\">i</span></span></span></span><span class=\"vlist-s\">â€‹</span></span><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.15em;\"><span></span></span></span></span></span></span><span class=\"mclose\">)</span></span></span></span> å…¶å®å°±æ˜¯å•è¯å¯¹åº”çš„ Word Embedding å€¼ï¼Œä¹Ÿå°±æ˜¯æˆ‘ä»¬è¿™èŠ‚çš„æ ¸å¿ƒ â€”â€” è¯å‘é‡ã€‚</strong></p>\n<p>åœ¨ç¥ç»ç½‘ç»œè¯­è¨€æ¨¡å‹ä¸­ï¼Œæˆ‘ä»¬å¹¶æ²¡æœ‰è¯¦ç»†è§£é‡Šè¯å‘é‡æ˜¯å¦‚ä½•è®¡ç®—çš„ï¼Œç°åœ¨è®©æˆ‘ä»¬é‡çœ‹ç¥ç»ç½‘ç»œè¯­è¨€æ¨¡å‹çš„æ¶æ„å›¾ï¼š</p>\n<p>&lt;img src=&quot;<span class=\"exturl\" data-url=\"aHR0cHM6Ly9pbWdtZC5vc3MtY24tc2hhbmdoYWkuYWxpeXVuY3MuY29tL0JFUlRfSU1HLyVFNyVBNSU5RSVFNyVCQiU4RiVFNyVCRCU5MSVFNyVCQiU5QyVFOCVBRiVBRCVFOCVBOCU4MCVFNiVBOCVBMSVFNSU5RSU4Qi5qcGc=\">https://imgmd.oss-cn-shanghai.aliyuncs.com/BERT_IMG/ ç¥ç»ç½‘ç»œè¯­è¨€æ¨¡å‹.jpg</span>&quot; style=&quot;zoom:50%;&quot; /&gt;</p>\n<p>ä¸Šå›¾æ‰€ç¤ºæœ‰ä¸€ä¸ª <span class=\"katex\"><span class=\"katex-mathml\"><math xmlns=\"http://www.w3.org/1998/Math/MathML\"><semantics><mrow><mi>V</mi><mo>Ã—</mo><mi>m</mi></mrow><annotation encoding=\"application/x-tex\">VÃ—m</annotation></semantics></math></span><span class=\"katex-html\" aria-hidden=\"true\"><span class=\"base\"><span class=\"strut\" style=\"height:0.76666em;vertical-align:-0.08333em;\"></span><span class=\"mord mathnormal\" style=\"margin-right:0.22222em;\">V</span><span class=\"mspace\" style=\"margin-right:0.2222222222222222em;\"></span><span class=\"mbin\">Ã—</span><span class=\"mspace\" style=\"margin-right:0.2222222222222222em;\"></span></span><span class=\"base\"><span class=\"strut\" style=\"height:0.43056em;vertical-align:0em;\"></span><span class=\"mord mathnormal\">m</span></span></span></span> çš„çŸ©é˜µ <span class=\"katex\"><span class=\"katex-mathml\"><math xmlns=\"http://www.w3.org/1998/Math/MathML\"><semantics><mrow><mi>Q</mi></mrow><annotation encoding=\"application/x-tex\">Q</annotation></semantics></math></span><span class=\"katex-html\" aria-hidden=\"true\"><span class=\"base\"><span class=\"strut\" style=\"height:0.8777699999999999em;vertical-align:-0.19444em;\"></span><span class=\"mord mathnormal\">Q</span></span></span></span>ï¼Œè¿™ä¸ªçŸ©é˜µ <span class=\"katex\"><span class=\"katex-mathml\"><math xmlns=\"http://www.w3.org/1998/Math/MathML\"><semantics><mrow><mi>Q</mi></mrow><annotation encoding=\"application/x-tex\">Q</annotation></semantics></math></span><span class=\"katex-html\" aria-hidden=\"true\"><span class=\"base\"><span class=\"strut\" style=\"height:0.8777699999999999em;vertical-align:-0.19444em;\"></span><span class=\"mord mathnormal\">Q</span></span></span></span> åŒ…å« <span class=\"katex\"><span class=\"katex-mathml\"><math xmlns=\"http://www.w3.org/1998/Math/MathML\"><semantics><mrow><mi>V</mi></mrow><annotation encoding=\"application/x-tex\">V</annotation></semantics></math></span><span class=\"katex-html\" aria-hidden=\"true\"><span class=\"base\"><span class=\"strut\" style=\"height:0.68333em;vertical-align:0em;\"></span><span class=\"mord mathnormal\" style=\"margin-right:0.22222em;\">V</span></span></span></span> è¡Œï¼Œ<span class=\"katex\"><span class=\"katex-mathml\"><math xmlns=\"http://www.w3.org/1998/Math/MathML\"><semantics><mrow><mi>V</mi></mrow><annotation encoding=\"application/x-tex\">V</annotation></semantics></math></span><span class=\"katex-html\" aria-hidden=\"true\"><span class=\"base\"><span class=\"strut\" style=\"height:0.68333em;vertical-align:0em;\"></span><span class=\"mord mathnormal\" style=\"margin-right:0.22222em;\">V</span></span></span></span> ä»£è¡¨è¯å…¸å¤§å°ï¼Œæ¯ä¸€è¡Œçš„å†…å®¹ä»£è¡¨å¯¹åº”å•è¯çš„ Word Embedding å€¼ã€‚</p>\n<p>åªä¸è¿‡ <span class=\"katex\"><span class=\"katex-mathml\"><math xmlns=\"http://www.w3.org/1998/Math/MathML\"><semantics><mrow><mi>Q</mi></mrow><annotation encoding=\"application/x-tex\">Q</annotation></semantics></math></span><span class=\"katex-html\" aria-hidden=\"true\"><span class=\"base\"><span class=\"strut\" style=\"height:0.8777699999999999em;vertical-align:-0.19444em;\"></span><span class=\"mord mathnormal\">Q</span></span></span></span> çš„å†…å®¹ä¹Ÿæ˜¯ç½‘ç»œå‚æ•°ï¼Œéœ€è¦å­¦ä¹ è·å¾—ï¼Œè®­ç»ƒåˆšå¼€å§‹ç”¨éšæœºå€¼åˆå§‹åŒ–çŸ©é˜µ <span class=\"katex\"><span class=\"katex-mathml\"><math xmlns=\"http://www.w3.org/1998/Math/MathML\"><semantics><mrow><mi>Q</mi></mrow><annotation encoding=\"application/x-tex\">Q</annotation></semantics></math></span><span class=\"katex-html\" aria-hidden=\"true\"><span class=\"base\"><span class=\"strut\" style=\"height:0.8777699999999999em;vertical-align:-0.19444em;\"></span><span class=\"mord mathnormal\">Q</span></span></span></span>ï¼Œå½“è¿™ä¸ªç½‘ç»œè®­ç»ƒå¥½ä¹‹åï¼ŒçŸ©é˜µ <span class=\"katex\"><span class=\"katex-mathml\"><math xmlns=\"http://www.w3.org/1998/Math/MathML\"><semantics><mrow><mi>Q</mi></mrow><annotation encoding=\"application/x-tex\">Q</annotation></semantics></math></span><span class=\"katex-html\" aria-hidden=\"true\"><span class=\"base\"><span class=\"strut\" style=\"height:0.8777699999999999em;vertical-align:-0.19444em;\"></span><span class=\"mord mathnormal\">Q</span></span></span></span> çš„å†…å®¹è¢«æ­£ç¡®èµ‹å€¼ï¼Œæ¯ä¸€è¡Œä»£è¡¨ä¸€ä¸ªå•è¯å¯¹åº”çš„ Word embedding å€¼ã€‚</p>\n<p>ä½†æ˜¯è¿™ä¸ªè¯å‘é‡æœ‰æ²¡æœ‰è§£å†³è¯ä¹‹é—´çš„ç›¸ä¼¼åº¦é—®é¢˜å‘¢ï¼Ÿä¸ºäº†å›ç­”è¿™ä¸ªé—®é¢˜ï¼Œæˆ‘ä»¬å¯ä»¥çœ‹çœ‹è¯å‘é‡çš„è®¡ç®—è¿‡ç¨‹ï¼š</p>\n<p><span class=\"katex-display\"><span class=\"katex\"><span class=\"katex-mathml\"><math xmlns=\"http://www.w3.org/1998/Math/MathML\" display=\"block\"><semantics><mrow><mrow><mo fence=\"true\">[</mo><mtable rowspacing=\"0.15999999999999992em\" columnspacing=\"1em\"><mtr><mtd><mstyle scriptlevel=\"0\" displaystyle=\"false\"><mn>0</mn></mstyle></mtd><mtd><mstyle scriptlevel=\"0\" displaystyle=\"false\"><mn>0</mn></mstyle></mtd><mtd><mstyle scriptlevel=\"0\" displaystyle=\"false\"><mn>0</mn></mstyle></mtd><mtd><mstyle scriptlevel=\"0\" displaystyle=\"false\"><mn>1</mn></mstyle></mtd><mtd><mstyle scriptlevel=\"0\" displaystyle=\"false\"><mn>0</mn></mstyle></mtd></mtr></mtable><mo fence=\"true\">]</mo></mrow><mrow><mo fence=\"true\">[</mo><mtable rowspacing=\"0.15999999999999992em\" columnspacing=\"1em\"><mtr><mtd><mstyle scriptlevel=\"0\" displaystyle=\"false\"><mn>17</mn></mstyle></mtd><mtd><mstyle scriptlevel=\"0\" displaystyle=\"false\"><mn>24</mn></mstyle></mtd><mtd><mstyle scriptlevel=\"0\" displaystyle=\"false\"><mn>1</mn></mstyle></mtd></mtr><mtr><mtd><mstyle scriptlevel=\"0\" displaystyle=\"false\"><mn>23</mn></mstyle></mtd><mtd><mstyle scriptlevel=\"0\" displaystyle=\"false\"><mn>5</mn></mstyle></mtd><mtd><mstyle scriptlevel=\"0\" displaystyle=\"false\"><mn>7</mn></mstyle></mtd></mtr><mtr><mtd><mstyle scriptlevel=\"0\" displaystyle=\"false\"><mn>4</mn></mstyle></mtd><mtd><mstyle scriptlevel=\"0\" displaystyle=\"false\"><mn>6</mn></mstyle></mtd><mtd><mstyle scriptlevel=\"0\" displaystyle=\"false\"><mn>13</mn></mstyle></mtd></mtr><mtr><mtd><mstyle scriptlevel=\"0\" displaystyle=\"false\"><mn>10</mn></mstyle></mtd><mtd><mstyle scriptlevel=\"0\" displaystyle=\"false\"><mn>12</mn></mstyle></mtd><mtd><mstyle scriptlevel=\"0\" displaystyle=\"false\"><mn>19</mn></mstyle></mtd></mtr><mtr><mtd><mstyle scriptlevel=\"0\" displaystyle=\"false\"><mn>11</mn></mstyle></mtd><mtd><mstyle scriptlevel=\"0\" displaystyle=\"false\"><mn>18</mn></mstyle></mtd><mtd><mstyle scriptlevel=\"0\" displaystyle=\"false\"><mn>25</mn></mstyle></mtd></mtr></mtable><mo fence=\"true\">]</mo></mrow><mo>=</mo><mrow><mo fence=\"true\">[</mo><mtable rowspacing=\"0.15999999999999992em\" columnspacing=\"1em\"><mtr><mtd><mstyle scriptlevel=\"0\" displaystyle=\"false\"><mn>10</mn></mstyle></mtd><mtd><mstyle scriptlevel=\"0\" displaystyle=\"false\"><mn>12</mn></mstyle></mtd><mtd><mstyle scriptlevel=\"0\" displaystyle=\"false\"><mn>19</mn></mstyle></mtd></mtr></mtable><mo fence=\"true\">]</mo></mrow><mspace width=\"1em\"/><mtext>å…¬å¼(8)</mtext></mrow><annotation encoding=\"application/x-tex\">\\begin{bmatrix}\n0&amp;0&amp;0&amp;1&amp;0\n\\end{bmatrix}\n\n\\begin{bmatrix}\n17&amp;24&amp;1\\\\\n23&amp;5&amp;7\\\\\n4&amp;6&amp;13\\\\\n10&amp;12&amp;19\\\\\n11&amp;18&amp;25\n\\end{bmatrix}\n\n=\n\n\\begin{bmatrix}\n10&amp;12&amp;19\n\\end{bmatrix}\n\\quad\\text{å…¬å¼(8)}\n</annotation></semantics></math></span><span class=\"katex-html\" aria-hidden=\"true\"><span class=\"base\"><span class=\"strut\" style=\"height:6.00503em;vertical-align:-2.75004em;\"></span><span class=\"minner\"><span class=\"mopen delimcenter\" style=\"top:0em;\"><span class=\"delimsizing size1\">[</span></span><span class=\"mord\"><span class=\"mtable\"><span class=\"col-align-c\"><span class=\"vlist-t vlist-t2\"><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.8500000000000001em;\"><span style=\"top:-3.01em;\"><span class=\"pstrut\" style=\"height:3em;\"></span><span class=\"mord\"><span class=\"mord\">0</span></span></span></span><span class=\"vlist-s\">â€‹</span></span><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.35000000000000003em;\"><span></span></span></span></span></span><span class=\"arraycolsep\" style=\"width:0.5em;\"></span><span class=\"arraycolsep\" style=\"width:0.5em;\"></span><span class=\"col-align-c\"><span class=\"vlist-t vlist-t2\"><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.8500000000000001em;\"><span style=\"top:-3.01em;\"><span class=\"pstrut\" style=\"height:3em;\"></span><span class=\"mord\"><span class=\"mord\">0</span></span></span></span><span class=\"vlist-s\">â€‹</span></span><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.35000000000000003em;\"><span></span></span></span></span></span><span class=\"arraycolsep\" style=\"width:0.5em;\"></span><span class=\"arraycolsep\" style=\"width:0.5em;\"></span><span class=\"col-align-c\"><span class=\"vlist-t vlist-t2\"><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.8500000000000001em;\"><span style=\"top:-3.01em;\"><span class=\"pstrut\" style=\"height:3em;\"></span><span class=\"mord\"><span class=\"mord\">0</span></span></span></span><span class=\"vlist-s\">â€‹</span></span><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.35000000000000003em;\"><span></span></span></span></span></span><span class=\"arraycolsep\" style=\"width:0.5em;\"></span><span class=\"arraycolsep\" style=\"width:0.5em;\"></span><span class=\"col-align-c\"><span class=\"vlist-t vlist-t2\"><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.8500000000000001em;\"><span style=\"top:-3.01em;\"><span class=\"pstrut\" style=\"height:3em;\"></span><span class=\"mord\"><span class=\"mord\">1</span></span></span></span><span class=\"vlist-s\">â€‹</span></span><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.35000000000000003em;\"><span></span></span></span></span></span><span class=\"arraycolsep\" style=\"width:0.5em;\"></span><span class=\"arraycolsep\" style=\"width:0.5em;\"></span><span class=\"col-align-c\"><span class=\"vlist-t vlist-t2\"><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.8500000000000001em;\"><span style=\"top:-3.01em;\"><span class=\"pstrut\" style=\"height:3em;\"></span><span class=\"mord\"><span class=\"mord\">0</span></span></span></span><span class=\"vlist-s\">â€‹</span></span><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.35000000000000003em;\"><span></span></span></span></span></span></span></span><span class=\"mclose delimcenter\" style=\"top:0em;\"><span class=\"delimsizing size1\">]</span></span></span><span class=\"mspace\" style=\"margin-right:0.16666666666666666em;\"></span><span class=\"minner\"><span class=\"mopen\"><span class=\"delimsizing mult\"><span class=\"vlist-t vlist-t2\"><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:3.2549900000000003em;\"><span style=\"top:-1.0499800000000006em;\"><span class=\"pstrut\" style=\"height:3.1550000000000002em;\"></span><span class=\"delimsizinginner delim-size4\"><span>â£</span></span></span><span style=\"top:-2.1999800000000005em;\"><span class=\"pstrut\" style=\"height:3.1550000000000002em;\"></span><span class=\"delimsizinginner delim-size4\"><span>â¢</span></span></span><span style=\"top:-2.79598em;\"><span class=\"pstrut\" style=\"height:3.1550000000000002em;\"></span><span class=\"delimsizinginner delim-size4\"><span>â¢</span></span></span><span style=\"top:-3.39198em;\"><span class=\"pstrut\" style=\"height:3.1550000000000002em;\"></span><span class=\"delimsizinginner delim-size4\"><span>â¢</span></span></span><span style=\"top:-3.9879800000000003em;\"><span class=\"pstrut\" style=\"height:3.1550000000000002em;\"></span><span class=\"delimsizinginner delim-size4\"><span>â¢</span></span></span><span style=\"top:-4.0139700000000005em;\"><span class=\"pstrut\" style=\"height:3.1550000000000002em;\"></span><span class=\"delimsizinginner delim-size4\"><span>â¢</span></span></span><span style=\"top:-5.25499em;\"><span class=\"pstrut\" style=\"height:3.1550000000000002em;\"></span><span class=\"delimsizinginner delim-size4\"><span>â¡</span></span></span></span><span class=\"vlist-s\">â€‹</span></span><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:2.75004em;\"><span></span></span></span></span></span></span><span class=\"mord\"><span class=\"mtable\"><span class=\"col-align-c\"><span class=\"vlist-t vlist-t2\"><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:3.2500000000000004em;\"><span style=\"top:-5.410000000000001em;\"><span class=\"pstrut\" style=\"height:3em;\"></span><span class=\"mord\"><span class=\"mord\">1</span><span class=\"mord\">7</span></span></span><span style=\"top:-4.21em;\"><span class=\"pstrut\" style=\"height:3em;\"></span><span class=\"mord\"><span class=\"mord\">2</span><span class=\"mord\">3</span></span></span><span style=\"top:-3.01em;\"><span class=\"pstrut\" style=\"height:3em;\"></span><span class=\"mord\"><span class=\"mord\">4</span></span></span><span style=\"top:-1.8099999999999998em;\"><span class=\"pstrut\" style=\"height:3em;\"></span><span class=\"mord\"><span class=\"mord\">1</span><span class=\"mord\">0</span></span></span><span style=\"top:-0.6099999999999997em;\"><span class=\"pstrut\" style=\"height:3em;\"></span><span class=\"mord\"><span class=\"mord\">1</span><span class=\"mord\">1</span></span></span></span><span class=\"vlist-s\">â€‹</span></span><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:2.7500000000000004em;\"><span></span></span></span></span></span><span class=\"arraycolsep\" style=\"width:0.5em;\"></span><span class=\"arraycolsep\" style=\"width:0.5em;\"></span><span class=\"col-align-c\"><span class=\"vlist-t vlist-t2\"><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:3.2500000000000004em;\"><span style=\"top:-5.410000000000001em;\"><span class=\"pstrut\" style=\"height:3em;\"></span><span class=\"mord\"><span class=\"mord\">2</span><span class=\"mord\">4</span></span></span><span style=\"top:-4.21em;\"><span class=\"pstrut\" style=\"height:3em;\"></span><span class=\"mord\"><span class=\"mord\">5</span></span></span><span style=\"top:-3.01em;\"><span class=\"pstrut\" style=\"height:3em;\"></span><span class=\"mord\"><span class=\"mord\">6</span></span></span><span style=\"top:-1.8099999999999998em;\"><span class=\"pstrut\" style=\"height:3em;\"></span><span class=\"mord\"><span class=\"mord\">1</span><span class=\"mord\">2</span></span></span><span style=\"top:-0.6099999999999997em;\"><span class=\"pstrut\" style=\"height:3em;\"></span><span class=\"mord\"><span class=\"mord\">1</span><span class=\"mord\">8</span></span></span></span><span class=\"vlist-s\">â€‹</span></span><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:2.7500000000000004em;\"><span></span></span></span></span></span><span class=\"arraycolsep\" style=\"width:0.5em;\"></span><span class=\"arraycolsep\" style=\"width:0.5em;\"></span><span class=\"col-align-c\"><span class=\"vlist-t vlist-t2\"><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:3.2500000000000004em;\"><span style=\"top:-5.410000000000001em;\"><span class=\"pstrut\" style=\"height:3em;\"></span><span class=\"mord\"><span class=\"mord\">1</span></span></span><span style=\"top:-4.21em;\"><span class=\"pstrut\" style=\"height:3em;\"></span><span class=\"mord\"><span class=\"mord\">7</span></span></span><span style=\"top:-3.01em;\"><span class=\"pstrut\" style=\"height:3em;\"></span><span class=\"mord\"><span class=\"mord\">1</span><span class=\"mord\">3</span></span></span><span style=\"top:-1.8099999999999998em;\"><span class=\"pstrut\" style=\"height:3em;\"></span><span class=\"mord\"><span class=\"mord\">1</span><span class=\"mord\">9</span></span></span><span style=\"top:-0.6099999999999997em;\"><span class=\"pstrut\" style=\"height:3em;\"></span><span class=\"mord\"><span class=\"mord\">2</span><span class=\"mord\">5</span></span></span></span><span class=\"vlist-s\">â€‹</span></span><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:2.7500000000000004em;\"><span></span></span></span></span></span></span></span><span class=\"mclose\"><span class=\"delimsizing mult\"><span class=\"vlist-t vlist-t2\"><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:3.2549900000000003em;\"><span style=\"top:-1.0499800000000006em;\"><span class=\"pstrut\" style=\"height:3.1550000000000002em;\"></span><span class=\"delimsizinginner delim-size4\"><span>â¦</span></span></span><span style=\"top:-2.1999800000000005em;\"><span class=\"pstrut\" style=\"height:3.1550000000000002em;\"></span><span class=\"delimsizinginner delim-size4\"><span>â¥</span></span></span><span style=\"top:-2.79598em;\"><span class=\"pstrut\" style=\"height:3.1550000000000002em;\"></span><span class=\"delimsizinginner delim-size4\"><span>â¥</span></span></span><span style=\"top:-3.39198em;\"><span class=\"pstrut\" style=\"height:3.1550000000000002em;\"></span><span class=\"delimsizinginner delim-size4\"><span>â¥</span></span></span><span style=\"top:-3.9879800000000003em;\"><span class=\"pstrut\" style=\"height:3.1550000000000002em;\"></span><span class=\"delimsizinginner delim-size4\"><span>â¥</span></span></span><span style=\"top:-4.0139700000000005em;\"><span class=\"pstrut\" style=\"height:3.1550000000000002em;\"></span><span class=\"delimsizinginner delim-size4\"><span>â¥</span></span></span><span style=\"top:-5.25499em;\"><span class=\"pstrut\" style=\"height:3.1550000000000002em;\"></span><span class=\"delimsizinginner delim-size4\"><span>â¤</span></span></span></span><span class=\"vlist-s\">â€‹</span></span><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:2.75004em;\"><span></span></span></span></span></span></span></span><span class=\"mspace\" style=\"margin-right:0.2777777777777778em;\"></span><span class=\"mrel\">=</span><span class=\"mspace\" style=\"margin-right:0.2777777777777778em;\"></span></span><span class=\"base\"><span class=\"strut\" style=\"height:1.20001em;vertical-align:-0.35001em;\"></span><span class=\"minner\"><span class=\"mopen delimcenter\" style=\"top:0em;\"><span class=\"delimsizing size1\">[</span></span><span class=\"mord\"><span class=\"mtable\"><span class=\"col-align-c\"><span class=\"vlist-t vlist-t2\"><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.8500000000000001em;\"><span style=\"top:-3.01em;\"><span class=\"pstrut\" style=\"height:3em;\"></span><span class=\"mord\"><span class=\"mord\">1</span><span class=\"mord\">0</span></span></span></span><span class=\"vlist-s\">â€‹</span></span><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.35000000000000003em;\"><span></span></span></span></span></span><span class=\"arraycolsep\" style=\"width:0.5em;\"></span><span class=\"arraycolsep\" style=\"width:0.5em;\"></span><span class=\"col-align-c\"><span class=\"vlist-t vlist-t2\"><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.8500000000000001em;\"><span style=\"top:-3.01em;\"><span class=\"pstrut\" style=\"height:3em;\"></span><span class=\"mord\"><span class=\"mord\">1</span><span class=\"mord\">2</span></span></span></span><span class=\"vlist-s\">â€‹</span></span><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.35000000000000003em;\"><span></span></span></span></span></span><span class=\"arraycolsep\" style=\"width:0.5em;\"></span><span class=\"arraycolsep\" style=\"width:0.5em;\"></span><span class=\"col-align-c\"><span class=\"vlist-t vlist-t2\"><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.8500000000000001em;\"><span style=\"top:-3.01em;\"><span class=\"pstrut\" style=\"height:3em;\"></span><span class=\"mord\"><span class=\"mord\">1</span><span class=\"mord\">9</span></span></span></span><span class=\"vlist-s\">â€‹</span></span><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.35000000000000003em;\"><span></span></span></span></span></span></span></span><span class=\"mclose delimcenter\" style=\"top:0em;\"><span class=\"delimsizing size1\">]</span></span></span><span class=\"mspace\" style=\"margin-right:1em;\"></span><span class=\"mspace\" style=\"margin-right:0.16666666666666666em;\"></span><span class=\"mord text\"><span class=\"mord cjk_fallback\">å…¬å¼</span><span class=\"mord\">(8)</span></span></span></span></span></span></p>\n<p>é€šè¿‡ä¸Šè¿°è¯å‘é‡çš„è®¡ç®—ï¼Œå¯ä»¥å‘ç°ç¬¬ 4 ä¸ªè¯çš„è¯å‘é‡è¡¨ç¤ºä¸º <span class=\"katex\"><span class=\"katex-mathml\"><math xmlns=\"http://www.w3.org/1998/Math/MathML\"><semantics><mrow><mo stretchy=\"false\">[</mo><mn>10</mn><mtext>â€‰</mtext><mn>12</mn><mtext>â€‰</mtext><mn>19</mn><mo stretchy=\"false\">]</mo></mrow><annotation encoding=\"application/x-tex\">[10\\,12\\,19]</annotation></semantics></math></span><span class=\"katex-html\" aria-hidden=\"true\"><span class=\"base\"><span class=\"strut\" style=\"height:1em;vertical-align:-0.25em;\"></span><span class=\"mopen\">[</span><span class=\"mord\">1</span><span class=\"mord\">0</span><span class=\"mspace\" style=\"margin-right:0.16666666666666666em;\"></span><span class=\"mord\">1</span><span class=\"mord\">2</span><span class=\"mspace\" style=\"margin-right:0.16666666666666666em;\"></span><span class=\"mord\">1</span><span class=\"mord\">9</span><span class=\"mclose\">]</span></span></span></span>ã€‚</p>\n<p>å¦‚æœå†æ¬¡é‡‡ç”¨ä½™å¼¦ç›¸ä¼¼åº¦è®¡ç®—ä¸¤ä¸ªè¯ä¹‹é—´çš„ç›¸ä¼¼åº¦ï¼Œç»“æœä¸å†æ˜¯ 0 ï¼Œæ—¢å¯ä»¥ä¸€å®šç¨‹åº¦ä¸Šæè¿°ä¸¤ä¸ªè¯ä¹‹é—´çš„ç›¸ä¼¼åº¦ã€‚</p>\n<p>ä¸‹å›¾ç»™äº†ç½‘ä¸Šæ‰¾çš„å‡ ä¸ªä¾‹å­ï¼Œå¯ä»¥çœ‹å‡ºæœ‰äº›ä¾‹å­æ•ˆæœè¿˜æ˜¯å¾ˆä¸é”™çš„ï¼Œä¸€ä¸ªå•è¯è¡¨è¾¾æˆ Word Embedding åï¼Œå¾ˆå®¹æ˜“æ‰¾å‡ºè¯­ä¹‰ç›¸è¿‘çš„å…¶å®ƒè¯æ±‡ã€‚</p>\n<p>&lt;img src=&quot;<span class=\"exturl\" data-url=\"aHR0cHM6Ly9pbWdtZC5vc3MtY24tc2hhbmdoYWkuYWxpeXVuY3MuY29tL0JFUlRfSU1HL3dvcmRlbWJlZGRpbmclRTQlQkUlOEIlRTUlQUQlOTAuanBn\">https://imgmd.oss-cn-shanghai.aliyuncs.com/BERT_IMG/wordembedding ä¾‹å­.jpg</span>&quot; style=&quot;zoom:50%;&quot; /&gt;</p>\n<h1 id=\"å››-word2vec-æ¨¡å‹\"><a class=\"anchor\" href=\"#å››-word2vec-æ¨¡å‹\">#</a> å››ã€Word2Vec æ¨¡å‹</h1>\n<p>2013 å¹´æœ€ç«çš„ç”¨è¯­è¨€æ¨¡å‹åš Word Embedding çš„å·¥å…·æ˜¯ Word2Vec ï¼Œåæ¥åˆå‡ºäº† Gloveï¼ˆç”±äº Glove å’Œ Word2Vec çš„ä½œç”¨ç±»ä¼¼ï¼Œå¹¶å¯¹ BERT çš„è®²è§£æ²¡æœ‰ä»€ä¹ˆå¸®åŠ©ï¼Œä¹‹åä¸å†å¤šåŠ å™è¿°ï¼‰ï¼ŒWord2Vec æ˜¯æ€ä¹ˆå·¥ä½œçš„å‘¢ï¼Ÿçœ‹ä¸‹å›¾ï¼š</p>\n<p>&lt;img src=&quot;<span class=\"exturl\" data-url=\"aHR0cHM6Ly9pbWdtZC5vc3MtY24tc2hhbmdoYWkuYWxpeXVuY3MuY29tL0JFUlRfSU1HL3dvcmQydmVjLmpwZw==\">https://imgmd.oss-cn-shanghai.aliyuncs.com/BERT_IMG/word2vec.jpg</span>&quot; style=&quot;zoom:50%;&quot; /&gt;</p>\n<p>Word2Vec çš„ç½‘ç»œç»“æ„å…¶å®å’Œç¥ç»ç½‘ç»œè¯­è¨€æ¨¡å‹ï¼ˆNNLMï¼‰æ˜¯åŸºæœ¬ç±»ä¼¼çš„ï¼Œåªæ˜¯è¿™ä¸ªå›¾é•¿å¾—æ¸…æ™°åº¦å·®äº†ç‚¹ï¼Œçœ‹ä¸Šå»ä¸åƒï¼Œå…¶å®å®ƒä»¬æ˜¯äº²å…„å¼Ÿã€‚ä¸è¿‡è¿™é‡Œéœ€è¦æŒ‡å‡ºï¼šå°½ç®¡ç½‘ç»œç»“æ„ç›¸è¿‘ï¼Œè€Œä¸”éƒ½æ˜¯åšè¯­è¨€æ¨¡å‹ä»»åŠ¡ï¼Œä½†æ˜¯ä»–ä»¬è®­ç»ƒæ–¹æ³•ä¸å¤ªä¸€æ ·ã€‚</p>\n<p>Word2Vec æœ‰ä¸¤ç§è®­ç»ƒæ–¹æ³•ï¼š</p>\n<ol>\n<li>ç¬¬ä¸€ç§å« CBOWï¼Œ<strong>æ ¸å¿ƒæ€æƒ³æ˜¯ä»ä¸€ä¸ªå¥å­é‡Œé¢æŠŠä¸€ä¸ªè¯æŠ æ‰</strong>ï¼Œç”¨è¿™ä¸ªè¯çš„ä¸Šæ–‡å’Œä¸‹æ–‡å»é¢„æµ‹è¢«æŠ æ‰çš„è¿™ä¸ªè¯ï¼›</li>\n<li>ç¬¬äºŒç§å«åš Skip-gramï¼Œå’Œ CBOW æ­£å¥½åè¿‡æ¥ï¼Œè¾“å…¥æŸä¸ªå•è¯ï¼Œè¦æ±‚ç½‘ç»œé¢„æµ‹å®ƒçš„ä¸Šä¸‹æ–‡å•è¯ã€‚</li>\n</ol>\n<p>è€Œä½ å›å¤´çœ‹çœ‹ï¼ŒNNLM æ˜¯æ€ä¹ˆè®­ç»ƒçš„ï¼Ÿæ˜¯è¾“å…¥ä¸€ä¸ªå•è¯çš„ä¸Šæ–‡ï¼Œå»é¢„æµ‹è¿™ä¸ªå•è¯ã€‚è¿™æ˜¯æœ‰æ˜¾è‘—å·®å¼‚çš„ã€‚</p>\n<p>ä¸ºä»€ä¹ˆ Word2Vec è¿™ä¹ˆå¤„ç†ï¼ŸåŸå› å¾ˆç®€å•ï¼Œå› ä¸º Word2Vec å’Œ NNLM ä¸ä¸€æ ·ï¼ŒNNLM çš„ä¸»è¦ä»»åŠ¡æ˜¯è¦å­¦ä¹ ä¸€ä¸ªè§£å†³è¯­è¨€æ¨¡å‹ä»»åŠ¡çš„ç½‘ç»œç»“æ„ï¼Œè¯­è¨€æ¨¡å‹å°±æ˜¯è¦çœ‹åˆ°ä¸Šæ–‡é¢„æµ‹ä¸‹æ–‡ï¼Œè€Œ Word Embedding åªæ˜¯ NNLM æ— å¿ƒæ’æŸ³çš„ä¸€ä¸ªå‰¯äº§å“ï¼›ä½†æ˜¯ Word2Vec ç›®æ ‡ä¸ä¸€æ ·ï¼Œå®ƒå•çº¯å°±æ˜¯è¦ Word Embedding çš„ï¼Œè¿™æ˜¯ä¸»äº§å“ï¼Œæ‰€ä»¥å®ƒå®Œå…¨å¯ä»¥éšæ€§åœ°è¿™ä¹ˆå»è®­ç»ƒç½‘ç»œã€‚</p>\n<p>ä¸ºä»€ä¹ˆè¦è®² Word2Vec å‘¢ï¼Ÿè¿™é‡Œä¸»è¦æ˜¯è¦å¼•å‡º CBOW çš„è®­ç»ƒæ–¹æ³•ï¼ŒBERT å…¶å®è·Ÿå®ƒæœ‰å…³ç³»ï¼Œåé¢ä¼šè®²è§£å®ƒä»¬ä¹‹é—´çš„å…³ç³»ï¼Œå½“ç„¶å®ƒä»¬çš„å…³ç³» BERT ä½œè€…æ²¡è¯´ï¼Œæ˜¯æˆ‘çŒœçš„ï¼Œè‡³äºæˆ‘çŒœçš„å¯¹ä¸å¯¹ï¼Œä½ çœ‹å®Œè¿™ç¯‡æ–‡ç« ä¹‹åå¯ä»¥è‡ªè¡Œåˆ¤æ–­ã€‚</p>\n<h1 id=\"äº”-è‡ªç„¶è¯­è¨€å¤„ç†çš„é¢„è®­ç»ƒæ¨¡å‹\"><a class=\"anchor\" href=\"#äº”-è‡ªç„¶è¯­è¨€å¤„ç†çš„é¢„è®­ç»ƒæ¨¡å‹\">#</a> äº”ã€è‡ªç„¶è¯­è¨€å¤„ç†çš„é¢„è®­ç»ƒæ¨¡å‹</h1>\n<p>çªç„¶åœ¨æ–‡ç« ä¸­æ’å…¥è¿™ä¸€æ®µï¼Œå…¶å®å°±æ˜¯ç»™å‡ºä¸€ä¸ªé—®é¢˜ï¼šWord Embedding è¿™ç§åšæ³•èƒ½ç®—æ˜¯é¢„è®­ç»ƒå—ï¼Ÿè¿™å…¶å®å°±æ˜¯æ ‡å‡†çš„é¢„è®­ç»ƒè¿‡ç¨‹ã€‚è¦ç†è§£è¿™ä¸€ç‚¹è¦çœ‹çœ‹å­¦ä¼š Word Embedding åä¸‹æ¸¸ä»»åŠ¡æ˜¯æ€ä¹ˆä½¿ç”¨å®ƒçš„ã€‚</p>\n<p>&lt;img src=&quot;<span class=\"exturl\" data-url=\"aHR0cHM6Ly9pbWdtZC5vc3MtY24tc2hhbmdoYWkuYWxpeXVuY3MuY29tL0JFUlRfSU1HL3dlJUU2JUE4JUExJUU1JUJDJThGJUU0JUI4JThCJUU3JTlBJTg0JUU5JUEyJTg0JUU4JUFFJUFEJUU3JUJCJTgzLmpwZw==\">https://imgmd.oss-cn-shanghai.aliyuncs.com/BERT_IMG/we æ¨¡å¼ä¸‹çš„é¢„è®­ç»ƒ.jpg</span>&quot; style=&quot;zoom:50%;&quot; /&gt;</p>\n<p>å‡è®¾å¦‚ä¸Šå›¾æ‰€ç¤ºï¼Œæˆ‘ä»¬æœ‰ä¸ª NLP çš„ä¸‹æ¸¸ä»»åŠ¡ï¼Œæ¯”å¦‚ QAï¼Œå°±æ˜¯é—®ç­”é—®é¢˜ï¼Œæ‰€è°“é—®ç­”é—®é¢˜ï¼ŒæŒ‡çš„æ˜¯ç»™å®šä¸€ä¸ªé—®é¢˜ Xï¼Œç»™å®šå¦å¤–ä¸€ä¸ªå¥å­ Yï¼Œè¦åˆ¤æ–­å¥å­ Y æ˜¯å¦æ˜¯é—®é¢˜ X çš„æ­£ç¡®ç­”æ¡ˆã€‚</p>\n<p>é—®ç­”é—®é¢˜å‡è®¾è®¾è®¡çš„ç½‘ç»œç»“æ„å¦‚ä¸Šå›¾æ‰€ç¤ºï¼Œè¿™é‡Œä¸å±•å¼€è®²äº†ï¼Œæ‡‚å¾—è‡ªç„¶æ‡‚ï¼Œä¸æ‡‚çš„ä¹Ÿæ²¡å…³ç³»ï¼Œå› ä¸ºè¿™ç‚¹å¯¹äºæœ¬æ–‡ä¸»æ—¨æ¥è¯´ä¸å…³é”®ï¼Œå…³é”®æ˜¯ç½‘ç»œå¦‚ä½•ä½¿ç”¨è®­ç»ƒå¥½çš„ Word Embedding çš„ã€‚</p>\n<p>å®ƒçš„ä½¿ç”¨æ–¹æ³•å…¶å®å’Œå‰é¢è®²çš„ NNLM æ˜¯ä¸€æ ·çš„ï¼Œå¥å­ä¸­æ¯ä¸ªå•è¯ä»¥ Onehot å½¢å¼ä½œä¸ºè¾“å…¥ï¼Œç„¶åä¹˜ä¸Šå­¦å¥½çš„ Word Embedding çŸ©é˜µ Qï¼Œå°±ç›´æ¥å–å‡ºå•è¯å¯¹åº”çš„ Word Embedding äº†ã€‚</p>\n<p>è¿™ä¹çœ‹ä¸Šå»å¥½åƒæ˜¯ä¸ªæŸ¥è¡¨æ“ä½œï¼Œä¸åƒæ˜¯é¢„è®­ç»ƒçš„åšæ³•æ˜¯å§ï¼Ÿå…¶å®ä¸ç„¶ï¼Œ<strong>é‚£ä¸ª Word Embedding çŸ©é˜µ Q å…¶å®å°±æ˜¯ç½‘ç»œ Onehot å±‚åˆ° embedding å±‚æ˜ å°„çš„ç½‘ç»œå‚æ•°çŸ©é˜µã€‚</strong></p>\n<p>æ‰€ä»¥ä½ çœ‹åˆ°äº†ï¼Œä½¿ç”¨ Word Embedding ç­‰ä»·äºä»€ä¹ˆï¼Ÿç­‰ä»·äºæŠŠ Onehot å±‚åˆ° embedding å±‚çš„ç½‘ç»œç”¨é¢„è®­ç»ƒå¥½çš„å‚æ•°çŸ©é˜µ Q åˆå§‹åŒ–äº†ã€‚è¿™è·Ÿå‰é¢è®²çš„å›¾åƒé¢†åŸŸçš„ä½å±‚é¢„è®­ç»ƒè¿‡ç¨‹å…¶å®æ˜¯ä¸€æ ·çš„ï¼Œ<strong>åŒºåˆ«æ— é Word Embedding åªèƒ½åˆå§‹åŒ–ç¬¬ä¸€å±‚ç½‘ç»œå‚æ•°ï¼Œå†é«˜å±‚çš„å‚æ•°å°±æ— èƒ½ä¸ºåŠ›äº†</strong>ã€‚</p>\n<p>ä¸‹æ¸¸ NLP ä»»åŠ¡åœ¨ä½¿ç”¨ Word Embedding çš„æ—¶å€™ä¹Ÿç±»ä¼¼å›¾åƒæœ‰ä¸¤ç§åšæ³•ï¼Œä¸€ç§æ˜¯ Frozenï¼Œå°±æ˜¯ Word Embedding é‚£å±‚ç½‘ç»œå‚æ•°å›ºå®šä¸åŠ¨ï¼›å¦å¤–ä¸€ç§æ˜¯ Fine-Tuningï¼Œå°±æ˜¯ Word Embedding è¿™å±‚å‚æ•°ä½¿ç”¨æ–°çš„è®­ç»ƒé›†åˆè®­ç»ƒä¹Ÿéœ€è¦è·Ÿç€è®­ç»ƒè¿‡ç¨‹æ›´æ–°æ‰ã€‚</p>\n<p>ä¸Šé¢è¿™ç§åšæ³•å°±æ˜¯ 18 å¹´ä¹‹å‰ NLP é¢†åŸŸé‡Œé¢é‡‡ç”¨é¢„è®­ç»ƒçš„å…¸å‹åšæ³•ï¼Œå¹¶ä¸” Word Embedding å…¶å®å¯¹äºå¾ˆå¤šä¸‹æ¸¸ NLP ä»»åŠ¡æ˜¯æœ‰å¸®åŠ©çš„ï¼Œåªæ˜¯å¸®åŠ©æ²¡æœ‰å¤§åˆ°é—ªçå¿˜è®°æˆ´å¢¨é•œçš„å›´è§‚ç¾¤ä¼—çš„åŒçœ¼è€Œå·²ã€‚</p>\n<h1 id=\"å…­-rnn-å’Œ-lstm\"><a class=\"anchor\" href=\"#å…­-rnn-å’Œ-lstm\">#</a> å…­ã€RNN å’Œ LSTM</h1>\n<p>ä¸ºä»€ä¹ˆè¦åœ¨è¿™é‡Œç©¿æ’ä¸€ä¸ª RNNï¼ˆRecurrent Neural Networkï¼‰ å’Œ LSTMï¼ˆLong Short-Term Memoryï¼‰ å‘¢ï¼Ÿ</p>\n<p>å› ä¸ºæ¥ä¸‹æ¥è¦ä»‹ç»çš„ ELMoï¼ˆEmbeddings from Language Modelsï¼‰ æ¨¡å‹åœ¨è®­ç»ƒè¿‡ç¨‹ä¸­ä½¿ç”¨äº†åŒå‘é•¿çŸ­æœŸè®°å¿†ç½‘ç»œï¼ˆBi-LSTMï¼‰ã€‚</p>\n<p>å½“ç„¶ï¼Œè¿™é‡Œåªæ˜¯ç®€å•åœ°ä»‹ç»ï¼Œæƒ³è¦è¯¦ç»†äº†è§£çš„å¯ä»¥å»æŸ¥çœ‹ç½‘ä¸Šé“ºå¤©ç›–åœ°çš„å‚è€ƒèµ„æ–™ã€‚</p>\n<h2 id=\"61-rnn\"><a class=\"anchor\" href=\"#61-rnn\">#</a> 6.1 RNN</h2>\n<p>ä¼ ç»Ÿçš„ç¥ç»ç½‘ç»œæ— æ³•è·å–æ—¶åºä¿¡æ¯ï¼Œç„¶è€Œ<strong>æ—¶åºä¿¡æ¯åœ¨è‡ªç„¶è¯­è¨€å¤„ç†ä»»åŠ¡ä¸­éå¸¸é‡è¦</strong>ã€‚</p>\n<p>ä¾‹å¦‚å¯¹äºè¿™ä¸€å¥è¯ â€œæˆ‘åƒäº†ä¸€ä¸ªè‹¹æœâ€ï¼Œâ€œè‹¹æœâ€ çš„è¯æ€§å’Œæ„æ€ï¼Œåœ¨è¿™é‡Œå–å†³äºå‰é¢è¯çš„ä¿¡æ¯ï¼Œå¦‚æœæ²¡æœ‰ â€œæˆ‘åƒäº†ä¸€ä¸ªâ€ è¿™äº›è¯ï¼Œâ€œè‹¹æœâ€ ä¹Ÿå¯ä»¥ç¿»è¯‘ä¸ºä¹”å¸ƒæ–¯æå‡ºæ¥çš„é‚£ä¸ªè¢«å’¬äº†ä¸€å£çš„è‹¹æœã€‚</p>\n<p>ä¹Ÿå°±æ˜¯è¯´ï¼ŒRNN çš„å‡ºç°ï¼Œè®©å¤„ç†æ—¶åºä¿¡æ¯å˜ä¸ºå¯èƒ½ã€‚</p>\n<p>RNN çš„åŸºæœ¬å•å…ƒç»“æ„å¦‚ä¸‹å›¾æ‰€ç¤ºï¼š</p>\n<p>&lt;img src=&quot;<span class=\"exturl\" data-url=\"aHR0cHM6Ly9pbWdtZC5vc3MtY24tc2hhbmdoYWkuYWxpeXVuY3MuY29tL0JFUlRfSU1HL1JOTi11bnJvbGxlZC5wbmc=\">https://imgmd.oss-cn-shanghai.aliyuncs.com/BERT_IMG/RNN-unrolled.png</span>&quot; style=&quot;zoom:36%;&quot; /&gt;</p>\n<p>ä¸Šå›¾å·¦è¾¹éƒ¨åˆ†ç§°ä½œ RNN çš„ä¸€ä¸ª timestepï¼Œåœ¨è¿™ä¸ª timestep ä¸­å¯ä»¥çœ‹åˆ°ï¼Œåœ¨ <span class=\"katex\"><span class=\"katex-mathml\"><math xmlns=\"http://www.w3.org/1998/Math/MathML\"><semantics><mrow><mi>t</mi></mrow><annotation encoding=\"application/x-tex\">t</annotation></semantics></math></span><span class=\"katex-html\" aria-hidden=\"true\"><span class=\"base\"><span class=\"strut\" style=\"height:0.61508em;vertical-align:0em;\"></span><span class=\"mord mathnormal\">t</span></span></span></span> æ—¶åˆ»ï¼Œè¾“å…¥å˜é‡ <span class=\"katex\"><span class=\"katex-mathml\"><math xmlns=\"http://www.w3.org/1998/Math/MathML\"><semantics><mrow><msub><mi>x</mi><mi>t</mi></msub></mrow><annotation encoding=\"application/x-tex\">x_t</annotation></semantics></math></span><span class=\"katex-html\" aria-hidden=\"true\"><span class=\"base\"><span class=\"strut\" style=\"height:0.58056em;vertical-align:-0.15em;\"></span><span class=\"mord\"><span class=\"mord mathnormal\">x</span><span class=\"msupsub\"><span class=\"vlist-t vlist-t2\"><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.2805559999999999em;\"><span style=\"top:-2.5500000000000003em;margin-left:0em;margin-right:0.05em;\"><span class=\"pstrut\" style=\"height:2.7em;\"></span><span class=\"sizing reset-size6 size3 mtight\"><span class=\"mord mathnormal mtight\">t</span></span></span></span><span class=\"vlist-s\">â€‹</span></span><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.15em;\"><span></span></span></span></span></span></span></span></span></span>ï¼Œé€šè¿‡ RNN çš„ä¸€ä¸ªåŸºç¡€æ¨¡å— Aï¼Œè¾“å‡ºå˜é‡ <span class=\"katex\"><span class=\"katex-mathml\"><math xmlns=\"http://www.w3.org/1998/Math/MathML\"><semantics><mrow><msub><mi>h</mi><mi>t</mi></msub></mrow><annotation encoding=\"application/x-tex\">h_t</annotation></semantics></math></span><span class=\"katex-html\" aria-hidden=\"true\"><span class=\"base\"><span class=\"strut\" style=\"height:0.84444em;vertical-align:-0.15em;\"></span><span class=\"mord\"><span class=\"mord mathnormal\">h</span><span class=\"msupsub\"><span class=\"vlist-t vlist-t2\"><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.2805559999999999em;\"><span style=\"top:-2.5500000000000003em;margin-left:0em;margin-right:0.05em;\"><span class=\"pstrut\" style=\"height:2.7em;\"></span><span class=\"sizing reset-size6 size3 mtight\"><span class=\"mord mathnormal mtight\">t</span></span></span></span><span class=\"vlist-s\">â€‹</span></span><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.15em;\"><span></span></span></span></span></span></span></span></span></span>ï¼Œè€Œ <span class=\"katex\"><span class=\"katex-mathml\"><math xmlns=\"http://www.w3.org/1998/Math/MathML\"><semantics><mrow><mi>t</mi></mrow><annotation encoding=\"application/x-tex\">t</annotation></semantics></math></span><span class=\"katex-html\" aria-hidden=\"true\"><span class=\"base\"><span class=\"strut\" style=\"height:0.61508em;vertical-align:0em;\"></span><span class=\"mord mathnormal\">t</span></span></span></span> æ—¶åˆ»çš„ä¿¡æ¯ï¼Œå°†ä¼šä¼ é€’åˆ°ä¸‹ä¸€ä¸ªæ—¶åˆ» <span class=\"katex\"><span class=\"katex-mathml\"><math xmlns=\"http://www.w3.org/1998/Math/MathML\"><semantics><mrow><mi>t</mi><mo>+</mo><mn>1</mn></mrow><annotation encoding=\"application/x-tex\">t+1</annotation></semantics></math></span><span class=\"katex-html\" aria-hidden=\"true\"><span class=\"base\"><span class=\"strut\" style=\"height:0.69841em;vertical-align:-0.08333em;\"></span><span class=\"mord mathnormal\">t</span><span class=\"mspace\" style=\"margin-right:0.2222222222222222em;\"></span><span class=\"mbin\">+</span><span class=\"mspace\" style=\"margin-right:0.2222222222222222em;\"></span></span><span class=\"base\"><span class=\"strut\" style=\"height:0.64444em;vertical-align:0em;\"></span><span class=\"mord\">1</span></span></span></span>ã€‚</p>\n<p>å¦‚æœæŠŠæ¨¡å—æŒ‰ç…§æ—¶åºå±•å¼€ï¼Œåˆ™ä¼šå¦‚ä¸Šå›¾å³è¾¹éƒ¨åˆ†æ‰€ç¤ºï¼Œ<strong>ç”±æ­¤å¯ä»¥çœ‹åˆ° RNN ä¸ºå¤šä¸ªåŸºç¡€æ¨¡å— A çš„äº’è¿ï¼Œæ¯ä¸€ä¸ªæ¨¡å—éƒ½ä¼šæŠŠå½“å‰ä¿¡æ¯ä¼ é€’ç»™ä¸‹ä¸€ä¸ªæ¨¡å—</strong>ã€‚</p>\n<p>RNN è§£å†³äº†æ—¶åºä¾èµ–é—®é¢˜ï¼Œä½†è¿™é‡Œçš„æ—¶åºä¸€èˆ¬æŒ‡çš„æ˜¯çŸ­è·ç¦»çš„ï¼Œé¦–å…ˆæˆ‘ä»¬å…ˆä»‹ç»ä¸‹çŸ­è·ç¦»ä¾èµ–å’Œé•¿è·ç¦»ä¾èµ–çš„åŒºåˆ«ï¼š</p>\n<ul>\n<li>çŸ­è·ç¦»ä¾èµ–ï¼šå¯¹äºè¿™ä¸ªå¡«ç©ºé¢˜ â€œæˆ‘æƒ³çœ‹ä¸€åœºç¯®çƒ____â€ï¼Œæˆ‘ä»¬å¾ˆå®¹æ˜“å°±åˆ¤æ–­å‡º â€œç¯®çƒâ€ åé¢è·Ÿçš„æ˜¯ â€œæ¯”èµ›â€ï¼Œè¿™ç§çŸ­è·ç¦»ä¾èµ–é—®é¢˜éå¸¸é€‚åˆ RNNã€‚</li>\n<li>é•¿è·ç¦»ä¾èµ–ï¼šå¯¹äºè¿™ä¸ªå¡«ç©ºé¢˜ â€œæˆ‘å‡ºç”Ÿåœ¨ä¸­å›½çš„ç“·éƒ½æ™¯å¾·é•‡ï¼Œå°å­¦å’Œä¸­å­¦ç¦»å®¶éƒ½å¾ˆè¿‘ï¼Œâ€¦â€¦ï¼Œæˆ‘çš„æ¯è¯­æ˜¯____â€ï¼Œå¯¹äºçŸ­è·ç¦»ä¾èµ–ï¼Œâ€œæˆ‘çš„æ¯è¯­æ˜¯â€ åé¢å¯ä»¥ç´§è·Ÿç€ â€œæ±‰è¯­â€ã€â€œè‹±è¯­â€ã€â€œæ³•è¯­â€ï¼Œä½†æ˜¯å¦‚æœæˆ‘ä»¬æƒ³ç²¾ç¡®ç­”æ¡ˆï¼Œåˆ™å¿…é¡»å›åˆ°ä¸Šæ–‡ä¸­å¾ˆé•¿è·ç¦»ä¹‹å‰çš„è¡¨è¿° â€œæˆ‘å‡ºç”Ÿåœ¨ä¸­å›½çš„ç“·éƒ½æ™¯å¾·é•‡â€ï¼Œè¿›è€Œåˆ¤æ–­ç­”æ¡ˆä¸º â€œæ±‰è¯­â€ï¼Œè€Œ RNN æ˜¯å¾ˆéš¾å­¦ä¹ åˆ°è¿™äº›ä¿¡æ¯çš„ã€‚</li>\n</ul>\n<h2 id=\"62-rnn-çš„æ¢¯åº¦æ¶ˆå¤±é—®é¢˜\"><a class=\"anchor\" href=\"#62-rnn-çš„æ¢¯åº¦æ¶ˆå¤±é—®é¢˜\">#</a> 6.2 RNN çš„æ¢¯åº¦æ¶ˆå¤±é—®é¢˜</h2>\n<p>åœ¨è¿™é‡Œæˆ‘ç®€å•è®²è§£ä¸‹ RNN ä¸ºä»€ä¹ˆä¸é€‚åˆé•¿è·ç¦»ä¾èµ–é—®é¢˜ã€‚</p>\n<p>&lt;img src=&quot;<span class=\"exturl\" data-url=\"aHR0cHM6Ly9pbWdtZC5vc3MtY24tc2hhbmdoYWkuYWxpeXVuY3MuY29tL0JFUlRfSU1HL1JOTiVFNiVBOCVBMSVFNSU5RSU4QiVFNyVCQiU5MyVFNiU5RSU4NC5qcGc=\">https://imgmd.oss-cn-shanghai.aliyuncs.com/BERT_IMG/RNN æ¨¡å‹ç»“æ„.jpg</span>&quot; style=&quot;zoom:50%;&quot; /&gt;</p>\n<p>å¦‚ä¸Šå›¾æ‰€ç¤ºï¼Œä¸º RNN æ¨¡å‹ç»“æ„ï¼Œå‰å‘ä¼ æ’­è¿‡ç¨‹åŒ…æ‹¬ï¼š</p>\n<ul (t)=\"\">\n<li><strong>éšè—çŠ¶æ€ï¼š</strong><span class=\"katex\"><span class=\"katex-mathml\"><math xmlns=\"http://www.w3.org/1998/Math/MathML\"><semantics><mrow><msup><mi>h</mi><mrow><mo stretchy=\"false\">(</mo><mi>t</mi><mo stretchy=\"false\">)</mo></mrow></msup><mo>=</mo><mi>Ïƒ</mi><mo stretchy=\"false\">(</mo><msup><mi>z</mi><mrow><mo stretchy=\"false\">(</mo><mi>t</mi><mo stretchy=\"false\">)</mo></mrow></msup><mo stretchy=\"false\">)</mo><mo>=</mo><mi>Ïƒ</mi><mo stretchy=\"false\">(</mo><mi>U</mi><msup><mi>x</mi><mrow><mo stretchy=\"false\">(</mo><mi>t</mi><mo stretchy=\"false\">)</mo></mrow></msup><mo>+</mo><mi>W</mi><msup><mi>h</mi><mrow><mo stretchy=\"false\">(</mo><mi>t</mi><mo>âˆ’</mo><mn>1</mn><mo stretchy=\"false\">)</mo></mrow></msup><mo>+</mo><mi>b</mi><mo stretchy=\"false\">)</mo></mrow><annotation encoding=\"application/x-tex\">h^{(t)} = \\sigma (z^{(t)}) = \\sigma(Ux^{(t)} + Wh^{(t-1)} + b)</annotation></semantics></math></span><span class=\"katex-html\" aria-hidden=\"true\"><span class=\"base\"><span class=\"strut\" style=\"height:0.8879999999999999em;vertical-align:0em;\"></span><span class=\"mord\"><span class=\"mord mathnormal\">h</span><span class=\"msupsub\"><span class=\"vlist-t\"><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.8879999999999999em;\"><span style=\"top:-3.063em;margin-right:0.05em;\"><span class=\"pstrut\" style=\"height:2.7em;\"></span><span class=\"sizing reset-size6 size3 mtight\"><span class=\"mord mtight\"><span class=\"mopen mtight\">(</span><span class=\"mord mathnormal mtight\">t</span><span class=\"mclose mtight\">)</span></span></span></span></span></span></span></span></span><span class=\"mspace\" style=\"margin-right:0.2777777777777778em;\"></span><span class=\"mrel\">=</span><span class=\"mspace\" style=\"margin-right:0.2777777777777778em;\"></span></span><span class=\"base\"><span class=\"strut\" style=\"height:1.138em;vertical-align:-0.25em;\"></span><span class=\"mord mathnormal\" style=\"margin-right:0.03588em;\">Ïƒ</span><span class=\"mopen\">(</span><span class=\"mord\"><span class=\"mord mathnormal\" style=\"margin-right:0.04398em;\">z</span><span class=\"msupsub\"><span class=\"vlist-t\"><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.8879999999999999em;\"><span style=\"top:-3.063em;margin-right:0.05em;\"><span class=\"pstrut\" style=\"height:2.7em;\"></span><span class=\"sizing reset-size6 size3 mtight\"><span class=\"mord mtight\"><span class=\"mopen mtight\">(</span><span class=\"mord mathnormal mtight\">t</span><span class=\"mclose mtight\">)</span></span></span></span></span></span></span></span></span><span class=\"mclose\">)</span><span class=\"mspace\" style=\"margin-right:0.2777777777777778em;\"></span><span class=\"mrel\">=</span><span class=\"mspace\" style=\"margin-right:0.2777777777777778em;\"></span></span><span class=\"base\"><span class=\"strut\" style=\"height:1.138em;vertical-align:-0.25em;\"></span><span class=\"mord mathnormal\" style=\"margin-right:0.03588em;\">Ïƒ</span><span class=\"mopen\">(</span><span class=\"mord mathnormal\" style=\"margin-right:0.10903em;\">U</span><span class=\"mord\"><span class=\"mord mathnormal\">x</span><span class=\"msupsub\"><span class=\"vlist-t\"><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.8879999999999999em;\"><span style=\"top:-3.063em;margin-right:0.05em;\"><span class=\"pstrut\" style=\"height:2.7em;\"></span><span class=\"sizing reset-size6 size3 mtight\"><span class=\"mord mtight\"><span class=\"mopen mtight\">(</span><span class=\"mord mathnormal mtight\">t</span><span class=\"mclose mtight\">)</span></span></span></span></span></span></span></span></span><span class=\"mspace\" style=\"margin-right:0.2222222222222222em;\"></span><span class=\"mbin\">+</span><span class=\"mspace\" style=\"margin-right:0.2222222222222222em;\"></span></span><span class=\"base\"><span class=\"strut\" style=\"height:0.9713299999999999em;vertical-align:-0.08333em;\"></span><span class=\"mord mathnormal\" style=\"margin-right:0.13889em;\">W</span><span class=\"mord\"><span class=\"mord mathnormal\">h</span><span class=\"msupsub\"><span class=\"vlist-t\"><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.8879999999999999em;\"><span style=\"top:-3.063em;margin-right:0.05em;\"><span class=\"pstrut\" style=\"height:2.7em;\"></span><span class=\"sizing reset-size6 size3 mtight\"><span class=\"mord mtight\"><span class=\"mopen mtight\">(</span><span class=\"mord mathnormal mtight\">t</span><span class=\"mbin mtight\">âˆ’</span><span class=\"mord mtight\">1</span><span class=\"mclose mtight\">)</span></span></span></span></span></span></span></span></span><span class=\"mspace\" style=\"margin-right:0.2222222222222222em;\"></span><span class=\"mbin\">+</span><span class=\"mspace\" style=\"margin-right:0.2222222222222222em;\"></span></span><span class=\"base\"><span class=\"strut\" style=\"height:1em;vertical-align:-0.25em;\"></span><span class=\"mord mathnormal\">b</span><span class=\"mclose\">)</span></span></span></span> ï¼Œæ­¤å¤„æ¿€æ´»å‡½æ•°ä¸€èˆ¬ä¸º <span class=\"katex\"><span class=\"katex-mathml\"><math xmlns=\"http://www.w3.org/1998/Math/MathML\"><semantics><mrow><mi>t</mi><mi>a</mi><mi>n</mi><mi>h</mi></mrow><annotation encoding=\"application/x-tex\">tanh</annotation></semantics></math></span><span class=\"katex-html\" aria-hidden=\"true\"><span class=\"base\"><span class=\"strut\" style=\"height:0.69444em;vertical-align:0em;\"></span><span class=\"mord mathnormal\">t</span><span class=\"mord mathnormal\">a</span><span class=\"mord mathnormal\">n</span><span class=\"mord mathnormal\">h</span></span></span></span> ã€‚</li>\n<li><strong>æ¨¡å‹è¾“å‡ºï¼š</strong><span class=\"katex\"><span class=\"katex-mathml\"><math xmlns=\"http://www.w3.org/1998/Math/MathML\"><semantics><mrow><msup><mi>o</mi><mrow><mo stretchy=\"false\">(</mo><mi>t</mi><mo stretchy=\"false\">)</mo></mrow></msup><mo>=</mo><mi>V</mi><msup><mi>h</mi><mrow><mo stretchy=\"false\">(</mo><mi>t</mi><mo stretchy=\"false\">)</mo></mrow></msup><mo>+</mo><mi>c</mi></mrow><annotation encoding=\"application/x-tex\">o^{(t)} = Vh^{(t)} + c</annotation></semantics></math></span><span class=\"katex-html\" aria-hidden=\"true\"><span class=\"base\"><span class=\"strut\" style=\"height:0.8879999999999999em;vertical-align:0em;\"></span><span class=\"mord\"><span class=\"mord mathnormal\">o</span><span class=\"msupsub\"><span class=\"vlist-t\"><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.8879999999999999em;\"><span style=\"top:-3.063em;margin-right:0.05em;\"><span class=\"pstrut\" style=\"height:2.7em;\"></span><span class=\"sizing reset-size6 size3 mtight\"><span class=\"mord mtight\"><span class=\"mopen mtight\">(</span><span class=\"mord mathnormal mtight\">t</span><span class=\"mclose mtight\">)</span></span></span></span></span></span></span></span></span><span class=\"mspace\" style=\"margin-right:0.2777777777777778em;\"></span><span class=\"mrel\">=</span><span class=\"mspace\" style=\"margin-right:0.2777777777777778em;\"></span></span><span class=\"base\"><span class=\"strut\" style=\"height:0.9713299999999999em;vertical-align:-0.08333em;\"></span><span class=\"mord mathnormal\" style=\"margin-right:0.22222em;\">V</span><span class=\"mord\"><span class=\"mord mathnormal\">h</span><span class=\"msupsub\"><span class=\"vlist-t\"><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.8879999999999999em;\"><span style=\"top:-3.063em;margin-right:0.05em;\"><span class=\"pstrut\" style=\"height:2.7em;\"></span><span class=\"sizing reset-size6 size3 mtight\"><span class=\"mord mtight\"><span class=\"mopen mtight\">(</span><span class=\"mord mathnormal mtight\">t</span><span class=\"mclose mtight\">)</span></span></span></span></span></span></span></span></span><span class=\"mspace\" style=\"margin-right:0.2222222222222222em;\"></span><span class=\"mbin\">+</span><span class=\"mspace\" style=\"margin-right:0.2222222222222222em;\"></span></span><span class=\"base\"><span class=\"strut\" style=\"height:0.43056em;vertical-align:0em;\"></span><span class=\"mord mathnormal\">c</span></span></span></span></li>\n<li><strong>é¢„æµ‹è¾“å‡ºï¼š</strong><span class=\"katex\"><span class=\"katex-mathml\"><math xmlns=\"http://www.w3.org/1998/Math/MathML\"><semantics><mrow><msup><mover accent=\"true\"><mi>y</mi><mo>^</mo></mover><mrow><mo stretchy=\"false\">(</mo><mi>t</mi><mo stretchy=\"false\">)</mo></mrow></msup><mo>=</mo><mi>Ïƒ</mi><mo stretchy=\"false\">(</mo><msup><mi>o</mi><mrow><mo stretchy=\"false\">(</mo><mi>t</mi><mo stretchy=\"false\">)</mo></mrow></msup><mo stretchy=\"false\">)</mo></mrow><annotation encoding=\"application/x-tex\">\\hat{y}^{(t)} = \\sigma(o^{(t)})</annotation></semantics></math></span><span class=\"katex-html\" aria-hidden=\"true\"><span class=\"base\"><span class=\"strut\" style=\"height:1.0824399999999998em;vertical-align:-0.19444em;\"></span><span class=\"mord\"><span class=\"mord accent\"><span class=\"vlist-t vlist-t2\"><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.69444em;\"><span style=\"top:-3em;\"><span class=\"pstrut\" style=\"height:3em;\"></span><span class=\"mord\"><span class=\"mord mathnormal\" style=\"margin-right:0.03588em;\">y</span></span></span><span style=\"top:-3em;\"><span class=\"pstrut\" style=\"height:3em;\"></span><span class=\"accent-body\" style=\"left:-0.19444em;\"><span class=\"mord\">^</span></span></span></span><span class=\"vlist-s\">â€‹</span></span><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.19444em;\"><span></span></span></span></span></span><span class=\"msupsub\"><span class=\"vlist-t\"><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.8879999999999999em;\"><span style=\"top:-3.063em;margin-right:0.05em;\"><span class=\"pstrut\" style=\"height:2.7em;\"></span><span class=\"sizing reset-size6 size3 mtight\"><span class=\"mord mtight\"><span class=\"mopen mtight\">(</span><span class=\"mord mathnormal mtight\">t</span><span class=\"mclose mtight\">)</span></span></span></span></span></span></span></span></span><span class=\"mspace\" style=\"margin-right:0.2777777777777778em;\"></span><span class=\"mrel\">=</span><span class=\"mspace\" style=\"margin-right:0.2777777777777778em;\"></span></span><span class=\"base\"><span class=\"strut\" style=\"height:1.138em;vertical-align:-0.25em;\"></span><span class=\"mord mathnormal\" style=\"margin-right:0.03588em;\">Ïƒ</span><span class=\"mopen\">(</span><span class=\"mord\"><span class=\"mord mathnormal\">o</span><span class=\"msupsub\"><span class=\"vlist-t\"><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.8879999999999999em;\"><span style=\"top:-3.063em;margin-right:0.05em;\"><span class=\"pstrut\" style=\"height:2.7em;\"></span><span class=\"sizing reset-size6 size3 mtight\"><span class=\"mord mtight\"><span class=\"mopen mtight\">(</span><span class=\"mord mathnormal mtight\">t</span><span class=\"mclose mtight\">)</span></span></span></span></span></span></span></span></span><span class=\"mclose\">)</span></span></span></span> ï¼Œæ­¤å¤„æ¿€æ´»å‡½æ•°ä¸€èˆ¬ä¸º softmaxã€‚</li>\n<li><strong>æ¨¡å‹æŸå¤±ï¼š</strong>L = \\sum_{t = 1}^{T} L^</li>\n</ul>\n<p>RNN æ‰€æœ‰çš„ timestep å…±äº«ä¸€å¥—å‚æ•° <span class=\"katex\"><span class=\"katex-mathml\"><math xmlns=\"http://www.w3.org/1998/Math/MathML\"><semantics><mrow><mi>U</mi><mo separator=\"true\">,</mo><mi>V</mi><mo separator=\"true\">,</mo><mi>W</mi></mrow><annotation encoding=\"application/x-tex\">U,V,W</annotation></semantics></math></span><span class=\"katex-html\" aria-hidden=\"true\"><span class=\"base\"><span class=\"strut\" style=\"height:0.8777699999999999em;vertical-align:-0.19444em;\"></span><span class=\"mord mathnormal\" style=\"margin-right:0.10903em;\">U</span><span class=\"mpunct\">,</span><span class=\"mspace\" style=\"margin-right:0.16666666666666666em;\"></span><span class=\"mord mathnormal\" style=\"margin-right:0.22222em;\">V</span><span class=\"mpunct\">,</span><span class=\"mspace\" style=\"margin-right:0.16666666666666666em;\"></span><span class=\"mord mathnormal\" style=\"margin-right:0.13889em;\">W</span></span></span></span>ï¼Œåœ¨ RNN åå‘ä¼ æ’­è¿‡ç¨‹ä¸­ï¼Œéœ€è¦è®¡ç®— <span class=\"katex\"><span class=\"katex-mathml\"><math xmlns=\"http://www.w3.org/1998/Math/MathML\"><semantics><mrow><mi>U</mi><mo separator=\"true\">,</mo><mi>V</mi><mo separator=\"true\">,</mo><mi>W</mi></mrow><annotation encoding=\"application/x-tex\">U,V,W</annotation></semantics></math></span><span class=\"katex-html\" aria-hidden=\"true\"><span class=\"base\"><span class=\"strut\" style=\"height:0.8777699999999999em;vertical-align:-0.19444em;\"></span><span class=\"mord mathnormal\" style=\"margin-right:0.10903em;\">U</span><span class=\"mpunct\">,</span><span class=\"mspace\" style=\"margin-right:0.16666666666666666em;\"></span><span class=\"mord mathnormal\" style=\"margin-right:0.22222em;\">V</span><span class=\"mpunct\">,</span><span class=\"mspace\" style=\"margin-right:0.16666666666666666em;\"></span><span class=\"mord mathnormal\" style=\"margin-right:0.13889em;\">W</span></span></span></span> ç­‰å‚æ•°çš„æ¢¯åº¦ï¼Œä»¥ <span class=\"katex\"><span class=\"katex-mathml\"><math xmlns=\"http://www.w3.org/1998/Math/MathML\"><semantics><mrow><mi>W</mi></mrow><annotation encoding=\"application/x-tex\">W</annotation></semantics></math></span><span class=\"katex-html\" aria-hidden=\"true\"><span class=\"base\"><span class=\"strut\" style=\"height:0.68333em;vertical-align:0em;\"></span><span class=\"mord mathnormal\" style=\"margin-right:0.13889em;\">W</span></span></span></span> çš„æ¢¯åº¦è¡¨è¾¾å¼ä¸ºä¾‹ï¼ˆå‡è®¾ RNN æ¨¡å‹çš„æŸå¤±å‡½æ•°ä¸º <span class=\"katex\"><span class=\"katex-mathml\"><math xmlns=\"http://www.w3.org/1998/Math/MathML\"><semantics><mrow><mi>L</mi></mrow><annotation encoding=\"application/x-tex\">L</annotation></semantics></math></span><span class=\"katex-html\" aria-hidden=\"true\"><span class=\"base\"><span class=\"strut\" style=\"height:0.68333em;vertical-align:0em;\"></span><span class=\"mord mathnormal\">L</span></span></span></span>ï¼‰ï¼š</p>\n<p><span class=\"katex-display\"><span class=\"katex\"><span class=\"katex-mathml\"><math xmlns=\"http://www.w3.org/1998/Math/MathML\" display=\"block\"><semantics><mrow><mfrac><mrow><mi mathvariant=\"normal\">âˆ‚</mi><mi>L</mi></mrow><mrow><mi mathvariant=\"normal\">âˆ‚</mi><mi>W</mi></mrow></mfrac><mo>=</mo><munderover><mo>âˆ‘</mo><mrow><mi>t</mi><mo>=</mo><mn>1</mn></mrow><mi>T</mi></munderover><mfrac><mrow><mi mathvariant=\"normal\">âˆ‚</mi><mi>L</mi></mrow><mrow><mi mathvariant=\"normal\">âˆ‚</mi><msup><mi>y</mi><mrow><mo stretchy=\"false\">(</mo><mi>T</mi><mo stretchy=\"false\">)</mo></mrow></msup></mrow></mfrac><mfrac><mrow><mi mathvariant=\"normal\">âˆ‚</mi><msup><mi>y</mi><mrow><mo stretchy=\"false\">(</mo><mi>T</mi><mo stretchy=\"false\">)</mo></mrow></msup></mrow><mrow><mi mathvariant=\"normal\">âˆ‚</mi><msup><mi>o</mi><mrow><mo stretchy=\"false\">(</mo><mi>T</mi><mo stretchy=\"false\">)</mo></mrow></msup></mrow></mfrac><mfrac><mrow><mi mathvariant=\"normal\">âˆ‚</mi><msup><mi>o</mi><mrow><mo stretchy=\"false\">(</mo><mi>T</mi><mo stretchy=\"false\">)</mo></mrow></msup></mrow><mrow><mi mathvariant=\"normal\">âˆ‚</mi><msup><mi>h</mi><mrow><mo stretchy=\"false\">(</mo><mi>T</mi><mo stretchy=\"false\">)</mo></mrow></msup></mrow></mfrac><mrow><mo fence=\"true\">(</mo><munderover><mo>âˆ</mo><mrow><mi>k</mi><mo>=</mo><mi>t</mi><mo>+</mo><mn>1</mn></mrow><mi>T</mi></munderover><mfrac><mrow><mi mathvariant=\"normal\">âˆ‚</mi><msup><mi>h</mi><mrow><mo stretchy=\"false\">(</mo><mi>k</mi><mo stretchy=\"false\">)</mo></mrow></msup></mrow><mrow><mi mathvariant=\"normal\">âˆ‚</mi><msup><mi>h</mi><mrow><mo stretchy=\"false\">(</mo><mi>k</mi><mo>âˆ’</mo><mn>1</mn><mo stretchy=\"false\">)</mo></mrow></msup></mrow></mfrac><mo fence=\"true\">)</mo></mrow><mfrac><mrow><mi mathvariant=\"normal\">âˆ‚</mi><msup><mi>h</mi><mrow><mo stretchy=\"false\">(</mo><mi>t</mi><mo stretchy=\"false\">)</mo></mrow></msup></mrow><mrow><mi mathvariant=\"normal\">âˆ‚</mi><mi>W</mi></mrow></mfrac><mtext>Â </mtext><mspace linebreak=\"newline\"></mspace><mo>=</mo><munderover><mo>âˆ‘</mo><mrow><mi>t</mi><mo>=</mo><mn>1</mn></mrow><mi>T</mi></munderover><mfrac><mrow><mi mathvariant=\"normal\">âˆ‚</mi><mi>L</mi></mrow><mrow><mi mathvariant=\"normal\">âˆ‚</mi><msup><mi>y</mi><mrow><mo stretchy=\"false\">(</mo><mi>T</mi><mo stretchy=\"false\">)</mo></mrow></msup></mrow></mfrac><mfrac><mrow><mi mathvariant=\"normal\">âˆ‚</mi><msup><mi>y</mi><mrow><mo stretchy=\"false\">(</mo><mi>T</mi><mo stretchy=\"false\">)</mo></mrow></msup></mrow><mrow><mi mathvariant=\"normal\">âˆ‚</mi><msup><mi>o</mi><mrow><mo stretchy=\"false\">(</mo><mi>T</mi><mo stretchy=\"false\">)</mo></mrow></msup></mrow></mfrac><mfrac><mrow><mi mathvariant=\"normal\">âˆ‚</mi><msup><mi>o</mi><mrow><mo stretchy=\"false\">(</mo><mi>T</mi><mo stretchy=\"false\">)</mo></mrow></msup></mrow><mrow><mi mathvariant=\"normal\">âˆ‚</mi><msup><mi>h</mi><mrow><mo stretchy=\"false\">(</mo><mi>T</mi><mo stretchy=\"false\">)</mo></mrow></msup></mrow></mfrac><mrow><mo fence=\"true\">(</mo><munderover><mo>âˆ</mo><mrow><mi>k</mi><mo>=</mo><mi>t</mi><mo>+</mo><mn>1</mn></mrow><mi>T</mi></munderover><mi>t</mi><mi>a</mi><mi>n</mi><msup><mi>h</mi><msup><mrow></mrow><mo mathvariant=\"normal\" lspace=\"0em\" rspace=\"0em\">â€²</mo></msup></msup><mo stretchy=\"false\">(</mo><msup><mi>z</mi><mrow><mo stretchy=\"false\">(</mo><mi>k</mi><mo stretchy=\"false\">)</mo></mrow></msup><mo stretchy=\"false\">)</mo><mi>W</mi><mo fence=\"true\">)</mo></mrow><mfrac><mrow><mi mathvariant=\"normal\">âˆ‚</mi><msup><mi>h</mi><mrow><mo stretchy=\"false\">(</mo><mi>t</mi><mo stretchy=\"false\">)</mo></mrow></msup></mrow><mrow><mi mathvariant=\"normal\">âˆ‚</mi><mi>W</mi></mrow></mfrac><mtext>Â </mtext><mspace linebreak=\"newline\"></mspace><mspace width=\"1em\"/><mtext>å…¬å¼(9)</mtext></mrow><annotation encoding=\"application/x-tex\">\\frac{\\partial L}{\\partial W} \n= \\sum_{t = 1}^{T} \\frac{\\partial L}{\\partial y^{(T)}} \\frac{\\partial y^{(T)}}{\\partial o^{(T)}} \\frac{\\partial o^{(T)}}{\\partial h^{(T)}} \\left( \\prod_{k=t + 1}^{T} \\frac{\\partial h^{(k)}}{\\partial h^{(k - 1)}} \\right) \\frac{\\partial h^{(t)}}{\\partial W} \\  \\\\ \n= \\sum_{t = 1}^{T} \\frac{\\partial L}{\\partial y^{(T)}} \\frac{\\partial y^{(T)}}{\\partial o^{(T)}} \\frac{\\partial o^{(T)}}{\\partial h^{(T)}} \\left( \\prod_{k=t+1}^{T} tanh^{&#x27;}(z^{(k)}) W \\right) \\frac{\\partial h^{(t)}}{\\partial W} \\  \\\\\n\\quad\\text{å…¬å¼(9)}\n</annotation></semantics></math></span><span class=\"katex-html\" aria-hidden=\"true\"><span class=\"base\"><span class=\"strut\" style=\"height:2.05744em;vertical-align:-0.686em;\"></span><span class=\"mord\"><span class=\"mopen nulldelimiter\"></span><span class=\"mfrac\"><span class=\"vlist-t vlist-t2\"><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:1.37144em;\"><span style=\"top:-2.314em;\"><span class=\"pstrut\" style=\"height:3em;\"></span><span class=\"mord\"><span class=\"mord\" style=\"margin-right:0.05556em;\">âˆ‚</span><span class=\"mord mathnormal\" style=\"margin-right:0.13889em;\">W</span></span></span><span style=\"top:-3.23em;\"><span class=\"pstrut\" style=\"height:3em;\"></span><span class=\"frac-line\" style=\"border-bottom-width:0.04em;\"></span></span><span style=\"top:-3.677em;\"><span class=\"pstrut\" style=\"height:3em;\"></span><span class=\"mord\"><span class=\"mord\" style=\"margin-right:0.05556em;\">âˆ‚</span><span class=\"mord mathnormal\">L</span></span></span></span><span class=\"vlist-s\">â€‹</span></span><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.686em;\"><span></span></span></span></span></span><span class=\"mclose nulldelimiter\"></span></span><span class=\"mspace\" style=\"margin-right:0.2777777777777778em;\"></span><span class=\"mrel\">=</span><span class=\"mspace\" style=\"margin-right:0.2777777777777778em;\"></span></span><span class=\"base\"><span class=\"strut\" style=\"height:3.1887800000000004em;vertical-align:-1.360444em;\"></span><span class=\"mop op-limits\"><span class=\"vlist-t vlist-t2\"><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:1.8283360000000002em;\"><span style=\"top:-1.882887em;margin-left:0em;\"><span class=\"pstrut\" style=\"height:3.05em;\"></span><span class=\"sizing reset-size6 size3 mtight\"><span class=\"mord mtight\"><span class=\"mord mathnormal mtight\">t</span><span class=\"mrel mtight\">=</span><span class=\"mord mtight\">1</span></span></span></span><span style=\"top:-3.050005em;\"><span class=\"pstrut\" style=\"height:3.05em;\"></span><span><span class=\"mop op-symbol large-op\">âˆ‘</span></span></span><span style=\"top:-4.3000050000000005em;margin-left:0em;\"><span class=\"pstrut\" style=\"height:3.05em;\"></span><span class=\"sizing reset-size6 size3 mtight\"><span class=\"mord mtight\"><span class=\"mord mathnormal mtight\" style=\"margin-right:0.13889em;\">T</span></span></span></span></span><span class=\"vlist-s\">â€‹</span></span><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:1.267113em;\"><span></span></span></span></span></span><span class=\"mspace\" style=\"margin-right:0.16666666666666666em;\"></span><span class=\"mord\"><span class=\"mopen nulldelimiter\"></span><span class=\"mfrac\"><span class=\"vlist-t vlist-t2\"><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:1.37144em;\"><span style=\"top:-2.2960000000000003em;\"><span class=\"pstrut\" style=\"height:3em;\"></span><span class=\"mord\"><span class=\"mord\" style=\"margin-right:0.05556em;\">âˆ‚</span><span class=\"mord\"><span class=\"mord mathnormal\" style=\"margin-right:0.03588em;\">y</span><span class=\"msupsub\"><span class=\"vlist-t\"><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.814em;\"><span style=\"top:-2.989em;margin-right:0.05em;\"><span class=\"pstrut\" style=\"height:2.7em;\"></span><span class=\"sizing reset-size6 size3 mtight\"><span class=\"mord mtight\"><span class=\"mopen mtight\">(</span><span class=\"mord mathnormal mtight\" style=\"margin-right:0.13889em;\">T</span><span class=\"mclose mtight\">)</span></span></span></span></span></span></span></span></span></span></span><span style=\"top:-3.23em;\"><span class=\"pstrut\" style=\"height:3em;\"></span><span class=\"frac-line\" style=\"border-bottom-width:0.04em;\"></span></span><span style=\"top:-3.677em;\"><span class=\"pstrut\" style=\"height:3em;\"></span><span class=\"mord\"><span class=\"mord\" style=\"margin-right:0.05556em;\">âˆ‚</span><span class=\"mord mathnormal\">L</span></span></span></span><span class=\"vlist-s\">â€‹</span></span><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.8984399999999999em;\"><span></span></span></span></span></span><span class=\"mclose nulldelimiter\"></span></span><span class=\"mord\"><span class=\"mopen nulldelimiter\"></span><span class=\"mfrac\"><span class=\"vlist-t vlist-t2\"><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:1.565em;\"><span style=\"top:-2.2960000000000003em;\"><span class=\"pstrut\" style=\"height:3em;\"></span><span class=\"mord\"><span class=\"mord\" style=\"margin-right:0.05556em;\">âˆ‚</span><span class=\"mord\"><span class=\"mord mathnormal\">o</span><span class=\"msupsub\"><span class=\"vlist-t\"><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.814em;\"><span style=\"top:-2.989em;margin-right:0.05em;\"><span class=\"pstrut\" style=\"height:2.7em;\"></span><span class=\"sizing reset-size6 size3 mtight\"><span class=\"mord mtight\"><span class=\"mopen mtight\">(</span><span class=\"mord mathnormal mtight\" style=\"margin-right:0.13889em;\">T</span><span class=\"mclose mtight\">)</span></span></span></span></span></span></span></span></span></span></span><span style=\"top:-3.23em;\"><span class=\"pstrut\" style=\"height:3em;\"></span><span class=\"frac-line\" style=\"border-bottom-width:0.04em;\"></span></span><span style=\"top:-3.677em;\"><span class=\"pstrut\" style=\"height:3em;\"></span><span class=\"mord\"><span class=\"mord\" style=\"margin-right:0.05556em;\">âˆ‚</span><span class=\"mord\"><span class=\"mord mathnormal\" style=\"margin-right:0.03588em;\">y</span><span class=\"msupsub\"><span class=\"vlist-t\"><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.8879999999999999em;\"><span style=\"top:-3.063em;margin-right:0.05em;\"><span class=\"pstrut\" style=\"height:2.7em;\"></span><span class=\"sizing reset-size6 size3 mtight\"><span class=\"mord mtight\"><span class=\"mopen mtight\">(</span><span class=\"mord mathnormal mtight\" style=\"margin-right:0.13889em;\">T</span><span class=\"mclose mtight\">)</span></span></span></span></span></span></span></span></span></span></span></span><span class=\"vlist-s\">â€‹</span></span><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.704em;\"><span></span></span></span></span></span><span class=\"mclose nulldelimiter\"></span></span><span class=\"mord\"><span class=\"mopen nulldelimiter\"></span><span class=\"mfrac\"><span class=\"vlist-t vlist-t2\"><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:1.565em;\"><span style=\"top:-2.2960000000000003em;\"><span class=\"pstrut\" style=\"height:3em;\"></span><span class=\"mord\"><span class=\"mord\" style=\"margin-right:0.05556em;\">âˆ‚</span><span class=\"mord\"><span class=\"mord mathnormal\">h</span><span class=\"msupsub\"><span class=\"vlist-t\"><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.814em;\"><span style=\"top:-2.989em;margin-right:0.05em;\"><span class=\"pstrut\" style=\"height:2.7em;\"></span><span class=\"sizing reset-size6 size3 mtight\"><span class=\"mord mtight\"><span class=\"mopen mtight\">(</span><span class=\"mord mathnormal mtight\" style=\"margin-right:0.13889em;\">T</span><span class=\"mclose mtight\">)</span></span></span></span></span></span></span></span></span></span></span><span style=\"top:-3.23em;\"><span class=\"pstrut\" style=\"height:3em;\"></span><span class=\"frac-line\" style=\"border-bottom-width:0.04em;\"></span></span><span style=\"top:-3.677em;\"><span class=\"pstrut\" style=\"height:3em;\"></span><span class=\"mord\"><span class=\"mord\" style=\"margin-right:0.05556em;\">âˆ‚</span><span class=\"mord\"><span class=\"mord mathnormal\">o</span><span class=\"msupsub\"><span class=\"vlist-t\"><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.8879999999999999em;\"><span style=\"top:-3.063em;margin-right:0.05em;\"><span class=\"pstrut\" style=\"height:2.7em;\"></span><span class=\"sizing reset-size6 size3 mtight\"><span class=\"mord mtight\"><span class=\"mopen mtight\">(</span><span class=\"mord mathnormal mtight\" style=\"margin-right:0.13889em;\">T</span><span class=\"mclose mtight\">)</span></span></span></span></span></span></span></span></span></span></span></span><span class=\"vlist-s\">â€‹</span></span><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.704em;\"><span></span></span></span></span></span><span class=\"mclose nulldelimiter\"></span></span><span class=\"mspace\" style=\"margin-right:0.16666666666666666em;\"></span><span class=\"minner\"><span class=\"mopen delimcenter\" style=\"top:0em;\"><span class=\"delimsizing size4\">(</span></span><span class=\"mop op-limits\"><span class=\"vlist-t vlist-t2\"><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:1.8283360000000002em;\"><span style=\"top:-1.8478869999999998em;margin-left:0em;\"><span class=\"pstrut\" style=\"height:3.05em;\"></span><span class=\"sizing reset-size6 size3 mtight\"><span class=\"mord mtight\"><span class=\"mord mathnormal mtight\" style=\"margin-right:0.03148em;\">k</span><span class=\"mrel mtight\">=</span><span class=\"mord mathnormal mtight\">t</span><span class=\"mbin mtight\">+</span><span class=\"mord mtight\">1</span></span></span></span><span style=\"top:-3.0500049999999996em;\"><span class=\"pstrut\" style=\"height:3.05em;\"></span><span><span class=\"mop op-symbol large-op\">âˆ</span></span></span><span style=\"top:-4.300005em;margin-left:0em;\"><span class=\"pstrut\" style=\"height:3.05em;\"></span><span class=\"sizing reset-size6 size3 mtight\"><span class=\"mord mtight\"><span class=\"mord mathnormal mtight\" style=\"margin-right:0.13889em;\">T</span></span></span></span></span><span class=\"vlist-s\">â€‹</span></span><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:1.360444em;\"><span></span></span></span></span></span><span class=\"mspace\" style=\"margin-right:0.16666666666666666em;\"></span><span class=\"mord\"><span class=\"mopen nulldelimiter\"></span><span class=\"mfrac\"><span class=\"vlist-t vlist-t2\"><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:1.565em;\"><span style=\"top:-2.2960000000000003em;\"><span class=\"pstrut\" style=\"height:3em;\"></span><span class=\"mord\"><span class=\"mord\" style=\"margin-right:0.05556em;\">âˆ‚</span><span class=\"mord\"><span class=\"mord mathnormal\">h</span><span class=\"msupsub\"><span class=\"vlist-t\"><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.814em;\"><span style=\"top:-2.989em;margin-right:0.05em;\"><span class=\"pstrut\" style=\"height:2.7em;\"></span><span class=\"sizing reset-size6 size3 mtight\"><span class=\"mord mtight\"><span class=\"mopen mtight\">(</span><span class=\"mord mathnormal mtight\" style=\"margin-right:0.03148em;\">k</span><span class=\"mbin mtight\">âˆ’</span><span class=\"mord mtight\">1</span><span class=\"mclose mtight\">)</span></span></span></span></span></span></span></span></span></span></span><span style=\"top:-3.23em;\"><span class=\"pstrut\" style=\"height:3em;\"></span><span class=\"frac-line\" style=\"border-bottom-width:0.04em;\"></span></span><span style=\"top:-3.677em;\"><span class=\"pstrut\" style=\"height:3em;\"></span><span class=\"mord\"><span class=\"mord\" style=\"margin-right:0.05556em;\">âˆ‚</span><span class=\"mord\"><span class=\"mord mathnormal\">h</span><span class=\"msupsub\"><span class=\"vlist-t\"><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.8879999999999999em;\"><span style=\"top:-3.063em;margin-right:0.05em;\"><span class=\"pstrut\" style=\"height:2.7em;\"></span><span class=\"sizing reset-size6 size3 mtight\"><span class=\"mord mtight\"><span class=\"mopen mtight\">(</span><span class=\"mord mathnormal mtight\" style=\"margin-right:0.03148em;\">k</span><span class=\"mclose mtight\">)</span></span></span></span></span></span></span></span></span></span></span></span><span class=\"vlist-s\">â€‹</span></span><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.704em;\"><span></span></span></span></span></span><span class=\"mclose nulldelimiter\"></span></span><span class=\"mclose delimcenter\" style=\"top:0em;\"><span class=\"delimsizing size4\">)</span></span></span><span class=\"mspace\" style=\"margin-right:0.16666666666666666em;\"></span><span class=\"mord\"><span class=\"mopen nulldelimiter\"></span><span class=\"mfrac\"><span class=\"vlist-t vlist-t2\"><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:1.565em;\"><span style=\"top:-2.314em;\"><span class=\"pstrut\" style=\"height:3em;\"></span><span class=\"mord\"><span class=\"mord\" style=\"margin-right:0.05556em;\">âˆ‚</span><span class=\"mord mathnormal\" style=\"margin-right:0.13889em;\">W</span></span></span><span style=\"top:-3.23em;\"><span class=\"pstrut\" style=\"height:3em;\"></span><span class=\"frac-line\" style=\"border-bottom-width:0.04em;\"></span></span><span style=\"top:-3.677em;\"><span class=\"pstrut\" style=\"height:3em;\"></span><span class=\"mord\"><span class=\"mord\" style=\"margin-right:0.05556em;\">âˆ‚</span><span class=\"mord\"><span class=\"mord mathnormal\">h</span><span class=\"msupsub\"><span class=\"vlist-t\"><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.8879999999999999em;\"><span style=\"top:-3.063em;margin-right:0.05em;\"><span class=\"pstrut\" style=\"height:2.7em;\"></span><span class=\"sizing reset-size6 size3 mtight\"><span class=\"mord mtight\"><span class=\"mopen mtight\">(</span><span class=\"mord mathnormal mtight\">t</span><span class=\"mclose mtight\">)</span></span></span></span></span></span></span></span></span></span></span></span><span class=\"vlist-s\">â€‹</span></span><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.686em;\"><span></span></span></span></span></span><span class=\"mclose nulldelimiter\"></span></span><span class=\"mspace\">Â </span></span><span class=\"mspace newline\"></span><span class=\"base\"><span class=\"strut\" style=\"height:0.36687em;vertical-align:0em;\"></span><span class=\"mrel\">=</span><span class=\"mspace\" style=\"margin-right:0.2777777777777778em;\"></span></span><span class=\"base\"><span class=\"strut\" style=\"height:3.1887800000000004em;vertical-align:-1.360444em;\"></span><span class=\"mop op-limits\"><span class=\"vlist-t vlist-t2\"><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:1.8283360000000002em;\"><span style=\"top:-1.882887em;margin-left:0em;\"><span class=\"pstrut\" style=\"height:3.05em;\"></span><span class=\"sizing reset-size6 size3 mtight\"><span class=\"mord mtight\"><span class=\"mord mathnormal mtight\">t</span><span class=\"mrel mtight\">=</span><span class=\"mord mtight\">1</span></span></span></span><span style=\"top:-3.050005em;\"><span class=\"pstrut\" style=\"height:3.05em;\"></span><span><span class=\"mop op-symbol large-op\">âˆ‘</span></span></span><span style=\"top:-4.3000050000000005em;margin-left:0em;\"><span class=\"pstrut\" style=\"height:3.05em;\"></span><span class=\"sizing reset-size6 size3 mtight\"><span class=\"mord mtight\"><span class=\"mord mathnormal mtight\" style=\"margin-right:0.13889em;\">T</span></span></span></span></span><span class=\"vlist-s\">â€‹</span></span><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:1.267113em;\"><span></span></span></span></span></span><span class=\"mspace\" style=\"margin-right:0.16666666666666666em;\"></span><span class=\"mord\"><span class=\"mopen nulldelimiter\"></span><span class=\"mfrac\"><span class=\"vlist-t vlist-t2\"><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:1.37144em;\"><span style=\"top:-2.2960000000000003em;\"><span class=\"pstrut\" style=\"height:3em;\"></span><span class=\"mord\"><span class=\"mord\" style=\"margin-right:0.05556em;\">âˆ‚</span><span class=\"mord\"><span class=\"mord mathnormal\" style=\"margin-right:0.03588em;\">y</span><span class=\"msupsub\"><span class=\"vlist-t\"><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.814em;\"><span style=\"top:-2.989em;margin-right:0.05em;\"><span class=\"pstrut\" style=\"height:2.7em;\"></span><span class=\"sizing reset-size6 size3 mtight\"><span class=\"mord mtight\"><span class=\"mopen mtight\">(</span><span class=\"mord mathnormal mtight\" style=\"margin-right:0.13889em;\">T</span><span class=\"mclose mtight\">)</span></span></span></span></span></span></span></span></span></span></span><span style=\"top:-3.23em;\"><span class=\"pstrut\" style=\"height:3em;\"></span><span class=\"frac-line\" style=\"border-bottom-width:0.04em;\"></span></span><span style=\"top:-3.677em;\"><span class=\"pstrut\" style=\"height:3em;\"></span><span class=\"mord\"><span class=\"mord\" style=\"margin-right:0.05556em;\">âˆ‚</span><span class=\"mord mathnormal\">L</span></span></span></span><span class=\"vlist-s\">â€‹</span></span><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.8984399999999999em;\"><span></span></span></span></span></span><span class=\"mclose nulldelimiter\"></span></span><span class=\"mord\"><span class=\"mopen nulldelimiter\"></span><span class=\"mfrac\"><span class=\"vlist-t vlist-t2\"><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:1.565em;\"><span style=\"top:-2.2960000000000003em;\"><span class=\"pstrut\" style=\"height:3em;\"></span><span class=\"mord\"><span class=\"mord\" style=\"margin-right:0.05556em;\">âˆ‚</span><span class=\"mord\"><span class=\"mord mathnormal\">o</span><span class=\"msupsub\"><span class=\"vlist-t\"><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.814em;\"><span style=\"top:-2.989em;margin-right:0.05em;\"><span class=\"pstrut\" style=\"height:2.7em;\"></span><span class=\"sizing reset-size6 size3 mtight\"><span class=\"mord mtight\"><span class=\"mopen mtight\">(</span><span class=\"mord mathnormal mtight\" style=\"margin-right:0.13889em;\">T</span><span class=\"mclose mtight\">)</span></span></span></span></span></span></span></span></span></span></span><span style=\"top:-3.23em;\"><span class=\"pstrut\" style=\"height:3em;\"></span><span class=\"frac-line\" style=\"border-bottom-width:0.04em;\"></span></span><span style=\"top:-3.677em;\"><span class=\"pstrut\" style=\"height:3em;\"></span><span class=\"mord\"><span class=\"mord\" style=\"margin-right:0.05556em;\">âˆ‚</span><span class=\"mord\"><span class=\"mord mathnormal\" style=\"margin-right:0.03588em;\">y</span><span class=\"msupsub\"><span class=\"vlist-t\"><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.8879999999999999em;\"><span style=\"top:-3.063em;margin-right:0.05em;\"><span class=\"pstrut\" style=\"height:2.7em;\"></span><span class=\"sizing reset-size6 size3 mtight\"><span class=\"mord mtight\"><span class=\"mopen mtight\">(</span><span class=\"mord mathnormal mtight\" style=\"margin-right:0.13889em;\">T</span><span class=\"mclose mtight\">)</span></span></span></span></span></span></span></span></span></span></span></span><span class=\"vlist-s\">â€‹</span></span><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.704em;\"><span></span></span></span></span></span><span class=\"mclose nulldelimiter\"></span></span><span class=\"mord\"><span class=\"mopen nulldelimiter\"></span><span class=\"mfrac\"><span class=\"vlist-t vlist-t2\"><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:1.565em;\"><span style=\"top:-2.2960000000000003em;\"><span class=\"pstrut\" style=\"height:3em;\"></span><span class=\"mord\"><span class=\"mord\" style=\"margin-right:0.05556em;\">âˆ‚</span><span class=\"mord\"><span class=\"mord mathnormal\">h</span><span class=\"msupsub\"><span class=\"vlist-t\"><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.814em;\"><span style=\"top:-2.989em;margin-right:0.05em;\"><span class=\"pstrut\" style=\"height:2.7em;\"></span><span class=\"sizing reset-size6 size3 mtight\"><span class=\"mord mtight\"><span class=\"mopen mtight\">(</span><span class=\"mord mathnormal mtight\" style=\"margin-right:0.13889em;\">T</span><span class=\"mclose mtight\">)</span></span></span></span></span></span></span></span></span></span></span><span style=\"top:-3.23em;\"><span class=\"pstrut\" style=\"height:3em;\"></span><span class=\"frac-line\" style=\"border-bottom-width:0.04em;\"></span></span><span style=\"top:-3.677em;\"><span class=\"pstrut\" style=\"height:3em;\"></span><span class=\"mord\"><span class=\"mord\" style=\"margin-right:0.05556em;\">âˆ‚</span><span class=\"mord\"><span class=\"mord mathnormal\">o</span><span class=\"msupsub\"><span class=\"vlist-t\"><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.8879999999999999em;\"><span style=\"top:-3.063em;margin-right:0.05em;\"><span class=\"pstrut\" style=\"height:2.7em;\"></span><span class=\"sizing reset-size6 size3 mtight\"><span class=\"mord mtight\"><span class=\"mopen mtight\">(</span><span class=\"mord mathnormal mtight\" style=\"margin-right:0.13889em;\">T</span><span class=\"mclose mtight\">)</span></span></span></span></span></span></span></span></span></span></span></span><span class=\"vlist-s\">â€‹</span></span><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.704em;\"><span></span></span></span></span></span><span class=\"mclose nulldelimiter\"></span></span><span class=\"mspace\" style=\"margin-right:0.16666666666666666em;\"></span><span class=\"minner\"><span class=\"mopen delimcenter\" style=\"top:0em;\"><span class=\"delimsizing size4\">(</span></span><span class=\"mop op-limits\"><span class=\"vlist-t vlist-t2\"><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:1.8283360000000002em;\"><span style=\"top:-1.8478869999999998em;margin-left:0em;\"><span class=\"pstrut\" style=\"height:3.05em;\"></span><span class=\"sizing reset-size6 size3 mtight\"><span class=\"mord mtight\"><span class=\"mord mathnormal mtight\" style=\"margin-right:0.03148em;\">k</span><span class=\"mrel mtight\">=</span><span class=\"mord mathnormal mtight\">t</span><span class=\"mbin mtight\">+</span><span class=\"mord mtight\">1</span></span></span></span><span style=\"top:-3.0500049999999996em;\"><span class=\"pstrut\" style=\"height:3.05em;\"></span><span><span class=\"mop op-symbol large-op\">âˆ</span></span></span><span style=\"top:-4.300005em;margin-left:0em;\"><span class=\"pstrut\" style=\"height:3.05em;\"></span><span class=\"sizing reset-size6 size3 mtight\"><span class=\"mord mtight\"><span class=\"mord mathnormal mtight\" style=\"margin-right:0.13889em;\">T</span></span></span></span></span><span class=\"vlist-s\">â€‹</span></span><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:1.360444em;\"><span></span></span></span></span></span><span class=\"mspace\" style=\"margin-right:0.16666666666666666em;\"></span><span class=\"mord mathnormal\">t</span><span class=\"mord mathnormal\">a</span><span class=\"mord mathnormal\">n</span><span class=\"mord\"><span class=\"mord mathnormal\">h</span><span class=\"msupsub\"><span class=\"vlist-t\"><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.99248em;\"><span style=\"top:-2.99248em;margin-right:0.05em;\"><span class=\"pstrut\" style=\"height:2.57948em;\"></span><span class=\"sizing reset-size6 size3 mtight\"><span class=\"mord mtight\"><span class=\"mord mtight\"><span></span><span class=\"msupsub\"><span class=\"vlist-t\"><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.8278285714285715em;\"><span style=\"top:-2.931em;margin-right:0.07142857142857144em;\"><span class=\"pstrut\" style=\"height:2.5em;\"></span><span class=\"sizing reset-size3 size1 mtight\"><span class=\"mord mtight\"><span class=\"mord mtight\">â€²</span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span><span class=\"mopen\">(</span><span class=\"mord\"><span class=\"mord mathnormal\" style=\"margin-right:0.04398em;\">z</span><span class=\"msupsub\"><span class=\"vlist-t\"><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.938em;\"><span style=\"top:-3.113em;margin-right:0.05em;\"><span class=\"pstrut\" style=\"height:2.7em;\"></span><span class=\"sizing reset-size6 size3 mtight\"><span class=\"mord mtight\"><span class=\"mopen mtight\">(</span><span class=\"mord mathnormal mtight\" style=\"margin-right:0.03148em;\">k</span><span class=\"mclose mtight\">)</span></span></span></span></span></span></span></span></span><span class=\"mclose\">)</span><span class=\"mord mathnormal\" style=\"margin-right:0.13889em;\">W</span><span class=\"mclose delimcenter\" style=\"top:0em;\"><span class=\"delimsizing size4\">)</span></span></span><span class=\"mspace\" style=\"margin-right:0.16666666666666666em;\"></span><span class=\"mord\"><span class=\"mopen nulldelimiter\"></span><span class=\"mfrac\"><span class=\"vlist-t vlist-t2\"><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:1.565em;\"><span style=\"top:-2.314em;\"><span class=\"pstrut\" style=\"height:3em;\"></span><span class=\"mord\"><span class=\"mord\" style=\"margin-right:0.05556em;\">âˆ‚</span><span class=\"mord mathnormal\" style=\"margin-right:0.13889em;\">W</span></span></span><span style=\"top:-3.23em;\"><span class=\"pstrut\" style=\"height:3em;\"></span><span class=\"frac-line\" style=\"border-bottom-width:0.04em;\"></span></span><span style=\"top:-3.677em;\"><span class=\"pstrut\" style=\"height:3em;\"></span><span class=\"mord\"><span class=\"mord\" style=\"margin-right:0.05556em;\">âˆ‚</span><span class=\"mord\"><span class=\"mord mathnormal\">h</span><span class=\"msupsub\"><span class=\"vlist-t\"><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.8879999999999999em;\"><span style=\"top:-3.063em;margin-right:0.05em;\"><span class=\"pstrut\" style=\"height:2.7em;\"></span><span class=\"sizing reset-size6 size3 mtight\"><span class=\"mord mtight\"><span class=\"mopen mtight\">(</span><span class=\"mord mathnormal mtight\">t</span><span class=\"mclose mtight\">)</span></span></span></span></span></span></span></span></span></span></span></span><span class=\"vlist-s\">â€‹</span></span><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.686em;\"><span></span></span></span></span></span><span class=\"mclose nulldelimiter\"></span></span><span class=\"mspace\">Â </span></span><span class=\"mspace newline\"></span><span class=\"base\"><span class=\"strut\" style=\"height:1em;vertical-align:-0.25em;\"></span><span class=\"mspace\" style=\"margin-right:1em;\"></span><span class=\"mord text\"><span class=\"mord cjk_fallback\">å…¬å¼</span><span class=\"mord\">(9)</span></span></span></span></span></span></p>\n<p>å¯¹äºå…¬å¼ï¼ˆ9ï¼‰ä¸­çš„ <span class=\"katex\"><span class=\"katex-mathml\"><math xmlns=\"http://www.w3.org/1998/Math/MathML\"><semantics><mrow><mrow><mo fence=\"true\">(</mo><msubsup><mo>âˆ</mo><mrow><mi>k</mi><mo>=</mo><mi>t</mi><mo>+</mo><mn>1</mn></mrow><mi>T</mi></msubsup><mfrac><mrow><mi mathvariant=\"normal\">âˆ‚</mi><msup><mi>h</mi><mrow><mo stretchy=\"false\">(</mo><mi>k</mi><mo stretchy=\"false\">)</mo></mrow></msup></mrow><mrow><mi mathvariant=\"normal\">âˆ‚</mi><msup><mi>h</mi><mrow><mo stretchy=\"false\">(</mo><mi>k</mi><mo>âˆ’</mo><mn>1</mn><mo stretchy=\"false\">)</mo></mrow></msup></mrow></mfrac><mo fence=\"true\">)</mo></mrow><mo>=</mo><mrow><mo fence=\"true\">(</mo><msubsup><mo>âˆ</mo><mrow><mi>k</mi><mo>=</mo><mi>t</mi><mo>+</mo><mn>1</mn></mrow><mi>T</mi></msubsup><mi>t</mi><mi>a</mi><mi>n</mi><msup><mi>h</mi><msup><mrow></mrow><mo mathvariant=\"normal\" lspace=\"0em\" rspace=\"0em\">â€²</mo></msup></msup><mo stretchy=\"false\">(</mo><msup><mi>z</mi><mrow><mo stretchy=\"false\">(</mo><mi>k</mi><mo stretchy=\"false\">)</mo></mrow></msup><mo stretchy=\"false\">)</mo><mi>W</mi><mo fence=\"true\">)</mo></mrow></mrow><annotation encoding=\"application/x-tex\">\\left( \\prod_{k=t + 1}^{T} \\frac{\\partial h^{(k)}}{\\partial h^{(k - 1)}} \\right) = \\left( \\prod_{k=t+1}^{T} tanh^{&#x27;}(z^{(k)}) W \\right)</annotation></semantics></math></span><span class=\"katex-html\" aria-hidden=\"true\"><span class=\"base\"><span class=\"strut\" style=\"height:1.80002em;vertical-align:-0.65002em;\"></span><span class=\"minner\"><span class=\"mopen delimcenter\" style=\"top:0em;\"><span class=\"delimsizing size2\">(</span></span><span class=\"mop\"><span class=\"mop op-symbol small-op\" style=\"position:relative;top:-0.0000050000000000050004em;\">âˆ</span><span class=\"msupsub\"><span class=\"vlist-t vlist-t2\"><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.981231em;\"><span style=\"top:-2.40029em;margin-left:0em;margin-right:0.05em;\"><span class=\"pstrut\" style=\"height:2.7em;\"></span><span class=\"sizing reset-size6 size3 mtight\"><span class=\"mord mtight\"><span class=\"mord mathnormal mtight\" style=\"margin-right:0.03148em;\">k</span><span class=\"mrel mtight\">=</span><span class=\"mord mathnormal mtight\">t</span><span class=\"mbin mtight\">+</span><span class=\"mord mtight\">1</span></span></span></span><span style=\"top:-3.2029em;margin-right:0.05em;\"><span class=\"pstrut\" style=\"height:2.7em;\"></span><span class=\"sizing reset-size6 size3 mtight\"><span class=\"mord mtight\"><span class=\"mord mathnormal mtight\" style=\"margin-right:0.13889em;\">T</span></span></span></span></span><span class=\"vlist-s\">â€‹</span></span><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.35804100000000005em;\"><span></span></span></span></span></span></span><span class=\"mspace\" style=\"margin-right:0.16666666666666666em;\"></span><span class=\"mord\"><span class=\"mopen nulldelimiter\"></span><span class=\"mfrac\"><span class=\"vlist-t vlist-t2\"><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:1.0707em;\"><span style=\"top:-2.614575em;\"><span class=\"pstrut\" style=\"height:3em;\"></span><span class=\"sizing reset-size6 size3 mtight\"><span class=\"mord mtight\"><span class=\"mord mtight\" style=\"margin-right:0.05556em;\">âˆ‚</span><span class=\"mord mtight\"><span class=\"mord mathnormal mtight\">h</span><span class=\"msupsub\"><span class=\"vlist-t\"><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.8220357142857143em;\"><span style=\"top:-2.8220357142857138em;margin-right:0.07142857142857144em;\"><span class=\"pstrut\" style=\"height:2.5357142857142856em;\"></span><span class=\"sizing reset-size3 size1 mtight\"><span class=\"mord mtight\"><span class=\"mopen mtight\">(</span><span class=\"mord mathnormal mtight\" style=\"margin-right:0.03148em;\">k</span><span class=\"mbin mtight\">âˆ’</span><span class=\"mord mtight\">1</span><span class=\"mclose mtight\">)</span></span></span></span></span></span></span></span></span></span></span></span><span style=\"top:-3.23em;\"><span class=\"pstrut\" style=\"height:3em;\"></span><span class=\"frac-line\" style=\"border-bottom-width:0.04em;\"></span></span><span style=\"top:-3.394em;\"><span class=\"pstrut\" style=\"height:3em;\"></span><span class=\"sizing reset-size6 size3 mtight\"><span class=\"mord mtight\"><span class=\"mord mtight\" style=\"margin-right:0.05556em;\">âˆ‚</span><span class=\"mord mtight\"><span class=\"mord mathnormal mtight\">h</span><span class=\"msupsub\"><span class=\"vlist-t\"><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.9667142857142857em;\"><span style=\"top:-2.966714285714285em;margin-right:0.07142857142857144em;\"><span class=\"pstrut\" style=\"height:2.5357142857142856em;\"></span><span class=\"sizing reset-size3 size1 mtight\"><span class=\"mord mtight\"><span class=\"mopen mtight\">(</span><span class=\"mord mathnormal mtight\" style=\"margin-right:0.03148em;\">k</span><span class=\"mclose mtight\">)</span></span></span></span></span></span></span></span></span></span></span></span></span><span class=\"vlist-s\">â€‹</span></span><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.38542499999999996em;\"><span></span></span></span></span></span><span class=\"mclose nulldelimiter\"></span></span><span class=\"mclose delimcenter\" style=\"top:0em;\"><span class=\"delimsizing size2\">)</span></span></span><span class=\"mspace\" style=\"margin-right:0.2777777777777778em;\"></span><span class=\"mrel\">=</span><span class=\"mspace\" style=\"margin-right:0.2777777777777778em;\"></span></span><span class=\"base\"><span class=\"strut\" style=\"height:1.80002em;vertical-align:-0.65002em;\"></span><span class=\"minner\"><span class=\"mopen delimcenter\" style=\"top:0em;\"><span class=\"delimsizing size2\">(</span></span><span class=\"mop\"><span class=\"mop op-symbol small-op\" style=\"position:relative;top:-0.0000050000000000050004em;\">âˆ</span><span class=\"msupsub\"><span class=\"vlist-t vlist-t2\"><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.981231em;\"><span style=\"top:-2.40029em;margin-left:0em;margin-right:0.05em;\"><span class=\"pstrut\" style=\"height:2.7em;\"></span><span class=\"sizing reset-size6 size3 mtight\"><span class=\"mord mtight\"><span class=\"mord mathnormal mtight\" style=\"margin-right:0.03148em;\">k</span><span class=\"mrel mtight\">=</span><span class=\"mord mathnormal mtight\">t</span><span class=\"mbin mtight\">+</span><span class=\"mord mtight\">1</span></span></span></span><span style=\"top:-3.2029em;margin-right:0.05em;\"><span class=\"pstrut\" style=\"height:2.7em;\"></span><span class=\"sizing reset-size6 size3 mtight\"><span class=\"mord mtight\"><span class=\"mord mathnormal mtight\" style=\"margin-right:0.13889em;\">T</span></span></span></span></span><span class=\"vlist-s\">â€‹</span></span><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.35804100000000005em;\"><span></span></span></span></span></span></span><span class=\"mspace\" style=\"margin-right:0.16666666666666666em;\"></span><span class=\"mord mathnormal\">t</span><span class=\"mord mathnormal\">a</span><span class=\"mord mathnormal\">n</span><span class=\"mord\"><span class=\"mord mathnormal\">h</span><span class=\"msupsub\"><span class=\"vlist-t\"><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.94248em;\"><span style=\"top:-2.94248em;margin-right:0.05em;\"><span class=\"pstrut\" style=\"height:2.57948em;\"></span><span class=\"sizing reset-size6 size3 mtight\"><span class=\"mord mtight\"><span class=\"mord mtight\"><span></span><span class=\"msupsub\"><span class=\"vlist-t\"><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.8278285714285715em;\"><span style=\"top:-2.931em;margin-right:0.07142857142857144em;\"><span class=\"pstrut\" style=\"height:2.5em;\"></span><span class=\"sizing reset-size3 size1 mtight\"><span class=\"mord mtight\"><span class=\"mord mtight\">â€²</span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span><span class=\"mopen\">(</span><span class=\"mord\"><span class=\"mord mathnormal\" style=\"margin-right:0.04398em;\">z</span><span class=\"msupsub\"><span class=\"vlist-t\"><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.8879999999999999em;\"><span style=\"top:-3.063em;margin-right:0.05em;\"><span class=\"pstrut\" style=\"height:2.7em;\"></span><span class=\"sizing reset-size6 size3 mtight\"><span class=\"mord mtight\"><span class=\"mopen mtight\">(</span><span class=\"mord mathnormal mtight\" style=\"margin-right:0.03148em;\">k</span><span class=\"mclose mtight\">)</span></span></span></span></span></span></span></span></span><span class=\"mclose\">)</span><span class=\"mord mathnormal\" style=\"margin-right:0.13889em;\">W</span><span class=\"mclose delimcenter\" style=\"top:0em;\"><span class=\"delimsizing size2\">)</span></span></span></span></span></span>ï¼Œ<span class=\"katex\"><span class=\"katex-mathml\"><math xmlns=\"http://www.w3.org/1998/Math/MathML\"><semantics><mrow><mi>tanh</mi><mo>â¡</mo></mrow><annotation encoding=\"application/x-tex\">\\tanh</annotation></semantics></math></span><span class=\"katex-html\" aria-hidden=\"true\"><span class=\"base\"><span class=\"strut\" style=\"height:0.69444em;vertical-align:0em;\"></span><span class=\"mop\">tanh</span></span></span></span> çš„å¯¼æ•°æ€»æ˜¯å°äº 1 çš„ï¼Œç”±äºæ˜¯ <span class=\"katex\"><span class=\"katex-mathml\"><math xmlns=\"http://www.w3.org/1998/Math/MathML\"><semantics><mrow><mi>T</mi><mo>âˆ’</mo><mo stretchy=\"false\">(</mo><mi>t</mi><mo>+</mo><mn>1</mn><mo stretchy=\"false\">)</mo></mrow><annotation encoding=\"application/x-tex\">T-(t+1)</annotation></semantics></math></span><span class=\"katex-html\" aria-hidden=\"true\"><span class=\"base\"><span class=\"strut\" style=\"height:0.76666em;vertical-align:-0.08333em;\"></span><span class=\"mord mathnormal\" style=\"margin-right:0.13889em;\">T</span><span class=\"mspace\" style=\"margin-right:0.2222222222222222em;\"></span><span class=\"mbin\">âˆ’</span><span class=\"mspace\" style=\"margin-right:0.2222222222222222em;\"></span></span><span class=\"base\"><span class=\"strut\" style=\"height:1em;vertical-align:-0.25em;\"></span><span class=\"mopen\">(</span><span class=\"mord mathnormal\">t</span><span class=\"mspace\" style=\"margin-right:0.2222222222222222em;\"></span><span class=\"mbin\">+</span><span class=\"mspace\" style=\"margin-right:0.2222222222222222em;\"></span></span><span class=\"base\"><span class=\"strut\" style=\"height:1em;vertical-align:-0.25em;\"></span><span class=\"mord\">1</span><span class=\"mclose\">)</span></span></span></span> ä¸ª timestep å‚æ•°çš„è¿ä¹˜ï¼Œ<strong>å¦‚æœ <span class=\"katex\"><span class=\"katex-mathml\"><math xmlns=\"http://www.w3.org/1998/Math/MathML\"><semantics><mrow><mi>W</mi></mrow><annotation encoding=\"application/x-tex\">W</annotation></semantics></math></span><span class=\"katex-html\" aria-hidden=\"true\"><span class=\"base\"><span class=\"strut\" style=\"height:0.68333em;vertical-align:0em;\"></span><span class=\"mord mathnormal\" style=\"margin-right:0.13889em;\">W</span></span></span></span> çš„ä¸»ç‰¹å¾å€¼å°äº 1ï¼Œæ¢¯åº¦ä¾¿ä¼šæ¶ˆå¤±ï¼›å¦‚æœ <span class=\"katex\"><span class=\"katex-mathml\"><math xmlns=\"http://www.w3.org/1998/Math/MathML\"><semantics><mrow><mi>W</mi></mrow><annotation encoding=\"application/x-tex\">W</annotation></semantics></math></span><span class=\"katex-html\" aria-hidden=\"true\"><span class=\"base\"><span class=\"strut\" style=\"height:0.68333em;vertical-align:0em;\"></span><span class=\"mord mathnormal\" style=\"margin-right:0.13889em;\">W</span></span></span></span> çš„ç‰¹å¾å€¼å¤§äº 1ï¼Œæ¢¯åº¦ä¾¿ä¼šçˆ†ç‚¸ã€‚</strong></p>\n<p>éœ€è¦æ³¨æ„çš„æ˜¯ï¼ŒRNN å’Œ DNN æ¢¯åº¦æ¶ˆå¤±å’Œæ¢¯åº¦çˆ†ç‚¸å«ä¹‰å¹¶ä¸ç›¸åŒã€‚</p>\n<p>RNN ä¸­æƒé‡åœ¨å„æ—¶é—´æ­¥å†…å…±äº«ï¼Œæœ€ç»ˆçš„æ¢¯åº¦æ˜¯å„ä¸ªæ—¶é—´æ­¥çš„æ¢¯åº¦å’Œï¼Œæ¢¯åº¦å’Œä¼šè¶Šæ¥è¶Šå¤§ã€‚å› æ­¤ï¼ŒRNN ä¸­æ€»çš„æ¢¯åº¦æ˜¯ä¸ä¼šæ¶ˆå¤±çš„ï¼Œå³ä½¿æ¢¯åº¦è¶Šä¼ è¶Šå¼±ï¼Œä¹Ÿåªæ˜¯è¿œè·ç¦»çš„æ¢¯åº¦æ¶ˆå¤±ã€‚ ä»å…¬å¼ï¼ˆ9ï¼‰ä¸­çš„ <span class=\"katex\"><span class=\"katex-mathml\"><math xmlns=\"http://www.w3.org/1998/Math/MathML\"><semantics><mrow><mo fence=\"true\">(</mo><msubsup><mo>âˆ</mo><mrow><mi>k</mi><mo>=</mo><mi>t</mi><mo>+</mo><mn>1</mn></mrow><mi>T</mi></msubsup><mi>t</mi><mi>a</mi><mi>n</mi><msup><mi>h</mi><msup><mrow></mrow><mo mathvariant=\"normal\" lspace=\"0em\" rspace=\"0em\">â€²</mo></msup></msup><mo stretchy=\"false\">(</mo><msup><mi>z</mi><mrow><mo stretchy=\"false\">(</mo><mi>k</mi><mo stretchy=\"false\">)</mo></mrow></msup><mo stretchy=\"false\">)</mo><mi>W</mi><mo fence=\"true\">)</mo></mrow><annotation encoding=\"application/x-tex\">\\left( \\prod_{k=t+1}^{T} tanh^{&#x27;}(z^{(k)}) W \\right)</annotation></semantics></math></span><span class=\"katex-html\" aria-hidden=\"true\"><span class=\"base\"><span class=\"strut\" style=\"height:1.80002em;vertical-align:-0.65002em;\"></span><span class=\"minner\"><span class=\"mopen delimcenter\" style=\"top:0em;\"><span class=\"delimsizing size2\">(</span></span><span class=\"mop\"><span class=\"mop op-symbol small-op\" style=\"position:relative;top:-0.0000050000000000050004em;\">âˆ</span><span class=\"msupsub\"><span class=\"vlist-t vlist-t2\"><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.981231em;\"><span style=\"top:-2.40029em;margin-left:0em;margin-right:0.05em;\"><span class=\"pstrut\" style=\"height:2.7em;\"></span><span class=\"sizing reset-size6 size3 mtight\"><span class=\"mord mtight\"><span class=\"mord mathnormal mtight\" style=\"margin-right:0.03148em;\">k</span><span class=\"mrel mtight\">=</span><span class=\"mord mathnormal mtight\">t</span><span class=\"mbin mtight\">+</span><span class=\"mord mtight\">1</span></span></span></span><span style=\"top:-3.2029em;margin-right:0.05em;\"><span class=\"pstrut\" style=\"height:2.7em;\"></span><span class=\"sizing reset-size6 size3 mtight\"><span class=\"mord mtight\"><span class=\"mord mathnormal mtight\" style=\"margin-right:0.13889em;\">T</span></span></span></span></span><span class=\"vlist-s\">â€‹</span></span><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.35804100000000005em;\"><span></span></span></span></span></span></span><span class=\"mspace\" style=\"margin-right:0.16666666666666666em;\"></span><span class=\"mord mathnormal\">t</span><span class=\"mord mathnormal\">a</span><span class=\"mord mathnormal\">n</span><span class=\"mord\"><span class=\"mord mathnormal\">h</span><span class=\"msupsub\"><span class=\"vlist-t\"><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.94248em;\"><span style=\"top:-2.94248em;margin-right:0.05em;\"><span class=\"pstrut\" style=\"height:2.57948em;\"></span><span class=\"sizing reset-size6 size3 mtight\"><span class=\"mord mtight\"><span class=\"mord mtight\"><span></span><span class=\"msupsub\"><span class=\"vlist-t\"><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.8278285714285715em;\"><span style=\"top:-2.931em;margin-right:0.07142857142857144em;\"><span class=\"pstrut\" style=\"height:2.5em;\"></span><span class=\"sizing reset-size3 size1 mtight\"><span class=\"mord mtight\"><span class=\"mord mtight\">â€²</span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span><span class=\"mopen\">(</span><span class=\"mord\"><span class=\"mord mathnormal\" style=\"margin-right:0.04398em;\">z</span><span class=\"msupsub\"><span class=\"vlist-t\"><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.8879999999999999em;\"><span style=\"top:-3.063em;margin-right:0.05em;\"><span class=\"pstrut\" style=\"height:2.7em;\"></span><span class=\"sizing reset-size6 size3 mtight\"><span class=\"mord mtight\"><span class=\"mopen mtight\">(</span><span class=\"mord mathnormal mtight\" style=\"margin-right:0.03148em;\">k</span><span class=\"mclose mtight\">)</span></span></span></span></span></span></span></span></span><span class=\"mclose\">)</span><span class=\"mord mathnormal\" style=\"margin-right:0.13889em;\">W</span><span class=\"mclose delimcenter\" style=\"top:0em;\"><span class=\"delimsizing size2\">)</span></span></span></span></span></span> å¯ä»¥çœ‹åˆ°ï¼Œ<strong>RNN æ‰€è°“æ¢¯åº¦æ¶ˆå¤±çš„çœŸæ­£å«ä¹‰æ˜¯ï¼Œæ¢¯åº¦è¢«è¿‘è·ç¦»ï¼ˆ<span class=\"katex\"><span class=\"katex-mathml\"><math xmlns=\"http://www.w3.org/1998/Math/MathML\"><semantics><mrow><mi>t</mi><mo>+</mo><mn>1</mn><mtext>è¶‹å‘äº</mtext><mi>T</mi></mrow><annotation encoding=\"application/x-tex\">t+1 è¶‹å‘äº T</annotation></semantics></math></span><span class=\"katex-html\" aria-hidden=\"true\"><span class=\"base\"><span class=\"strut\" style=\"height:0.69841em;vertical-align:-0.08333em;\"></span><span class=\"mord mathnormal\">t</span><span class=\"mspace\" style=\"margin-right:0.2222222222222222em;\"></span><span class=\"mbin\">+</span><span class=\"mspace\" style=\"margin-right:0.2222222222222222em;\"></span></span><span class=\"base\"><span class=\"strut\" style=\"height:0.68333em;vertical-align:0em;\"></span><span class=\"mord\">1</span><span class=\"mord cjk_fallback\">è¶‹</span><span class=\"mord cjk_fallback\">å‘</span><span class=\"mord cjk_fallback\">äº</span><span class=\"mord mathnormal\" style=\"margin-right:0.13889em;\">T</span></span></span></span>ï¼‰æ¢¯åº¦ä¸»å¯¼ï¼Œè¿œè·ç¦»ï¼ˆ<span class=\"katex\"><span class=\"katex-mathml\"><math xmlns=\"http://www.w3.org/1998/Math/MathML\"><semantics><mrow><mi>t</mi><mo>+</mo><mn>1</mn><mtext>è¿œç¦»</mtext><mi>T</mi></mrow><annotation encoding=\"application/x-tex\">t+1 è¿œç¦» T</annotation></semantics></math></span><span class=\"katex-html\" aria-hidden=\"true\"><span class=\"base\"><span class=\"strut\" style=\"height:0.69841em;vertical-align:-0.08333em;\"></span><span class=\"mord mathnormal\">t</span><span class=\"mspace\" style=\"margin-right:0.2222222222222222em;\"></span><span class=\"mbin\">+</span><span class=\"mspace\" style=\"margin-right:0.2222222222222222em;\"></span></span><span class=\"base\"><span class=\"strut\" style=\"height:0.68333em;vertical-align:0em;\"></span><span class=\"mord\">1</span><span class=\"mord cjk_fallback\">è¿œ</span><span class=\"mord cjk_fallback\">ç¦»</span><span class=\"mord mathnormal\" style=\"margin-right:0.13889em;\">T</span></span></span></span>ï¼‰æ¢¯åº¦å¾ˆå°ï¼Œå¯¼è‡´æ¨¡å‹éš¾ä»¥å­¦åˆ°è¿œè·ç¦»çš„ä¿¡æ¯ã€‚</strong></p>\n<h2 id=\"63-lstm\"><a class=\"anchor\" href=\"#63-lstm\">#</a> 6.3 LSTM</h2>\n<p>ä¸ºäº†è§£å†³ RNN ç¼ºä¹çš„åºåˆ—é•¿è·ç¦»ä¾èµ–é—®é¢˜ï¼ŒLSTM è¢«æäº†å‡ºæ¥ï¼Œé¦–å…ˆæˆ‘ä»¬æ¥çœ‹çœ‹ LSTM ç›¸å¯¹äº RNN åšäº†å“ªäº›æ”¹è¿›ï¼š</p>\n<p>&lt;img src=&quot;<span class=\"exturl\" data-url=\"aHR0cHM6Ly9pbWdtZC5vc3MtY24tc2hhbmdoYWkuYWxpeXVuY3MuY29tL0JFUlRfSU1HL0xTVE0lRTYlQTglQTElRTUlOUUlOEIlRTclQkIlOTMlRTYlOUUlODQuanBn\">https://imgmd.oss-cn-shanghai.aliyuncs.com/BERT_IMG/LSTM æ¨¡å‹ç»“æ„.jpg</span>&quot; style=&quot;zoom:50%;&quot; /&gt;</p>\n<p>å¦‚ä¸Šå›¾æ‰€ç¤ºï¼Œä¸º LSTM çš„ RNN é—¨æ§ç»“æ„ï¼ˆLSTM çš„ timestepï¼‰ï¼ŒLSTM å‰å‘ä¼ æ’­è¿‡ç¨‹åŒ…æ‹¬ï¼š</p>\n<ul>\n<li>** é—å¿˜é—¨ï¼š** å†³å®šäº†ä¸¢å¼ƒå“ªäº›ä¿¡æ¯ï¼Œé—å¿˜é—¨æ¥æ”¶ <span class=\"katex\"><span class=\"katex-mathml\"><math xmlns=\"http://www.w3.org/1998/Math/MathML\"><semantics><mrow><mi>t</mi><mo>âˆ’</mo><mn>1</mn></mrow><annotation encoding=\"application/x-tex\">t-1</annotation></semantics></math></span><span class=\"katex-html\" aria-hidden=\"true\"><span class=\"base\"><span class=\"strut\" style=\"height:0.69841em;vertical-align:-0.08333em;\"></span><span class=\"mord mathnormal\">t</span><span class=\"mspace\" style=\"margin-right:0.2222222222222222em;\"></span><span class=\"mbin\">âˆ’</span><span class=\"mspace\" style=\"margin-right:0.2222222222222222em;\"></span></span><span class=\"base\"><span class=\"strut\" style=\"height:0.64444em;vertical-align:0em;\"></span><span class=\"mord\">1</span></span></span></span> æ—¶åˆ»çš„çŠ¶æ€ <span class=\"katex\"><span class=\"katex-mathml\"><math xmlns=\"http://www.w3.org/1998/Math/MathML\"><semantics><mrow><msub><mi>h</mi><mrow><mi>t</mi><mo>âˆ’</mo><mn>1</mn></mrow></msub></mrow><annotation encoding=\"application/x-tex\">h_{t-1}</annotation></semantics></math></span><span class=\"katex-html\" aria-hidden=\"true\"><span class=\"base\"><span class=\"strut\" style=\"height:0.902771em;vertical-align:-0.208331em;\"></span><span class=\"mord\"><span class=\"mord mathnormal\">h</span><span class=\"msupsub\"><span class=\"vlist-t vlist-t2\"><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.301108em;\"><span style=\"top:-2.5500000000000003em;margin-left:0em;margin-right:0.05em;\"><span class=\"pstrut\" style=\"height:2.7em;\"></span><span class=\"sizing reset-size6 size3 mtight\"><span class=\"mord mtight\"><span class=\"mord mathnormal mtight\">t</span><span class=\"mbin mtight\">âˆ’</span><span class=\"mord mtight\">1</span></span></span></span></span><span class=\"vlist-s\">â€‹</span></span><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.208331em;\"><span></span></span></span></span></span></span></span></span></span>ï¼Œä»¥åŠå½“å‰çš„è¾“å…¥ <span class=\"katex\"><span class=\"katex-mathml\"><math xmlns=\"http://www.w3.org/1998/Math/MathML\"><semantics><mrow><msub><mi>x</mi><mi>t</mi></msub></mrow><annotation encoding=\"application/x-tex\">x_t</annotation></semantics></math></span><span class=\"katex-html\" aria-hidden=\"true\"><span class=\"base\"><span class=\"strut\" style=\"height:0.58056em;vertical-align:-0.15em;\"></span><span class=\"mord\"><span class=\"mord mathnormal\">x</span><span class=\"msupsub\"><span class=\"vlist-t vlist-t2\"><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.2805559999999999em;\"><span style=\"top:-2.5500000000000003em;margin-left:0em;margin-right:0.05em;\"><span class=\"pstrut\" style=\"height:2.7em;\"></span><span class=\"sizing reset-size6 size3 mtight\"><span class=\"mord mathnormal mtight\">t</span></span></span></span><span class=\"vlist-s\">â€‹</span></span><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.15em;\"><span></span></span></span></span></span></span></span></span></span>ï¼Œç»è¿‡ Sigmoid å‡½æ•°åè¾“å‡ºä¸€ä¸ª 0 åˆ° 1 ä¹‹é—´çš„å€¼ <span class=\"katex\"><span class=\"katex-mathml\"><math xmlns=\"http://www.w3.org/1998/Math/MathML\"><semantics><mrow><msub><mi>f</mi><mi>t</mi></msub></mrow><annotation encoding=\"application/x-tex\">f_t</annotation></semantics></math></span><span class=\"katex-html\" aria-hidden=\"true\"><span class=\"base\"><span class=\"strut\" style=\"height:0.8888799999999999em;vertical-align:-0.19444em;\"></span><span class=\"mord\"><span class=\"mord mathnormal\" style=\"margin-right:0.10764em;\">f</span><span class=\"msupsub\"><span class=\"vlist-t vlist-t2\"><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.2805559999999999em;\"><span style=\"top:-2.5500000000000003em;margin-left:-0.10764em;margin-right:0.05em;\"><span class=\"pstrut\" style=\"height:2.7em;\"></span><span class=\"sizing reset-size6 size3 mtight\"><span class=\"mord mathnormal mtight\">t</span></span></span></span><span class=\"vlist-s\">â€‹</span></span><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.15em;\"><span></span></span></span></span></span></span></span></span></span>\n<ul>\n<li>è¾“å‡ºï¼š <span class=\"katex\"><span class=\"katex-mathml\"><math xmlns=\"http://www.w3.org/1998/Math/MathML\"><semantics><mrow><msub><mi>f</mi><mi>t</mi></msub><mo>=</mo><mi>Ïƒ</mi><mo stretchy=\"false\">(</mo><msub><mi>W</mi><mi>f</mi></msub><msub><mi>h</mi><mrow><mi>t</mi><mo>âˆ’</mo><mn>1</mn></mrow></msub><mo>+</mo><msub><mi>U</mi><mi>f</mi></msub><msub><mi>x</mi><mi>t</mi></msub><mo>+</mo><msub><mi>b</mi><mi>f</mi></msub><mo stretchy=\"false\">)</mo></mrow><annotation encoding=\"application/x-tex\">f_{t} = \\sigma(W_fh_{t-1} + U_fx_{t} + b_f)</annotation></semantics></math></span><span class=\"katex-html\" aria-hidden=\"true\"><span class=\"base\"><span class=\"strut\" style=\"height:0.8888799999999999em;vertical-align:-0.19444em;\"></span><span class=\"mord\"><span class=\"mord mathnormal\" style=\"margin-right:0.10764em;\">f</span><span class=\"msupsub\"><span class=\"vlist-t vlist-t2\"><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.2805559999999999em;\"><span style=\"top:-2.5500000000000003em;margin-left:-0.10764em;margin-right:0.05em;\"><span class=\"pstrut\" style=\"height:2.7em;\"></span><span class=\"sizing reset-size6 size3 mtight\"><span class=\"mord mtight\"><span class=\"mord mathnormal mtight\">t</span></span></span></span></span><span class=\"vlist-s\">â€‹</span></span><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.15em;\"><span></span></span></span></span></span></span><span class=\"mspace\" style=\"margin-right:0.2777777777777778em;\"></span><span class=\"mrel\">=</span><span class=\"mspace\" style=\"margin-right:0.2777777777777778em;\"></span></span><span class=\"base\"><span class=\"strut\" style=\"height:1.036108em;vertical-align:-0.286108em;\"></span><span class=\"mord mathnormal\" style=\"margin-right:0.03588em;\">Ïƒ</span><span class=\"mopen\">(</span><span class=\"mord\"><span class=\"mord mathnormal\" style=\"margin-right:0.13889em;\">W</span><span class=\"msupsub\"><span class=\"vlist-t vlist-t2\"><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.3361079999999999em;\"><span style=\"top:-2.5500000000000003em;margin-left:-0.13889em;margin-right:0.05em;\"><span class=\"pstrut\" style=\"height:2.7em;\"></span><span class=\"sizing reset-size6 size3 mtight\"><span class=\"mord mathnormal mtight\" style=\"margin-right:0.10764em;\">f</span></span></span></span><span class=\"vlist-s\">â€‹</span></span><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.286108em;\"><span></span></span></span></span></span></span><span class=\"mord\"><span class=\"mord mathnormal\">h</span><span class=\"msupsub\"><span class=\"vlist-t vlist-t2\"><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.301108em;\"><span style=\"top:-2.5500000000000003em;margin-left:0em;margin-right:0.05em;\"><span class=\"pstrut\" style=\"height:2.7em;\"></span><span class=\"sizing reset-size6 size3 mtight\"><span class=\"mord mtight\"><span class=\"mord mathnormal mtight\">t</span><span class=\"mbin mtight\">âˆ’</span><span class=\"mord mtight\">1</span></span></span></span></span><span class=\"vlist-s\">â€‹</span></span><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.208331em;\"><span></span></span></span></span></span></span><span class=\"mspace\" style=\"margin-right:0.2222222222222222em;\"></span><span class=\"mbin\">+</span><span class=\"mspace\" style=\"margin-right:0.2222222222222222em;\"></span></span><span class=\"base\"><span class=\"strut\" style=\"height:0.969438em;vertical-align:-0.286108em;\"></span><span class=\"mord\"><span class=\"mord mathnormal\" style=\"margin-right:0.10903em;\">U</span><span class=\"msupsub\"><span class=\"vlist-t vlist-t2\"><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.3361079999999999em;\"><span style=\"top:-2.5500000000000003em;margin-left:-0.10903em;margin-right:0.05em;\"><span class=\"pstrut\" style=\"height:2.7em;\"></span><span class=\"sizing reset-size6 size3 mtight\"><span class=\"mord mathnormal mtight\" style=\"margin-right:0.10764em;\">f</span></span></span></span><span class=\"vlist-s\">â€‹</span></span><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.286108em;\"><span></span></span></span></span></span></span><span class=\"mord\"><span class=\"mord mathnormal\">x</span><span class=\"msupsub\"><span class=\"vlist-t vlist-t2\"><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.2805559999999999em;\"><span style=\"top:-2.5500000000000003em;margin-left:0em;margin-right:0.05em;\"><span class=\"pstrut\" style=\"height:2.7em;\"></span><span class=\"sizing reset-size6 size3 mtight\"><span class=\"mord mtight\"><span class=\"mord mathnormal mtight\">t</span></span></span></span></span><span class=\"vlist-s\">â€‹</span></span><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.15em;\"><span></span></span></span></span></span></span><span class=\"mspace\" style=\"margin-right:0.2222222222222222em;\"></span><span class=\"mbin\">+</span><span class=\"mspace\" style=\"margin-right:0.2222222222222222em;\"></span></span><span class=\"base\"><span class=\"strut\" style=\"height:1.036108em;vertical-align:-0.286108em;\"></span><span class=\"mord\"><span class=\"mord mathnormal\">b</span><span class=\"msupsub\"><span class=\"vlist-t vlist-t2\"><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.3361079999999999em;\"><span style=\"top:-2.5500000000000003em;margin-left:0em;margin-right:0.05em;\"><span class=\"pstrut\" style=\"height:2.7em;\"></span><span class=\"sizing reset-size6 size3 mtight\"><span class=\"mord mathnormal mtight\" style=\"margin-right:0.10764em;\">f</span></span></span></span><span class=\"vlist-s\">â€‹</span></span><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.286108em;\"><span></span></span></span></span></span></span><span class=\"mclose\">)</span></span></span></span></li>\n</ul>\n</li>\n<li>** è¾“å…¥é—¨ï¼š** å†³å®šäº†å“ªäº›æ–°ä¿¡æ¯è¢«ä¿ç•™ï¼Œå¹¶æ›´æ–°ç»†èƒçŠ¶æ€ï¼Œè¾“å…¥ä»¬çš„å–å€¼ç”± <span class=\"katex\"><span class=\"katex-mathml\"><math xmlns=\"http://www.w3.org/1998/Math/MathML\"><semantics><mrow><msub><mi>h</mi><mrow><mi>t</mi><mo>âˆ’</mo><mn>1</mn></mrow></msub></mrow><annotation encoding=\"application/x-tex\">h_{t-1}</annotation></semantics></math></span><span class=\"katex-html\" aria-hidden=\"true\"><span class=\"base\"><span class=\"strut\" style=\"height:0.902771em;vertical-align:-0.208331em;\"></span><span class=\"mord\"><span class=\"mord mathnormal\">h</span><span class=\"msupsub\"><span class=\"vlist-t vlist-t2\"><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.301108em;\"><span style=\"top:-2.5500000000000003em;margin-left:0em;margin-right:0.05em;\"><span class=\"pstrut\" style=\"height:2.7em;\"></span><span class=\"sizing reset-size6 size3 mtight\"><span class=\"mord mtight\"><span class=\"mord mathnormal mtight\">t</span><span class=\"mbin mtight\">âˆ’</span><span class=\"mord mtight\">1</span></span></span></span></span><span class=\"vlist-s\">â€‹</span></span><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.208331em;\"><span></span></span></span></span></span></span></span></span></span> å’Œ <span class=\"katex\"><span class=\"katex-mathml\"><math xmlns=\"http://www.w3.org/1998/Math/MathML\"><semantics><mrow><msub><mi>x</mi><mi>t</mi></msub></mrow><annotation encoding=\"application/x-tex\">x_t</annotation></semantics></math></span><span class=\"katex-html\" aria-hidden=\"true\"><span class=\"base\"><span class=\"strut\" style=\"height:0.58056em;vertical-align:-0.15em;\"></span><span class=\"mord\"><span class=\"mord mathnormal\">x</span><span class=\"msupsub\"><span class=\"vlist-t vlist-t2\"><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.2805559999999999em;\"><span style=\"top:-2.5500000000000003em;margin-left:0em;margin-right:0.05em;\"><span class=\"pstrut\" style=\"height:2.7em;\"></span><span class=\"sizing reset-size6 size3 mtight\"><span class=\"mord mathnormal mtight\">t</span></span></span></span><span class=\"vlist-s\">â€‹</span></span><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.15em;\"><span></span></span></span></span></span></span></span></span></span> å†³å®šï¼Œé€šè¿‡ Sigmoid å‡½æ•°å¾—åˆ°ä¸€ä¸ª 0 åˆ° 1 ä¹‹é—´çš„å€¼ <span class=\"katex\"><span class=\"katex-mathml\"><math xmlns=\"http://www.w3.org/1998/Math/MathML\"><semantics><mrow><msub><mi>i</mi><mi>t</mi></msub></mrow><annotation encoding=\"application/x-tex\">i_t</annotation></semantics></math></span><span class=\"katex-html\" aria-hidden=\"true\"><span class=\"base\"><span class=\"strut\" style=\"height:0.80952em;vertical-align:-0.15em;\"></span><span class=\"mord\"><span class=\"mord mathnormal\">i</span><span class=\"msupsub\"><span class=\"vlist-t vlist-t2\"><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.2805559999999999em;\"><span style=\"top:-2.5500000000000003em;margin-left:0em;margin-right:0.05em;\"><span class=\"pstrut\" style=\"height:2.7em;\"></span><span class=\"sizing reset-size6 size3 mtight\"><span class=\"mord mathnormal mtight\">t</span></span></span></span><span class=\"vlist-s\">â€‹</span></span><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.15em;\"><span></span></span></span></span></span></span></span></span></span>ï¼Œè€Œ <span class=\"katex\"><span class=\"katex-mathml\"><math xmlns=\"http://www.w3.org/1998/Math/MathML\"><semantics><mrow><mi>tanh</mi><mo>â¡</mo></mrow><annotation encoding=\"application/x-tex\">\\tanh</annotation></semantics></math></span><span class=\"katex-html\" aria-hidden=\"true\"><span class=\"base\"><span class=\"strut\" style=\"height:0.69444em;vertical-align:0em;\"></span><span class=\"mop\">tanh</span></span></span></span> å‡½æ•°åˆ™åˆ›é€ äº†ä¸€ä¸ªå½“å‰ç»†èƒçŠ¶æ€çš„å€™é€‰ <span class=\"katex\"><span class=\"katex-mathml\"><math xmlns=\"http://www.w3.org/1998/Math/MathML\"><semantics><mrow><msub><mi>a</mi><mi>t</mi></msub></mrow><annotation encoding=\"application/x-tex\">a_t</annotation></semantics></math></span><span class=\"katex-html\" aria-hidden=\"true\"><span class=\"base\"><span class=\"strut\" style=\"height:0.58056em;vertical-align:-0.15em;\"></span><span class=\"mord\"><span class=\"mord mathnormal\">a</span><span class=\"msupsub\"><span class=\"vlist-t vlist-t2\"><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.2805559999999999em;\"><span style=\"top:-2.5500000000000003em;margin-left:0em;margin-right:0.05em;\"><span class=\"pstrut\" style=\"height:2.7em;\"></span><span class=\"sizing reset-size6 size3 mtight\"><span class=\"mord mathnormal mtight\">t</span></span></span></span><span class=\"vlist-s\">â€‹</span></span><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.15em;\"><span></span></span></span></span></span></span></span></span></span>\n<ul>\n<li>è¾“å‡ºï¼š<span class=\"katex\"><span class=\"katex-mathml\"><math xmlns=\"http://www.w3.org/1998/Math/MathML\"><semantics><mrow><msub><mi>i</mi><mi>t</mi></msub><mo>=</mo><mi>Ïƒ</mi><mo stretchy=\"false\">(</mo><msub><mi>W</mi><mi>i</mi></msub><msub><mi>h</mi><mrow><mi>t</mi><mo>âˆ’</mo><mn>1</mn></mrow></msub><mo>+</mo><msub><mi>U</mi><mi>i</mi></msub><msub><mi>x</mi><mi>t</mi></msub><mo>+</mo><msub><mi>b</mi><mi>i</mi></msub><mo stretchy=\"false\">)</mo></mrow><annotation encoding=\"application/x-tex\">i_{t} = \\sigma(W_ih_{t-1} + U_ix_{t} + b_i)</annotation></semantics></math></span><span class=\"katex-html\" aria-hidden=\"true\"><span class=\"base\"><span class=\"strut\" style=\"height:0.80952em;vertical-align:-0.15em;\"></span><span class=\"mord\"><span class=\"mord mathnormal\">i</span><span class=\"msupsub\"><span class=\"vlist-t vlist-t2\"><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.2805559999999999em;\"><span style=\"top:-2.5500000000000003em;margin-left:0em;margin-right:0.05em;\"><span class=\"pstrut\" style=\"height:2.7em;\"></span><span class=\"sizing reset-size6 size3 mtight\"><span class=\"mord mtight\"><span class=\"mord mathnormal mtight\">t</span></span></span></span></span><span class=\"vlist-s\">â€‹</span></span><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.15em;\"><span></span></span></span></span></span></span><span class=\"mspace\" style=\"margin-right:0.2777777777777778em;\"></span><span class=\"mrel\">=</span><span class=\"mspace\" style=\"margin-right:0.2777777777777778em;\"></span></span><span class=\"base\"><span class=\"strut\" style=\"height:1em;vertical-align:-0.25em;\"></span><span class=\"mord mathnormal\" style=\"margin-right:0.03588em;\">Ïƒ</span><span class=\"mopen\">(</span><span class=\"mord\"><span class=\"mord mathnormal\" style=\"margin-right:0.13889em;\">W</span><span class=\"msupsub\"><span class=\"vlist-t vlist-t2\"><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.31166399999999994em;\"><span style=\"top:-2.5500000000000003em;margin-left:-0.13889em;margin-right:0.05em;\"><span class=\"pstrut\" style=\"height:2.7em;\"></span><span class=\"sizing reset-size6 size3 mtight\"><span class=\"mord mathnormal mtight\">i</span></span></span></span><span class=\"vlist-s\">â€‹</span></span><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.15em;\"><span></span></span></span></span></span></span><span class=\"mord\"><span class=\"mord mathnormal\">h</span><span class=\"msupsub\"><span class=\"vlist-t vlist-t2\"><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.301108em;\"><span style=\"top:-2.5500000000000003em;margin-left:0em;margin-right:0.05em;\"><span class=\"pstrut\" style=\"height:2.7em;\"></span><span class=\"sizing reset-size6 size3 mtight\"><span class=\"mord mtight\"><span class=\"mord mathnormal mtight\">t</span><span class=\"mbin mtight\">âˆ’</span><span class=\"mord mtight\">1</span></span></span></span></span><span class=\"vlist-s\">â€‹</span></span><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.208331em;\"><span></span></span></span></span></span></span><span class=\"mspace\" style=\"margin-right:0.2222222222222222em;\"></span><span class=\"mbin\">+</span><span class=\"mspace\" style=\"margin-right:0.2222222222222222em;\"></span></span><span class=\"base\"><span class=\"strut\" style=\"height:0.83333em;vertical-align:-0.15em;\"></span><span class=\"mord\"><span class=\"mord mathnormal\" style=\"margin-right:0.10903em;\">U</span><span class=\"msupsub\"><span class=\"vlist-t vlist-t2\"><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.31166399999999994em;\"><span style=\"top:-2.5500000000000003em;margin-left:-0.10903em;margin-right:0.05em;\"><span class=\"pstrut\" style=\"height:2.7em;\"></span><span class=\"sizing reset-size6 size3 mtight\"><span class=\"mord mathnormal mtight\">i</span></span></span></span><span class=\"vlist-s\">â€‹</span></span><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.15em;\"><span></span></span></span></span></span></span><span class=\"mord\"><span class=\"mord mathnormal\">x</span><span class=\"msupsub\"><span class=\"vlist-t vlist-t2\"><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.2805559999999999em;\"><span style=\"top:-2.5500000000000003em;margin-left:0em;margin-right:0.05em;\"><span class=\"pstrut\" style=\"height:2.7em;\"></span><span class=\"sizing reset-size6 size3 mtight\"><span class=\"mord mtight\"><span class=\"mord mathnormal mtight\">t</span></span></span></span></span><span class=\"vlist-s\">â€‹</span></span><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.15em;\"><span></span></span></span></span></span></span><span class=\"mspace\" style=\"margin-right:0.2222222222222222em;\"></span><span class=\"mbin\">+</span><span class=\"mspace\" style=\"margin-right:0.2222222222222222em;\"></span></span><span class=\"base\"><span class=\"strut\" style=\"height:1em;vertical-align:-0.25em;\"></span><span class=\"mord\"><span class=\"mord mathnormal\">b</span><span class=\"msupsub\"><span class=\"vlist-t vlist-t2\"><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.31166399999999994em;\"><span style=\"top:-2.5500000000000003em;margin-left:0em;margin-right:0.05em;\"><span class=\"pstrut\" style=\"height:2.7em;\"></span><span class=\"sizing reset-size6 size3 mtight\"><span class=\"mord mathnormal mtight\">i</span></span></span></span><span class=\"vlist-s\">â€‹</span></span><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.15em;\"><span></span></span></span></span></span></span><span class=\"mclose\">)</span></span></span></span> , <span class=\"katex\"><span class=\"katex-mathml\"><math xmlns=\"http://www.w3.org/1998/Math/MathML\"><semantics><mrow><mover accent=\"true\"><msub><mi>C</mi><mi>t</mi></msub><mo>~</mo></mover><mo>=</mo><mi>t</mi><mi>a</mi><mi>n</mi><mi>h</mi><msub><mi>W</mi><mi>a</mi></msub><msub><mi>h</mi><mrow><mi>t</mi><mo>âˆ’</mo><mn>1</mn></mrow></msub><mo>+</mo><msub><mi>U</mi><mi>a</mi></msub><msub><mi>x</mi><mi>t</mi></msub><mo>+</mo><msub><mi>b</mi><mi>a</mi></msub></mrow><annotation encoding=\"application/x-tex\">\\tilde{C_{t} }= tanhW_ah_{t-1} + U_ax_{t} + b_a</annotation></semantics></math></span><span class=\"katex-html\" aria-hidden=\"true\"><span class=\"base\"><span class=\"strut\" style=\"height:1.0701899999999998em;vertical-align:-0.15em;\"></span><span class=\"mord accent\"><span class=\"vlist-t vlist-t2\"><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.9201899999999998em;\"><span style=\"top:-3em;\"><span class=\"pstrut\" style=\"height:3em;\"></span><span class=\"mord\"><span class=\"mord\"><span class=\"mord mathnormal\" style=\"margin-right:0.07153em;\">C</span><span class=\"msupsub\"><span class=\"vlist-t vlist-t2\"><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.2805559999999999em;\"><span style=\"top:-2.5500000000000003em;margin-left:-0.07153em;margin-right:0.05em;\"><span class=\"pstrut\" style=\"height:2.7em;\"></span><span class=\"sizing reset-size6 size3 mtight\"><span class=\"mord mtight\"><span class=\"mord mathnormal mtight\">t</span></span></span></span></span><span class=\"vlist-s\">â€‹</span></span><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.15em;\"><span></span></span></span></span></span></span></span></span><span style=\"top:-3.6023300000000003em;\"><span class=\"pstrut\" style=\"height:3em;\"></span><span class=\"accent-body\" style=\"left:-0.25em;\"><span class=\"mord\">~</span></span></span></span><span class=\"vlist-s\">â€‹</span></span><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.15em;\"><span></span></span></span></span></span><span class=\"mspace\" style=\"margin-right:0.2777777777777778em;\"></span><span class=\"mrel\">=</span><span class=\"mspace\" style=\"margin-right:0.2777777777777778em;\"></span></span><span class=\"base\"><span class=\"strut\" style=\"height:0.902771em;vertical-align:-0.208331em;\"></span><span class=\"mord mathnormal\">t</span><span class=\"mord mathnormal\">a</span><span class=\"mord mathnormal\">n</span><span class=\"mord mathnormal\">h</span><span class=\"mord\"><span class=\"mord mathnormal\" style=\"margin-right:0.13889em;\">W</span><span class=\"msupsub\"><span class=\"vlist-t vlist-t2\"><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.151392em;\"><span style=\"top:-2.5500000000000003em;margin-left:-0.13889em;margin-right:0.05em;\"><span class=\"pstrut\" style=\"height:2.7em;\"></span><span class=\"sizing reset-size6 size3 mtight\"><span class=\"mord mathnormal mtight\">a</span></span></span></span><span class=\"vlist-s\">â€‹</span></span><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.15em;\"><span></span></span></span></span></span></span><span class=\"mord\"><span class=\"mord mathnormal\">h</span><span class=\"msupsub\"><span class=\"vlist-t vlist-t2\"><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.301108em;\"><span style=\"top:-2.5500000000000003em;margin-left:0em;margin-right:0.05em;\"><span class=\"pstrut\" style=\"height:2.7em;\"></span><span class=\"sizing reset-size6 size3 mtight\"><span class=\"mord mtight\"><span class=\"mord mathnormal mtight\">t</span><span class=\"mbin mtight\">âˆ’</span><span class=\"mord mtight\">1</span></span></span></span></span><span class=\"vlist-s\">â€‹</span></span><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.208331em;\"><span></span></span></span></span></span></span><span class=\"mspace\" style=\"margin-right:0.2222222222222222em;\"></span><span class=\"mbin\">+</span><span class=\"mspace\" style=\"margin-right:0.2222222222222222em;\"></span></span><span class=\"base\"><span class=\"strut\" style=\"height:0.83333em;vertical-align:-0.15em;\"></span><span class=\"mord\"><span class=\"mord mathnormal\" style=\"margin-right:0.10903em;\">U</span><span class=\"msupsub\"><span class=\"vlist-t vlist-t2\"><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.151392em;\"><span style=\"top:-2.5500000000000003em;margin-left:-0.10903em;margin-right:0.05em;\"><span class=\"pstrut\" style=\"height:2.7em;\"></span><span class=\"sizing reset-size6 size3 mtight\"><span class=\"mord mathnormal mtight\">a</span></span></span></span><span class=\"vlist-s\">â€‹</span></span><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.15em;\"><span></span></span></span></span></span></span><span class=\"mord\"><span class=\"mord mathnormal\">x</span><span class=\"msupsub\"><span class=\"vlist-t vlist-t2\"><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.2805559999999999em;\"><span style=\"top:-2.5500000000000003em;margin-left:0em;margin-right:0.05em;\"><span class=\"pstrut\" style=\"height:2.7em;\"></span><span class=\"sizing reset-size6 size3 mtight\"><span class=\"mord mtight\"><span class=\"mord mathnormal mtight\">t</span></span></span></span></span><span class=\"vlist-s\">â€‹</span></span><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.15em;\"><span></span></span></span></span></span></span><span class=\"mspace\" style=\"margin-right:0.2222222222222222em;\"></span><span class=\"mbin\">+</span><span class=\"mspace\" style=\"margin-right:0.2222222222222222em;\"></span></span><span class=\"base\"><span class=\"strut\" style=\"height:0.84444em;vertical-align:-0.15em;\"></span><span class=\"mord\"><span class=\"mord mathnormal\">b</span><span class=\"msupsub\"><span class=\"vlist-t vlist-t2\"><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.151392em;\"><span style=\"top:-2.5500000000000003em;margin-left:0em;margin-right:0.05em;\"><span class=\"pstrut\" style=\"height:2.7em;\"></span><span class=\"sizing reset-size6 size3 mtight\"><span class=\"mord mathnormal mtight\">a</span></span></span></span><span class=\"vlist-s\">â€‹</span></span><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.15em;\"><span></span></span></span></span></span></span></span></span></span></li>\n</ul>\n</li>\n<li>** ç»†èƒçŠ¶æ€ï¼š** æ—§ç»†èƒçŠ¶æ€ <span class=\"katex\"><span class=\"katex-mathml\"><math xmlns=\"http://www.w3.org/1998/Math/MathML\"><semantics><mrow><msub><mi>C</mi><mrow><mi>t</mi><mo>âˆ’</mo><mn>1</mn></mrow></msub></mrow><annotation encoding=\"application/x-tex\">C_{t-1}</annotation></semantics></math></span><span class=\"katex-html\" aria-hidden=\"true\"><span class=\"base\"><span class=\"strut\" style=\"height:0.891661em;vertical-align:-0.208331em;\"></span><span class=\"mord\"><span class=\"mord mathnormal\" style=\"margin-right:0.07153em;\">C</span><span class=\"msupsub\"><span class=\"vlist-t vlist-t2\"><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.301108em;\"><span style=\"top:-2.5500000000000003em;margin-left:-0.07153em;margin-right:0.05em;\"><span class=\"pstrut\" style=\"height:2.7em;\"></span><span class=\"sizing reset-size6 size3 mtight\"><span class=\"mord mtight\"><span class=\"mord mathnormal mtight\">t</span><span class=\"mbin mtight\">âˆ’</span><span class=\"mord mtight\">1</span></span></span></span></span><span class=\"vlist-s\">â€‹</span></span><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.208331em;\"><span></span></span></span></span></span></span></span></span></span> è¢«æ›´æ–°åˆ°æ–°çš„ç»†èƒçŠ¶æ€ <span class=\"katex\"><span class=\"katex-mathml\"><math xmlns=\"http://www.w3.org/1998/Math/MathML\"><semantics><mrow><msub><mi>C</mi><mi>t</mi></msub></mrow><annotation encoding=\"application/x-tex\">C_t</annotation></semantics></math></span><span class=\"katex-html\" aria-hidden=\"true\"><span class=\"base\"><span class=\"strut\" style=\"height:0.83333em;vertical-align:-0.15em;\"></span><span class=\"mord\"><span class=\"mord mathnormal\" style=\"margin-right:0.07153em;\">C</span><span class=\"msupsub\"><span class=\"vlist-t vlist-t2\"><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.2805559999999999em;\"><span style=\"top:-2.5500000000000003em;margin-left:-0.07153em;margin-right:0.05em;\"><span class=\"pstrut\" style=\"height:2.7em;\"></span><span class=\"sizing reset-size6 size3 mtight\"><span class=\"mord mathnormal mtight\">t</span></span></span></span><span class=\"vlist-s\">â€‹</span></span><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.15em;\"><span></span></span></span></span></span></span></span></span></span> ä¸Šï¼Œ\n<ul>\n<li>è¾“å‡ºï¼š<span class=\"katex\"><span class=\"katex-mathml\"><math xmlns=\"http://www.w3.org/1998/Math/MathML\"><semantics><mrow><msub><mi>C</mi><mi>t</mi></msub><mo>=</mo><msub><mi>C</mi><mrow><mi>t</mi><mo>âˆ’</mo><mn>1</mn></mrow></msub><mo>âŠ™</mo><msub><mi>f</mi><mi>t</mi></msub><mo>+</mo><msub><mi>i</mi><mi>t</mi></msub><mo>âŠ™</mo><mover accent=\"true\"><msub><mi>C</mi><mi>t</mi></msub><mo>~</mo></mover></mrow><annotation encoding=\"application/x-tex\">C_{t} = C_{t-1}\\odot f_{t} + i_{t}\\odot \\tilde{C_{t} }</annotation></semantics></math></span><span class=\"katex-html\" aria-hidden=\"true\"><span class=\"base\"><span class=\"strut\" style=\"height:0.83333em;vertical-align:-0.15em;\"></span><span class=\"mord\"><span class=\"mord mathnormal\" style=\"margin-right:0.07153em;\">C</span><span class=\"msupsub\"><span class=\"vlist-t vlist-t2\"><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.2805559999999999em;\"><span style=\"top:-2.5500000000000003em;margin-left:-0.07153em;margin-right:0.05em;\"><span class=\"pstrut\" style=\"height:2.7em;\"></span><span class=\"sizing reset-size6 size3 mtight\"><span class=\"mord mtight\"><span class=\"mord mathnormal mtight\">t</span></span></span></span></span><span class=\"vlist-s\">â€‹</span></span><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.15em;\"><span></span></span></span></span></span></span><span class=\"mspace\" style=\"margin-right:0.2777777777777778em;\"></span><span class=\"mrel\">=</span><span class=\"mspace\" style=\"margin-right:0.2777777777777778em;\"></span></span><span class=\"base\"><span class=\"strut\" style=\"height:0.891661em;vertical-align:-0.208331em;\"></span><span class=\"mord\"><span class=\"mord mathnormal\" style=\"margin-right:0.07153em;\">C</span><span class=\"msupsub\"><span class=\"vlist-t vlist-t2\"><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.301108em;\"><span style=\"top:-2.5500000000000003em;margin-left:-0.07153em;margin-right:0.05em;\"><span class=\"pstrut\" style=\"height:2.7em;\"></span><span class=\"sizing reset-size6 size3 mtight\"><span class=\"mord mtight\"><span class=\"mord mathnormal mtight\">t</span><span class=\"mbin mtight\">âˆ’</span><span class=\"mord mtight\">1</span></span></span></span></span><span class=\"vlist-s\">â€‹</span></span><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.208331em;\"><span></span></span></span></span></span></span><span class=\"mspace\" style=\"margin-right:0.2222222222222222em;\"></span><span class=\"mbin\">âŠ™</span><span class=\"mspace\" style=\"margin-right:0.2222222222222222em;\"></span></span><span class=\"base\"><span class=\"strut\" style=\"height:0.8888799999999999em;vertical-align:-0.19444em;\"></span><span class=\"mord\"><span class=\"mord mathnormal\" style=\"margin-right:0.10764em;\">f</span><span class=\"msupsub\"><span class=\"vlist-t vlist-t2\"><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.2805559999999999em;\"><span style=\"top:-2.5500000000000003em;margin-left:-0.10764em;margin-right:0.05em;\"><span class=\"pstrut\" style=\"height:2.7em;\"></span><span class=\"sizing reset-size6 size3 mtight\"><span class=\"mord mtight\"><span class=\"mord mathnormal mtight\">t</span></span></span></span></span><span class=\"vlist-s\">â€‹</span></span><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.15em;\"><span></span></span></span></span></span></span><span class=\"mspace\" style=\"margin-right:0.2222222222222222em;\"></span><span class=\"mbin\">+</span><span class=\"mspace\" style=\"margin-right:0.2222222222222222em;\"></span></span><span class=\"base\"><span class=\"strut\" style=\"height:0.80952em;vertical-align:-0.15em;\"></span><span class=\"mord\"><span class=\"mord mathnormal\">i</span><span class=\"msupsub\"><span class=\"vlist-t vlist-t2\"><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.2805559999999999em;\"><span style=\"top:-2.5500000000000003em;margin-left:0em;margin-right:0.05em;\"><span class=\"pstrut\" style=\"height:2.7em;\"></span><span class=\"sizing reset-size6 size3 mtight\"><span class=\"mord mtight\"><span class=\"mord mathnormal mtight\">t</span></span></span></span></span><span class=\"vlist-s\">â€‹</span></span><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.15em;\"><span></span></span></span></span></span></span><span class=\"mspace\" style=\"margin-right:0.2222222222222222em;\"></span><span class=\"mbin\">âŠ™</span><span class=\"mspace\" style=\"margin-right:0.2222222222222222em;\"></span></span><span class=\"base\"><span class=\"strut\" style=\"height:1.0701899999999998em;vertical-align:-0.15em;\"></span><span class=\"mord accent\"><span class=\"vlist-t vlist-t2\"><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.9201899999999998em;\"><span style=\"top:-3em;\"><span class=\"pstrut\" style=\"height:3em;\"></span><span class=\"mord\"><span class=\"mord\"><span class=\"mord mathnormal\" style=\"margin-right:0.07153em;\">C</span><span class=\"msupsub\"><span class=\"vlist-t vlist-t2\"><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.2805559999999999em;\"><span style=\"top:-2.5500000000000003em;margin-left:-0.07153em;margin-right:0.05em;\"><span class=\"pstrut\" style=\"height:2.7em;\"></span><span class=\"sizing reset-size6 size3 mtight\"><span class=\"mord mtight\"><span class=\"mord mathnormal mtight\">t</span></span></span></span></span><span class=\"vlist-s\">â€‹</span></span><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.15em;\"><span></span></span></span></span></span></span></span></span><span style=\"top:-3.6023300000000003em;\"><span class=\"pstrut\" style=\"height:3em;\"></span><span class=\"accent-body\" style=\"left:-0.25em;\"><span class=\"mord\">~</span></span></span></span><span class=\"vlist-s\">â€‹</span></span><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.15em;\"><span></span></span></span></span></span></span></span></span></li>\n</ul>\n</li>\n<li t=\"\">** è¾“å‡ºé—¨ï¼š** å†³å®šäº†æœ€åè¾“å‡ºçš„ä¿¡æ¯ï¼Œè¾“å‡ºé—¨å–å€¼ç”± <span class=\"katex\"><span class=\"katex-mathml\"><math xmlns=\"http://www.w3.org/1998/Math/MathML\"><semantics><mrow><msub><mi>h</mi><mrow><mi>t</mi><mo>âˆ’</mo><mn>1</mn></mrow></msub></mrow><annotation encoding=\"application/x-tex\">h_{t-1}</annotation></semantics></math></span><span class=\"katex-html\" aria-hidden=\"true\"><span class=\"base\"><span class=\"strut\" style=\"height:0.902771em;vertical-align:-0.208331em;\"></span><span class=\"mord\"><span class=\"mord mathnormal\">h</span><span class=\"msupsub\"><span class=\"vlist-t vlist-t2\"><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.301108em;\"><span style=\"top:-2.5500000000000003em;margin-left:0em;margin-right:0.05em;\"><span class=\"pstrut\" style=\"height:2.7em;\"></span><span class=\"sizing reset-size6 size3 mtight\"><span class=\"mord mtight\"><span class=\"mord mathnormal mtight\">t</span><span class=\"mbin mtight\">âˆ’</span><span class=\"mord mtight\">1</span></span></span></span></span><span class=\"vlist-s\">â€‹</span></span><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.208331em;\"><span></span></span></span></span></span></span></span></span></span> å’Œ <span class=\"katex\"><span class=\"katex-mathml\"><math xmlns=\"http://www.w3.org/1998/Math/MathML\"><semantics><mrow><msub><mi>x</mi><mi>t</mi></msub></mrow><annotation encoding=\"application/x-tex\">x_t</annotation></semantics></math></span><span class=\"katex-html\" aria-hidden=\"true\"><span class=\"base\"><span class=\"strut\" style=\"height:0.58056em;vertical-align:-0.15em;\"></span><span class=\"mord\"><span class=\"mord mathnormal\">x</span><span class=\"msupsub\"><span class=\"vlist-t vlist-t2\"><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.2805559999999999em;\"><span style=\"top:-2.5500000000000003em;margin-left:0em;margin-right:0.05em;\"><span class=\"pstrut\" style=\"height:2.7em;\"></span><span class=\"sizing reset-size6 size3 mtight\"><span class=\"mord mathnormal mtight\">t</span></span></span></span><span class=\"vlist-s\">â€‹</span></span><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.15em;\"><span></span></span></span></span></span></span></span></span></span> å†³å®šï¼Œé€šè¿‡ Sigmoid å‡½æ•°å¾—åˆ°ä¸€ä¸ª 0 åˆ° 1 ä¹‹é—´çš„å€¼ <span class=\"katex\"><span class=\"katex-mathml\"><math xmlns=\"http://www.w3.org/1998/Math/MathML\"><semantics><mrow><msub><mi>o</mi><mi>t</mi></msub></mrow><annotation encoding=\"application/x-tex\">o_t</annotation></semantics></math></span><span class=\"katex-html\" aria-hidden=\"true\"><span class=\"base\"><span class=\"strut\" style=\"height:0.58056em;vertical-align:-0.15em;\"></span><span class=\"mord\"><span class=\"mord mathnormal\">o</span><span class=\"msupsub\"><span class=\"vlist-t vlist-t2\"><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.2805559999999999em;\"><span style=\"top:-2.5500000000000003em;margin-left:0em;margin-right:0.05em;\"><span class=\"pstrut\" style=\"height:2.7em;\"></span><span class=\"sizing reset-size6 size3 mtight\"><span class=\"mord mathnormal mtight\">t</span></span></span></span><span class=\"vlist-s\">â€‹</span></span><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.15em;\"><span></span></span></span></span></span></span></span></span></span>ï¼Œæœ€åé€šè¿‡ <span class=\"katex\"><span class=\"katex-mathml\"><math xmlns=\"http://www.w3.org/1998/Math/MathML\"><semantics><mrow><mi>tanh</mi><mo>â¡</mo></mrow><annotation encoding=\"application/x-tex\">\\tanh</annotation></semantics></math></span><span class=\"katex-html\" aria-hidden=\"true\"><span class=\"base\"><span class=\"strut\" style=\"height:0.69444em;vertical-align:0em;\"></span><span class=\"mop\">tanh</span></span></span></span> å‡½æ•°å†³å®šæœ€åè¾“å‡ºçš„ä¿¡æ¯\n<ul>\n<li>è¾“å‡ºï¼š<span class=\"katex\"><span class=\"katex-mathml\"><math xmlns=\"http://www.w3.org/1998/Math/MathML\"><semantics><mrow><msub><mi>o</mi><mi>t</mi></msub><mo>=</mo><mi>Ïƒ</mi><mo stretchy=\"false\">(</mo><msub><mi>W</mi><mi>o</mi></msub><msub><mi>h</mi><mrow><mi>t</mi><mo>âˆ’</mo><mn>1</mn></mrow></msub><mo>+</mo><msub><mi>U</mi><mi>o</mi></msub><msub><mi>x</mi><mi>t</mi></msub><mo>+</mo><msub><mi>b</mi><mi>o</mi></msub><mo stretchy=\"false\">)</mo></mrow><annotation encoding=\"application/x-tex\">o_{t} = \\sigma(W_oh_{t-1} + U_ox_{t} + b_o)</annotation></semantics></math></span><span class=\"katex-html\" aria-hidden=\"true\"><span class=\"base\"><span class=\"strut\" style=\"height:0.58056em;vertical-align:-0.15em;\"></span><span class=\"mord\"><span class=\"mord mathnormal\">o</span><span class=\"msupsub\"><span class=\"vlist-t vlist-t2\"><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.2805559999999999em;\"><span style=\"top:-2.5500000000000003em;margin-left:0em;margin-right:0.05em;\"><span class=\"pstrut\" style=\"height:2.7em;\"></span><span class=\"sizing reset-size6 size3 mtight\"><span class=\"mord mtight\"><span class=\"mord mathnormal mtight\">t</span></span></span></span></span><span class=\"vlist-s\">â€‹</span></span><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.15em;\"><span></span></span></span></span></span></span><span class=\"mspace\" style=\"margin-right:0.2777777777777778em;\"></span><span class=\"mrel\">=</span><span class=\"mspace\" style=\"margin-right:0.2777777777777778em;\"></span></span><span class=\"base\"><span class=\"strut\" style=\"height:1em;vertical-align:-0.25em;\"></span><span class=\"mord mathnormal\" style=\"margin-right:0.03588em;\">Ïƒ</span><span class=\"mopen\">(</span><span class=\"mord\"><span class=\"mord mathnormal\" style=\"margin-right:0.13889em;\">W</span><span class=\"msupsub\"><span class=\"vlist-t vlist-t2\"><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.151392em;\"><span style=\"top:-2.5500000000000003em;margin-left:-0.13889em;margin-right:0.05em;\"><span class=\"pstrut\" style=\"height:2.7em;\"></span><span class=\"sizing reset-size6 size3 mtight\"><span class=\"mord mathnormal mtight\">o</span></span></span></span><span class=\"vlist-s\">â€‹</span></span><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.15em;\"><span></span></span></span></span></span></span><span class=\"mord\"><span class=\"mord mathnormal\">h</span><span class=\"msupsub\"><span class=\"vlist-t vlist-t2\"><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.301108em;\"><span style=\"top:-2.5500000000000003em;margin-left:0em;margin-right:0.05em;\"><span class=\"pstrut\" style=\"height:2.7em;\"></span><span class=\"sizing reset-size6 size3 mtight\"><span class=\"mord mtight\"><span class=\"mord mathnormal mtight\">t</span><span class=\"mbin mtight\">âˆ’</span><span class=\"mord mtight\">1</span></span></span></span></span><span class=\"vlist-s\">â€‹</span></span><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.208331em;\"><span></span></span></span></span></span></span><span class=\"mspace\" style=\"margin-right:0.2222222222222222em;\"></span><span class=\"mbin\">+</span><span class=\"mspace\" style=\"margin-right:0.2222222222222222em;\"></span></span><span class=\"base\"><span class=\"strut\" style=\"height:0.83333em;vertical-align:-0.15em;\"></span><span class=\"mord\"><span class=\"mord mathnormal\" style=\"margin-right:0.10903em;\">U</span><span class=\"msupsub\"><span class=\"vlist-t vlist-t2\"><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.151392em;\"><span style=\"top:-2.5500000000000003em;margin-left:-0.10903em;margin-right:0.05em;\"><span class=\"pstrut\" style=\"height:2.7em;\"></span><span class=\"sizing reset-size6 size3 mtight\"><span class=\"mord mathnormal mtight\">o</span></span></span></span><span class=\"vlist-s\">â€‹</span></span><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.15em;\"><span></span></span></span></span></span></span><span class=\"mord\"><span class=\"mord mathnormal\">x</span><span class=\"msupsub\"><span class=\"vlist-t vlist-t2\"><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.2805559999999999em;\"><span style=\"top:-2.5500000000000003em;margin-left:0em;margin-right:0.05em;\"><span class=\"pstrut\" style=\"height:2.7em;\"></span><span class=\"sizing reset-size6 size3 mtight\"><span class=\"mord mtight\"><span class=\"mord mathnormal mtight\">t</span></span></span></span></span><span class=\"vlist-s\">â€‹</span></span><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.15em;\"><span></span></span></span></span></span></span><span class=\"mspace\" style=\"margin-right:0.2222222222222222em;\"></span><span class=\"mbin\">+</span><span class=\"mspace\" style=\"margin-right:0.2222222222222222em;\"></span></span><span class=\"base\"><span class=\"strut\" style=\"height:1em;vertical-align:-0.25em;\"></span><span class=\"mord\"><span class=\"mord mathnormal\">b</span><span class=\"msupsub\"><span class=\"vlist-t vlist-t2\"><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.151392em;\"><span style=\"top:-2.5500000000000003em;margin-left:0em;margin-right:0.05em;\"><span class=\"pstrut\" style=\"height:2.7em;\"></span><span class=\"sizing reset-size6 size3 mtight\"><span class=\"mord mathnormal mtight\">o</span></span></span></span><span class=\"vlist-s\">â€‹</span></span><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.15em;\"><span></span></span></span></span></span></span><span class=\"mclose\">)</span></span></span></span> , h_{t} = o_{t}\\odot tanhC_</li>\n</ul>\n</li>\n<li><strong>é¢„æµ‹è¾“å‡ºï¼š</strong><span class=\"katex\"><span class=\"katex-mathml\"><math xmlns=\"http://www.w3.org/1998/Math/MathML\"><semantics><mrow><msub><mover accent=\"true\"><mi>y</mi><mo>^</mo></mover><mi>t</mi></msub><mo>=</mo><mi>Ïƒ</mi><mo stretchy=\"false\">(</mo><mi>V</mi><msub><mi>h</mi><mi>t</mi></msub><mo>+</mo><mi>c</mi><mo stretchy=\"false\">)</mo></mrow><annotation encoding=\"application/x-tex\">\\hat{y}_{t} = \\sigma(Vh_{t}+c)</annotation></semantics></math></span><span class=\"katex-html\" aria-hidden=\"true\"><span class=\"base\"><span class=\"strut\" style=\"height:0.8888799999999999em;vertical-align:-0.19444em;\"></span><span class=\"mord\"><span class=\"mord accent\"><span class=\"vlist-t vlist-t2\"><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.69444em;\"><span style=\"top:-3em;\"><span class=\"pstrut\" style=\"height:3em;\"></span><span class=\"mord\"><span class=\"mord mathnormal\" style=\"margin-right:0.03588em;\">y</span></span></span><span style=\"top:-3em;\"><span class=\"pstrut\" style=\"height:3em;\"></span><span class=\"accent-body\" style=\"left:-0.19444em;\"><span class=\"mord\">^</span></span></span></span><span class=\"vlist-s\">â€‹</span></span><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.19444em;\"><span></span></span></span></span></span><span class=\"msupsub\"><span class=\"vlist-t vlist-t2\"><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.2805559999999999em;\"><span style=\"top:-2.5500000000000003em;margin-right:0.05em;\"><span class=\"pstrut\" style=\"height:2.7em;\"></span><span class=\"sizing reset-size6 size3 mtight\"><span class=\"mord mtight\"><span class=\"mord mathnormal mtight\">t</span></span></span></span></span><span class=\"vlist-s\">â€‹</span></span><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.15em;\"><span></span></span></span></span></span></span><span class=\"mspace\" style=\"margin-right:0.2777777777777778em;\"></span><span class=\"mrel\">=</span><span class=\"mspace\" style=\"margin-right:0.2777777777777778em;\"></span></span><span class=\"base\"><span class=\"strut\" style=\"height:1em;vertical-align:-0.25em;\"></span><span class=\"mord mathnormal\" style=\"margin-right:0.03588em;\">Ïƒ</span><span class=\"mopen\">(</span><span class=\"mord mathnormal\" style=\"margin-right:0.22222em;\">V</span><span class=\"mord\"><span class=\"mord mathnormal\">h</span><span class=\"msupsub\"><span class=\"vlist-t vlist-t2\"><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.2805559999999999em;\"><span style=\"top:-2.5500000000000003em;margin-left:0em;margin-right:0.05em;\"><span class=\"pstrut\" style=\"height:2.7em;\"></span><span class=\"sizing reset-size6 size3 mtight\"><span class=\"mord mtight\"><span class=\"mord mathnormal mtight\">t</span></span></span></span></span><span class=\"vlist-s\">â€‹</span></span><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.15em;\"><span></span></span></span></span></span></span><span class=\"mspace\" style=\"margin-right:0.2222222222222222em;\"></span><span class=\"mbin\">+</span><span class=\"mspace\" style=\"margin-right:0.2222222222222222em;\"></span></span><span class=\"base\"><span class=\"strut\" style=\"height:1em;vertical-align:-0.25em;\"></span><span class=\"mord mathnormal\">c</span><span class=\"mclose\">)</span></span></span></span></li>\n</ul>\n<h2 id=\"64-lstm-è§£å†³-rnn-çš„æ¢¯åº¦æ¶ˆå¤±é—®é¢˜\"><a class=\"anchor\" href=\"#64-lstm-è§£å†³-rnn-çš„æ¢¯åº¦æ¶ˆå¤±é—®é¢˜\">#</a> 6.4 LSTM è§£å†³ RNN çš„æ¢¯åº¦æ¶ˆå¤±é—®é¢˜</h2>\n<p>æ˜ç™½äº† RNN æ¢¯åº¦æ¶ˆå¤±çš„åŸå› ä¹‹åï¼Œæˆ‘ä»¬çœ‹ LSTM å¦‚ä½•è§£å†³é—®é¢˜çš„å‘¢ï¼Ÿ</p>\n<p>RNN æ¢¯åº¦æ¶ˆå¤±çš„åŸå› æ˜¯ï¼Œéšç€æ¢¯åº¦çš„ä¼ å¯¼ï¼Œæ¢¯åº¦è¢«è¿‘è·ç¦»æ¢¯åº¦ä¸»å¯¼ï¼Œæ¨¡å‹éš¾ä»¥å­¦ä¹ åˆ°è¿œè·ç¦»çš„ä¿¡æ¯ã€‚å…·ä½“åŸå› ä¹Ÿå°±æ˜¯ <span class=\"katex\"><span class=\"katex-mathml\"><math xmlns=\"http://www.w3.org/1998/Math/MathML\"><semantics><mrow><msubsup><mo>âˆ</mo><mrow><mi>k</mi><mo>=</mo><mi>t</mi><mo>+</mo><mn>1</mn></mrow><mi>T</mi></msubsup><mfrac><mrow><mi mathvariant=\"normal\">âˆ‚</mi><msub><mi>h</mi><mi>k</mi></msub></mrow><mrow><mi mathvariant=\"normal\">âˆ‚</mi><msub><mi>h</mi><mrow><mi>k</mi><mo>âˆ’</mo><mn>1</mn></mrow></msub></mrow></mfrac></mrow><annotation encoding=\"application/x-tex\">\\prod_{k=t+1}^{T}\\frac{\\partial h_{k}}{\\partial h_{k - 1}}</annotation></semantics></math></span><span class=\"katex-html\" aria-hidden=\"true\"><span class=\"base\"><span class=\"strut\" style=\"height:1.4737559999999998em;vertical-align:-0.4925249999999999em;\"></span><span class=\"mop\"><span class=\"mop op-symbol small-op\" style=\"position:relative;top:-0.0000050000000000050004em;\">âˆ</span><span class=\"msupsub\"><span class=\"vlist-t vlist-t2\"><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.981231em;\"><span style=\"top:-2.40029em;margin-left:0em;margin-right:0.05em;\"><span class=\"pstrut\" style=\"height:2.7em;\"></span><span class=\"sizing reset-size6 size3 mtight\"><span class=\"mord mtight\"><span class=\"mord mathnormal mtight\" style=\"margin-right:0.03148em;\">k</span><span class=\"mrel mtight\">=</span><span class=\"mord mathnormal mtight\">t</span><span class=\"mbin mtight\">+</span><span class=\"mord mtight\">1</span></span></span></span><span style=\"top:-3.2029em;margin-right:0.05em;\"><span class=\"pstrut\" style=\"height:2.7em;\"></span><span class=\"sizing reset-size6 size3 mtight\"><span class=\"mord mtight\"><span class=\"mord mathnormal mtight\" style=\"margin-right:0.13889em;\">T</span></span></span></span></span><span class=\"vlist-s\">â€‹</span></span><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.35804100000000005em;\"><span></span></span></span></span></span></span><span class=\"mspace\" style=\"margin-right:0.16666666666666666em;\"></span><span class=\"mord\"><span class=\"mopen nulldelimiter\"></span><span class=\"mfrac\"><span class=\"vlist-t vlist-t2\"><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.9019679999999999em;\"><span style=\"top:-2.6550000000000002em;\"><span class=\"pstrut\" style=\"height:3em;\"></span><span class=\"sizing reset-size6 size3 mtight\"><span class=\"mord mtight\"><span class=\"mord mtight\" style=\"margin-right:0.05556em;\">âˆ‚</span><span class=\"mord mtight\"><span class=\"mord mathnormal mtight\">h</span><span class=\"msupsub\"><span class=\"vlist-t vlist-t2\"><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.34480000000000005em;\"><span style=\"top:-2.3487714285714287em;margin-left:0em;margin-right:0.07142857142857144em;\"><span class=\"pstrut\" style=\"height:2.5em;\"></span><span class=\"sizing reset-size3 size1 mtight\"><span class=\"mord mtight\"><span class=\"mord mathnormal mtight\" style=\"margin-right:0.03148em;\">k</span><span class=\"mbin mtight\">âˆ’</span><span class=\"mord mtight\">1</span></span></span></span></span><span class=\"vlist-s\">â€‹</span></span><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.21074999999999994em;\"><span></span></span></span></span></span></span></span></span></span><span style=\"top:-3.23em;\"><span class=\"pstrut\" style=\"height:3em;\"></span><span class=\"frac-line\" style=\"border-bottom-width:0.04em;\"></span></span><span style=\"top:-3.41586em;\"><span class=\"pstrut\" style=\"height:3em;\"></span><span class=\"sizing reset-size6 size3 mtight\"><span class=\"mord mtight\"><span class=\"mord mtight\" style=\"margin-right:0.05556em;\">âˆ‚</span><span class=\"mord mtight\"><span class=\"mord mathnormal mtight\">h</span><span class=\"msupsub\"><span class=\"vlist-t vlist-t2\"><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.3448em;\"><span style=\"top:-2.3487714285714287em;margin-left:0em;margin-right:0.07142857142857144em;\"><span class=\"pstrut\" style=\"height:2.5em;\"></span><span class=\"sizing reset-size3 size1 mtight\"><span class=\"mord mtight\"><span class=\"mord mathnormal mtight\" style=\"margin-right:0.03148em;\">k</span></span></span></span></span><span class=\"vlist-s\">â€‹</span></span><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.15122857142857138em;\"><span></span></span></span></span></span></span></span></span></span></span><span class=\"vlist-s\">â€‹</span></span><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.4925249999999999em;\"><span></span></span></span></span></span><span class=\"mclose nulldelimiter\"></span></span></span></span></span> éƒ¨åˆ†ï¼Œåœ¨è¿­ä»£è¿‡ç¨‹ä¸­ï¼Œæ¯ä¸€æ­¥ <span class=\"katex\"><span class=\"katex-mathml\"><math xmlns=\"http://www.w3.org/1998/Math/MathML\"><semantics><mrow><mfrac><mrow><mi mathvariant=\"normal\">âˆ‚</mi><msub><mi>h</mi><mi>k</mi></msub></mrow><mrow><mi mathvariant=\"normal\">âˆ‚</mi><msub><mi>h</mi><mrow><mi>k</mi><mo>âˆ’</mo><mn>1</mn></mrow></msub></mrow></mfrac></mrow><annotation encoding=\"application/x-tex\">\\frac{\\partial h_{k}}{\\partial h_{k - 1}}</annotation></semantics></math></span><span class=\"katex-html\" aria-hidden=\"true\"><span class=\"base\"><span class=\"strut\" style=\"height:1.3944929999999998em;vertical-align:-0.4925249999999999em;\"></span><span class=\"mord\"><span class=\"mopen nulldelimiter\"></span><span class=\"mfrac\"><span class=\"vlist-t vlist-t2\"><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.9019679999999999em;\"><span style=\"top:-2.6550000000000002em;\"><span class=\"pstrut\" style=\"height:3em;\"></span><span class=\"sizing reset-size6 size3 mtight\"><span class=\"mord mtight\"><span class=\"mord mtight\" style=\"margin-right:0.05556em;\">âˆ‚</span><span class=\"mord mtight\"><span class=\"mord mathnormal mtight\">h</span><span class=\"msupsub\"><span class=\"vlist-t vlist-t2\"><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.34480000000000005em;\"><span style=\"top:-2.3487714285714287em;margin-left:0em;margin-right:0.07142857142857144em;\"><span class=\"pstrut\" style=\"height:2.5em;\"></span><span class=\"sizing reset-size3 size1 mtight\"><span class=\"mord mtight\"><span class=\"mord mathnormal mtight\" style=\"margin-right:0.03148em;\">k</span><span class=\"mbin mtight\">âˆ’</span><span class=\"mord mtight\">1</span></span></span></span></span><span class=\"vlist-s\">â€‹</span></span><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.21074999999999994em;\"><span></span></span></span></span></span></span></span></span></span><span style=\"top:-3.23em;\"><span class=\"pstrut\" style=\"height:3em;\"></span><span class=\"frac-line\" style=\"border-bottom-width:0.04em;\"></span></span><span style=\"top:-3.41586em;\"><span class=\"pstrut\" style=\"height:3em;\"></span><span class=\"sizing reset-size6 size3 mtight\"><span class=\"mord mtight\"><span class=\"mord mtight\" style=\"margin-right:0.05556em;\">âˆ‚</span><span class=\"mord mtight\"><span class=\"mord mathnormal mtight\">h</span><span class=\"msupsub\"><span class=\"vlist-t vlist-t2\"><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.3448em;\"><span style=\"top:-2.3487714285714287em;margin-left:0em;margin-right:0.07142857142857144em;\"><span class=\"pstrut\" style=\"height:2.5em;\"></span><span class=\"sizing reset-size3 size1 mtight\"><span class=\"mord mtight\"><span class=\"mord mathnormal mtight\" style=\"margin-right:0.03148em;\">k</span></span></span></span></span><span class=\"vlist-s\">â€‹</span></span><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.15122857142857138em;\"><span></span></span></span></span></span></span></span></span></span></span><span class=\"vlist-s\">â€‹</span></span><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.4925249999999999em;\"><span></span></span></span></span></span><span class=\"mclose nulldelimiter\"></span></span></span></span></span> <strong>å§‹ç»ˆåœ¨ [0,1) ä¹‹é—´æˆ–è€…å§‹ç»ˆå¤§äº 1ã€‚</strong></p>\n<p>è€Œå¯¹äº LSTM æ¨¡å‹è€Œè¨€ï¼Œé’ˆå¯¹ <span class=\"katex\"><span class=\"katex-mathml\"><math xmlns=\"http://www.w3.org/1998/Math/MathML\"><semantics><mrow><msubsup><mo>âˆ</mo><mrow><mi>k</mi><mo>=</mo><mi>t</mi><mo>+</mo><mn>1</mn></mrow><mi>T</mi></msubsup><mfrac><mrow><mi mathvariant=\"normal\">âˆ‚</mi><msub><mi>C</mi><mi>k</mi></msub></mrow><mrow><mi mathvariant=\"normal\">âˆ‚</mi><msub><mi>C</mi><mrow><mi>k</mi><mo>âˆ’</mo><mn>1</mn></mrow></msub></mrow></mfrac></mrow><annotation encoding=\"application/x-tex\">\\prod _{k=t+1}^{T} \\frac{\\partial C_{k}}{\\partial C_{k-1}}</annotation></semantics></math></span><span class=\"katex-html\" aria-hidden=\"true\"><span class=\"base\"><span class=\"strut\" style=\"height:1.4737559999999998em;vertical-align:-0.4925249999999999em;\"></span><span class=\"mop\"><span class=\"mop op-symbol small-op\" style=\"position:relative;top:-0.0000050000000000050004em;\">âˆ</span><span class=\"msupsub\"><span class=\"vlist-t vlist-t2\"><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.981231em;\"><span style=\"top:-2.40029em;margin-left:0em;margin-right:0.05em;\"><span class=\"pstrut\" style=\"height:2.7em;\"></span><span class=\"sizing reset-size6 size3 mtight\"><span class=\"mord mtight\"><span class=\"mord mathnormal mtight\" style=\"margin-right:0.03148em;\">k</span><span class=\"mrel mtight\">=</span><span class=\"mord mathnormal mtight\">t</span><span class=\"mbin mtight\">+</span><span class=\"mord mtight\">1</span></span></span></span><span style=\"top:-3.2029em;margin-right:0.05em;\"><span class=\"pstrut\" style=\"height:2.7em;\"></span><span class=\"sizing reset-size6 size3 mtight\"><span class=\"mord mtight\"><span class=\"mord mathnormal mtight\" style=\"margin-right:0.13889em;\">T</span></span></span></span></span><span class=\"vlist-s\">â€‹</span></span><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.35804100000000005em;\"><span></span></span></span></span></span></span><span class=\"mspace\" style=\"margin-right:0.16666666666666666em;\"></span><span class=\"mord\"><span class=\"mopen nulldelimiter\"></span><span class=\"mfrac\"><span class=\"vlist-t vlist-t2\"><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.9019679999999999em;\"><span style=\"top:-2.6550000000000002em;\"><span class=\"pstrut\" style=\"height:3em;\"></span><span class=\"sizing reset-size6 size3 mtight\"><span class=\"mord mtight\"><span class=\"mord mtight\" style=\"margin-right:0.05556em;\">âˆ‚</span><span class=\"mord mtight\"><span class=\"mord mathnormal mtight\" style=\"margin-right:0.07153em;\">C</span><span class=\"msupsub\"><span class=\"vlist-t vlist-t2\"><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.34480000000000005em;\"><span style=\"top:-2.3487714285714287em;margin-left:-0.07153em;margin-right:0.07142857142857144em;\"><span class=\"pstrut\" style=\"height:2.5em;\"></span><span class=\"sizing reset-size3 size1 mtight\"><span class=\"mord mtight\"><span class=\"mord mathnormal mtight\" style=\"margin-right:0.03148em;\">k</span><span class=\"mbin mtight\">âˆ’</span><span class=\"mord mtight\">1</span></span></span></span></span><span class=\"vlist-s\">â€‹</span></span><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.21074999999999994em;\"><span></span></span></span></span></span></span></span></span></span><span style=\"top:-3.23em;\"><span class=\"pstrut\" style=\"height:3em;\"></span><span class=\"frac-line\" style=\"border-bottom-width:0.04em;\"></span></span><span style=\"top:-3.41586em;\"><span class=\"pstrut\" style=\"height:3em;\"></span><span class=\"sizing reset-size6 size3 mtight\"><span class=\"mord mtight\"><span class=\"mord mtight\" style=\"margin-right:0.05556em;\">âˆ‚</span><span class=\"mord mtight\"><span class=\"mord mathnormal mtight\" style=\"margin-right:0.07153em;\">C</span><span class=\"msupsub\"><span class=\"vlist-t vlist-t2\"><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.3448em;\"><span style=\"top:-2.3487714285714287em;margin-left:-0.07153em;margin-right:0.07142857142857144em;\"><span class=\"pstrut\" style=\"height:2.5em;\"></span><span class=\"sizing reset-size3 size1 mtight\"><span class=\"mord mtight\"><span class=\"mord mathnormal mtight\" style=\"margin-right:0.03148em;\">k</span></span></span></span></span><span class=\"vlist-s\">â€‹</span></span><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.15122857142857138em;\"><span></span></span></span></span></span></span></span></span></span></span><span class=\"vlist-s\">â€‹</span></span><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.4925249999999999em;\"><span></span></span></span></span></span><span class=\"mclose nulldelimiter\"></span></span></span></span></span> æ±‚å¾—ï¼š</p>\n\\begin{align}\n& \\frac{\\partial C_{k}}{\\partial C_{k-1}} = f_k + other \\\\\n& \\prod _{k=t+1}^{T} \\frac{\\partial C_{k}}{\\partial C_{k-1}} = f_{k}f_{k+1}...f_{T} + other  \\\\\n\\end{align}\n\n<p>åœ¨ LSTM è¿­ä»£è¿‡ç¨‹ä¸­ï¼Œé’ˆå¯¹ <span class=\"katex\"><span class=\"katex-mathml\"><math xmlns=\"http://www.w3.org/1998/Math/MathML\"><semantics><mrow><msubsup><mo>âˆ</mo><mrow><mi>k</mi><mo>=</mo><mi>t</mi><mo>+</mo><mn>1</mn></mrow><mi>T</mi></msubsup><mfrac><mrow><mi mathvariant=\"normal\">âˆ‚</mi><msub><mi>C</mi><mi>k</mi></msub></mrow><mrow><mi mathvariant=\"normal\">âˆ‚</mi><msub><mi>C</mi><mrow><mi>k</mi><mo>âˆ’</mo><mn>1</mn></mrow></msub></mrow></mfrac></mrow><annotation encoding=\"application/x-tex\">\\prod_{k=t+1}^{T} \\frac{\\partial C_{k}}{\\partial C_{k-1}}</annotation></semantics></math></span><span class=\"katex-html\" aria-hidden=\"true\"><span class=\"base\"><span class=\"strut\" style=\"height:1.4737559999999998em;vertical-align:-0.4925249999999999em;\"></span><span class=\"mop\"><span class=\"mop op-symbol small-op\" style=\"position:relative;top:-0.0000050000000000050004em;\">âˆ</span><span class=\"msupsub\"><span class=\"vlist-t vlist-t2\"><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.981231em;\"><span style=\"top:-2.40029em;margin-left:0em;margin-right:0.05em;\"><span class=\"pstrut\" style=\"height:2.7em;\"></span><span class=\"sizing reset-size6 size3 mtight\"><span class=\"mord mtight\"><span class=\"mord mathnormal mtight\" style=\"margin-right:0.03148em;\">k</span><span class=\"mrel mtight\">=</span><span class=\"mord mathnormal mtight\">t</span><span class=\"mbin mtight\">+</span><span class=\"mord mtight\">1</span></span></span></span><span style=\"top:-3.2029em;margin-right:0.05em;\"><span class=\"pstrut\" style=\"height:2.7em;\"></span><span class=\"sizing reset-size6 size3 mtight\"><span class=\"mord mtight\"><span class=\"mord mathnormal mtight\" style=\"margin-right:0.13889em;\">T</span></span></span></span></span><span class=\"vlist-s\">â€‹</span></span><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.35804100000000005em;\"><span></span></span></span></span></span></span><span class=\"mspace\" style=\"margin-right:0.16666666666666666em;\"></span><span class=\"mord\"><span class=\"mopen nulldelimiter\"></span><span class=\"mfrac\"><span class=\"vlist-t vlist-t2\"><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.9019679999999999em;\"><span style=\"top:-2.6550000000000002em;\"><span class=\"pstrut\" style=\"height:3em;\"></span><span class=\"sizing reset-size6 size3 mtight\"><span class=\"mord mtight\"><span class=\"mord mtight\" style=\"margin-right:0.05556em;\">âˆ‚</span><span class=\"mord mtight\"><span class=\"mord mathnormal mtight\" style=\"margin-right:0.07153em;\">C</span><span class=\"msupsub\"><span class=\"vlist-t vlist-t2\"><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.34480000000000005em;\"><span style=\"top:-2.3487714285714287em;margin-left:-0.07153em;margin-right:0.07142857142857144em;\"><span class=\"pstrut\" style=\"height:2.5em;\"></span><span class=\"sizing reset-size3 size1 mtight\"><span class=\"mord mtight\"><span class=\"mord mathnormal mtight\" style=\"margin-right:0.03148em;\">k</span><span class=\"mbin mtight\">âˆ’</span><span class=\"mord mtight\">1</span></span></span></span></span><span class=\"vlist-s\">â€‹</span></span><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.21074999999999994em;\"><span></span></span></span></span></span></span></span></span></span><span style=\"top:-3.23em;\"><span class=\"pstrut\" style=\"height:3em;\"></span><span class=\"frac-line\" style=\"border-bottom-width:0.04em;\"></span></span><span style=\"top:-3.41586em;\"><span class=\"pstrut\" style=\"height:3em;\"></span><span class=\"sizing reset-size6 size3 mtight\"><span class=\"mord mtight\"><span class=\"mord mtight\" style=\"margin-right:0.05556em;\">âˆ‚</span><span class=\"mord mtight\"><span class=\"mord mathnormal mtight\" style=\"margin-right:0.07153em;\">C</span><span class=\"msupsub\"><span class=\"vlist-t vlist-t2\"><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.3448em;\"><span style=\"top:-2.3487714285714287em;margin-left:-0.07153em;margin-right:0.07142857142857144em;\"><span class=\"pstrut\" style=\"height:2.5em;\"></span><span class=\"sizing reset-size3 size1 mtight\"><span class=\"mord mtight\"><span class=\"mord mathnormal mtight\" style=\"margin-right:0.03148em;\">k</span></span></span></span></span><span class=\"vlist-s\">â€‹</span></span><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.15122857142857138em;\"><span></span></span></span></span></span></span></span></span></span></span><span class=\"vlist-s\">â€‹</span></span><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.4925249999999999em;\"><span></span></span></span></span></span><span class=\"mclose nulldelimiter\"></span></span></span></span></span> è€Œè¨€ï¼Œæ¯ä¸€æ­¥<span class=\"katex\"><span class=\"katex-mathml\"><math xmlns=\"http://www.w3.org/1998/Math/MathML\"><semantics><mrow><mfrac><mrow><mi mathvariant=\"normal\">âˆ‚</mi><msub><mi>C</mi><mi>k</mi></msub></mrow><mrow><mi mathvariant=\"normal\">âˆ‚</mi><msub><mi>C</mi><mrow><mi>k</mi><mo>âˆ’</mo><mn>1</mn></mrow></msub></mrow></mfrac></mrow><annotation encoding=\"application/x-tex\">\\frac{\\partial C_{k}}{\\partial C_{k-1}}</annotation></semantics></math></span><span class=\"katex-html\" aria-hidden=\"true\"><span class=\"base\"><span class=\"strut\" style=\"height:1.3944929999999998em;vertical-align:-0.4925249999999999em;\"></span><span class=\"mord\"><span class=\"mopen nulldelimiter\"></span><span class=\"mfrac\"><span class=\"vlist-t vlist-t2\"><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.9019679999999999em;\"><span style=\"top:-2.6550000000000002em;\"><span class=\"pstrut\" style=\"height:3em;\"></span><span class=\"sizing reset-size6 size3 mtight\"><span class=\"mord mtight\"><span class=\"mord mtight\" style=\"margin-right:0.05556em;\">âˆ‚</span><span class=\"mord mtight\"><span class=\"mord mathnormal mtight\" style=\"margin-right:0.07153em;\">C</span><span class=\"msupsub\"><span class=\"vlist-t vlist-t2\"><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.34480000000000005em;\"><span style=\"top:-2.3487714285714287em;margin-left:-0.07153em;margin-right:0.07142857142857144em;\"><span class=\"pstrut\" style=\"height:2.5em;\"></span><span class=\"sizing reset-size3 size1 mtight\"><span class=\"mord mtight\"><span class=\"mord mathnormal mtight\" style=\"margin-right:0.03148em;\">k</span><span class=\"mbin mtight\">âˆ’</span><span class=\"mord mtight\">1</span></span></span></span></span><span class=\"vlist-s\">â€‹</span></span><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.21074999999999994em;\"><span></span></span></span></span></span></span></span></span></span><span style=\"top:-3.23em;\"><span class=\"pstrut\" style=\"height:3em;\"></span><span class=\"frac-line\" style=\"border-bottom-width:0.04em;\"></span></span><span style=\"top:-3.41586em;\"><span class=\"pstrut\" style=\"height:3em;\"></span><span class=\"sizing reset-size6 size3 mtight\"><span class=\"mord mtight\"><span class=\"mord mtight\" style=\"margin-right:0.05556em;\">âˆ‚</span><span class=\"mord mtight\"><span class=\"mord mathnormal mtight\" style=\"margin-right:0.07153em;\">C</span><span class=\"msupsub\"><span class=\"vlist-t vlist-t2\"><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.3448em;\"><span style=\"top:-2.3487714285714287em;margin-left:-0.07153em;margin-right:0.07142857142857144em;\"><span class=\"pstrut\" style=\"height:2.5em;\"></span><span class=\"sizing reset-size3 size1 mtight\"><span class=\"mord mtight\"><span class=\"mord mathnormal mtight\" style=\"margin-right:0.03148em;\">k</span></span></span></span></span><span class=\"vlist-s\">â€‹</span></span><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.15122857142857138em;\"><span></span></span></span></span></span></span></span></span></span></span><span class=\"vlist-s\">â€‹</span></span><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.4925249999999999em;\"><span></span></span></span></span></span><span class=\"mclose nulldelimiter\"></span></span></span></span></span> <strong>å¯ä»¥è‡ªä¸»çš„é€‰æ‹©åœ¨ [0,1] ä¹‹é—´ï¼Œæˆ–è€…å¤§äº 1</strong>ï¼Œå› ä¸º <span class=\"katex\"><span class=\"katex-mathml\"><math xmlns=\"http://www.w3.org/1998/Math/MathML\"><semantics><mrow><msub><mi>f</mi><mi>k</mi></msub></mrow><annotation encoding=\"application/x-tex\">f_{k}</annotation></semantics></math></span><span class=\"katex-html\" aria-hidden=\"true\"><span class=\"base\"><span class=\"strut\" style=\"height:0.8888799999999999em;vertical-align:-0.19444em;\"></span><span class=\"mord\"><span class=\"mord mathnormal\" style=\"margin-right:0.10764em;\">f</span><span class=\"msupsub\"><span class=\"vlist-t vlist-t2\"><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.33610799999999996em;\"><span style=\"top:-2.5500000000000003em;margin-left:-0.10764em;margin-right:0.05em;\"><span class=\"pstrut\" style=\"height:2.7em;\"></span><span class=\"sizing reset-size6 size3 mtight\"><span class=\"mord mtight\"><span class=\"mord mathnormal mtight\" style=\"margin-right:0.03148em;\">k</span></span></span></span></span><span class=\"vlist-s\">â€‹</span></span><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.15em;\"><span></span></span></span></span></span></span></span></span></span> æ˜¯å¯è®­ç»ƒå­¦ä¹ çš„ã€‚é‚£ä¹ˆæ•´ä½“ <span class=\"katex\"><span class=\"katex-mathml\"><math xmlns=\"http://www.w3.org/1998/Math/MathML\"><semantics><mrow><msubsup><mo>âˆ</mo><mrow><mi>k</mi><mo>=</mo><mi>t</mi><mo>+</mo><mn>1</mn></mrow><mi>T</mi></msubsup><mfrac><mrow><mi mathvariant=\"normal\">âˆ‚</mi><msub><mi>C</mi><mi>k</mi></msub></mrow><mrow><mi mathvariant=\"normal\">âˆ‚</mi><msub><mi>C</mi><mrow><mi>k</mi><mo>âˆ’</mo><mn>1</mn></mrow></msub></mrow></mfrac></mrow><annotation encoding=\"application/x-tex\">\\prod _{k=t+1}^{T} \\frac{\\partial C_{k}}{\\partial C_{k-1}}</annotation></semantics></math></span><span class=\"katex-html\" aria-hidden=\"true\"><span class=\"base\"><span class=\"strut\" style=\"height:1.4737559999999998em;vertical-align:-0.4925249999999999em;\"></span><span class=\"mop\"><span class=\"mop op-symbol small-op\" style=\"position:relative;top:-0.0000050000000000050004em;\">âˆ</span><span class=\"msupsub\"><span class=\"vlist-t vlist-t2\"><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.981231em;\"><span style=\"top:-2.40029em;margin-left:0em;margin-right:0.05em;\"><span class=\"pstrut\" style=\"height:2.7em;\"></span><span class=\"sizing reset-size6 size3 mtight\"><span class=\"mord mtight\"><span class=\"mord mathnormal mtight\" style=\"margin-right:0.03148em;\">k</span><span class=\"mrel mtight\">=</span><span class=\"mord mathnormal mtight\">t</span><span class=\"mbin mtight\">+</span><span class=\"mord mtight\">1</span></span></span></span><span style=\"top:-3.2029em;margin-right:0.05em;\"><span class=\"pstrut\" style=\"height:2.7em;\"></span><span class=\"sizing reset-size6 size3 mtight\"><span class=\"mord mtight\"><span class=\"mord mathnormal mtight\" style=\"margin-right:0.13889em;\">T</span></span></span></span></span><span class=\"vlist-s\">â€‹</span></span><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.35804100000000005em;\"><span></span></span></span></span></span></span><span class=\"mspace\" style=\"margin-right:0.16666666666666666em;\"></span><span class=\"mord\"><span class=\"mopen nulldelimiter\"></span><span class=\"mfrac\"><span class=\"vlist-t vlist-t2\"><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.9019679999999999em;\"><span style=\"top:-2.6550000000000002em;\"><span class=\"pstrut\" style=\"height:3em;\"></span><span class=\"sizing reset-size6 size3 mtight\"><span class=\"mord mtight\"><span class=\"mord mtight\" style=\"margin-right:0.05556em;\">âˆ‚</span><span class=\"mord mtight\"><span class=\"mord mathnormal mtight\" style=\"margin-right:0.07153em;\">C</span><span class=\"msupsub\"><span class=\"vlist-t vlist-t2\"><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.34480000000000005em;\"><span style=\"top:-2.3487714285714287em;margin-left:-0.07153em;margin-right:0.07142857142857144em;\"><span class=\"pstrut\" style=\"height:2.5em;\"></span><span class=\"sizing reset-size3 size1 mtight\"><span class=\"mord mtight\"><span class=\"mord mathnormal mtight\" style=\"margin-right:0.03148em;\">k</span><span class=\"mbin mtight\">âˆ’</span><span class=\"mord mtight\">1</span></span></span></span></span><span class=\"vlist-s\">â€‹</span></span><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.21074999999999994em;\"><span></span></span></span></span></span></span></span></span></span><span style=\"top:-3.23em;\"><span class=\"pstrut\" style=\"height:3em;\"></span><span class=\"frac-line\" style=\"border-bottom-width:0.04em;\"></span></span><span style=\"top:-3.41586em;\"><span class=\"pstrut\" style=\"height:3em;\"></span><span class=\"sizing reset-size6 size3 mtight\"><span class=\"mord mtight\"><span class=\"mord mtight\" style=\"margin-right:0.05556em;\">âˆ‚</span><span class=\"mord mtight\"><span class=\"mord mathnormal mtight\" style=\"margin-right:0.07153em;\">C</span><span class=\"msupsub\"><span class=\"vlist-t vlist-t2\"><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.3448em;\"><span style=\"top:-2.3487714285714287em;margin-left:-0.07153em;margin-right:0.07142857142857144em;\"><span class=\"pstrut\" style=\"height:2.5em;\"></span><span class=\"sizing reset-size3 size1 mtight\"><span class=\"mord mtight\"><span class=\"mord mathnormal mtight\" style=\"margin-right:0.03148em;\">k</span></span></span></span></span><span class=\"vlist-s\">â€‹</span></span><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.15122857142857138em;\"><span></span></span></span></span></span></span></span></span></span></span><span class=\"vlist-s\">â€‹</span></span><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.4925249999999999em;\"><span></span></span></span></span></span><span class=\"mclose nulldelimiter\"></span></span></span></span></span> ä¹Ÿå°±ä¸ä¼šä¸€ç›´å‡å°ï¼Œè¿œè·ç¦»æ¢¯åº¦ä¸è‡³äºå®Œå…¨æ¶ˆå¤±ï¼Œä¹Ÿå°±èƒ½å¤Ÿè§£å†³ RNN ä¸­å­˜åœ¨çš„æ¢¯åº¦æ¶ˆå¤±é—®é¢˜ã€‚</p>\n<p>LSTM é—å¿˜é—¨å€¼ <span class=\"katex\"><span class=\"katex-mathml\"><math xmlns=\"http://www.w3.org/1998/Math/MathML\"><semantics><mrow><msub><mi>f</mi><mi>t</mi></msub></mrow><annotation encoding=\"application/x-tex\">f_t</annotation></semantics></math></span><span class=\"katex-html\" aria-hidden=\"true\"><span class=\"base\"><span class=\"strut\" style=\"height:0.8888799999999999em;vertical-align:-0.19444em;\"></span><span class=\"mord\"><span class=\"mord mathnormal\" style=\"margin-right:0.10764em;\">f</span><span class=\"msupsub\"><span class=\"vlist-t vlist-t2\"><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.2805559999999999em;\"><span style=\"top:-2.5500000000000003em;margin-left:-0.10764em;margin-right:0.05em;\"><span class=\"pstrut\" style=\"height:2.7em;\"></span><span class=\"sizing reset-size6 size3 mtight\"><span class=\"mord mathnormal mtight\">t</span></span></span></span><span class=\"vlist-s\">â€‹</span></span><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.15em;\"><span></span></span></span></span></span></span></span></span></span> å¯ä»¥é€‰æ‹©åœ¨ [0,1] ä¹‹é—´ï¼Œè®© LSTM æ¥æ”¹å–„æ¢¯åº¦æ¶ˆå¤±çš„æƒ…å†µã€‚ä¹Ÿå¯ä»¥é€‰æ‹©æ¥è¿‘ 1ï¼Œè®©é—å¿˜é—¨é¥±å’Œï¼Œæ­¤æ—¶è¿œè·ç¦»ä¿¡æ¯æ¢¯åº¦ä¸æ¶ˆå¤±ï¼›ä¹Ÿå¯ä»¥é€‰æ‹©æ¥è¿‘ 0ï¼Œæ­¤æ—¶æ¨¡å‹æ˜¯æ•…æ„é˜»æ–­æ¢¯åº¦æµï¼Œé—å¿˜ä¹‹å‰ä¿¡æ¯ã€‚</p>\n<p>å¦å¤–éœ€è¦å¼ºè°ƒçš„æ˜¯ LSTM æçš„è¿™ä¹ˆå¤æ‚ï¼Œ<strong>é™¤äº†åœ¨ç»“æ„ä¸Šå¤©ç„¶åœ°å…‹æœäº†æ¢¯åº¦æ¶ˆå¤±çš„é—®é¢˜ï¼Œæ›´é‡è¦çš„æ˜¯å…·æœ‰æ›´å¤šçš„å‚æ•°æ¥æ§åˆ¶æ¨¡å‹</strong>ï¼›é€šè¿‡å››å€äº RNN çš„å‚æ•°é‡ï¼Œå¯ä»¥æ›´åŠ ç²¾ç»†åœ°é¢„æµ‹æ—¶é—´åºåˆ—å˜é‡ã€‚</p>\n<p>æ­¤å¤–ï¼Œæˆ‘è®°å¾—æœ‰ä¸€ç¯‡æ–‡ç« è®²åˆ°ï¼Œ<strong>LSTM åœ¨ 200 å·¦å³é•¿åº¦çš„æ–‡æœ¬ä¸Šï¼Œå°±å·²ç»æ‰è¥Ÿè§è‚˜äº†</strong>ã€‚</p>\n<h1 id=\"ä¸ƒ-elmo-æ¨¡å‹\"><a class=\"anchor\" href=\"#ä¸ƒ-elmo-æ¨¡å‹\">#</a> ä¸ƒã€ELMo æ¨¡å‹</h1>\n<h2 id=\"71-elmo-çš„é¢„è®­ç»ƒ\"><a class=\"anchor\" href=\"#71-elmo-çš„é¢„è®­ç»ƒ\">#</a> 7.1 ELMo çš„é¢„è®­ç»ƒ</h2>\n<p>åœ¨è®²è§£ Word Embedding æ—¶ï¼Œç»†å¿ƒåœ°è¯»è€…ä¸€å®šå·²ç»å‘ç°ï¼Œè¿™äº›è¯è¡¨ç¤ºæ–¹æ³•æœ¬è´¨ä¸Šæ˜¯é™æ€çš„ï¼Œæ¯ä¸€ä¸ªè¯éƒ½æœ‰ä¸€ä¸ªå”¯ä¸€ç¡®å®šçš„è¯å‘é‡ï¼Œä¸èƒ½æ ¹æ®å¥å­çš„ä¸åŒè€Œæ”¹å˜ï¼Œæ— æ³•å¤„ç†è‡ªç„¶è¯­è¨€å¤„ç†ä»»åŠ¡ä¸­çš„å¤šä¹‰è¯é—®é¢˜ã€‚</p>\n<p>&lt;img src=&quot;<span class=\"exturl\" data-url=\"aHR0cHM6Ly9pbWdtZC5vc3MtY24tc2hhbmdoYWkuYWxpeXVuY3MuY29tL0JFUlRfSU1HL3dlJUU1JUE0JTlBJUU0JUI5JTg5JUU4JUFGJThEJUU5JTk3JUFFJUU5JUEyJTk4LmpwZw==\">https://imgmd.oss-cn-shanghai.aliyuncs.com/BERT_IMG/we å¤šä¹‰è¯é—®é¢˜.jpg</span>&quot; style=&quot;zoom:50%;&quot; /&gt;</p>\n<p>å¦‚ä¸Šå›¾æ‰€ç¤ºï¼Œä¾‹å¦‚å¤šä¹‰è¯ Bankï¼Œæœ‰ä¸¤ä¸ªå¸¸ç”¨å«ä¹‰ï¼Œä½†æ˜¯ Word Embedding åœ¨å¯¹ bank è¿™ä¸ªå•è¯è¿›è¡Œç¼–ç çš„æ—¶å€™ï¼Œæ˜¯åŒºåˆ†ä¸å¼€è¿™ä¸¤ä¸ªå«ä¹‰çš„ã€‚</p>\n<p>å› ä¸ºå°½ç®¡è¿™ä¸¤å¥å«æœ‰ bank çš„å¥å­ä¸­ bank ä¸Šä¸‹æ–‡ç¯å¢ƒä¸­å‡ºç°çš„å•è¯ä¸åŒï¼Œä½†æ˜¯åœ¨ç”¨è¯­è¨€æ¨¡å‹è®­ç»ƒçš„æ—¶å€™ï¼Œä¸è®ºä»€ä¹ˆä¸Šä¸‹æ–‡çš„å¥å­ç»è¿‡ Word2Vecï¼Œéƒ½æ˜¯é¢„æµ‹ç›¸åŒçš„å•è¯ bankï¼Œè€ŒåŒä¸€ä¸ªå•è¯å ç”¨çš„æ˜¯åŒä¸€è¡Œçš„å‚æ•°ç©ºé—´ï¼Œè¿™ä¼šå¯¼è‡´ä¸¤ç§ä¸åŒçš„ä¸Šä¸‹æ–‡ä¿¡æ¯éƒ½ä¼šç¼–ç åˆ°ç›¸åŒçš„ Word Embedding ç©ºé—´é‡Œï¼Œè¿›è€Œå¯¼è‡´ Word Embedding æ— æ³•åŒºåˆ†å¤šä¹‰è¯çš„ä¸åŒè¯­ä¹‰ã€‚</p>\n<p>æ‰€ä»¥å¯¹äºæ¯”å¦‚ Bank è¿™ä¸ªè¯ï¼Œå®ƒäº‹å…ˆå­¦å¥½çš„ Word Embedding ä¸­æ··åˆäº†å‡ ç§è¯­ä¹‰ ï¼Œåœ¨åº”ç”¨ä¸­æ¥äº†ä¸ªæ–°å¥å­ï¼Œå³ä½¿ä»ä¸Šä¸‹æ–‡ä¸­ï¼ˆæ¯”å¦‚å¥å­åŒ…å« money ç­‰è¯ï¼‰æ˜æ˜¾å¯ä»¥çœ‹å‡ºå®ƒä»£è¡¨çš„æ˜¯ â€œé“¶è¡Œâ€ çš„å«ä¹‰ï¼Œä½†æ˜¯å¯¹åº”çš„ Word Embedding å†…å®¹ä¹Ÿä¸ä¼šå˜ï¼Œå®ƒè¿˜æ˜¯æ··åˆäº†å¤šç§è¯­ä¹‰ã€‚</p>\n<p>é’ˆå¯¹ Word Embedding ä¸­å‡ºç°çš„å¤šä¹‰è¯é—®é¢˜ï¼ŒELMo æä¾›äº†ä¸€ä¸ªç®€æ´ä¼˜é›…çš„è§£å†³æ–¹æ¡ˆã€‚</p>\n<p>ELMo çš„æœ¬è´¨æ€æƒ³æ˜¯ï¼šæˆ‘äº‹å…ˆç”¨è¯­è¨€æ¨¡å‹å­¦å¥½ä¸€ä¸ªå•è¯çš„ Word Embeddingï¼Œæ­¤æ—¶å¤šä¹‰è¯æ— æ³•åŒºåˆ†ï¼Œä¸è¿‡è¿™æ²¡å…³ç³»ã€‚åœ¨æˆ‘å®é™…ä½¿ç”¨ Word Embedding çš„æ—¶å€™ï¼Œå•è¯å·²ç»å…·å¤‡äº†ç‰¹å®šçš„ä¸Šä¸‹æ–‡äº†ï¼Œè¿™ä¸ªæ—¶å€™æˆ‘å¯ä»¥æ ¹æ®ä¸Šä¸‹æ–‡å•è¯çš„è¯­ä¹‰å†å»è°ƒæ•´å•è¯çš„ Word Embedding è¡¨ç¤ºï¼Œè¿™æ ·ç»è¿‡è°ƒæ•´åçš„ Word Embedding æ›´èƒ½è¡¨è¾¾åœ¨è¿™ä¸ªä¸Šä¸‹æ–‡ä¸­çš„å…·ä½“å«ä¹‰ï¼Œè‡ªç„¶ä¹Ÿå°±è§£å†³äº†å¤šä¹‰è¯çš„é—®é¢˜äº†ã€‚æ‰€ä»¥ ELMo æœ¬èº«æ˜¯ä¸ªæ ¹æ®å½“å‰ä¸Šä¸‹æ–‡å¯¹ Word Embedding åŠ¨æ€è°ƒæ•´çš„æ€è·¯ã€‚</p>\n<p>ELMo é‡‡ç”¨äº†å…¸å‹çš„ä¸¤é˜¶æ®µè¿‡ç¨‹ï¼š</p>\n<ol>\n<li>ç¬¬ä¸€ä¸ªé˜¶æ®µæ˜¯åˆ©ç”¨è¯­è¨€æ¨¡å‹è¿›è¡Œé¢„è®­ç»ƒï¼›</li>\n<li>ç¬¬äºŒä¸ªé˜¶æ®µæ˜¯åœ¨åšä¸‹æ¸¸ä»»åŠ¡æ—¶ï¼Œä»é¢„è®­ç»ƒç½‘ç»œä¸­æå–å¯¹åº”å•è¯çš„ç½‘ç»œå„å±‚çš„ Word Embedding ä½œä¸ºæ–°ç‰¹å¾è¡¥å……åˆ°ä¸‹æ¸¸ä»»åŠ¡ä¸­ã€‚</li>\n</ol>\n<p>&lt;img src=&quot;<span class=\"exturl\" data-url=\"aHR0cHM6Ly9pbWdtZC5vc3MtY24tc2hhbmdoYWkuYWxpeXVuY3MuY29tL0JFUlRfSU1HLyVFNSU5RiVCQSVFNCVCQSU4RSVFNCVCOCU4QSVFNCVCOCU4QiVFNiU5NiU4NyVFNyU5QSU4NGVtZWRkaW5nLmpwZw==\">https://imgmd.oss-cn-shanghai.aliyuncs.com/BERT_IMG/ åŸºäºä¸Šä¸‹æ–‡çš„ emedding.jpg</span>&quot; style=&quot;zoom:50%;&quot; /&gt;</p>\n<p>ä¸Šå›¾å±•ç¤ºçš„æ˜¯å…¶ç¬¬ä¸€é˜¶æ®µé¢„è®­ç»ƒè¿‡ç¨‹ï¼Œå®ƒçš„ç½‘ç»œç»“æ„é‡‡ç”¨äº†åŒå±‚åŒå‘ LSTMï¼Œç›®å‰è¯­è¨€æ¨¡å‹è®­ç»ƒçš„ä»»åŠ¡ç›®æ ‡æ˜¯æ ¹æ®å•è¯ <span class=\"katex\"><span class=\"katex-mathml\"><math xmlns=\"http://www.w3.org/1998/Math/MathML\"><semantics><mrow><msub><mi>w</mi><mi>i</mi></msub></mrow><annotation encoding=\"application/x-tex\">w_i</annotation></semantics></math></span><span class=\"katex-html\" aria-hidden=\"true\"><span class=\"base\"><span class=\"strut\" style=\"height:0.58056em;vertical-align:-0.15em;\"></span><span class=\"mord\"><span class=\"mord mathnormal\" style=\"margin-right:0.02691em;\">w</span><span class=\"msupsub\"><span class=\"vlist-t vlist-t2\"><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.31166399999999994em;\"><span style=\"top:-2.5500000000000003em;margin-left:-0.02691em;margin-right:0.05em;\"><span class=\"pstrut\" style=\"height:2.7em;\"></span><span class=\"sizing reset-size6 size3 mtight\"><span class=\"mord mathnormal mtight\">i</span></span></span></span><span class=\"vlist-s\">â€‹</span></span><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.15em;\"><span></span></span></span></span></span></span></span></span></span> çš„ä¸Šä¸‹æ–‡å»æ­£ç¡®é¢„æµ‹å•è¯ <span class=\"katex\"><span class=\"katex-mathml\"><math xmlns=\"http://www.w3.org/1998/Math/MathML\"><semantics><mrow><msub><mi>w</mi><mi>i</mi></msub></mrow><annotation encoding=\"application/x-tex\">w_i</annotation></semantics></math></span><span class=\"katex-html\" aria-hidden=\"true\"><span class=\"base\"><span class=\"strut\" style=\"height:0.58056em;vertical-align:-0.15em;\"></span><span class=\"mord\"><span class=\"mord mathnormal\" style=\"margin-right:0.02691em;\">w</span><span class=\"msupsub\"><span class=\"vlist-t vlist-t2\"><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.31166399999999994em;\"><span style=\"top:-2.5500000000000003em;margin-left:-0.02691em;margin-right:0.05em;\"><span class=\"pstrut\" style=\"height:2.7em;\"></span><span class=\"sizing reset-size6 size3 mtight\"><span class=\"mord mathnormal mtight\">i</span></span></span></span><span class=\"vlist-s\">â€‹</span></span><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.15em;\"><span></span></span></span></span></span></span></span></span></span>ï¼Œ<span class=\"katex\"><span class=\"katex-mathml\"><math xmlns=\"http://www.w3.org/1998/Math/MathML\"><semantics><mrow><msub><mi>w</mi><mi>i</mi></msub></mrow><annotation encoding=\"application/x-tex\">w_i</annotation></semantics></math></span><span class=\"katex-html\" aria-hidden=\"true\"><span class=\"base\"><span class=\"strut\" style=\"height:0.58056em;vertical-align:-0.15em;\"></span><span class=\"mord\"><span class=\"mord mathnormal\" style=\"margin-right:0.02691em;\">w</span><span class=\"msupsub\"><span class=\"vlist-t vlist-t2\"><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.31166399999999994em;\"><span style=\"top:-2.5500000000000003em;margin-left:-0.02691em;margin-right:0.05em;\"><span class=\"pstrut\" style=\"height:2.7em;\"></span><span class=\"sizing reset-size6 size3 mtight\"><span class=\"mord mathnormal mtight\">i</span></span></span></span><span class=\"vlist-s\">â€‹</span></span><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.15em;\"><span></span></span></span></span></span></span></span></span></span> ä¹‹å‰çš„å•è¯åºåˆ— Context-before ç§°ä¸ºä¸Šæ–‡ï¼Œä¹‹åçš„å•è¯åºåˆ— Context-after ç§°ä¸ºä¸‹æ–‡ã€‚</p>\n<p>å›¾ä¸­å·¦ç«¯çš„å‰å‘åŒå±‚ LSTM ä»£è¡¨æ­£æ–¹å‘ç¼–ç å™¨ï¼Œè¾“å…¥çš„æ˜¯ä»å·¦åˆ°å³é¡ºåºçš„é™¤äº†é¢„æµ‹å•è¯å¤– <span class=\"katex\"><span class=\"katex-mathml\"><math xmlns=\"http://www.w3.org/1998/Math/MathML\"><semantics><mrow><msub><mi>W</mi><mi>i</mi></msub></mrow><annotation encoding=\"application/x-tex\">W_i</annotation></semantics></math></span><span class=\"katex-html\" aria-hidden=\"true\"><span class=\"base\"><span class=\"strut\" style=\"height:0.83333em;vertical-align:-0.15em;\"></span><span class=\"mord\"><span class=\"mord mathnormal\" style=\"margin-right:0.13889em;\">W</span><span class=\"msupsub\"><span class=\"vlist-t vlist-t2\"><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.31166399999999994em;\"><span style=\"top:-2.5500000000000003em;margin-left:-0.13889em;margin-right:0.05em;\"><span class=\"pstrut\" style=\"height:2.7em;\"></span><span class=\"sizing reset-size6 size3 mtight\"><span class=\"mord mathnormal mtight\">i</span></span></span></span><span class=\"vlist-s\">â€‹</span></span><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.15em;\"><span></span></span></span></span></span></span></span></span></span> çš„ä¸Šæ–‡ Context-beforeï¼›å³ç«¯çš„é€†å‘åŒå±‚ LSTM ä»£è¡¨åæ–¹å‘ç¼–ç å™¨ï¼Œè¾“å…¥çš„æ˜¯ä»å³åˆ°å·¦çš„é€†åºçš„å¥å­ä¸‹æ–‡ Context-afterï¼›æ¯ä¸ªç¼–ç å™¨çš„æ·±åº¦éƒ½æ˜¯ä¸¤å±‚ LSTM å åŠ ã€‚</p>\n<p>è¿™ä¸ªç½‘ç»œç»“æ„å…¶å®åœ¨ NLP ä¸­æ˜¯å¾ˆå¸¸ç”¨çš„ã€‚ä½¿ç”¨è¿™ä¸ªç½‘ç»œç»“æ„åˆ©ç”¨å¤§é‡è¯­æ–™åšè¯­è¨€æ¨¡å‹ä»»åŠ¡å°±èƒ½é¢„å…ˆè®­ç»ƒå¥½è¿™ä¸ªç½‘ç»œï¼Œå¦‚æœè®­ç»ƒå¥½è¿™ä¸ªç½‘ç»œåï¼Œè¾“å…¥ä¸€ä¸ªæ–°å¥å­ <span class=\"katex\"><span class=\"katex-mathml\"><math xmlns=\"http://www.w3.org/1998/Math/MathML\"><semantics><mrow><msub><mi>s</mi><mrow><mi>n</mi><mi>e</mi><mi>w</mi></mrow></msub></mrow><annotation encoding=\"application/x-tex\">s_{new}</annotation></semantics></math></span><span class=\"katex-html\" aria-hidden=\"true\"><span class=\"base\"><span class=\"strut\" style=\"height:0.58056em;vertical-align:-0.15em;\"></span><span class=\"mord\"><span class=\"mord mathnormal\">s</span><span class=\"msupsub\"><span class=\"vlist-t vlist-t2\"><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.151392em;\"><span style=\"top:-2.5500000000000003em;margin-left:0em;margin-right:0.05em;\"><span class=\"pstrut\" style=\"height:2.7em;\"></span><span class=\"sizing reset-size6 size3 mtight\"><span class=\"mord mtight\"><span class=\"mord mathnormal mtight\">n</span><span class=\"mord mathnormal mtight\">e</span><span class=\"mord mathnormal mtight\" style=\"margin-right:0.02691em;\">w</span></span></span></span></span><span class=\"vlist-s\">â€‹</span></span><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.15em;\"><span></span></span></span></span></span></span></span></span></span> ï¼Œå¥å­ä¸­æ¯ä¸ªå•è¯éƒ½èƒ½å¾—åˆ°å¯¹åº”çš„ä¸‰ä¸ª Embeddingï¼š</p>\n<ul>\n<li>æœ€åº•å±‚æ˜¯å•è¯çš„ Word Embeddingï¼›</li>\n<li>å¾€ä¸Šèµ°æ˜¯ç¬¬ä¸€å±‚åŒå‘ LSTM ä¸­å¯¹åº”å•è¯ä½ç½®çš„ Embeddingï¼Œè¿™å±‚ç¼–ç å•è¯çš„å¥æ³•ä¿¡æ¯æ›´å¤šä¸€äº›ï¼›</li>\n<li>å†å¾€ä¸Šèµ°æ˜¯ç¬¬äºŒå±‚ LSTM ä¸­å¯¹åº”å•è¯ä½ç½®çš„ Embeddingï¼Œè¿™å±‚ç¼–ç å•è¯çš„è¯­ä¹‰ä¿¡æ¯æ›´å¤šä¸€äº›ã€‚</li>\n</ul>\n<p>ä¹Ÿå°±æ˜¯è¯´ï¼ŒELMo çš„é¢„è®­ç»ƒè¿‡ç¨‹ä¸ä»…ä»…å­¦ä¼šå•è¯çš„ Word Embeddingï¼Œè¿˜å­¦ä¼šäº†ä¸€ä¸ªåŒå±‚åŒå‘çš„ LSTM ç½‘ç»œç»“æ„ï¼Œè€Œè¿™ä¸¤è€…åé¢éƒ½æœ‰ç”¨ã€‚</p>\n<h2 id=\"72-elmo-çš„-feature-based-pre-training\"><a class=\"anchor\" href=\"#72-elmo-çš„-feature-based-pre-training\">#</a> 7.2 ELMo çš„ Feature-based Pre-Training</h2>\n<p>ä¸Šé¢ä»‹ç»çš„æ˜¯ ELMo çš„ç¬¬ä¸€é˜¶æ®µï¼šé¢„è®­ç»ƒé˜¶æ®µã€‚é‚£ä¹ˆé¢„è®­ç»ƒå¥½ç½‘ç»œç»“æ„åï¼Œå¦‚ä½•ç»™ä¸‹æ¸¸ä»»åŠ¡ä½¿ç”¨å‘¢ï¼Ÿ</p>\n<p>&lt;img src=&quot;<span class=\"exturl\" data-url=\"aHR0cHM6Ly9pbWdtZC5vc3MtY24tc2hhbmdoYWkuYWxpeXVuY3MuY29tL0JFUlRfSU1HL2VsbW8lRTglQUUlQUQlRTclQkIlODMlRTUlOTAlOEUlRTclOUElODQlRTQlQkQlQkYlRTclOTQlQTguanBn\">https://imgmd.oss-cn-shanghai.aliyuncs.com/BERT_IMG/elmo è®­ç»ƒåçš„ä½¿ç”¨.jpg</span>&quot; style=&quot;zoom:50%;&quot; /&gt;</p>\n<p>ä¸Šå›¾å±•ç¤ºäº†ä¸‹æ¸¸ä»»åŠ¡çš„ä½¿ç”¨è¿‡ç¨‹ï¼Œæ¯”å¦‚æˆ‘ä»¬çš„ä¸‹æ¸¸ä»»åŠ¡ä»ç„¶æ˜¯ QA é—®é¢˜ï¼Œæ­¤æ—¶å¯¹äºé—®å¥ Xï¼š</p>\n<ol>\n<li>æˆ‘ä»¬å¯ä»¥å…ˆå°†å¥å­ X ä½œä¸ºé¢„è®­ç»ƒå¥½çš„ ELMo ç½‘ç»œçš„è¾“å…¥ï¼Œè¿™æ ·å¥å­ X ä¸­æ¯ä¸ªå•è¯åœ¨ ELMO ç½‘ç»œä¸­éƒ½èƒ½è·å¾—å¯¹åº”çš„ä¸‰ä¸ª Embeddingï¼›</li>\n<li>ä¹‹åç»™äºˆè¿™ä¸‰ä¸ª Embedding ä¸­çš„æ¯ä¸€ä¸ª Embedding ä¸€ä¸ªæƒé‡ aï¼Œè¿™ä¸ªæƒé‡å¯ä»¥å­¦ä¹ å¾—æ¥ï¼Œæ ¹æ®å„è‡ªæƒé‡ç´¯åŠ æ±‚å’Œï¼Œå°†ä¸‰ä¸ª Embedding æ•´åˆæˆä¸€ä¸ªï¼›</li>\n<li>ç„¶åå°†æ•´åˆåçš„è¿™ä¸ª Embedding ä½œä¸º X å¥åœ¨è‡ªå·±ä»»åŠ¡çš„é‚£ä¸ªç½‘ç»œç»“æ„ä¸­å¯¹åº”å•è¯çš„è¾“å…¥ï¼Œä»¥æ­¤ä½œä¸ºè¡¥å……çš„æ–°ç‰¹å¾ç»™ä¸‹æ¸¸ä»»åŠ¡ä½¿ç”¨ã€‚</li>\n<li>å¯¹äºä¸Šå›¾æ‰€ç¤ºä¸‹æ¸¸ä»»åŠ¡ QA ä¸­çš„å›ç­”å¥å­ Y æ¥è¯´ä¹Ÿæ˜¯å¦‚æ­¤å¤„ç†ã€‚</li>\n</ol>\n<p><strong>å› ä¸º ELMo ç»™ä¸‹æ¸¸æä¾›çš„æ˜¯æ¯ä¸ªå•è¯çš„ç‰¹å¾å½¢å¼ï¼Œæ‰€ä»¥è¿™ä¸€ç±»é¢„è®­ç»ƒçš„æ–¹æ³•è¢«ç§°ä¸º â€œFeature-based Pre-Trainingâ€ã€‚</strong></p>\n<p>è‡³äºä¸ºä½•è¿™ä¹ˆåšèƒ½å¤Ÿè¾¾åˆ°åŒºåˆ†å¤šä¹‰è¯çš„æ•ˆæœï¼ŒåŸå› åœ¨äºåœ¨è®­ç»ƒå¥½ ELMo åï¼Œ<strong>åœ¨ç‰¹å¾æå–çš„æ—¶å€™ï¼Œæ¯ä¸ªå•è¯åœ¨ä¸¤å±‚ LSTM ä¸Šéƒ½ä¼šæœ‰å¯¹åº”çš„èŠ‚ç‚¹ï¼Œè¿™ä¸¤ä¸ªèŠ‚ç‚¹ä¼šç¼–ç å•è¯çš„ä¸€äº›å¥æ³•ç‰¹å¾å’Œè¯­ä¹‰ç‰¹å¾ï¼Œå¹¶ä¸”å®ƒä»¬çš„ Embedding ç¼–ç æ˜¯åŠ¨æ€æ”¹å˜çš„</strong>ï¼Œä¼šå—åˆ°ä¸Šä¸‹æ–‡å•è¯çš„å½±å“ï¼Œå‘¨å›´å•è¯çš„ä¸Šä¸‹æ–‡ä¸åŒåº”è¯¥ä¼šå¼ºåŒ–æŸç§è¯­ä¹‰ï¼Œå¼±åŒ–å…¶å®ƒè¯­ä¹‰ï¼Œè¿›è€Œå°±è§£å†³äº†å¤šä¹‰è¯çš„é—®é¢˜ã€‚</p>\n<h1 id=\"å…«-attention\"><a class=\"anchor\" href=\"#å…«-attention\">#</a> å…«ã€Attention</h1>\n<p>ä¸Šé¢å·´æ‹‰å·´æ‹‰äº†ä¸€å †ï¼Œéƒ½åœ¨ä¸º BERT çš„è®²è§£åšé“ºå«ï¼Œè€Œæ¥ä¸‹æ¥è¦å™è¿°çš„ Attention å’Œ Transformer åŒæ ·å¦‚æ­¤ï¼Œå®ƒä»¬éƒ½åªæ˜¯ BERT æ„æˆçš„ä¸€éƒ¨åˆ†ã€‚</p>\n<h2 id=\"81-äººç±»çš„è§†è§‰æ³¨æ„åŠ›\"><a class=\"anchor\" href=\"#81-äººç±»çš„è§†è§‰æ³¨æ„åŠ›\">#</a> 8.1 äººç±»çš„è§†è§‰æ³¨æ„åŠ›</h2>\n<p>Attention æ˜¯æ³¨æ„åŠ›çš„æ„æ€ï¼Œä»å®ƒçš„å‘½åæ–¹å¼çœ‹ï¼Œå¾ˆæ˜æ˜¾å€Ÿé‰´äº†äººç±»çš„æ³¨æ„åŠ›æœºåˆ¶ï¼Œå› æ­¤ï¼Œæˆ‘ä»¬é¦–å…ˆä»‹ç»äººç±»çš„è§†è§‰æ³¨æ„åŠ›ã€‚</p>\n<p>&lt;img src=&quot;<span class=\"exturl\" data-url=\"aHR0cHM6Ly9pbWdtZC5vc3MtY24tc2hhbmdoYWkuYWxpeXVuY3MuY29tL0JFUlRfSU1HLyVFNCVCQSVCQSVFNyVCMSVCQiVFNyU5QSU4NCVFOCVBNyU4NiVFOCVBNyU4OSVFNiVCMyVBOCVFNiU4NCU4RiVFNSU4QSU5Qi5qcGc=\">https://imgmd.oss-cn-shanghai.aliyuncs.com/BERT_IMG/ äººç±»çš„è§†è§‰æ³¨æ„åŠ›.jpg</span>&quot; style=&quot;zoom:50%;&quot; /&gt;</p>\n<p>è§†è§‰æ³¨æ„åŠ›æœºåˆ¶æ˜¯äººç±»è§†è§‰æ‰€ç‰¹æœ‰çš„å¤§è„‘ä¿¡å·å¤„ç†æœºåˆ¶ã€‚äººç±»è§†è§‰é€šè¿‡å¿«é€Ÿæ‰«æå…¨å±€å›¾åƒï¼Œè·å¾—éœ€è¦é‡ç‚¹å…³æ³¨çš„ç›®æ ‡åŒºåŸŸï¼Œä¹Ÿå°±æ˜¯ä¸€èˆ¬æ‰€è¯´çš„æ³¨æ„åŠ›ç„¦ç‚¹ï¼Œè€Œåå¯¹è¿™ä¸€åŒºåŸŸæŠ•å…¥æ›´å¤šæ³¨æ„åŠ›èµ„æºï¼Œä»¥è·å–æ›´å¤šæ‰€éœ€è¦å…³æ³¨ç›®æ ‡çš„ç»†èŠ‚ä¿¡æ¯ï¼Œè€ŒæŠ‘åˆ¶å…¶ä»–æ— ç”¨ä¿¡æ¯ã€‚</p>\n<p>è¿™æ˜¯äººç±»åˆ©ç”¨æœ‰é™çš„æ³¨æ„åŠ›èµ„æºä»å¤§é‡ä¿¡æ¯ä¸­å¿«é€Ÿç­›é€‰å‡ºé«˜ä»·å€¼ä¿¡æ¯çš„æ‰‹æ®µï¼Œæ˜¯äººç±»åœ¨é•¿æœŸè¿›åŒ–ä¸­å½¢æˆçš„ä¸€ç§ç”Ÿå­˜æœºåˆ¶ï¼Œäººç±»è§†è§‰æ³¨æ„åŠ›æœºåˆ¶æå¤§åœ°æé«˜äº†è§†è§‰ä¿¡æ¯å¤„ç†çš„æ•ˆç‡ä¸å‡†ç¡®æ€§ã€‚</p>\n<p>ä¸Šå›¾å½¢è±¡åŒ–å±•ç¤ºäº†äººç±»åœ¨çœ‹åˆ°ä¸€å‰¯å›¾åƒæ—¶æ˜¯å¦‚ä½•é«˜æ•ˆåˆ†é…æœ‰é™çš„æ³¨æ„åŠ›èµ„æºçš„ï¼Œ<strong>å…¶ä¸­çº¢è‰²åŒºåŸŸè¡¨æ˜è§†è§‰ç³»ç»Ÿæ›´å…³æ³¨çš„ç›®æ ‡</strong>ï¼Œå¾ˆæ˜æ˜¾å¯¹äºä¸Šå›¾æ‰€ç¤ºçš„åœºæ™¯ï¼Œäººä»¬ä¼šæŠŠæ³¨æ„åŠ›æ›´å¤šæŠ•å…¥åˆ°äººçš„è„¸éƒ¨ï¼Œæ–‡æœ¬çš„æ ‡é¢˜ä»¥åŠæ–‡ç« é¦–å¥ç­‰ä½ç½®ã€‚</p>\n<p>æ·±åº¦å­¦ä¹ ä¸­çš„æ³¨æ„åŠ›æœºåˆ¶ä»æœ¬è´¨ä¸Šè®²å’Œäººç±»çš„é€‰æ‹©æ€§è§†è§‰æ³¨æ„åŠ›æœºåˆ¶ç±»ä¼¼ï¼Œ<strong>æ ¸å¿ƒç›®æ ‡ä¹Ÿæ˜¯ä»ä¼—å¤šä¿¡æ¯ä¸­é€‰æ‹©å‡ºå¯¹å½“å‰ä»»åŠ¡ç›®æ ‡æ›´å…³é”®çš„ä¿¡æ¯ã€‚</strong></p>\n<h2 id=\"82-attention-çš„æœ¬è´¨æ€æƒ³\"><a class=\"anchor\" href=\"#82-attention-çš„æœ¬è´¨æ€æƒ³\">#</a> 8.2 Attention çš„æœ¬è´¨æ€æƒ³</h2>\n<p>ä»äººç±»çš„è§†è§‰æ³¨æ„åŠ›å¯ä»¥çœ‹å‡ºï¼Œæ³¨æ„åŠ›æ¨¡å‹ Attention çš„æœ¬è´¨æ€æƒ³ä¸ºï¼šä»å¤§é‡ä¿¡æ¯ä¸­æœ‰é€‰æ‹©åœ°ç­›é€‰å‡ºå°‘é‡é‡è¦ä¿¡æ¯å¹¶èšç„¦åˆ°è¿™äº›é‡è¦ä¿¡æ¯ä¸Šï¼Œå¿½ç•¥ä¸é‡è¦çš„ä¿¡æ¯ã€‚</p>\n<p>åœ¨è¯¦ç»†è®²è§£ Attention ä¹‹å‰ï¼Œæˆ‘ä»¬åœ¨è®²è®² Attention çš„å…¶ä»–ä½œç”¨ã€‚ä¹‹å‰æˆ‘ä»¬è®²è§£ LSTM çš„æ—¶å€™è¯´åˆ°ï¼Œè™½ç„¶ LSTM è§£å†³äº†åºåˆ—é•¿è·ç¦»ä¾èµ–é—®é¢˜ï¼Œä½†æ˜¯å•è¯è¶…è¿‡ 200 çš„æ—¶å€™å°±ä¼šå¤±æ•ˆã€‚<strong>è€Œ Attention æœºåˆ¶å¯ä»¥æ›´åŠ å¥½çš„è§£å†³åºåˆ—é•¿è·ç¦»ä¾èµ–é—®é¢˜ï¼Œå¹¶ä¸”å…·æœ‰å¹¶è¡Œè®¡ç®—èƒ½åŠ›</strong>ã€‚ç°åœ¨ä¸æ˜ç™½è¿™ç‚¹ä¸é‡è¦ï¼Œéšç€æˆ‘ä»¬å¯¹ Attention çš„æ…¢æ…¢æ·±å…¥ï¼Œç›¸ä¿¡ä½ ä¼šæ˜ç™½ã€‚</p>\n<p>é¦–å…ˆæˆ‘ä»¬å¾—æ˜ç¡®ä¸€ä¸ªç‚¹ï¼Œæ³¨æ„åŠ›æ¨¡å‹ä»å¤§é‡ä¿¡æ¯ Values ä¸­ç­›é€‰å‡ºå°‘é‡é‡è¦ä¿¡æ¯ï¼Œè¿™äº›é‡è¦ä¿¡æ¯ä¸€å®šæ˜¯ç›¸å¯¹äºå¦å¤–ä¸€ä¸ªä¿¡æ¯ Query è€Œè¨€æ˜¯é‡è¦çš„ï¼Œä¾‹å¦‚å¯¹äºä¸Šé¢é‚£å¼ å©´å„¿å›¾ï¼ŒQuery å°±æ˜¯è§‚å¯Ÿè€…ã€‚ä¹Ÿå°±æ˜¯è¯´ï¼Œæˆ‘ä»¬è¦æ­å»ºä¸€ä¸ªæ³¨æ„åŠ›æ¨¡å‹ï¼Œæˆ‘ä»¬å¿…é¡»å¾—è¦æœ‰ä¸€ä¸ª Query å’Œä¸€ä¸ª Valuesï¼Œç„¶åé€šè¿‡ Query è¿™ä¸ªä¿¡æ¯ä» Values ä¸­ç­›é€‰å‡ºé‡è¦ä¿¡æ¯ã€‚</p>\n<p>é€šè¿‡ Query è¿™ä¸ªä¿¡æ¯ä» Values ä¸­ç­›é€‰å‡ºé‡è¦ä¿¡æ¯ï¼Œç®€å•ç‚¹è¯´ï¼Œ<strong>å°±æ˜¯è®¡ç®— Query å’Œ Values ä¸­æ¯ä¸ªä¿¡æ¯çš„ç›¸å…³ç¨‹åº¦ã€‚</strong></p>\n<p>&lt;img src=&quot;<span class=\"exturl\" data-url=\"aHR0cHM6Ly9pbWdtZC5vc3MtY24tc2hhbmdoYWkuYWxpeXVuY3MuY29tL0JFUlRfSU1HL2F0dGVudGlvbi0lRTglQUUlQTElRTclQUUlOTclRTUlOUIlQkUucG5n\">https://imgmd.oss-cn-shanghai.aliyuncs.com/BERT_IMG/attention - è®¡ç®—å›¾.png</span>&quot; style=&quot;zoom:50%;&quot; /&gt;</p>\n<p>å†å…·ä½“ç‚¹ï¼Œé€šè¿‡ä¸Šå›¾ï¼ŒAttention é€šå¸¸å¯ä»¥è¿›è¡Œå¦‚ä¸‹æè¿°ï¼Œè¡¨ç¤ºä¸ºå°† Query (Q) å’Œ key-value pairsï¼ˆ<strong>æŠŠ Values æ‹†åˆ†æˆäº†é”®å€¼å¯¹çš„å½¢å¼</strong>ï¼‰ æ˜ å°„åˆ°è¾“å‡ºä¸Šï¼Œå…¶ä¸­ queryã€æ¯ä¸ª keyã€æ¯ä¸ª value éƒ½æ˜¯å‘é‡ï¼Œè¾“å‡ºæ˜¯ V ä¸­æ‰€æœ‰ values çš„åŠ æƒï¼Œå…¶ä¸­æƒé‡æ˜¯ç”± Query å’Œæ¯ä¸ª key è®¡ç®—å‡ºæ¥çš„ï¼Œè®¡ç®—æ–¹æ³•åˆ†ä¸ºä¸‰æ­¥ï¼š</p>\n<ol>\n<li>ç¬¬ä¸€æ­¥ï¼šè®¡ç®—æ¯”è¾ƒ Q å’Œ K çš„ç›¸ä¼¼åº¦ï¼Œç”¨ f æ¥è¡¨ç¤ºï¼š<span class=\"katex\"><span class=\"katex-mathml\"><math xmlns=\"http://www.w3.org/1998/Math/MathML\"><semantics><mrow><mi>f</mi><mo stretchy=\"false\">(</mo><mi>Q</mi><mo separator=\"true\">,</mo><msub><mi>K</mi><mi>i</mi></msub><mo stretchy=\"false\">)</mo><mspace width=\"1em\"/><mi>i</mi><mo>=</mo><mn>1</mn><mo separator=\"true\">,</mo><mn>2</mn><mo separator=\"true\">,</mo><mo>â‹¯</mo><mtext>â€‰</mtext><mo separator=\"true\">,</mo><mi>m</mi></mrow><annotation encoding=\"application/x-tex\">f(Q,K_i)\\quad i=1,2,\\cdots,m</annotation></semantics></math></span><span class=\"katex-html\" aria-hidden=\"true\"><span class=\"base\"><span class=\"strut\" style=\"height:1em;vertical-align:-0.25em;\"></span><span class=\"mord mathnormal\" style=\"margin-right:0.10764em;\">f</span><span class=\"mopen\">(</span><span class=\"mord mathnormal\">Q</span><span class=\"mpunct\">,</span><span class=\"mspace\" style=\"margin-right:0.16666666666666666em;\"></span><span class=\"mord\"><span class=\"mord mathnormal\" style=\"margin-right:0.07153em;\">K</span><span class=\"msupsub\"><span class=\"vlist-t vlist-t2\"><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.31166399999999994em;\"><span style=\"top:-2.5500000000000003em;margin-left:-0.07153em;margin-right:0.05em;\"><span class=\"pstrut\" style=\"height:2.7em;\"></span><span class=\"sizing reset-size6 size3 mtight\"><span class=\"mord mathnormal mtight\">i</span></span></span></span><span class=\"vlist-s\">â€‹</span></span><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.15em;\"><span></span></span></span></span></span></span><span class=\"mclose\">)</span><span class=\"mspace\" style=\"margin-right:1em;\"></span><span class=\"mord mathnormal\">i</span><span class=\"mspace\" style=\"margin-right:0.2777777777777778em;\"></span><span class=\"mrel\">=</span><span class=\"mspace\" style=\"margin-right:0.2777777777777778em;\"></span></span><span class=\"base\"><span class=\"strut\" style=\"height:0.8388800000000001em;vertical-align:-0.19444em;\"></span><span class=\"mord\">1</span><span class=\"mpunct\">,</span><span class=\"mspace\" style=\"margin-right:0.16666666666666666em;\"></span><span class=\"mord\">2</span><span class=\"mpunct\">,</span><span class=\"mspace\" style=\"margin-right:0.16666666666666666em;\"></span><span class=\"minner\">â‹¯</span><span class=\"mspace\" style=\"margin-right:0.16666666666666666em;\"></span><span class=\"mspace\" style=\"margin-right:0.16666666666666666em;\"></span><span class=\"mpunct\">,</span><span class=\"mspace\" style=\"margin-right:0.16666666666666666em;\"></span><span class=\"mord mathnormal\">m</span></span></span></span>ï¼Œä¸€èˆ¬ç¬¬ä¸€æ­¥è®¡ç®—æ–¹æ³•åŒ…æ‹¬å››ç§\n<ol>\n<li>ç‚¹ä¹˜ï¼ˆ<strong>Transformer ä½¿ç”¨</strong>ï¼‰ï¼š<span class=\"katex\"><span class=\"katex-mathml\"><math xmlns=\"http://www.w3.org/1998/Math/MathML\"><semantics><mrow><mi>f</mi><mo stretchy=\"false\">(</mo><mi>Q</mi><mo separator=\"true\">,</mo><msub><mi>K</mi><mi>i</mi></msub><mo stretchy=\"false\">)</mo><mo>=</mo><msup><mi>Q</mi><mi>T</mi></msup><msub><mi>K</mi><mi>i</mi></msub></mrow><annotation encoding=\"application/x-tex\">f(Q,K_i) = Q^T K_i</annotation></semantics></math></span><span class=\"katex-html\" aria-hidden=\"true\"><span class=\"base\"><span class=\"strut\" style=\"height:1em;vertical-align:-0.25em;\"></span><span class=\"mord mathnormal\" style=\"margin-right:0.10764em;\">f</span><span class=\"mopen\">(</span><span class=\"mord mathnormal\">Q</span><span class=\"mpunct\">,</span><span class=\"mspace\" style=\"margin-right:0.16666666666666666em;\"></span><span class=\"mord\"><span class=\"mord mathnormal\" style=\"margin-right:0.07153em;\">K</span><span class=\"msupsub\"><span class=\"vlist-t vlist-t2\"><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.31166399999999994em;\"><span style=\"top:-2.5500000000000003em;margin-left:-0.07153em;margin-right:0.05em;\"><span class=\"pstrut\" style=\"height:2.7em;\"></span><span class=\"sizing reset-size6 size3 mtight\"><span class=\"mord mathnormal mtight\">i</span></span></span></span><span class=\"vlist-s\">â€‹</span></span><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.15em;\"><span></span></span></span></span></span></span><span class=\"mclose\">)</span><span class=\"mspace\" style=\"margin-right:0.2777777777777778em;\"></span><span class=\"mrel\">=</span><span class=\"mspace\" style=\"margin-right:0.2777777777777778em;\"></span></span><span class=\"base\"><span class=\"strut\" style=\"height:1.035771em;vertical-align:-0.19444em;\"></span><span class=\"mord\"><span class=\"mord mathnormal\">Q</span><span class=\"msupsub\"><span class=\"vlist-t\"><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.8413309999999999em;\"><span style=\"top:-3.063em;margin-right:0.05em;\"><span class=\"pstrut\" style=\"height:2.7em;\"></span><span class=\"sizing reset-size6 size3 mtight\"><span class=\"mord mathnormal mtight\" style=\"margin-right:0.13889em;\">T</span></span></span></span></span></span></span></span><span class=\"mord\"><span class=\"mord mathnormal\" style=\"margin-right:0.07153em;\">K</span><span class=\"msupsub\"><span class=\"vlist-t vlist-t2\"><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.31166399999999994em;\"><span style=\"top:-2.5500000000000003em;margin-left:-0.07153em;margin-right:0.05em;\"><span class=\"pstrut\" style=\"height:2.7em;\"></span><span class=\"sizing reset-size6 size3 mtight\"><span class=\"mord mathnormal mtight\">i</span></span></span></span><span class=\"vlist-s\">â€‹</span></span><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.15em;\"><span></span></span></span></span></span></span></span></span></span></li>\n<li>æƒé‡ï¼š<span class=\"katex\"><span class=\"katex-mathml\"><math xmlns=\"http://www.w3.org/1998/Math/MathML\"><semantics><mrow><mi>f</mi><mo stretchy=\"false\">(</mo><mi>Q</mi><mo separator=\"true\">,</mo><msub><mi>K</mi><mi>i</mi></msub><mo stretchy=\"false\">)</mo><mo>=</mo><msup><mi>Q</mi><mi>T</mi></msup><mi>W</mi><msub><mi>K</mi><mi>i</mi></msub></mrow><annotation encoding=\"application/x-tex\">f(Q,K_i) = Q^TWK_i</annotation></semantics></math></span><span class=\"katex-html\" aria-hidden=\"true\"><span class=\"base\"><span class=\"strut\" style=\"height:1em;vertical-align:-0.25em;\"></span><span class=\"mord mathnormal\" style=\"margin-right:0.10764em;\">f</span><span class=\"mopen\">(</span><span class=\"mord mathnormal\">Q</span><span class=\"mpunct\">,</span><span class=\"mspace\" style=\"margin-right:0.16666666666666666em;\"></span><span class=\"mord\"><span class=\"mord mathnormal\" style=\"margin-right:0.07153em;\">K</span><span class=\"msupsub\"><span class=\"vlist-t vlist-t2\"><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.31166399999999994em;\"><span style=\"top:-2.5500000000000003em;margin-left:-0.07153em;margin-right:0.05em;\"><span class=\"pstrut\" style=\"height:2.7em;\"></span><span class=\"sizing reset-size6 size3 mtight\"><span class=\"mord mathnormal mtight\">i</span></span></span></span><span class=\"vlist-s\">â€‹</span></span><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.15em;\"><span></span></span></span></span></span></span><span class=\"mclose\">)</span><span class=\"mspace\" style=\"margin-right:0.2777777777777778em;\"></span><span class=\"mrel\">=</span><span class=\"mspace\" style=\"margin-right:0.2777777777777778em;\"></span></span><span class=\"base\"><span class=\"strut\" style=\"height:1.035771em;vertical-align:-0.19444em;\"></span><span class=\"mord\"><span class=\"mord mathnormal\">Q</span><span class=\"msupsub\"><span class=\"vlist-t\"><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.8413309999999999em;\"><span style=\"top:-3.063em;margin-right:0.05em;\"><span class=\"pstrut\" style=\"height:2.7em;\"></span><span class=\"sizing reset-size6 size3 mtight\"><span class=\"mord mathnormal mtight\" style=\"margin-right:0.13889em;\">T</span></span></span></span></span></span></span></span><span class=\"mord mathnormal\" style=\"margin-right:0.13889em;\">W</span><span class=\"mord\"><span class=\"mord mathnormal\" style=\"margin-right:0.07153em;\">K</span><span class=\"msupsub\"><span class=\"vlist-t vlist-t2\"><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.31166399999999994em;\"><span style=\"top:-2.5500000000000003em;margin-left:-0.07153em;margin-right:0.05em;\"><span class=\"pstrut\" style=\"height:2.7em;\"></span><span class=\"sizing reset-size6 size3 mtight\"><span class=\"mord mathnormal mtight\">i</span></span></span></span><span class=\"vlist-s\">â€‹</span></span><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.15em;\"><span></span></span></span></span></span></span></span></span></span></li>\n<li>æ‹¼æ¥æƒé‡ï¼š<span class=\"katex\"><span class=\"katex-mathml\"><math xmlns=\"http://www.w3.org/1998/Math/MathML\"><semantics><mrow><mi>f</mi><mo stretchy=\"false\">(</mo><mi>Q</mi><mo separator=\"true\">,</mo><msub><mi>K</mi><mi>i</mi></msub><mo stretchy=\"false\">)</mo><mo>=</mo><mi>W</mi><mo stretchy=\"false\">[</mo><msup><mi>Q</mi><mi>T</mi></msup><mo separator=\"true\">;</mo><msub><mi>K</mi><mi>i</mi></msub><mo stretchy=\"false\">]</mo></mrow><annotation encoding=\"application/x-tex\">f(Q,K_i) = W[Q^T;K_i]</annotation></semantics></math></span><span class=\"katex-html\" aria-hidden=\"true\"><span class=\"base\"><span class=\"strut\" style=\"height:1em;vertical-align:-0.25em;\"></span><span class=\"mord mathnormal\" style=\"margin-right:0.10764em;\">f</span><span class=\"mopen\">(</span><span class=\"mord mathnormal\">Q</span><span class=\"mpunct\">,</span><span class=\"mspace\" style=\"margin-right:0.16666666666666666em;\"></span><span class=\"mord\"><span class=\"mord mathnormal\" style=\"margin-right:0.07153em;\">K</span><span class=\"msupsub\"><span class=\"vlist-t vlist-t2\"><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.31166399999999994em;\"><span style=\"top:-2.5500000000000003em;margin-left:-0.07153em;margin-right:0.05em;\"><span class=\"pstrut\" style=\"height:2.7em;\"></span><span class=\"sizing reset-size6 size3 mtight\"><span class=\"mord mathnormal mtight\">i</span></span></span></span><span class=\"vlist-s\">â€‹</span></span><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.15em;\"><span></span></span></span></span></span></span><span class=\"mclose\">)</span><span class=\"mspace\" style=\"margin-right:0.2777777777777778em;\"></span><span class=\"mrel\">=</span><span class=\"mspace\" style=\"margin-right:0.2777777777777778em;\"></span></span><span class=\"base\"><span class=\"strut\" style=\"height:1.0913309999999998em;vertical-align:-0.25em;\"></span><span class=\"mord mathnormal\" style=\"margin-right:0.13889em;\">W</span><span class=\"mopen\">[</span><span class=\"mord\"><span class=\"mord mathnormal\">Q</span><span class=\"msupsub\"><span class=\"vlist-t\"><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.8413309999999999em;\"><span style=\"top:-3.063em;margin-right:0.05em;\"><span class=\"pstrut\" style=\"height:2.7em;\"></span><span class=\"sizing reset-size6 size3 mtight\"><span class=\"mord mathnormal mtight\" style=\"margin-right:0.13889em;\">T</span></span></span></span></span></span></span></span><span class=\"mpunct\">;</span><span class=\"mspace\" style=\"margin-right:0.16666666666666666em;\"></span><span class=\"mord\"><span class=\"mord mathnormal\" style=\"margin-right:0.07153em;\">K</span><span class=\"msupsub\"><span class=\"vlist-t vlist-t2\"><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.31166399999999994em;\"><span style=\"top:-2.5500000000000003em;margin-left:-0.07153em;margin-right:0.05em;\"><span class=\"pstrut\" style=\"height:2.7em;\"></span><span class=\"sizing reset-size6 size3 mtight\"><span class=\"mord mathnormal mtight\">i</span></span></span></span><span class=\"vlist-s\">â€‹</span></span><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.15em;\"><span></span></span></span></span></span></span><span class=\"mclose\">]</span></span></span></span></li>\n<li>æ„ŸçŸ¥å™¨ï¼š<span class=\"katex\"><span class=\"katex-mathml\"><math xmlns=\"http://www.w3.org/1998/Math/MathML\"><semantics><mrow><mi>f</mi><mo stretchy=\"false\">(</mo><mi>Q</mi><mo separator=\"true\">,</mo><msub><mi>K</mi><mi>i</mi></msub><mo stretchy=\"false\">)</mo><mo>=</mo><msup><mi>V</mi><mi>T</mi></msup><mi>tanh</mi><mo>â¡</mo><mo stretchy=\"false\">(</mo><mi>W</mi><mi>Q</mi><mo>+</mo><mi>U</mi><msub><mi>K</mi><mi>i</mi></msub><mo stretchy=\"false\">)</mo></mrow><annotation encoding=\"application/x-tex\">f(Q,K_i)=V^T \\tanh(WQ+UK_i)</annotation></semantics></math></span><span class=\"katex-html\" aria-hidden=\"true\"><span class=\"base\"><span class=\"strut\" style=\"height:1em;vertical-align:-0.25em;\"></span><span class=\"mord mathnormal\" style=\"margin-right:0.10764em;\">f</span><span class=\"mopen\">(</span><span class=\"mord mathnormal\">Q</span><span class=\"mpunct\">,</span><span class=\"mspace\" style=\"margin-right:0.16666666666666666em;\"></span><span class=\"mord\"><span class=\"mord mathnormal\" style=\"margin-right:0.07153em;\">K</span><span class=\"msupsub\"><span class=\"vlist-t vlist-t2\"><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.31166399999999994em;\"><span style=\"top:-2.5500000000000003em;margin-left:-0.07153em;margin-right:0.05em;\"><span class=\"pstrut\" style=\"height:2.7em;\"></span><span class=\"sizing reset-size6 size3 mtight\"><span class=\"mord mathnormal mtight\">i</span></span></span></span><span class=\"vlist-s\">â€‹</span></span><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.15em;\"><span></span></span></span></span></span></span><span class=\"mclose\">)</span><span class=\"mspace\" style=\"margin-right:0.2777777777777778em;\"></span><span class=\"mrel\">=</span><span class=\"mspace\" style=\"margin-right:0.2777777777777778em;\"></span></span><span class=\"base\"><span class=\"strut\" style=\"height:1.0913309999999998em;vertical-align:-0.25em;\"></span><span class=\"mord\"><span class=\"mord mathnormal\" style=\"margin-right:0.22222em;\">V</span><span class=\"msupsub\"><span class=\"vlist-t\"><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.8413309999999999em;\"><span style=\"top:-3.063em;margin-right:0.05em;\"><span class=\"pstrut\" style=\"height:2.7em;\"></span><span class=\"sizing reset-size6 size3 mtight\"><span class=\"mord mathnormal mtight\" style=\"margin-right:0.13889em;\">T</span></span></span></span></span></span></span></span><span class=\"mspace\" style=\"margin-right:0.16666666666666666em;\"></span><span class=\"mop\">tanh</span><span class=\"mopen\">(</span><span class=\"mord mathnormal\" style=\"margin-right:0.13889em;\">W</span><span class=\"mord mathnormal\">Q</span><span class=\"mspace\" style=\"margin-right:0.2222222222222222em;\"></span><span class=\"mbin\">+</span><span class=\"mspace\" style=\"margin-right:0.2222222222222222em;\"></span></span><span class=\"base\"><span class=\"strut\" style=\"height:1em;vertical-align:-0.25em;\"></span><span class=\"mord mathnormal\" style=\"margin-right:0.10903em;\">U</span><span class=\"mord\"><span class=\"mord mathnormal\" style=\"margin-right:0.07153em;\">K</span><span class=\"msupsub\"><span class=\"vlist-t vlist-t2\"><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.31166399999999994em;\"><span style=\"top:-2.5500000000000003em;margin-left:-0.07153em;margin-right:0.05em;\"><span class=\"pstrut\" style=\"height:2.7em;\"></span><span class=\"sizing reset-size6 size3 mtight\"><span class=\"mord mathnormal mtight\">i</span></span></span></span><span class=\"vlist-s\">â€‹</span></span><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.15em;\"><span></span></span></span></span></span></span><span class=\"mclose\">)</span></span></span></span></li>\n</ol>\n</li>\n<li>ç¬¬äºŒæ­¥ï¼šå°†å¾—åˆ°çš„ç›¸ä¼¼åº¦è¿›è¡Œ softmax æ“ä½œï¼Œè¿›è¡Œå½’ä¸€åŒ–ï¼š<span class=\"katex\"><span class=\"katex-mathml\"><math xmlns=\"http://www.w3.org/1998/Math/MathML\"><semantics><mrow><msub><mi>Î±</mi><mi>i</mi></msub><mo>=</mo><mi>s</mi><mi>o</mi><mi>f</mi><mi>t</mi><mi>m</mi><mi>a</mi><mi>x</mi><mo stretchy=\"false\">(</mo><mfrac><mrow><mi>f</mi><mo stretchy=\"false\">(</mo><mi>Q</mi><mo separator=\"true\">,</mo><msub><mi>K</mi><mi>i</mi></msub><mo stretchy=\"false\">)</mo></mrow><msub><msqrt><mi>d</mi></msqrt><mi>k</mi></msub></mfrac><mo stretchy=\"false\">)</mo></mrow><annotation encoding=\"application/x-tex\">\\alpha_i = softmax(\\frac{f(Q,K_i)}{\\sqrt d_k})</annotation></semantics></math></span><span class=\"katex-html\" aria-hidden=\"true\"><span class=\"base\"><span class=\"strut\" style=\"height:0.58056em;vertical-align:-0.15em;\"></span><span class=\"mord\"><span class=\"mord mathnormal\" style=\"margin-right:0.0037em;\">Î±</span><span class=\"msupsub\"><span class=\"vlist-t vlist-t2\"><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.31166399999999994em;\"><span style=\"top:-2.5500000000000003em;margin-left:-0.0037em;margin-right:0.05em;\"><span class=\"pstrut\" style=\"height:2.7em;\"></span><span class=\"sizing reset-size6 size3 mtight\"><span class=\"mord mathnormal mtight\">i</span></span></span></span><span class=\"vlist-s\">â€‹</span></span><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.15em;\"><span></span></span></span></span></span></span><span class=\"mspace\" style=\"margin-right:0.2777777777777778em;\"></span><span class=\"mrel\">=</span><span class=\"mspace\" style=\"margin-right:0.2777777777777778em;\"></span></span><span class=\"base\"><span class=\"strut\" style=\"height:1.5979999999999999em;vertical-align:-0.588em;\"></span><span class=\"mord mathnormal\">s</span><span class=\"mord mathnormal\">o</span><span class=\"mord mathnormal\" style=\"margin-right:0.10764em;\">f</span><span class=\"mord mathnormal\">t</span><span class=\"mord mathnormal\">m</span><span class=\"mord mathnormal\">a</span><span class=\"mord mathnormal\">x</span><span class=\"mopen\">(</span><span class=\"mord\"><span class=\"mopen nulldelimiter\"></span><span class=\"mfrac\"><span class=\"vlist-t vlist-t2\"><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:1.01em;\"><span style=\"top:-2.5335085em;\"><span class=\"pstrut\" style=\"height:3em;\"></span><span class=\"sizing reset-size6 size3 mtight\"><span class=\"mord mtight\"><span class=\"mord mtight\"><span class=\"mord sqrt mtight\"><span class=\"vlist-t vlist-t2\"><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.937845em;\"><span class=\"svg-align\" style=\"top:-3em;\"><span class=\"pstrut\" style=\"height:3em;\"></span><span class=\"mord mathnormal mtight\" style=\"padding-left:0.833em;\">d</span></span><span style=\"top:-2.8978450000000002em;\"><span class=\"pstrut\" style=\"height:3em;\"></span><span class=\"hide-tail mtight\" style=\"min-width:0.853em;height:1.08em;\"><svg width='400em' height='1.08em' viewBox='0 0 400000 1080' preserveAspectRatio='xMinYMin slice'><path d='M95,702\nc-2.7,0,-7.17,-2.7,-13.5,-8c-5.8,-5.3,-9.5,-10,-9.5,-14\nc0,-2,0.3,-3.3,1,-4c1.3,-2.7,23.83,-20.7,67.5,-54\nc44.2,-33.3,65.8,-50.3,66.5,-51c1.3,-1.3,3,-2,5,-2c4.7,0,8.7,3.3,12,10\ns173,378,173,378c0.7,0,35.3,-71,104,-213c68.7,-142,137.5,-285,206.5,-429\nc69,-144,104.5,-217.7,106.5,-221\nl0 -0\nc5.3,-9.3,12,-14,20,-14\nH400000v40H845.2724\ns-225.272,467,-225.272,467s-235,486,-235,486c-2.7,4.7,-9,7,-19,7\nc-6,0,-10,-1,-12,-3s-194,-422,-194,-422s-65,47,-65,47z\nM834 80h400000v40h-400000z'/></svg></span></span></span><span class=\"vlist-s\">â€‹</span></span><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.102155em;\"><span></span></span></span></span></span><span class=\"msupsub\"><span class=\"vlist-t vlist-t2\"><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.3224449999999999em;\"><span style=\"top:-2.3264164285714286em;margin-right:0.07142857142857144em;\"><span class=\"pstrut\" style=\"height:2.5em;\"></span><span class=\"sizing reset-size3 size1 mtight\"><span class=\"mord mathnormal mtight\" style=\"margin-right:0.03148em;\">k</span></span></span></span><span class=\"vlist-s\">â€‹</span></span><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.17358357142857145em;\"><span></span></span></span></span></span></span></span></span></span><span style=\"top:-3.23em;\"><span class=\"pstrut\" style=\"height:3em;\"></span><span class=\"frac-line\" style=\"border-bottom-width:0.04em;\"></span></span><span style=\"top:-3.485em;\"><span class=\"pstrut\" style=\"height:3em;\"></span><span class=\"sizing reset-size6 size3 mtight\"><span class=\"mord mtight\"><span class=\"mord mathnormal mtight\" style=\"margin-right:0.10764em;\">f</span><span class=\"mopen mtight\">(</span><span class=\"mord mathnormal mtight\">Q</span><span class=\"mpunct mtight\">,</span><span class=\"mord mtight\"><span class=\"mord mathnormal mtight\" style=\"margin-right:0.07153em;\">K</span><span class=\"msupsub\"><span class=\"vlist-t vlist-t2\"><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.3280857142857143em;\"><span style=\"top:-2.357em;margin-left:-0.07153em;margin-right:0.07142857142857144em;\"><span class=\"pstrut\" style=\"height:2.5em;\"></span><span class=\"sizing reset-size3 size1 mtight\"><span class=\"mord mathnormal mtight\">i</span></span></span></span><span class=\"vlist-s\">â€‹</span></span><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.143em;\"><span></span></span></span></span></span></span><span class=\"mclose mtight\">)</span></span></span></span></span><span class=\"vlist-s\">â€‹</span></span><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.588em;\"><span></span></span></span></span></span><span class=\"mclose nulldelimiter\"></span></span><span class=\"mclose\">)</span></span></span></span>\n<ol>\n<li>è¿™é‡Œç®€å•è®²è§£é™¤ä»¥ <span class=\"katex\"><span class=\"katex-mathml\"><math xmlns=\"http://www.w3.org/1998/Math/MathML\"><semantics><mrow><msub><msqrt><mi>d</mi></msqrt><mi>k</mi></msub></mrow><annotation encoding=\"application/x-tex\">\\sqrt d_k</annotation></semantics></math></span><span class=\"katex-html\" aria-hidden=\"true\"><span class=\"base\"><span class=\"strut\" style=\"height:1.0897000000000001em;vertical-align:-0.15747999999999998em;\"></span><span class=\"mord\"><span class=\"mord sqrt\"><span class=\"vlist-t vlist-t2\"><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.93222em;\"><span class=\"svg-align\" style=\"top:-3em;\"><span class=\"pstrut\" style=\"height:3em;\"></span><span class=\"mord mathnormal\" style=\"padding-left:0.833em;\">d</span></span><span style=\"top:-2.89222em;\"><span class=\"pstrut\" style=\"height:3em;\"></span><span class=\"hide-tail\" style=\"min-width:0.853em;height:1.08em;\"><svg width='400em' height='1.08em' viewBox='0 0 400000 1080' preserveAspectRatio='xMinYMin slice'><path d='M95,702\nc-2.7,0,-7.17,-2.7,-13.5,-8c-5.8,-5.3,-9.5,-10,-9.5,-14\nc0,-2,0.3,-3.3,1,-4c1.3,-2.7,23.83,-20.7,67.5,-54\nc44.2,-33.3,65.8,-50.3,66.5,-51c1.3,-1.3,3,-2,5,-2c4.7,0,8.7,3.3,12,10\ns173,378,173,378c0.7,0,35.3,-71,104,-213c68.7,-142,137.5,-285,206.5,-429\nc69,-144,104.5,-217.7,106.5,-221\nl0 -0\nc5.3,-9.3,12,-14,20,-14\nH400000v40H845.2724\ns-225.272,467,-225.272,467s-235,486,-235,486c-2.7,4.7,-9,7,-19,7\nc-6,0,-10,-1,-12,-3s-194,-422,-194,-422s-65,47,-65,47z\nM834 80h400000v40h-400000z'/></svg></span></span></span><span class=\"vlist-s\">â€‹</span></span><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.10777999999999999em;\"><span></span></span></span></span></span><span class=\"msupsub\"><span class=\"vlist-t vlist-t2\"><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.3286279999999999em;\"><span style=\"top:-2.54252em;margin-right:0.05em;\"><span class=\"pstrut\" style=\"height:2.7em;\"></span><span class=\"sizing reset-size6 size3 mtight\"><span class=\"mord mathnormal mtight\" style=\"margin-right:0.03148em;\">k</span></span></span></span><span class=\"vlist-s\">â€‹</span></span><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.15747999999999998em;\"><span></span></span></span></span></span></span></span></span></span> çš„ä½œç”¨ï¼šå‡è®¾ <span class=\"katex\"><span class=\"katex-mathml\"><math xmlns=\"http://www.w3.org/1998/Math/MathML\"><semantics><mrow><mi>Q</mi></mrow><annotation encoding=\"application/x-tex\">Q</annotation></semantics></math></span><span class=\"katex-html\" aria-hidden=\"true\"><span class=\"base\"><span class=\"strut\" style=\"height:0.8777699999999999em;vertical-align:-0.19444em;\"></span><span class=\"mord mathnormal\">Q</span></span></span></span> , <span class=\"katex\"><span class=\"katex-mathml\"><math xmlns=\"http://www.w3.org/1998/Math/MathML\"><semantics><mrow><mi>K</mi></mrow><annotation encoding=\"application/x-tex\">K</annotation></semantics></math></span><span class=\"katex-html\" aria-hidden=\"true\"><span class=\"base\"><span class=\"strut\" style=\"height:0.68333em;vertical-align:0em;\"></span><span class=\"mord mathnormal\" style=\"margin-right:0.07153em;\">K</span></span></span></span> é‡Œçš„å…ƒç´ çš„å‡å€¼ä¸º 0ï¼Œæ–¹å·®ä¸º 1ï¼Œé‚£ä¹ˆ <span class=\"katex\"><span class=\"katex-mathml\"><math xmlns=\"http://www.w3.org/1998/Math/MathML\"><semantics><mrow><msup><mi>A</mi><mi>T</mi></msup><mo>=</mo><msup><mi>Q</mi><mi>T</mi></msup><mi>K</mi></mrow><annotation encoding=\"application/x-tex\">A^T=Q^TK</annotation></semantics></math></span><span class=\"katex-html\" aria-hidden=\"true\"><span class=\"base\"><span class=\"strut\" style=\"height:0.8413309999999999em;vertical-align:0em;\"></span><span class=\"mord\"><span class=\"mord mathnormal\">A</span><span class=\"msupsub\"><span class=\"vlist-t\"><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.8413309999999999em;\"><span style=\"top:-3.063em;margin-right:0.05em;\"><span class=\"pstrut\" style=\"height:2.7em;\"></span><span class=\"sizing reset-size6 size3 mtight\"><span class=\"mord mathnormal mtight\" style=\"margin-right:0.13889em;\">T</span></span></span></span></span></span></span></span><span class=\"mspace\" style=\"margin-right:0.2777777777777778em;\"></span><span class=\"mrel\">=</span><span class=\"mspace\" style=\"margin-right:0.2777777777777778em;\"></span></span><span class=\"base\"><span class=\"strut\" style=\"height:1.035771em;vertical-align:-0.19444em;\"></span><span class=\"mord\"><span class=\"mord mathnormal\">Q</span><span class=\"msupsub\"><span class=\"vlist-t\"><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.8413309999999999em;\"><span style=\"top:-3.063em;margin-right:0.05em;\"><span class=\"pstrut\" style=\"height:2.7em;\"></span><span class=\"sizing reset-size6 size3 mtight\"><span class=\"mord mathnormal mtight\" style=\"margin-right:0.13889em;\">T</span></span></span></span></span></span></span></span><span class=\"mord mathnormal\" style=\"margin-right:0.07153em;\">K</span></span></span></span> ä¸­å…ƒç´ çš„å‡å€¼ä¸º 0ï¼Œæ–¹å·®ä¸º dã€‚å½“ d å˜å¾—å¾ˆå¤§æ—¶ï¼Œ <span class=\"katex\"><span class=\"katex-mathml\"><math xmlns=\"http://www.w3.org/1998/Math/MathML\"><semantics><mrow><mi>A</mi></mrow><annotation encoding=\"application/x-tex\">A</annotation></semantics></math></span><span class=\"katex-html\" aria-hidden=\"true\"><span class=\"base\"><span class=\"strut\" style=\"height:0.68333em;vertical-align:0em;\"></span><span class=\"mord mathnormal\">A</span></span></span></span> ä¸­çš„å…ƒç´ çš„æ–¹å·®ä¹Ÿä¼šå˜å¾—å¾ˆå¤§ï¼Œå¦‚æœ <span class=\"katex\"><span class=\"katex-mathml\"><math xmlns=\"http://www.w3.org/1998/Math/MathML\"><semantics><mrow><mi>A</mi></mrow><annotation encoding=\"application/x-tex\">A</annotation></semantics></math></span><span class=\"katex-html\" aria-hidden=\"true\"><span class=\"base\"><span class=\"strut\" style=\"height:0.68333em;vertical-align:0em;\"></span><span class=\"mord mathnormal\">A</span></span></span></span> ä¸­çš„å…ƒç´ æ–¹å·®å¾ˆå¤§ (åˆ†å¸ƒçš„æ–¹å·®å¤§ï¼Œåˆ†å¸ƒé›†ä¸­åœ¨ç»å¯¹å€¼å¤§çš„åŒºåŸŸ)ï¼Œ<strong>åœ¨æ•°é‡çº§è¾ƒå¤§æ—¶ï¼Œ softmax å°†å‡ ä¹å…¨éƒ¨çš„æ¦‚ç‡åˆ†å¸ƒéƒ½åˆ†é…ç»™äº†æœ€å¤§å€¼å¯¹åº”çš„æ ‡ç­¾</strong>ï¼Œç”±äºæŸä¸€ç»´åº¦çš„æ•°é‡çº§è¾ƒå¤§ï¼Œè¿›è€Œä¼šå¯¼è‡´ softmax æœªæ¥æ±‚æ¢¯åº¦æ—¶ä¼šæ¶ˆå¤±ã€‚æ€»ç»“ä¸€ä¸‹å°±æ˜¯ <span class=\"katex\"><span class=\"katex-mathml\"><math xmlns=\"http://www.w3.org/1998/Math/MathML\"><semantics><mrow><mi mathvariant=\"normal\">softmax</mi><mo>â¡</mo><mrow><mo fence=\"true\">(</mo><mi>A</mi><mo fence=\"true\">)</mo></mrow></mrow><annotation encoding=\"application/x-tex\">\\operatorname{softmax}\\left(A\\right)</annotation></semantics></math></span><span class=\"katex-html\" aria-hidden=\"true\"><span class=\"base\"><span class=\"strut\" style=\"height:1em;vertical-align:-0.25em;\"></span><span class=\"mop\"><span class=\"mord mathrm\">s</span><span class=\"mord mathrm\">o</span><span class=\"mord mathrm\" style=\"margin-right:0.07778em;\">f</span><span class=\"mord mathrm\">t</span><span class=\"mord mathrm\">m</span><span class=\"mord mathrm\">a</span><span class=\"mord mathrm\">x</span></span><span class=\"mspace\" style=\"margin-right:0.16666666666666666em;\"></span><span class=\"minner\"><span class=\"mopen delimcenter\" style=\"top:0em;\">(</span><span class=\"mord mathnormal\">A</span><span class=\"mclose delimcenter\" style=\"top:0em;\">)</span></span></span></span></span> çš„åˆ†å¸ƒä¼šå’Œ d æœ‰å…³ã€‚å› æ­¤ <span class=\"katex\"><span class=\"katex-mathml\"><math xmlns=\"http://www.w3.org/1998/Math/MathML\"><semantics><mrow><mi>A</mi></mrow><annotation encoding=\"application/x-tex\">A</annotation></semantics></math></span><span class=\"katex-html\" aria-hidden=\"true\"><span class=\"base\"><span class=\"strut\" style=\"height:0.68333em;vertical-align:0em;\"></span><span class=\"mord mathnormal\">A</span></span></span></span> ä¸­æ¯ä¸€ä¸ªå…ƒç´ ä¹˜ä¸Š <span class=\"katex\"><span class=\"katex-mathml\"><math xmlns=\"http://www.w3.org/1998/Math/MathML\"><semantics><mrow><mfrac><mn>1</mn><msqrt><msub><mi>d</mi><mi>k</mi></msub></msqrt></mfrac></mrow><annotation encoding=\"application/x-tex\">\\frac{1}{\\sqrt{d_k}}</annotation></semantics></math></span><span class=\"katex-html\" aria-hidden=\"true\"><span class=\"base\"><span class=\"strut\" style=\"height:1.383108em;vertical-align:-0.538em;\"></span><span class=\"mord\"><span class=\"mopen nulldelimiter\"></span><span class=\"mfrac\"><span class=\"vlist-t vlist-t2\"><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.845108em;\"><span style=\"top:-2.5864385em;\"><span class=\"pstrut\" style=\"height:3em;\"></span><span class=\"sizing reset-size6 size3 mtight\"><span class=\"mord mtight\"><span class=\"mord sqrt mtight\"><span class=\"vlist-t vlist-t2\"><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.8622307142857143em;\"><span class=\"svg-align\" style=\"top:-3em;\"><span class=\"pstrut\" style=\"height:3em;\"></span><span class=\"mord mtight\" style=\"padding-left:0.833em;\"><span class=\"mord mtight\"><span class=\"mord mathnormal mtight\">d</span><span class=\"msupsub\"><span class=\"vlist-t vlist-t2\"><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.3448em;\"><span style=\"top:-2.3487714285714287em;margin-left:0em;margin-right:0.07142857142857144em;\"><span class=\"pstrut\" style=\"height:2.5em;\"></span><span class=\"sizing reset-size3 size1 mtight\"><span class=\"mord mathnormal mtight\" style=\"margin-right:0.03148em;\">k</span></span></span></span><span class=\"vlist-s\">â€‹</span></span><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.15122857142857138em;\"><span></span></span></span></span></span></span></span></span><span style=\"top:-2.8222307142857144em;\"><span class=\"pstrut\" style=\"height:3em;\"></span><span class=\"hide-tail mtight\" style=\"min-width:0.853em;height:1.08em;\"><svg width='400em' height='1.08em' viewBox='0 0 400000 1080' preserveAspectRatio='xMinYMin slice'><path d='M95,702\nc-2.7,0,-7.17,-2.7,-13.5,-8c-5.8,-5.3,-9.5,-10,-9.5,-14\nc0,-2,0.3,-3.3,1,-4c1.3,-2.7,23.83,-20.7,67.5,-54\nc44.2,-33.3,65.8,-50.3,66.5,-51c1.3,-1.3,3,-2,5,-2c4.7,0,8.7,3.3,12,10\ns173,378,173,378c0.7,0,35.3,-71,104,-213c68.7,-142,137.5,-285,206.5,-429\nc69,-144,104.5,-217.7,106.5,-221\nl0 -0\nc5.3,-9.3,12,-14,20,-14\nH400000v40H845.2724\ns-225.272,467,-225.272,467s-235,486,-235,486c-2.7,4.7,-9,7,-19,7\nc-6,0,-10,-1,-12,-3s-194,-422,-194,-422s-65,47,-65,47z\nM834 80h400000v40h-400000z'/></svg></span></span></span><span class=\"vlist-s\">â€‹</span></span><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.17776928571428574em;\"><span></span></span></span></span></span></span></span></span><span style=\"top:-3.23em;\"><span class=\"pstrut\" style=\"height:3em;\"></span><span class=\"frac-line\" style=\"border-bottom-width:0.04em;\"></span></span><span style=\"top:-3.394em;\"><span class=\"pstrut\" style=\"height:3em;\"></span><span class=\"sizing reset-size6 size3 mtight\"><span class=\"mord mtight\"><span class=\"mord mtight\">1</span></span></span></span></span><span class=\"vlist-s\">â€‹</span></span><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.538em;\"><span></span></span></span></span></span><span class=\"mclose nulldelimiter\"></span></span></span></span></span> åï¼Œæ–¹å·®åˆå˜ä¸º 1ï¼Œå¹¶ä¸” <span class=\"katex\"><span class=\"katex-mathml\"><math xmlns=\"http://www.w3.org/1998/Math/MathML\"><semantics><mrow><mi>A</mi></mrow><annotation encoding=\"application/x-tex\">A</annotation></semantics></math></span><span class=\"katex-html\" aria-hidden=\"true\"><span class=\"base\"><span class=\"strut\" style=\"height:0.68333em;vertical-align:0em;\"></span><span class=\"mord mathnormal\">A</span></span></span></span> çš„æ•°é‡çº§ä¹Ÿå°†ä¼šå˜å°ã€‚</li>\n</ol>\n</li>\n<li>ç¬¬ä¸‰æ­¥ï¼šé’ˆå¯¹è®¡ç®—å‡ºæ¥çš„æƒé‡ <span class=\"katex\"><span class=\"katex-mathml\"><math xmlns=\"http://www.w3.org/1998/Math/MathML\"><semantics><mrow><msub><mi>Î±</mi><mi>i</mi></msub></mrow><annotation encoding=\"application/x-tex\">\\alpha_i</annotation></semantics></math></span><span class=\"katex-html\" aria-hidden=\"true\"><span class=\"base\"><span class=\"strut\" style=\"height:0.58056em;vertical-align:-0.15em;\"></span><span class=\"mord\"><span class=\"mord mathnormal\" style=\"margin-right:0.0037em;\">Î±</span><span class=\"msupsub\"><span class=\"vlist-t vlist-t2\"><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.31166399999999994em;\"><span style=\"top:-2.5500000000000003em;margin-left:-0.0037em;margin-right:0.05em;\"><span class=\"pstrut\" style=\"height:2.7em;\"></span><span class=\"sizing reset-size6 size3 mtight\"><span class=\"mord mathnormal mtight\">i</span></span></span></span><span class=\"vlist-s\">â€‹</span></span><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.15em;\"><span></span></span></span></span></span></span></span></span></span>ï¼Œå¯¹ <span class=\"katex\"><span class=\"katex-mathml\"><math xmlns=\"http://www.w3.org/1998/Math/MathML\"><semantics><mrow><mi>V</mi></mrow><annotation encoding=\"application/x-tex\">V</annotation></semantics></math></span><span class=\"katex-html\" aria-hidden=\"true\"><span class=\"base\"><span class=\"strut\" style=\"height:0.68333em;vertical-align:0em;\"></span><span class=\"mord mathnormal\" style=\"margin-right:0.22222em;\">V</span></span></span></span> ä¸­çš„æ‰€æœ‰ values è¿›è¡ŒåŠ æƒæ±‚å’Œè®¡ç®—ï¼Œå¾—åˆ° Attention å‘é‡ï¼š<span class=\"katex\"><span class=\"katex-mathml\"><math xmlns=\"http://www.w3.org/1998/Math/MathML\"><semantics><mrow><mi>A</mi><mi>t</mi><mi>t</mi><mi>e</mi><mi>n</mi><mi>t</mi><mi>i</mi><mi>o</mi><mi>n</mi><mo>=</mo><msubsup><mo>âˆ‘</mo><mrow><mi>i</mi><mo>=</mo><mn>1</mn></mrow><mi>m</mi></msubsup><msub><mi>Î±</mi><mi>i</mi></msub><msub><mi>V</mi><mi>i</mi></msub></mrow><annotation encoding=\"application/x-tex\">Attention = \\sum_{i=1}^m \\alpha_i V_i</annotation></semantics></math></span><span class=\"katex-html\" aria-hidden=\"true\"><span class=\"base\"><span class=\"strut\" style=\"height:0.68333em;vertical-align:0em;\"></span><span class=\"mord mathnormal\">A</span><span class=\"mord mathnormal\">t</span><span class=\"mord mathnormal\">t</span><span class=\"mord mathnormal\">e</span><span class=\"mord mathnormal\">n</span><span class=\"mord mathnormal\">t</span><span class=\"mord mathnormal\">i</span><span class=\"mord mathnormal\">o</span><span class=\"mord mathnormal\">n</span><span class=\"mspace\" style=\"margin-right:0.2777777777777778em;\"></span><span class=\"mrel\">=</span><span class=\"mspace\" style=\"margin-right:0.2777777777777778em;\"></span></span><span class=\"base\"><span class=\"strut\" style=\"height:1.104002em;vertical-align:-0.29971000000000003em;\"></span><span class=\"mop\"><span class=\"mop op-symbol small-op\" style=\"position:relative;top:-0.0000050000000000050004em;\">âˆ‘</span><span class=\"msupsub\"><span class=\"vlist-t vlist-t2\"><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.804292em;\"><span style=\"top:-2.40029em;margin-left:0em;margin-right:0.05em;\"><span class=\"pstrut\" style=\"height:2.7em;\"></span><span class=\"sizing reset-size6 size3 mtight\"><span class=\"mord mtight\"><span class=\"mord mathnormal mtight\">i</span><span class=\"mrel mtight\">=</span><span class=\"mord mtight\">1</span></span></span></span><span style=\"top:-3.2029em;margin-right:0.05em;\"><span class=\"pstrut\" style=\"height:2.7em;\"></span><span class=\"sizing reset-size6 size3 mtight\"><span class=\"mord mathnormal mtight\">m</span></span></span></span><span class=\"vlist-s\">â€‹</span></span><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.29971000000000003em;\"><span></span></span></span></span></span></span><span class=\"mspace\" style=\"margin-right:0.16666666666666666em;\"></span><span class=\"mord\"><span class=\"mord mathnormal\" style=\"margin-right:0.0037em;\">Î±</span><span class=\"msupsub\"><span class=\"vlist-t vlist-t2\"><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.31166399999999994em;\"><span style=\"top:-2.5500000000000003em;margin-left:-0.0037em;margin-right:0.05em;\"><span class=\"pstrut\" style=\"height:2.7em;\"></span><span class=\"sizing reset-size6 size3 mtight\"><span class=\"mord mathnormal mtight\">i</span></span></span></span><span class=\"vlist-s\">â€‹</span></span><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.15em;\"><span></span></span></span></span></span></span><span class=\"mord\"><span class=\"mord mathnormal\" style=\"margin-right:0.22222em;\">V</span><span class=\"msupsub\"><span class=\"vlist-t vlist-t2\"><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.31166399999999994em;\"><span style=\"top:-2.5500000000000003em;margin-left:-0.22222em;margin-right:0.05em;\"><span class=\"pstrut\" style=\"height:2.7em;\"></span><span class=\"sizing reset-size6 size3 mtight\"><span class=\"mord mathnormal mtight\">i</span></span></span></span><span class=\"vlist-s\">â€‹</span></span><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.15em;\"><span></span></span></span></span></span></span></span></span></span></li>\n</ol>\n<h2 id=\"83-self-attention-æ¨¡å‹\"><a class=\"anchor\" href=\"#83-self-attention-æ¨¡å‹\">#</a> 8.3 Self Attention æ¨¡å‹</h2>\n<p>ä¸Šé¢å·²ç»è®²äº† Attention å°±æ˜¯ä»ä¸€å †ä¿¡æ¯ä¸­ç­›é€‰å‡ºé‡è¦çš„ä¿¡æ¯ï¼Œç°åœ¨æˆ‘ä»¬æ¥é€šè¿‡ Self Attention æ¨¡å‹æ¥è¯¦ç»†è®²è§£å¦‚ä½•æ‰¾åˆ°è¿™äº›é‡è¦çš„ä¿¡æ¯ã€‚</p>\n<p>Self Attention æ¨¡å‹çš„æ¶æ„å¦‚ä¸‹å›¾æ‰€ç¤ºï¼Œæ¥ä¸‹æ¥æˆ‘ä»¬å°†æŒ‰ç…§è¿™ä¸ªæ¨¡å‹æ¶æ„çš„é¡ºåºæ¥é€ä¸€è§£é‡Šã€‚</p>\n<p>&lt;img src=&quot;<span class=\"exturl\" data-url=\"aHR0cHM6Ly9pbWdtZC5vc3MtY24tc2hhbmdoYWkuYWxpeXVuY3MuY29tL0JFUlRfSU1HL3NlbGYtYXR0ZW50aW9uLmpwZw==\">https://imgmd.oss-cn-shanghai.aliyuncs.com/BERT_IMG/self-attention.jpg</span>&quot; style=&quot;zoom:50%;&quot; /&gt;</p>\n<p>é¦–å…ˆå¯ä»¥çœ‹åˆ° Self Attention æœ‰ä¸‰ä¸ªè¾“å…¥ Qã€Kã€Vï¼š<strong>å¯¹äº Self Attentionï¼ŒQã€Kã€V æ¥è‡ªå¥å­ X çš„ è¯å‘é‡ x çš„çº¿æ€§è½¬åŒ–ï¼Œå³å¯¹äºè¯å‘é‡ xï¼Œç»™å®šä¸‰ä¸ªå¯å­¦ä¹ çš„çŸ©é˜µå‚æ•° <span class=\"katex\"><span class=\"katex-mathml\"><math xmlns=\"http://www.w3.org/1998/Math/MathML\"><semantics><mrow><msub><mi>W</mi><mi>Q</mi></msub><mo separator=\"true\">,</mo><msub><mi>W</mi><mi>k</mi></msub><mo separator=\"true\">,</mo><msub><mi>W</mi><mi>v</mi></msub></mrow><annotation encoding=\"application/x-tex\">W_Q,W_k,W_v</annotation></semantics></math></span><span class=\"katex-html\" aria-hidden=\"true\"><span class=\"base\"><span class=\"strut\" style=\"height:0.969438em;vertical-align:-0.286108em;\"></span><span class=\"mord\"><span class=\"mord mathnormal\" style=\"margin-right:0.13889em;\">W</span><span class=\"msupsub\"><span class=\"vlist-t vlist-t2\"><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.328331em;\"><span style=\"top:-2.5500000000000003em;margin-left:-0.13889em;margin-right:0.05em;\"><span class=\"pstrut\" style=\"height:2.7em;\"></span><span class=\"sizing reset-size6 size3 mtight\"><span class=\"mord mathnormal mtight\">Q</span></span></span></span><span class=\"vlist-s\">â€‹</span></span><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.286108em;\"><span></span></span></span></span></span></span><span class=\"mpunct\">,</span><span class=\"mspace\" style=\"margin-right:0.16666666666666666em;\"></span><span class=\"mord\"><span class=\"mord mathnormal\" style=\"margin-right:0.13889em;\">W</span><span class=\"msupsub\"><span class=\"vlist-t vlist-t2\"><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.33610799999999996em;\"><span style=\"top:-2.5500000000000003em;margin-left:-0.13889em;margin-right:0.05em;\"><span class=\"pstrut\" style=\"height:2.7em;\"></span><span class=\"sizing reset-size6 size3 mtight\"><span class=\"mord mathnormal mtight\" style=\"margin-right:0.03148em;\">k</span></span></span></span><span class=\"vlist-s\">â€‹</span></span><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.15em;\"><span></span></span></span></span></span></span><span class=\"mpunct\">,</span><span class=\"mspace\" style=\"margin-right:0.16666666666666666em;\"></span><span class=\"mord\"><span class=\"mord mathnormal\" style=\"margin-right:0.13889em;\">W</span><span class=\"msupsub\"><span class=\"vlist-t vlist-t2\"><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.151392em;\"><span style=\"top:-2.5500000000000003em;margin-left:-0.13889em;margin-right:0.05em;\"><span class=\"pstrut\" style=\"height:2.7em;\"></span><span class=\"sizing reset-size6 size3 mtight\"><span class=\"mord mathnormal mtight\" style=\"margin-right:0.03588em;\">v</span></span></span></span><span class=\"vlist-s\">â€‹</span></span><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.15em;\"><span></span></span></span></span></span></span></span></span></span>ï¼Œx åˆ†åˆ«å³ä¹˜ä¸Šè¿°çŸ©é˜µå¾—åˆ° Qã€Kã€V</strong>ã€‚</p>\n<p>æ¥ä¸‹æ¥ä¸ºäº†è¡¨ç¤ºçš„æ–¹ä¾¿ï¼Œæˆ‘ä»¬å…ˆé€šè¿‡å‘é‡çš„è®¡ç®—å™è¿° Self Attention è®¡ç®—çš„æµç¨‹ï¼Œç„¶åå†æè¿° Self Attention çš„çŸ©é˜µè®¡ç®—è¿‡ç¨‹</p>\n<ol>\n<li>\n<p>ç¬¬ä¸€æ­¥ï¼ŒQã€Kã€V çš„è·å–</p>\n<ol>\n<li></li>\n</ol>\n<p>&lt;img src=&quot;<span class=\"exturl\" data-url=\"aHR0cHM6Ly9pbWdtZC5vc3MtY24tc2hhbmdoYWkuYWxpeXVuY3MuY29tL0JFUlRfSU1HL3Frdi5qcGc=\">https://imgmd.oss-cn-shanghai.aliyuncs.com/BERT_IMG/qkv.jpg</span>&quot; style=&quot;zoom:50%;&quot; /&gt;</p>\n<p>ä¸Šå›¾æ“ä½œï¼šä¸¤ä¸ªå•è¯ Thinking å’Œ Machinesã€‚é€šè¿‡çº¿æ€§å˜æ¢ï¼Œå³ <span class=\"katex\"><span class=\"katex-mathml\"><math xmlns=\"http://www.w3.org/1998/Math/MathML\"><semantics><mrow><msub><mi>x</mi><mi>i</mi></msub></mrow><annotation encoding=\"application/x-tex\">x_i</annotation></semantics></math></span><span class=\"katex-html\" aria-hidden=\"true\"><span class=\"base\"><span class=\"strut\" style=\"height:0.58056em;vertical-align:-0.15em;\"></span><span class=\"mord\"><span class=\"mord mathnormal\">x</span><span class=\"msupsub\"><span class=\"vlist-t vlist-t2\"><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.31166399999999994em;\"><span style=\"top:-2.5500000000000003em;margin-left:0em;margin-right:0.05em;\"><span class=\"pstrut\" style=\"height:2.7em;\"></span><span class=\"sizing reset-size6 size3 mtight\"><span class=\"mord mathnormal mtight\">i</span></span></span></span><span class=\"vlist-s\">â€‹</span></span><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.15em;\"><span></span></span></span></span></span></span></span></span></span> å’Œ <span class=\"katex\"><span class=\"katex-mathml\"><math xmlns=\"http://www.w3.org/1998/Math/MathML\"><semantics><mrow><msub><mi>x</mi><mn>2</mn></msub></mrow><annotation encoding=\"application/x-tex\">x_2</annotation></semantics></math></span><span class=\"katex-html\" aria-hidden=\"true\"><span class=\"base\"><span class=\"strut\" style=\"height:0.58056em;vertical-align:-0.15em;\"></span><span class=\"mord\"><span class=\"mord mathnormal\">x</span><span class=\"msupsub\"><span class=\"vlist-t vlist-t2\"><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.30110799999999993em;\"><span style=\"top:-2.5500000000000003em;margin-left:0em;margin-right:0.05em;\"><span class=\"pstrut\" style=\"height:2.7em;\"></span><span class=\"sizing reset-size6 size3 mtight\"><span class=\"mord mtight\">2</span></span></span></span><span class=\"vlist-s\">â€‹</span></span><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.15em;\"><span></span></span></span></span></span></span></span></span></span> ä¸¤ä¸ªå‘é‡åˆ†åˆ«ä¸<span class=\"katex\"><span class=\"katex-mathml\"><math xmlns=\"http://www.w3.org/1998/Math/MathML\"><semantics><mrow><msub><mi>W</mi><mi>q</mi></msub><mo separator=\"true\">,</mo><msub><mi>W</mi><mi>k</mi></msub><mo separator=\"true\">,</mo><msub><mi>W</mi><mi>v</mi></msub></mrow><annotation encoding=\"application/x-tex\">W_q,W_k,W_v</annotation></semantics></math></span><span class=\"katex-html\" aria-hidden=\"true\"><span class=\"base\"><span class=\"strut\" style=\"height:0.969438em;vertical-align:-0.286108em;\"></span><span class=\"mord\"><span class=\"mord mathnormal\" style=\"margin-right:0.13889em;\">W</span><span class=\"msupsub\"><span class=\"vlist-t vlist-t2\"><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.15139200000000003em;\"><span style=\"top:-2.5500000000000003em;margin-left:-0.13889em;margin-right:0.05em;\"><span class=\"pstrut\" style=\"height:2.7em;\"></span><span class=\"sizing reset-size6 size3 mtight\"><span class=\"mord mathnormal mtight\" style=\"margin-right:0.03588em;\">q</span></span></span></span><span class=\"vlist-s\">â€‹</span></span><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.286108em;\"><span></span></span></span></span></span></span><span class=\"mpunct\">,</span><span class=\"mspace\" style=\"margin-right:0.16666666666666666em;\"></span><span class=\"mord\"><span class=\"mord mathnormal\" style=\"margin-right:0.13889em;\">W</span><span class=\"msupsub\"><span class=\"vlist-t vlist-t2\"><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.33610799999999996em;\"><span style=\"top:-2.5500000000000003em;margin-left:-0.13889em;margin-right:0.05em;\"><span class=\"pstrut\" style=\"height:2.7em;\"></span><span class=\"sizing reset-size6 size3 mtight\"><span class=\"mord mathnormal mtight\" style=\"margin-right:0.03148em;\">k</span></span></span></span><span class=\"vlist-s\">â€‹</span></span><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.15em;\"><span></span></span></span></span></span></span><span class=\"mpunct\">,</span><span class=\"mspace\" style=\"margin-right:0.16666666666666666em;\"></span><span class=\"mord\"><span class=\"mord mathnormal\" style=\"margin-right:0.13889em;\">W</span><span class=\"msupsub\"><span class=\"vlist-t vlist-t2\"><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.151392em;\"><span style=\"top:-2.5500000000000003em;margin-left:-0.13889em;margin-right:0.05em;\"><span class=\"pstrut\" style=\"height:2.7em;\"></span><span class=\"sizing reset-size6 size3 mtight\"><span class=\"mord mathnormal mtight\" style=\"margin-right:0.03588em;\">v</span></span></span></span><span class=\"vlist-s\">â€‹</span></span><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.15em;\"><span></span></span></span></span></span></span></span></span></span> ä¸‰ä¸ªçŸ©é˜µç‚¹ä¹˜å¾—åˆ° ${q_1,q_2},{k_1,k_2},{v_1,v_2} $ å…± 6 ä¸ªå‘é‡ã€‚çŸ©é˜µ Q åˆ™æ˜¯å‘é‡ <span class=\"katex\"><span class=\"katex-mathml\"><math xmlns=\"http://www.w3.org/1998/Math/MathML\"><semantics><mrow><msub><mi>q</mi><mn>1</mn></msub><mo separator=\"true\">,</mo><msub><mi>q</mi><mn>2</mn></msub></mrow><annotation encoding=\"application/x-tex\">q_1,q_2</annotation></semantics></math></span><span class=\"katex-html\" aria-hidden=\"true\"><span class=\"base\"><span class=\"strut\" style=\"height:0.625em;vertical-align:-0.19444em;\"></span><span class=\"mord\"><span class=\"mord mathnormal\" style=\"margin-right:0.03588em;\">q</span><span class=\"msupsub\"><span class=\"vlist-t vlist-t2\"><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.30110799999999993em;\"><span style=\"top:-2.5500000000000003em;margin-left:-0.03588em;margin-right:0.05em;\"><span class=\"pstrut\" style=\"height:2.7em;\"></span><span class=\"sizing reset-size6 size3 mtight\"><span class=\"mord mtight\">1</span></span></span></span><span class=\"vlist-s\">â€‹</span></span><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.15em;\"><span></span></span></span></span></span></span><span class=\"mpunct\">,</span><span class=\"mspace\" style=\"margin-right:0.16666666666666666em;\"></span><span class=\"mord\"><span class=\"mord mathnormal\" style=\"margin-right:0.03588em;\">q</span><span class=\"msupsub\"><span class=\"vlist-t vlist-t2\"><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.30110799999999993em;\"><span style=\"top:-2.5500000000000003em;margin-left:-0.03588em;margin-right:0.05em;\"><span class=\"pstrut\" style=\"height:2.7em;\"></span><span class=\"sizing reset-size6 size3 mtight\"><span class=\"mord mtight\">2</span></span></span></span><span class=\"vlist-s\">â€‹</span></span><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.15em;\"><span></span></span></span></span></span></span></span></span></span> çš„æ‹¼æ¥ï¼ŒKã€V åŒç†ã€‚</p>\n</li>\n<li>\n<p>ç¬¬äºŒæ­¥ï¼ŒMatMul</p>\n<ol>\n<li>\n<p>&lt;img src=&quot;<span class=\"exturl\" data-url=\"aHR0cHM6Ly9pbWdtZC5vc3MtY24tc2hhbmdoYWkuYWxpeXVuY3MuY29tL0JFUlRfSU1HL1EtSyVFNCVCOSU5OCVFNyVBNyVBRi5qcGc=\">https://imgmd.oss-cn-shanghai.aliyuncs.com/BERT_IMG/Q-K ä¹˜ç§¯.jpg</span>&quot; style=&quot;zoom:50%;&quot; /&gt;</p>\n<p>ä¸Šå›¾æ“ä½œï¼šå‘é‡ <span class=\"katex\"><span class=\"katex-mathml\"><math xmlns=\"http://www.w3.org/1998/Math/MathML\"><semantics><mrow><msub><mi>q</mi><mn>1</mn></msub><mo separator=\"true\">,</mo><msub><mi>k</mi><mn>1</mn></msub></mrow><annotation encoding=\"application/x-tex\">{q_1,k_1}</annotation></semantics></math></span><span class=\"katex-html\" aria-hidden=\"true\"><span class=\"base\"><span class=\"strut\" style=\"height:0.8888799999999999em;vertical-align:-0.19444em;\"></span><span class=\"mord\"><span class=\"mord\"><span class=\"mord mathnormal\" style=\"margin-right:0.03588em;\">q</span><span class=\"msupsub\"><span class=\"vlist-t vlist-t2\"><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.30110799999999993em;\"><span style=\"top:-2.5500000000000003em;margin-left:-0.03588em;margin-right:0.05em;\"><span class=\"pstrut\" style=\"height:2.7em;\"></span><span class=\"sizing reset-size6 size3 mtight\"><span class=\"mord mtight\">1</span></span></span></span><span class=\"vlist-s\">â€‹</span></span><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.15em;\"><span></span></span></span></span></span></span><span class=\"mpunct\">,</span><span class=\"mspace\" style=\"margin-right:0.16666666666666666em;\"></span><span class=\"mord\"><span class=\"mord mathnormal\" style=\"margin-right:0.03148em;\">k</span><span class=\"msupsub\"><span class=\"vlist-t vlist-t2\"><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.30110799999999993em;\"><span style=\"top:-2.5500000000000003em;margin-left:-0.03148em;margin-right:0.05em;\"><span class=\"pstrut\" style=\"height:2.7em;\"></span><span class=\"sizing reset-size6 size3 mtight\"><span class=\"mord mtight\">1</span></span></span></span><span class=\"vlist-s\">â€‹</span></span><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.15em;\"><span></span></span></span></span></span></span></span></span></span></span> åšç‚¹ä¹˜å¾—åˆ°å¾—åˆ† 112ï¼Œ <span class=\"katex\"><span class=\"katex-mathml\"><math xmlns=\"http://www.w3.org/1998/Math/MathML\"><semantics><mrow><msub><mi>q</mi><mn>1</mn></msub><mo separator=\"true\">,</mo><msub><mi>k</mi><mn>2</mn></msub></mrow><annotation encoding=\"application/x-tex\">{q_1,k_2}</annotation></semantics></math></span><span class=\"katex-html\" aria-hidden=\"true\"><span class=\"base\"><span class=\"strut\" style=\"height:0.8888799999999999em;vertical-align:-0.19444em;\"></span><span class=\"mord\"><span class=\"mord\"><span class=\"mord mathnormal\" style=\"margin-right:0.03588em;\">q</span><span class=\"msupsub\"><span class=\"vlist-t vlist-t2\"><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.30110799999999993em;\"><span style=\"top:-2.5500000000000003em;margin-left:-0.03588em;margin-right:0.05em;\"><span class=\"pstrut\" style=\"height:2.7em;\"></span><span class=\"sizing reset-size6 size3 mtight\"><span class=\"mord mtight\">1</span></span></span></span><span class=\"vlist-s\">â€‹</span></span><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.15em;\"><span></span></span></span></span></span></span><span class=\"mpunct\">,</span><span class=\"mspace\" style=\"margin-right:0.16666666666666666em;\"></span><span class=\"mord\"><span class=\"mord mathnormal\" style=\"margin-right:0.03148em;\">k</span><span class=\"msupsub\"><span class=\"vlist-t vlist-t2\"><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.30110799999999993em;\"><span style=\"top:-2.5500000000000003em;margin-left:-0.03148em;margin-right:0.05em;\"><span class=\"pstrut\" style=\"height:2.7em;\"></span><span class=\"sizing reset-size6 size3 mtight\"><span class=\"mord mtight\">2</span></span></span></span><span class=\"vlist-s\">â€‹</span></span><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.15em;\"><span></span></span></span></span></span></span></span></span></span></span> åšç‚¹ä¹˜å¾—åˆ°å¾—åˆ† 96ã€‚æ³¨æ„ï¼š<strong>è¿™é‡Œæ˜¯é€šè¿‡ <span class=\"katex\"><span class=\"katex-mathml\"><math xmlns=\"http://www.w3.org/1998/Math/MathML\"><semantics><mrow><msub><mi>q</mi><mn>1</mn></msub></mrow><annotation encoding=\"application/x-tex\">q_1</annotation></semantics></math></span><span class=\"katex-html\" aria-hidden=\"true\"><span class=\"base\"><span class=\"strut\" style=\"height:0.625em;vertical-align:-0.19444em;\"></span><span class=\"mord\"><span class=\"mord mathnormal\" style=\"margin-right:0.03588em;\">q</span><span class=\"msupsub\"><span class=\"vlist-t vlist-t2\"><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.30110799999999993em;\"><span style=\"top:-2.5500000000000003em;margin-left:-0.03588em;margin-right:0.05em;\"><span class=\"pstrut\" style=\"height:2.7em;\"></span><span class=\"sizing reset-size6 size3 mtight\"><span class=\"mord mtight\">1</span></span></span></span><span class=\"vlist-s\">â€‹</span></span><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.15em;\"><span></span></span></span></span></span></span></span></span></span> è¿™ä¸ªä¿¡æ¯æ‰¾åˆ° <span class=\"katex\"><span class=\"katex-mathml\"><math xmlns=\"http://www.w3.org/1998/Math/MathML\"><semantics><mrow><msub><mi>x</mi><mn>1</mn></msub><mo separator=\"true\">,</mo><msub><mi>x</mi><mn>2</mn></msub></mrow><annotation encoding=\"application/x-tex\">x_1,x_2</annotation></semantics></math></span><span class=\"katex-html\" aria-hidden=\"true\"><span class=\"base\"><span class=\"strut\" style=\"height:0.625em;vertical-align:-0.19444em;\"></span><span class=\"mord\"><span class=\"mord mathnormal\">x</span><span class=\"msupsub\"><span class=\"vlist-t vlist-t2\"><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.30110799999999993em;\"><span style=\"top:-2.5500000000000003em;margin-left:0em;margin-right:0.05em;\"><span class=\"pstrut\" style=\"height:2.7em;\"></span><span class=\"sizing reset-size6 size3 mtight\"><span class=\"mord mtight\">1</span></span></span></span><span class=\"vlist-s\">â€‹</span></span><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.15em;\"><span></span></span></span></span></span></span><span class=\"mpunct\">,</span><span class=\"mspace\" style=\"margin-right:0.16666666666666666em;\"></span><span class=\"mord\"><span class=\"mord mathnormal\">x</span><span class=\"msupsub\"><span class=\"vlist-t vlist-t2\"><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.30110799999999993em;\"><span style=\"top:-2.5500000000000003em;margin-left:0em;margin-right:0.05em;\"><span class=\"pstrut\" style=\"height:2.7em;\"></span><span class=\"sizing reset-size6 size3 mtight\"><span class=\"mord mtight\">2</span></span></span></span><span class=\"vlist-s\">â€‹</span></span><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.15em;\"><span></span></span></span></span></span></span></span></span></span> ä¸­çš„é‡è¦ä¿¡æ¯ã€‚</strong></p>\n</li>\n</ol>\n</li>\n<li>\n<p>ç¬¬ä¸‰æ­¥å’Œç¬¬å››æ­¥ï¼ŒScale + Softmax</p>\n<ol>\n<li>&lt;img src=&quot;<span class=\"exturl\" data-url=\"aHR0cHM6Ly9pbWdtZC5vc3MtY24tc2hhbmdoYWkuYWxpeXVuY3MuY29tL0JFUlRfSU1HL3FrLXNjYWxlLmpwZw==\">https://imgmd.oss-cn-shanghai.aliyuncs.com/BERT_IMG/qk-scale.jpg</span>&quot; style=&quot;zoom:50%;&quot; /&gt;</li>\n</ol>\n<p>ä¸Šå›¾æ“ä½œï¼šå¯¹è¯¥å¾—åˆ†è¿›è¡Œè§„èŒƒï¼Œé™¤ä»¥ <span class=\"katex\"><span class=\"katex-mathml\"><math xmlns=\"http://www.w3.org/1998/Math/MathML\"><semantics><mrow><msqrt><msub><mi>d</mi><mi>k</mi></msub></msqrt><mo>=</mo><mn>8</mn></mrow><annotation encoding=\"application/x-tex\">\\sqrt {d_k} = 8</annotation></semantics></math></span><span class=\"katex-html\" aria-hidden=\"true\"><span class=\"base\"><span class=\"strut\" style=\"height:1.04em;vertical-align:-0.18278000000000005em;\"></span><span class=\"mord sqrt\"><span class=\"vlist-t vlist-t2\"><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.85722em;\"><span class=\"svg-align\" style=\"top:-3em;\"><span class=\"pstrut\" style=\"height:3em;\"></span><span class=\"mord\" style=\"padding-left:0.833em;\"><span class=\"mord\"><span class=\"mord mathnormal\">d</span><span class=\"msupsub\"><span class=\"vlist-t vlist-t2\"><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.33610799999999996em;\"><span style=\"top:-2.5500000000000003em;margin-left:0em;margin-right:0.05em;\"><span class=\"pstrut\" style=\"height:2.7em;\"></span><span class=\"sizing reset-size6 size3 mtight\"><span class=\"mord mathnormal mtight\" style=\"margin-right:0.03148em;\">k</span></span></span></span><span class=\"vlist-s\">â€‹</span></span><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.15em;\"><span></span></span></span></span></span></span></span></span><span style=\"top:-2.81722em;\"><span class=\"pstrut\" style=\"height:3em;\"></span><span class=\"hide-tail\" style=\"min-width:0.853em;height:1.08em;\"><svg width='400em' height='1.08em' viewBox='0 0 400000 1080' preserveAspectRatio='xMinYMin slice'><path d='M95,702\nc-2.7,0,-7.17,-2.7,-13.5,-8c-5.8,-5.3,-9.5,-10,-9.5,-14\nc0,-2,0.3,-3.3,1,-4c1.3,-2.7,23.83,-20.7,67.5,-54\nc44.2,-33.3,65.8,-50.3,66.5,-51c1.3,-1.3,3,-2,5,-2c4.7,0,8.7,3.3,12,10\ns173,378,173,378c0.7,0,35.3,-71,104,-213c68.7,-142,137.5,-285,206.5,-429\nc69,-144,104.5,-217.7,106.5,-221\nl0 -0\nc5.3,-9.3,12,-14,20,-14\nH400000v40H845.2724\ns-225.272,467,-225.272,467s-235,486,-235,486c-2.7,4.7,-9,7,-19,7\nc-6,0,-10,-1,-12,-3s-194,-422,-194,-422s-65,47,-65,47z\nM834 80h400000v40h-400000z'/></svg></span></span></span><span class=\"vlist-s\">â€‹</span></span><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.18278000000000005em;\"><span></span></span></span></span></span><span class=\"mspace\" style=\"margin-right:0.2777777777777778em;\"></span><span class=\"mrel\">=</span><span class=\"mspace\" style=\"margin-right:0.2777777777777778em;\"></span></span><span class=\"base\"><span class=\"strut\" style=\"height:0.64444em;vertical-align:0em;\"></span><span class=\"mord\">8</span></span></span></span></p>\n</li>\n<li>\n<p>ç¬¬äº”æ­¥ï¼ŒMatMul</p>\n<ol>\n<li>&lt;img src=&quot;<span class=\"exturl\" data-url=\"aHR0cHM6Ly9pbWdtZC5vc3MtY24tc2hhbmdoYWkuYWxpeXVuY3MuY29tL0JFUlRfSU1HL3FrLXNvZnRtYXguanBn\">https://imgmd.oss-cn-shanghai.aliyuncs.com/BERT_IMG/qk-softmax.jpg</span>&quot; style=&quot;zoom:50%;&quot; /&gt;</li>\n</ol>\n</li>\n</ol>\n<p>ç”¨å¾—åˆ†æ¯”ä¾‹ [0.88ï¼Œ0.12] ä¹˜ä»¥ <span class=\"katex\"><span class=\"katex-mathml\"><math xmlns=\"http://www.w3.org/1998/Math/MathML\"><semantics><mrow><mo stretchy=\"false\">[</mo><msub><mi>v</mi><mn>1</mn></msub><mo separator=\"true\">,</mo><msub><mi>v</mi><mn>2</mn></msub><mo stretchy=\"false\">]</mo></mrow><annotation encoding=\"application/x-tex\">[v_1,v_2]</annotation></semantics></math></span><span class=\"katex-html\" aria-hidden=\"true\"><span class=\"base\"><span class=\"strut\" style=\"height:1em;vertical-align:-0.25em;\"></span><span class=\"mopen\">[</span><span class=\"mord\"><span class=\"mord mathnormal\" style=\"margin-right:0.03588em;\">v</span><span class=\"msupsub\"><span class=\"vlist-t vlist-t2\"><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.30110799999999993em;\"><span style=\"top:-2.5500000000000003em;margin-left:-0.03588em;margin-right:0.05em;\"><span class=\"pstrut\" style=\"height:2.7em;\"></span><span class=\"sizing reset-size6 size3 mtight\"><span class=\"mord mtight\">1</span></span></span></span><span class=\"vlist-s\">â€‹</span></span><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.15em;\"><span></span></span></span></span></span></span><span class=\"mpunct\">,</span><span class=\"mspace\" style=\"margin-right:0.16666666666666666em;\"></span><span class=\"mord\"><span class=\"mord mathnormal\" style=\"margin-right:0.03588em;\">v</span><span class=\"msupsub\"><span class=\"vlist-t vlist-t2\"><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.30110799999999993em;\"><span style=\"top:-2.5500000000000003em;margin-left:-0.03588em;margin-right:0.05em;\"><span class=\"pstrut\" style=\"height:2.7em;\"></span><span class=\"sizing reset-size6 size3 mtight\"><span class=\"mord mtight\">2</span></span></span></span><span class=\"vlist-s\">â€‹</span></span><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.15em;\"><span></span></span></span></span></span></span><span class=\"mclose\">]</span></span></span></span> å€¼å¾—åˆ°ä¸€ä¸ªåŠ æƒåçš„å€¼ï¼Œå°†è¿™äº›å€¼åŠ èµ·æ¥å¾—åˆ° <span class=\"katex\"><span class=\"katex-mathml\"><math xmlns=\"http://www.w3.org/1998/Math/MathML\"><semantics><mrow><msub><mi>z</mi><mn>1</mn></msub></mrow><annotation encoding=\"application/x-tex\">z_1</annotation></semantics></math></span><span class=\"katex-html\" aria-hidden=\"true\"><span class=\"base\"><span class=\"strut\" style=\"height:0.58056em;vertical-align:-0.15em;\"></span><span class=\"mord\"><span class=\"mord mathnormal\" style=\"margin-right:0.04398em;\">z</span><span class=\"msupsub\"><span class=\"vlist-t vlist-t2\"><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.30110799999999993em;\"><span style=\"top:-2.5500000000000003em;margin-left:-0.04398em;margin-right:0.05em;\"><span class=\"pstrut\" style=\"height:2.7em;\"></span><span class=\"sizing reset-size6 size3 mtight\"><span class=\"mord mtight\">1</span></span></span></span><span class=\"vlist-s\">â€‹</span></span><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.15em;\"><span></span></span></span></span></span></span></span></span></span>ã€‚</p>\n<p>ä¸Šè¿°æ‰€è¯´å°±æ˜¯ Self Attention æ¨¡å‹æ‰€åšçš„äº‹ï¼Œä»”ç»†æ„Ÿå—ä¸€ä¸‹ï¼Œç”¨ <span class=\"katex\"><span class=\"katex-mathml\"><math xmlns=\"http://www.w3.org/1998/Math/MathML\"><semantics><mrow><msub><mi>q</mi><mn>1</mn></msub></mrow><annotation encoding=\"application/x-tex\">q_1</annotation></semantics></math></span><span class=\"katex-html\" aria-hidden=\"true\"><span class=\"base\"><span class=\"strut\" style=\"height:0.625em;vertical-align:-0.19444em;\"></span><span class=\"mord\"><span class=\"mord mathnormal\" style=\"margin-right:0.03588em;\">q</span><span class=\"msupsub\"><span class=\"vlist-t vlist-t2\"><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.30110799999999993em;\"><span style=\"top:-2.5500000000000003em;margin-left:-0.03588em;margin-right:0.05em;\"><span class=\"pstrut\" style=\"height:2.7em;\"></span><span class=\"sizing reset-size6 size3 mtight\"><span class=\"mord mtight\">1</span></span></span></span><span class=\"vlist-s\">â€‹</span></span><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.15em;\"><span></span></span></span></span></span></span></span></span></span>ã€<span class=\"katex\"><span class=\"katex-mathml\"><math xmlns=\"http://www.w3.org/1998/Math/MathML\"><semantics><mrow><mi>K</mi><mo>=</mo><mo stretchy=\"false\">[</mo><msub><mi>k</mi><mn>1</mn></msub><mo separator=\"true\">,</mo><msub><mi>k</mi><mn>2</mn></msub><mo stretchy=\"false\">]</mo></mrow><annotation encoding=\"application/x-tex\">K=[k_1,k_2]</annotation></semantics></math></span><span class=\"katex-html\" aria-hidden=\"true\"><span class=\"base\"><span class=\"strut\" style=\"height:0.68333em;vertical-align:0em;\"></span><span class=\"mord mathnormal\" style=\"margin-right:0.07153em;\">K</span><span class=\"mspace\" style=\"margin-right:0.2777777777777778em;\"></span><span class=\"mrel\">=</span><span class=\"mspace\" style=\"margin-right:0.2777777777777778em;\"></span></span><span class=\"base\"><span class=\"strut\" style=\"height:1em;vertical-align:-0.25em;\"></span><span class=\"mopen\">[</span><span class=\"mord\"><span class=\"mord mathnormal\" style=\"margin-right:0.03148em;\">k</span><span class=\"msupsub\"><span class=\"vlist-t vlist-t2\"><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.30110799999999993em;\"><span style=\"top:-2.5500000000000003em;margin-left:-0.03148em;margin-right:0.05em;\"><span class=\"pstrut\" style=\"height:2.7em;\"></span><span class=\"sizing reset-size6 size3 mtight\"><span class=\"mord mtight\">1</span></span></span></span><span class=\"vlist-s\">â€‹</span></span><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.15em;\"><span></span></span></span></span></span></span><span class=\"mpunct\">,</span><span class=\"mspace\" style=\"margin-right:0.16666666666666666em;\"></span><span class=\"mord\"><span class=\"mord mathnormal\" style=\"margin-right:0.03148em;\">k</span><span class=\"msupsub\"><span class=\"vlist-t vlist-t2\"><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.30110799999999993em;\"><span style=\"top:-2.5500000000000003em;margin-left:-0.03148em;margin-right:0.05em;\"><span class=\"pstrut\" style=\"height:2.7em;\"></span><span class=\"sizing reset-size6 size3 mtight\"><span class=\"mord mtight\">2</span></span></span></span><span class=\"vlist-s\">â€‹</span></span><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.15em;\"><span></span></span></span></span></span></span><span class=\"mclose\">]</span></span></span></span> å»è®¡ç®—ä¸€ä¸ª Thinking ç›¸å¯¹äº Thinking å’Œ Machine çš„æƒé‡ï¼Œå†ç”¨æƒé‡ä¹˜ä»¥ Thinking å’Œ Machine çš„ <span class=\"katex\"><span class=\"katex-mathml\"><math xmlns=\"http://www.w3.org/1998/Math/MathML\"><semantics><mrow><mi>V</mi><mo>=</mo><mo stretchy=\"false\">[</mo><msub><mi>v</mi><mn>1</mn></msub><mo separator=\"true\">,</mo><msub><mi>v</mi><mn>2</mn></msub><mo stretchy=\"false\">]</mo></mrow><annotation encoding=\"application/x-tex\">V=[v_1,v_2]</annotation></semantics></math></span><span class=\"katex-html\" aria-hidden=\"true\"><span class=\"base\"><span class=\"strut\" style=\"height:0.68333em;vertical-align:0em;\"></span><span class=\"mord mathnormal\" style=\"margin-right:0.22222em;\">V</span><span class=\"mspace\" style=\"margin-right:0.2777777777777778em;\"></span><span class=\"mrel\">=</span><span class=\"mspace\" style=\"margin-right:0.2777777777777778em;\"></span></span><span class=\"base\"><span class=\"strut\" style=\"height:1em;vertical-align:-0.25em;\"></span><span class=\"mopen\">[</span><span class=\"mord\"><span class=\"mord mathnormal\" style=\"margin-right:0.03588em;\">v</span><span class=\"msupsub\"><span class=\"vlist-t vlist-t2\"><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.30110799999999993em;\"><span style=\"top:-2.5500000000000003em;margin-left:-0.03588em;margin-right:0.05em;\"><span class=\"pstrut\" style=\"height:2.7em;\"></span><span class=\"sizing reset-size6 size3 mtight\"><span class=\"mord mtight\">1</span></span></span></span><span class=\"vlist-s\">â€‹</span></span><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.15em;\"><span></span></span></span></span></span></span><span class=\"mpunct\">,</span><span class=\"mspace\" style=\"margin-right:0.16666666666666666em;\"></span><span class=\"mord\"><span class=\"mord mathnormal\" style=\"margin-right:0.03588em;\">v</span><span class=\"msupsub\"><span class=\"vlist-t vlist-t2\"><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.30110799999999993em;\"><span style=\"top:-2.5500000000000003em;margin-left:-0.03588em;margin-right:0.05em;\"><span class=\"pstrut\" style=\"height:2.7em;\"></span><span class=\"sizing reset-size6 size3 mtight\"><span class=\"mord mtight\">2</span></span></span></span><span class=\"vlist-s\">â€‹</span></span><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.15em;\"><span></span></span></span></span></span></span><span class=\"mclose\">]</span></span></span></span> å¾—åˆ°åŠ æƒåçš„ Thinking å’Œ Machine çš„ <span class=\"katex\"><span class=\"katex-mathml\"><math xmlns=\"http://www.w3.org/1998/Math/MathML\"><semantics><mrow><mi>V</mi><mo>=</mo><mo stretchy=\"false\">[</mo><msub><mi>v</mi><mn>1</mn></msub><mo separator=\"true\">,</mo><msub><mi>v</mi><mn>2</mn></msub><mo stretchy=\"false\">]</mo></mrow><annotation encoding=\"application/x-tex\">V=[v_1,v_2]</annotation></semantics></math></span><span class=\"katex-html\" aria-hidden=\"true\"><span class=\"base\"><span class=\"strut\" style=\"height:0.68333em;vertical-align:0em;\"></span><span class=\"mord mathnormal\" style=\"margin-right:0.22222em;\">V</span><span class=\"mspace\" style=\"margin-right:0.2777777777777778em;\"></span><span class=\"mrel\">=</span><span class=\"mspace\" style=\"margin-right:0.2777777777777778em;\"></span></span><span class=\"base\"><span class=\"strut\" style=\"height:1em;vertical-align:-0.25em;\"></span><span class=\"mopen\">[</span><span class=\"mord\"><span class=\"mord mathnormal\" style=\"margin-right:0.03588em;\">v</span><span class=\"msupsub\"><span class=\"vlist-t vlist-t2\"><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.30110799999999993em;\"><span style=\"top:-2.5500000000000003em;margin-left:-0.03588em;margin-right:0.05em;\"><span class=\"pstrut\" style=\"height:2.7em;\"></span><span class=\"sizing reset-size6 size3 mtight\"><span class=\"mord mtight\">1</span></span></span></span><span class=\"vlist-s\">â€‹</span></span><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.15em;\"><span></span></span></span></span></span></span><span class=\"mpunct\">,</span><span class=\"mspace\" style=\"margin-right:0.16666666666666666em;\"></span><span class=\"mord\"><span class=\"mord mathnormal\" style=\"margin-right:0.03588em;\">v</span><span class=\"msupsub\"><span class=\"vlist-t vlist-t2\"><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.30110799999999993em;\"><span style=\"top:-2.5500000000000003em;margin-left:-0.03588em;margin-right:0.05em;\"><span class=\"pstrut\" style=\"height:2.7em;\"></span><span class=\"sizing reset-size6 size3 mtight\"><span class=\"mord mtight\">2</span></span></span></span><span class=\"vlist-s\">â€‹</span></span><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.15em;\"><span></span></span></span></span></span></span><span class=\"mclose\">]</span></span></span></span>ï¼Œæœ€åæ±‚å’Œå¾—åˆ°é’ˆå¯¹å„å•è¯çš„è¾“å‡º <span class=\"katex\"><span class=\"katex-mathml\"><math xmlns=\"http://www.w3.org/1998/Math/MathML\"><semantics><mrow><msub><mi>z</mi><mn>1</mn></msub></mrow><annotation encoding=\"application/x-tex\">z_1</annotation></semantics></math></span><span class=\"katex-html\" aria-hidden=\"true\"><span class=\"base\"><span class=\"strut\" style=\"height:0.58056em;vertical-align:-0.15em;\"></span><span class=\"mord\"><span class=\"mord mathnormal\" style=\"margin-right:0.04398em;\">z</span><span class=\"msupsub\"><span class=\"vlist-t vlist-t2\"><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.30110799999999993em;\"><span style=\"top:-2.5500000000000003em;margin-left:-0.04398em;margin-right:0.05em;\"><span class=\"pstrut\" style=\"height:2.7em;\"></span><span class=\"sizing reset-size6 size3 mtight\"><span class=\"mord mtight\">1</span></span></span></span><span class=\"vlist-s\">â€‹</span></span><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.15em;\"><span></span></span></span></span></span></span></span></span></span>ã€‚</p>\n<p>åŒç†å¯ä»¥è®¡ç®—å‡º Machine ç›¸å¯¹äº Thinking å’Œ Machine çš„åŠ æƒè¾“å‡º <span class=\"katex\"><span class=\"katex-mathml\"><math xmlns=\"http://www.w3.org/1998/Math/MathML\"><semantics><mrow><msub><mi>z</mi><mn>2</mn></msub></mrow><annotation encoding=\"application/x-tex\">z_2</annotation></semantics></math></span><span class=\"katex-html\" aria-hidden=\"true\"><span class=\"base\"><span class=\"strut\" style=\"height:0.58056em;vertical-align:-0.15em;\"></span><span class=\"mord\"><span class=\"mord mathnormal\" style=\"margin-right:0.04398em;\">z</span><span class=\"msupsub\"><span class=\"vlist-t vlist-t2\"><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.30110799999999993em;\"><span style=\"top:-2.5500000000000003em;margin-left:-0.04398em;margin-right:0.05em;\"><span class=\"pstrut\" style=\"height:2.7em;\"></span><span class=\"sizing reset-size6 size3 mtight\"><span class=\"mord mtight\">2</span></span></span></span><span class=\"vlist-s\">â€‹</span></span><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.15em;\"><span></span></span></span></span></span></span></span></span></span>ï¼Œæ‹¼æ¥ <span class=\"katex\"><span class=\"katex-mathml\"><math xmlns=\"http://www.w3.org/1998/Math/MathML\"><semantics><mrow><msub><mi>z</mi><mn>1</mn></msub></mrow><annotation encoding=\"application/x-tex\">z_1</annotation></semantics></math></span><span class=\"katex-html\" aria-hidden=\"true\"><span class=\"base\"><span class=\"strut\" style=\"height:0.58056em;vertical-align:-0.15em;\"></span><span class=\"mord\"><span class=\"mord mathnormal\" style=\"margin-right:0.04398em;\">z</span><span class=\"msupsub\"><span class=\"vlist-t vlist-t2\"><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.30110799999999993em;\"><span style=\"top:-2.5500000000000003em;margin-left:-0.04398em;margin-right:0.05em;\"><span class=\"pstrut\" style=\"height:2.7em;\"></span><span class=\"sizing reset-size6 size3 mtight\"><span class=\"mord mtight\">1</span></span></span></span><span class=\"vlist-s\">â€‹</span></span><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.15em;\"><span></span></span></span></span></span></span></span></span></span> å’Œ <span class=\"katex\"><span class=\"katex-mathml\"><math xmlns=\"http://www.w3.org/1998/Math/MathML\"><semantics><mrow><msub><mi>z</mi><mn>2</mn></msub></mrow><annotation encoding=\"application/x-tex\">z_2</annotation></semantics></math></span><span class=\"katex-html\" aria-hidden=\"true\"><span class=\"base\"><span class=\"strut\" style=\"height:0.58056em;vertical-align:-0.15em;\"></span><span class=\"mord\"><span class=\"mord mathnormal\" style=\"margin-right:0.04398em;\">z</span><span class=\"msupsub\"><span class=\"vlist-t vlist-t2\"><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.30110799999999993em;\"><span style=\"top:-2.5500000000000003em;margin-left:-0.04398em;margin-right:0.05em;\"><span class=\"pstrut\" style=\"height:2.7em;\"></span><span class=\"sizing reset-size6 size3 mtight\"><span class=\"mord mtight\">2</span></span></span></span><span class=\"vlist-s\">â€‹</span></span><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.15em;\"><span></span></span></span></span></span></span></span></span></span> å³å¯å¾—åˆ° Attention å€¼ <span class=\"katex\"><span class=\"katex-mathml\"><math xmlns=\"http://www.w3.org/1998/Math/MathML\"><semantics><mrow><mi>Z</mi><mo>=</mo><mo stretchy=\"false\">[</mo><msub><mi>z</mi><mn>1</mn></msub><mo separator=\"true\">,</mo><msub><mi>z</mi><mn>2</mn></msub><mo stretchy=\"false\">]</mo></mrow><annotation encoding=\"application/x-tex\">Z=[z_1,z_2]</annotation></semantics></math></span><span class=\"katex-html\" aria-hidden=\"true\"><span class=\"base\"><span class=\"strut\" style=\"height:0.68333em;vertical-align:0em;\"></span><span class=\"mord mathnormal\" style=\"margin-right:0.07153em;\">Z</span><span class=\"mspace\" style=\"margin-right:0.2777777777777778em;\"></span><span class=\"mrel\">=</span><span class=\"mspace\" style=\"margin-right:0.2777777777777778em;\"></span></span><span class=\"base\"><span class=\"strut\" style=\"height:1em;vertical-align:-0.25em;\"></span><span class=\"mopen\">[</span><span class=\"mord\"><span class=\"mord mathnormal\" style=\"margin-right:0.04398em;\">z</span><span class=\"msupsub\"><span class=\"vlist-t vlist-t2\"><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.30110799999999993em;\"><span style=\"top:-2.5500000000000003em;margin-left:-0.04398em;margin-right:0.05em;\"><span class=\"pstrut\" style=\"height:2.7em;\"></span><span class=\"sizing reset-size6 size3 mtight\"><span class=\"mord mtight\">1</span></span></span></span><span class=\"vlist-s\">â€‹</span></span><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.15em;\"><span></span></span></span></span></span></span><span class=\"mpunct\">,</span><span class=\"mspace\" style=\"margin-right:0.16666666666666666em;\"></span><span class=\"mord\"><span class=\"mord mathnormal\" style=\"margin-right:0.04398em;\">z</span><span class=\"msupsub\"><span class=\"vlist-t vlist-t2\"><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.30110799999999993em;\"><span style=\"top:-2.5500000000000003em;margin-left:-0.04398em;margin-right:0.05em;\"><span class=\"pstrut\" style=\"height:2.7em;\"></span><span class=\"sizing reset-size6 size3 mtight\"><span class=\"mord mtight\">2</span></span></span></span><span class=\"vlist-s\">â€‹</span></span><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.15em;\"><span></span></span></span></span></span></span><span class=\"mclose\">]</span></span></span></span>ï¼Œè¿™å°±æ˜¯ Self Attention çš„çŸ©é˜µè®¡ç®—ï¼Œå¦‚ä¸‹æ‰€ç¤ºã€‚</p>\n<p>ä¹‹å‰çš„ä¾‹å­æ˜¯å•ä¸ªå‘é‡çš„è¿ç®—ä¾‹å­ã€‚è¿™å¼ å›¾å±•ç¤ºçš„æ˜¯çŸ©é˜µè¿ç®—çš„ä¾‹å­ï¼Œè¾“å…¥æ˜¯ä¸€ä¸ª [2x4] çš„çŸ©é˜µï¼ˆå¥å­ä¸­æ¯ä¸ªå•è¯çš„è¯å‘é‡çš„æ‹¼æ¥ï¼‰ï¼Œæ¯ä¸ªè¿ç®—æ˜¯ [4x3] çš„çŸ©é˜µï¼Œæ±‚å¾— Qã€Kã€Vã€‚</p>\n<p>&lt;img src=&quot;<span class=\"exturl\" data-url=\"aHR0cHM6Ly9pbWdtZC5vc3MtY24tc2hhbmdoYWkuYWxpeXVuY3MuY29tL0JFUlRfSU1HL1FLVi0lRTclOUYlQTklRTklOTglQjUlRTglQTElQTglRTclQTQlQkEuanBn\">https://imgmd.oss-cn-shanghai.aliyuncs.com/BERT_IMG/QKV - çŸ©é˜µè¡¨ç¤º.jpg</span>&quot; style=&quot;zoom:50%;&quot; /&gt;</p>\n<p>Q å¯¹ K è½¬åˆ¶åšç‚¹ä¹˜ï¼Œé™¤ä»¥ <span class=\"katex\"><span class=\"katex-mathml\"><math xmlns=\"http://www.w3.org/1998/Math/MathML\"><semantics><mrow><msub><msqrt><mi>d</mi></msqrt><mi>k</mi></msub></mrow><annotation encoding=\"application/x-tex\">\\sqrt d_k</annotation></semantics></math></span><span class=\"katex-html\" aria-hidden=\"true\"><span class=\"base\"><span class=\"strut\" style=\"height:1.0897000000000001em;vertical-align:-0.15747999999999998em;\"></span><span class=\"mord\"><span class=\"mord sqrt\"><span class=\"vlist-t vlist-t2\"><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.93222em;\"><span class=\"svg-align\" style=\"top:-3em;\"><span class=\"pstrut\" style=\"height:3em;\"></span><span class=\"mord mathnormal\" style=\"padding-left:0.833em;\">d</span></span><span style=\"top:-2.89222em;\"><span class=\"pstrut\" style=\"height:3em;\"></span><span class=\"hide-tail\" style=\"min-width:0.853em;height:1.08em;\"><svg width='400em' height='1.08em' viewBox='0 0 400000 1080' preserveAspectRatio='xMinYMin slice'><path d='M95,702\nc-2.7,0,-7.17,-2.7,-13.5,-8c-5.8,-5.3,-9.5,-10,-9.5,-14\nc0,-2,0.3,-3.3,1,-4c1.3,-2.7,23.83,-20.7,67.5,-54\nc44.2,-33.3,65.8,-50.3,66.5,-51c1.3,-1.3,3,-2,5,-2c4.7,0,8.7,3.3,12,10\ns173,378,173,378c0.7,0,35.3,-71,104,-213c68.7,-142,137.5,-285,206.5,-429\nc69,-144,104.5,-217.7,106.5,-221\nl0 -0\nc5.3,-9.3,12,-14,20,-14\nH400000v40H845.2724\ns-225.272,467,-225.272,467s-235,486,-235,486c-2.7,4.7,-9,7,-19,7\nc-6,0,-10,-1,-12,-3s-194,-422,-194,-422s-65,47,-65,47z\nM834 80h400000v40h-400000z'/></svg></span></span></span><span class=\"vlist-s\">â€‹</span></span><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.10777999999999999em;\"><span></span></span></span></span></span><span class=\"msupsub\"><span class=\"vlist-t vlist-t2\"><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.3286279999999999em;\"><span style=\"top:-2.54252em;margin-right:0.05em;\"><span class=\"pstrut\" style=\"height:2.7em;\"></span><span class=\"sizing reset-size6 size3 mtight\"><span class=\"mord mathnormal mtight\" style=\"margin-right:0.03148em;\">k</span></span></span></span><span class=\"vlist-s\">â€‹</span></span><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.15747999999999998em;\"><span></span></span></span></span></span></span></span></span></span>ï¼Œåšä¸€ä¸ª softmax å¾—åˆ°åˆä¸º 1 çš„æ¯”ä¾‹ï¼Œå¯¹ V åšç‚¹ä¹˜å¾—åˆ°è¾“å‡º Zã€‚é‚£ä¹ˆè¿™ä¸ª Z å°±æ˜¯ä¸€ä¸ªè€ƒè™‘è¿‡ Thinking å‘¨å›´å•è¯ Machine çš„è¾“å‡ºã€‚</p>\n<p>&lt;img src=&quot;<span class=\"exturl\" data-url=\"aHR0cHM6Ly9pbWdtZC5vc3MtY24tc2hhbmdoYWkuYWxpeXVuY3MuY29tL0JFUlRfSU1HL1FLVlotJUU3JUJCJTkzJUU2JTlFJTlDLmpwZw==\">https://imgmd.oss-cn-shanghai.aliyuncs.com/BERT_IMG/QKVZ - ç»“æœ.jpg</span>&quot; style=&quot;zoom:50%;&quot; /&gt;</p>\n<p>æ³¨æ„çœ‹è¿™ä¸ªå…¬å¼ï¼Œ<strong><span class=\"katex\"><span class=\"katex-mathml\"><math xmlns=\"http://www.w3.org/1998/Math/MathML\"><semantics><mrow><mi>Q</mi><msup><mi>K</mi><mi>T</mi></msup></mrow><annotation encoding=\"application/x-tex\">QK^T</annotation></semantics></math></span><span class=\"katex-html\" aria-hidden=\"true\"><span class=\"base\"><span class=\"strut\" style=\"height:1.035771em;vertical-align:-0.19444em;\"></span><span class=\"mord mathnormal\">Q</span><span class=\"mord\"><span class=\"mord mathnormal\" style=\"margin-right:0.07153em;\">K</span><span class=\"msupsub\"><span class=\"vlist-t\"><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.8413309999999999em;\"><span style=\"top:-3.063em;margin-right:0.05em;\"><span class=\"pstrut\" style=\"height:2.7em;\"></span><span class=\"sizing reset-size6 size3 mtight\"><span class=\"mord mathnormal mtight\" style=\"margin-right:0.13889em;\">T</span></span></span></span></span></span></span></span></span></span></span> å…¶å®å°±ä¼šç»„æˆä¸€ä¸ª word2word çš„ attention mapï¼</strong>ï¼ˆåŠ äº† softmax ä¹‹åå°±æ˜¯ä¸€ä¸ªåˆä¸º 1 çš„æƒé‡äº†ï¼‰ã€‚æ¯”å¦‚è¯´ä½ çš„è¾“å…¥æ˜¯ä¸€å¥è¯ &quot;i have a dream&quot; æ€»å…± 4 ä¸ªå•è¯ï¼Œè¿™é‡Œå°±ä¼šå½¢æˆä¸€å¼  4x4 çš„æ³¨æ„åŠ›æœºåˆ¶çš„å›¾ï¼š</p>\n<p>&lt;img src=&quot;<span class=\"exturl\" data-url=\"aHR0cHM6Ly9pbWdtZC5vc3MtY24tc2hhbmdoYWkuYWxpeXVuY3MuY29tL0JFUlRfSU1HLyVFNiVCMyVBOCVFNiU4NCU4RiVFNSU4QSU5QiVFNiU5QyVCQSVFNSU4OCVCNiVFNyU5RiVBOSVFOSU5OCVCNSVFNSU5QiVCRS5qcGc=\">https://imgmd.oss-cn-shanghai.aliyuncs.com/BERT_IMG/ æ³¨æ„åŠ›æœºåˆ¶çŸ©é˜µå›¾.jpg</span>&quot; style=&quot;zoom:50%;&quot; /&gt;</p>\n<p>è¿™æ ·ä¸€æ¥ï¼Œæ¯ä¸€ä¸ªå•è¯å¯¹åº”æ¯ä¸€ä¸ªå•è¯éƒ½ä¼šæœ‰ä¸€ä¸ªæƒé‡ï¼Œ<strong>è¿™ä¹Ÿæ˜¯ Self Attention åå­—çš„æ¥æºï¼Œå³ Attention çš„è®¡ç®—æ¥æºäº Sourceï¼ˆæºå¥ï¼‰ å’Œ Source æœ¬èº«ï¼Œé€šä¿—ç‚¹è®²å°±æ˜¯ Qã€Kã€V éƒ½æ¥æºäºè¾“å…¥ X æœ¬èº«ã€‚</strong></p>\n<h2 id=\"84-self-attention-å’Œ-rnn-lstm-çš„åŒºåˆ«\"><a class=\"anchor\" href=\"#84-self-attention-å’Œ-rnn-lstm-çš„åŒºåˆ«\">#</a> 8.4 Self Attention å’Œ RNNã€LSTM çš„åŒºåˆ«</h2>\n<p>å¼•å…¥ Self Attention æœ‰ä»€ä¹ˆå¥½å¤„å‘¢ï¼Ÿæˆ–è€…è¯´é€šè¿‡ Self Attention åˆ°åº•å­¦åˆ°äº†å“ªäº›è§„å¾‹æˆ–è€…æŠ½å–å‡ºäº†å“ªäº›ç‰¹å¾å‘¢ï¼Ÿæˆ‘ä»¬å¯ä»¥é€šè¿‡ä¸‹è¿°ä¸¤å¹…å›¾æ¥è®²è§£ï¼š</p>\n<p>&lt;img src=&quot;<span class=\"exturl\" data-url=\"aHR0cHM6Ly9pbWdtZC5vc3MtY24tc2hhbmdoYWkuYWxpeXVuY3MuY29tL0JFUlRfSU1HL3NlbGYtYXR0ZW50aW9uLSVFNSVBNSVCRCVFNSVBNCU4NDEuanBn\">https://imgmd.oss-cn-shanghai.aliyuncs.com/BERT_IMG/self-attention - å¥½å¤„ 1.jpg</span>&quot; style=&quot;zoom:50%;&quot; /&gt;</p>\n<p>&lt;img src=&quot;<span class=\"exturl\" data-url=\"aHR0cHM6Ly9pbWdtZC5vc3MtY24tc2hhbmdoYWkuYWxpeXVuY3MuY29tL0JFUlRfSU1HL3NlbGYtYXR0ZW50aW9uLSVFNSVBNSVCRCVFNSVBNCU4NDIuanBn\">https://imgmd.oss-cn-shanghai.aliyuncs.com/BERT_IMG/self-attention - å¥½å¤„ 2.jpg</span>&quot; style=&quot;zoom:50%;&quot; /&gt;</p>\n<p>ä»ä¸Šè¿°ä¸¤å¼ å›¾å¯ä»¥çœ‹å‡ºï¼ŒSelf Attention å¯ä»¥æ•è·åŒä¸€ä¸ªå¥å­ä¸­å•è¯ä¹‹é—´çš„ä¸€äº›å¥æ³•ç‰¹å¾ï¼ˆä¾‹å¦‚ç¬¬ä¸€å¼ å›¾å±•ç¤ºçš„æœ‰ä¸€å®šè·ç¦»çš„çŸ­è¯­ç»“æ„ï¼‰æˆ–è€…è¯­ä¹‰ç‰¹å¾ï¼ˆä¾‹å¦‚ç¬¬äºŒå¼ å›¾å±•ç¤ºçš„ its çš„æŒ‡ä»£å¯¹è±¡ä¸º Lawï¼‰ã€‚</p>\n<p>æœ‰äº†ä¸Šè¿°çš„è®²è§£ï¼Œæˆ‘ä»¬ç°åœ¨å¯ä»¥æ¥çœ‹çœ‹ Self Attention å’Œ RNNã€LSTM çš„åŒºåˆ«ï¼š</p>\n<ul>\n<li>RNNã€LSTMï¼šå¦‚æœæ˜¯ RNN æˆ–è€… LSTMï¼Œéœ€è¦ä¾æ¬¡åºåˆ—è®¡ç®—ï¼Œå¯¹äºè¿œè·ç¦»çš„ç›¸äº’ä¾èµ–çš„ç‰¹å¾ï¼Œ<strong>è¦ç»è¿‡è‹¥å¹²æ—¶é—´æ­¥æ­¥éª¤çš„ä¿¡æ¯ç´¯ç§¯æ‰èƒ½å°†ä¸¤è€…è”ç³»èµ·æ¥ï¼Œè€Œè·ç¦»è¶Šè¿œï¼Œæœ‰æ•ˆæ•è·çš„å¯èƒ½æ€§è¶Šå°</strong>ã€‚</li>\n<li>Self Attentionï¼š\n<ul>\n<li>é€šè¿‡ä¸Šè¿°ä¸¤å¹…å›¾ï¼Œå¾ˆæ˜æ˜¾çš„å¯ä»¥çœ‹å‡ºï¼Œå¼•å…¥ Self Attention åä¼šæ›´å®¹æ˜“æ•è·å¥å­ä¸­é•¿è·ç¦»çš„ç›¸äº’ä¾èµ–çš„ç‰¹å¾ï¼Œ<strong>å› ä¸º Self Attention åœ¨è®¡ç®—è¿‡ç¨‹ä¸­ä¼šç›´æ¥å°†å¥å­ä¸­ä»»æ„ä¸¤ä¸ªå•è¯çš„è”ç³»é€šè¿‡ä¸€ä¸ªè®¡ç®—æ­¥éª¤ç›´æ¥è”ç³»èµ·æ¥ï¼Œæ‰€ä»¥è¿œè·ç¦»ä¾èµ–ç‰¹å¾ä¹‹é—´çš„è·ç¦»è¢«æå¤§ç¼©çŸ­ï¼Œæœ‰åˆ©äºæœ‰æ•ˆåœ°åˆ©ç”¨è¿™äº›ç‰¹å¾</strong>ï¼›</li>\n<li>é™¤æ­¤ä¹‹å¤–ï¼ŒSelf<br />\nAttention å¯¹äº<strong>ä¸€å¥è¯ä¸­çš„æ¯ä¸ªå•è¯éƒ½å¯ä»¥å•ç‹¬çš„è¿›è¡Œ Attention å€¼çš„è®¡ç®—</strong>ï¼Œä¹Ÿå°±æ˜¯è¯´ Self Attention å¯¹è®¡ç®—çš„å¹¶è¡Œæ€§ä¹Ÿæœ‰ç›´æ¥å¸®åŠ©ä½œç”¨ï¼Œè€Œå¯¹äºå¿…é¡»å¾—ä¾æ¬¡åºåˆ—è®¡ç®—çš„ RNN è€Œè¨€ï¼Œæ˜¯æ— æ³•åšåˆ°å¹¶è¡Œè®¡ç®—çš„ã€‚</li>\n</ul>\n</li>\n</ul>\n<p>ä»ä¸Šé¢çš„è®¡ç®—æ­¥éª¤å’Œå›¾ç‰‡å¯ä»¥çœ‹å‡ºï¼Œ<strong>æ— è®ºå¥å­åºåˆ—å¤šé•¿ï¼Œéƒ½å¯ä»¥å……åˆ†æ•è·è¿‘è·ç¦»ä¸Šå¾€ä¸‹é—®ä¸­çš„ä»»ä½•ä¾èµ–å…³ç³»ï¼Œè¿›è€Œå¯ä»¥å¾ˆå¥½çš„æå–å¥æ³•ç‰¹å¾è¿˜å¯ä»¥æå–è¯­ä¹‰ç‰¹å¾</strong>ï¼›è€Œä¸”å¯¹äºä¸€ä¸ªå¥å­è€Œè¨€ï¼Œ<strong>æ¯ä¸ªå•è¯çš„è®¡ç®—æ˜¯å¯ä»¥å¹¶è¡Œå¤„ç†çš„</strong>ã€‚</p>\n<p>ç†è®ºä¸Š Self-Attention ï¼ˆTransformer 50 ä¸ªå·¦å³çš„å•è¯æ•ˆæœæœ€å¥½ï¼‰è§£å†³äº† RNN æ¨¡å‹çš„é•¿åºåˆ—ä¾èµ–é—®é¢˜ï¼Œä½†æ˜¯ç”±äºæ–‡æœ¬é•¿åº¦å¢åŠ æ—¶ï¼Œè®­ç»ƒæ—¶é—´ä¹Ÿå°†ä¼šå‘ˆæŒ‡æ•°å¢é•¿ï¼Œå› æ­¤åœ¨å¤„ç†é•¿æ–‡æœ¬ä»»åŠ¡æ—¶å¯èƒ½ä¸ä¸€å®šæ¯” LSTMï¼ˆ200 ä¸ªå·¦å³çš„å•è¯æ•ˆæœæœ€å¥½ï¼‰ ç­‰ä¼ ç»Ÿçš„ RNN æ¨¡å‹çš„æ•ˆæœå¥½ã€‚</p>\n<p>ä¸Šè¿°æ‰€è¯´çš„ï¼Œåˆ™æ˜¯ä¸ºä½• Self Attention é€æ¸æ›¿ä»£ RNNã€LSTM è¢«å¹¿æ³›ä½¿ç”¨çš„åŸå› æ‰€åœ¨ã€‚</p>\n<h2 id=\"85-masked-self-attention-æ¨¡å‹\"><a class=\"anchor\" href=\"#85-masked-self-attention-æ¨¡å‹\">#</a> 8.5 Masked Self Attention æ¨¡å‹</h2>\n<p>è¶çƒ­æ‰“é“ï¼Œæˆ‘ä»¬è®²è®² Transformer æœªæ¥ä¼šç”¨åˆ°çš„ Masked Self Attention æ¨¡å‹ï¼Œè¿™é‡Œçš„ Masked å°±æ˜¯è¦åœ¨åšè¯­è¨€æ¨¡å‹ï¼ˆæˆ–è€…åƒç¿»è¯‘ï¼‰çš„æ—¶å€™ï¼Œä¸ç»™æ¨¡å‹çœ‹åˆ°æœªæ¥çš„ä¿¡æ¯ï¼Œå®ƒçš„ç»“æ„å¦‚ä¸‹å›¾æ‰€ç¤ºï¼š</p>\n<p>&lt;img src=&quot;<span class=\"exturl\" data-url=\"aHR0cHM6Ly9pbWdtZC5vc3MtY24tc2hhbmdoYWkuYWxpeXVuY3MuY29tL0JFUlRfSU1HL21hc2tlZC1hdHRlbnRpb24uanBn\">https://imgmd.oss-cn-shanghai.aliyuncs.com/BERT_IMG/masked-attention.jpg</span>&quot; style=&quot;zoom:50%;&quot; /&gt;</p>\n<p>ä¸Šå›¾ä¸­å’Œ Self Attention é‡å¤çš„éƒ¨åˆ†æ­¤å¤„å°±ä¸è®²äº†ï¼Œä¸»è¦è®²è®² Mask è¿™ä¸€å—ã€‚</p>\n<p>å‡è®¾åœ¨æ­¤ä¹‹å‰æˆ‘ä»¬å·²ç»é€šè¿‡ scale ä¹‹å‰çš„æ­¥éª¤å¾—åˆ°äº†ä¸€ä¸ª attention mapï¼Œ<strong>è€Œ mask å°±æ˜¯æ²¿ç€å¯¹è§’çº¿æŠŠç°è‰²çš„åŒºåŸŸç”¨ 0 è¦†ç›–æ‰ï¼Œä¸ç»™æ¨¡å‹çœ‹åˆ°æœªæ¥çš„ä¿¡æ¯</strong>ï¼Œå¦‚ä¸‹å›¾æ‰€ç¤ºï¼š</p>\n<p>&lt;img src=&quot;<span class=\"exturl\" data-url=\"aHR0cHM6Ly9pbWdtZC5vc3MtY24tc2hhbmdoYWkuYWxpeXVuY3MuY29tL0JFUlRfSU1HL21hc2stYXR0ZW50aW9uLW1hcC5qcGc=\">https://imgmd.oss-cn-shanghai.aliyuncs.com/BERT_IMG/mask-attention-map.jpg</span>&quot; style=&quot;zoom:50%;&quot; /&gt;</p>\n<p>è¯¦ç»†æ¥è¯´ï¼š</p>\n<ol>\n<li>&quot;i&quot; ä½œä¸ºç¬¬ä¸€ä¸ªå•è¯ï¼Œåªèƒ½æœ‰å’Œ &quot;i&quot; è‡ªå·±çš„ attentionï¼›</li>\n<li>&quot;have&quot; ä½œä¸ºç¬¬äºŒä¸ªå•è¯ï¼Œæœ‰å’Œ &quot;iã€have&quot; å‰é¢ä¸¤ä¸ªå•è¯çš„ attentionï¼›</li>\n<li>&quot;a&quot; ä½œä¸ºç¬¬ä¸‰ä¸ªå•è¯ï¼Œæœ‰å’Œ &quot;iã€haveã€a&quot; å‰é¢ä¸‰ä¸ªå•è¯çš„ attentionï¼›</li>\n<li>&quot;dream&quot; ä½œä¸ºæœ€åä¸€ä¸ªå•è¯ï¼Œæ‰æœ‰å¯¹æ•´ä¸ªå¥å­ 4 ä¸ªå•è¯çš„ attentionã€‚</li>\n</ol>\n<p>å¹¶ä¸”åœ¨åšå®Œ softmax ä¹‹åï¼Œæ¨ªè½´ç»“æœåˆä¸º 1ã€‚å¦‚ä¸‹å›¾æ‰€ç¤ºï¼š</p>\n<p>&lt;img src=&quot;<span class=\"exturl\" data-url=\"aHR0cHM6Ly9pbWdtZC5vc3MtY24tc2hhbmdoYWkuYWxpeXVuY3MuY29tL0JFUlRfSU1HL21hc2stYXR0ZW50aW9uLW1hcC1zb2Z0bWF4LmpwZw==\">https://imgmd.oss-cn-shanghai.aliyuncs.com/BERT_IMG/mask-attention-map-softmax.jpg</span>&quot; style=&quot;zoom:50%;&quot; /&gt;</p>\n<p>å…·ä½“ä¸ºä»€ä¹ˆè¦ maskï¼Œæœªæ¥å†è®²è§£ Transformer çš„æ—¶å€™æˆ‘ä»¬ä¼šè¯¦ç»†è§£é‡Šã€‚</p>\n<h2 id=\"86-multi-head-self-attention-æ¨¡å‹\"><a class=\"anchor\" href=\"#86-multi-head-self-attention-æ¨¡å‹\">#</a> 8.6 Multi-head Self Attention æ¨¡å‹</h2>\n<p>ç”±äº Transformer ä½¿ç”¨çš„éƒ½æ˜¯ Self Attention çš„è¿›é˜¶ç‰ˆ Multi-head Self Attentionï¼Œæˆ‘ä»¬ç®€å•è®²è®²  Multi-head Self Attention çš„æ¶æ„ï¼Œå¹¶ä¸”åœ¨è¯¥å°èŠ‚ç»“å°¾å¤„è®²è®²å®ƒçš„ä¼˜ç‚¹ã€‚</p>\n<p>Multi-Head Attention å°±æ˜¯æŠŠ Self Attention å¾—åˆ°çš„æ³¨æ„åŠ›å€¼ <span class=\"katex\"><span class=\"katex-mathml\"><math xmlns=\"http://www.w3.org/1998/Math/MathML\"><semantics><mrow><mi>Z</mi></mrow><annotation encoding=\"application/x-tex\">Z</annotation></semantics></math></span><span class=\"katex-html\" aria-hidden=\"true\"><span class=\"base\"><span class=\"strut\" style=\"height:0.68333em;vertical-align:0em;\"></span><span class=\"mord mathnormal\" style=\"margin-right:0.07153em;\">Z</span></span></span></span> åˆ‡åˆ†æˆ n ä¸ª <span class=\"katex\"><span class=\"katex-mathml\"><math xmlns=\"http://www.w3.org/1998/Math/MathML\"><semantics><mrow><msub><mi>Z</mi><mn>1</mn></msub><mo separator=\"true\">,</mo><msub><mi>Z</mi><mn>2</mn></msub><mo separator=\"true\">,</mo><mo>â‹¯</mo><mtext>â€‰</mtext><mo separator=\"true\">,</mo><msub><mi>Z</mi><mi>n</mi></msub></mrow><annotation encoding=\"application/x-tex\">Z_1,Z_2,\\cdots,Z_n</annotation></semantics></math></span><span class=\"katex-html\" aria-hidden=\"true\"><span class=\"base\"><span class=\"strut\" style=\"height:0.8777699999999999em;vertical-align:-0.19444em;\"></span><span class=\"mord\"><span class=\"mord mathnormal\" style=\"margin-right:0.07153em;\">Z</span><span class=\"msupsub\"><span class=\"vlist-t vlist-t2\"><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.30110799999999993em;\"><span style=\"top:-2.5500000000000003em;margin-left:-0.07153em;margin-right:0.05em;\"><span class=\"pstrut\" style=\"height:2.7em;\"></span><span class=\"sizing reset-size6 size3 mtight\"><span class=\"mord mtight\">1</span></span></span></span><span class=\"vlist-s\">â€‹</span></span><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.15em;\"><span></span></span></span></span></span></span><span class=\"mpunct\">,</span><span class=\"mspace\" style=\"margin-right:0.16666666666666666em;\"></span><span class=\"mord\"><span class=\"mord mathnormal\" style=\"margin-right:0.07153em;\">Z</span><span class=\"msupsub\"><span class=\"vlist-t vlist-t2\"><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.30110799999999993em;\"><span style=\"top:-2.5500000000000003em;margin-left:-0.07153em;margin-right:0.05em;\"><span class=\"pstrut\" style=\"height:2.7em;\"></span><span class=\"sizing reset-size6 size3 mtight\"><span class=\"mord mtight\">2</span></span></span></span><span class=\"vlist-s\">â€‹</span></span><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.15em;\"><span></span></span></span></span></span></span><span class=\"mpunct\">,</span><span class=\"mspace\" style=\"margin-right:0.16666666666666666em;\"></span><span class=\"minner\">â‹¯</span><span class=\"mspace\" style=\"margin-right:0.16666666666666666em;\"></span><span class=\"mspace\" style=\"margin-right:0.16666666666666666em;\"></span><span class=\"mpunct\">,</span><span class=\"mspace\" style=\"margin-right:0.16666666666666666em;\"></span><span class=\"mord\"><span class=\"mord mathnormal\" style=\"margin-right:0.07153em;\">Z</span><span class=\"msupsub\"><span class=\"vlist-t vlist-t2\"><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.151392em;\"><span style=\"top:-2.5500000000000003em;margin-left:-0.07153em;margin-right:0.05em;\"><span class=\"pstrut\" style=\"height:2.7em;\"></span><span class=\"sizing reset-size6 size3 mtight\"><span class=\"mord mathnormal mtight\">n</span></span></span></span><span class=\"vlist-s\">â€‹</span></span><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.15em;\"><span></span></span></span></span></span></span></span></span></span>ï¼Œç„¶åé€šè¿‡å…¨è¿æ¥å±‚è·å¾—æ–°çš„ <span class=\"katex\"><span class=\"katex-mathml\"><math xmlns=\"http://www.w3.org/1998/Math/MathML\"><semantics><mrow><msup><mi>Z</mi><mo mathvariant=\"normal\" lspace=\"0em\" rspace=\"0em\">â€²</mo></msup></mrow><annotation encoding=\"application/x-tex\">Z&#x27;</annotation></semantics></math></span><span class=\"katex-html\" aria-hidden=\"true\"><span class=\"base\"><span class=\"strut\" style=\"height:0.751892em;vertical-align:0em;\"></span><span class=\"mord\"><span class=\"mord mathnormal\" style=\"margin-right:0.07153em;\">Z</span><span class=\"msupsub\"><span class=\"vlist-t\"><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.751892em;\"><span style=\"top:-3.063em;margin-right:0.05em;\"><span class=\"pstrut\" style=\"height:2.7em;\"></span><span class=\"sizing reset-size6 size3 mtight\"><span class=\"mord mtight\"><span class=\"mord mtight\">â€²</span></span></span></span></span></span></span></span></span></span></span></span>.</p>\n<p>&lt;img src=&quot;<span class=\"exturl\" data-url=\"aHR0cHM6Ly9pbWdtZC5vc3MtY24tc2hhbmdoYWkuYWxpeXVuY3MuY29tL0JFUlRfSU1HL211bHRpLWhlYWQtYXR0ZW50aW9uLnBuZw==\">https://imgmd.oss-cn-shanghai.aliyuncs.com/BERT_IMG/multi-head-attention.png</span>&quot; style=&quot;zoom:50%;&quot; /&gt;</p>\n<p>æˆ‘ä»¬è¿˜æ˜¯ä»¥ä¸Šé¢çš„å½¢å¼æ¥è§£é‡Šï¼Œæˆ‘ä»¬å¯¹ <span class=\"katex\"><span class=\"katex-mathml\"><math xmlns=\"http://www.w3.org/1998/Math/MathML\"><semantics><mrow><mi>Z</mi></mrow><annotation encoding=\"application/x-tex\">Z</annotation></semantics></math></span><span class=\"katex-html\" aria-hidden=\"true\"><span class=\"base\"><span class=\"strut\" style=\"height:0.68333em;vertical-align:0em;\"></span><span class=\"mord mathnormal\" style=\"margin-right:0.07153em;\">Z</span></span></span></span> è¿›è¡Œ 8 ç­‰ä»½çš„åˆ‡åˆ†å¾—åˆ° 8 ä¸ª <span class=\"katex\"><span class=\"katex-mathml\"><math xmlns=\"http://www.w3.org/1998/Math/MathML\"><semantics><mrow><msub><mi>Z</mi><mi>i</mi></msub></mrow><annotation encoding=\"application/x-tex\">Z_i</annotation></semantics></math></span><span class=\"katex-html\" aria-hidden=\"true\"><span class=\"base\"><span class=\"strut\" style=\"height:0.83333em;vertical-align:-0.15em;\"></span><span class=\"mord\"><span class=\"mord mathnormal\" style=\"margin-right:0.07153em;\">Z</span><span class=\"msupsub\"><span class=\"vlist-t vlist-t2\"><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.31166399999999994em;\"><span style=\"top:-2.5500000000000003em;margin-left:-0.07153em;margin-right:0.05em;\"><span class=\"pstrut\" style=\"height:2.7em;\"></span><span class=\"sizing reset-size6 size3 mtight\"><span class=\"mord mathnormal mtight\">i</span></span></span></span><span class=\"vlist-s\">â€‹</span></span><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.15em;\"><span></span></span></span></span></span></span></span></span></span> çŸ©é˜µï¼š</p>\n<p>&lt;img src=&quot;<span class=\"exturl\" data-url=\"aHR0cHM6Ly9pbWdtZC5vc3MtY24tc2hhbmdoYWkuYWxpeXVuY3MuY29tL0JFUlRfSU1HLzgtaGVhZC1hdHRlbnRpb24uanBn\">https://imgmd.oss-cn-shanghai.aliyuncs.com/BERT_IMG/8-head-attention.jpg</span>&quot; style=&quot;zoom:50%;&quot; /&gt;</p>\n<p>ä¸ºäº†ä½¿å¾—è¾“å‡ºä¸è¾“å…¥ç»“æ„ç›¸åŒï¼Œæ‹¼æ¥çŸ©é˜µ <span class=\"katex\"><span class=\"katex-mathml\"><math xmlns=\"http://www.w3.org/1998/Math/MathML\"><semantics><mrow><msub><mi>Z</mi><mi>i</mi></msub></mrow><annotation encoding=\"application/x-tex\">Z_i</annotation></semantics></math></span><span class=\"katex-html\" aria-hidden=\"true\"><span class=\"base\"><span class=\"strut\" style=\"height:0.83333em;vertical-align:-0.15em;\"></span><span class=\"mord\"><span class=\"mord mathnormal\" style=\"margin-right:0.07153em;\">Z</span><span class=\"msupsub\"><span class=\"vlist-t vlist-t2\"><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.31166399999999994em;\"><span style=\"top:-2.5500000000000003em;margin-left:-0.07153em;margin-right:0.05em;\"><span class=\"pstrut\" style=\"height:2.7em;\"></span><span class=\"sizing reset-size6 size3 mtight\"><span class=\"mord mathnormal mtight\">i</span></span></span></span><span class=\"vlist-s\">â€‹</span></span><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.15em;\"><span></span></span></span></span></span></span></span></span></span> åä¹˜ä»¥ä¸€ä¸ªçº¿æ€§ <span class=\"katex\"><span class=\"katex-mathml\"><math xmlns=\"http://www.w3.org/1998/Math/MathML\"><semantics><mrow><msub><mi>W</mi><mn>0</mn></msub></mrow><annotation encoding=\"application/x-tex\">W_0</annotation></semantics></math></span><span class=\"katex-html\" aria-hidden=\"true\"><span class=\"base\"><span class=\"strut\" style=\"height:0.83333em;vertical-align:-0.15em;\"></span><span class=\"mord\"><span class=\"mord mathnormal\" style=\"margin-right:0.13889em;\">W</span><span class=\"msupsub\"><span class=\"vlist-t vlist-t2\"><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.30110799999999993em;\"><span style=\"top:-2.5500000000000003em;margin-left:-0.13889em;margin-right:0.05em;\"><span class=\"pstrut\" style=\"height:2.7em;\"></span><span class=\"sizing reset-size6 size3 mtight\"><span class=\"mord mtight\">0</span></span></span></span><span class=\"vlist-s\">â€‹</span></span><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.15em;\"><span></span></span></span></span></span></span></span></span></span> å¾—åˆ°æœ€ç»ˆçš„ Zï¼š</p>\n<p>&lt;img src=&quot;<span class=\"exturl\" data-url=\"aHR0cHM6Ly9pbWdtZC5vc3MtY24tc2hhbmdoYWkuYWxpeXVuY3MuY29tL0JFUlRfSU1HLzgtei0lRTYlOEIlQkMlRTYlOEUlQTUuanBn\">https://imgmd.oss-cn-shanghai.aliyuncs.com/BERT_IMG/8-z - æ‹¼æ¥.jpg</span>&quot; style=&quot;zoom:50%;&quot; /&gt;</p>\n<p>å¯ä»¥é€šè¿‡ä¸‹å›¾çœ‹çœ‹ multi-head attention çš„æ•´ä¸ªæµç¨‹ï¼š</p>\n<p>&lt;img src=&quot;<span class=\"exturl\" data-url=\"aHR0cHM6Ly9pbWdtZC5vc3MtY24tc2hhbmdoYWkuYWxpeXVuY3MuY29tL0JFUlRfSU1HL211bHRpLWhlYWQtJUU2JThCJUJDJUU2JThFJUE1LmpwZw==\">https://imgmd.oss-cn-shanghai.aliyuncs.com/BERT_IMG/multi-head - æ‹¼æ¥.jpg</span>&quot; style=&quot;zoom:50%;&quot; /&gt;</p>\n<p>ä¸Šè¿°æ“ä½œæœ‰ä»€ä¹ˆå¥½å¤„å‘¢ï¼Ÿ<strong>å¤šå¤´ç›¸å½“äºæŠŠåŸå§‹ä¿¡æ¯ Source æ”¾å…¥äº†å¤šä¸ªå­ç©ºé—´ä¸­ï¼Œä¹Ÿå°±æ˜¯æ•æ‰äº†å¤šä¸ªä¿¡æ¯ï¼Œå¯¹äºä½¿ç”¨ multi-headï¼ˆå¤šå¤´ï¼‰ attention çš„ç®€å•å›ç­”å°±æ˜¯ï¼Œå¤šå¤´ä¿è¯äº† attention å¯ä»¥æ³¨æ„åˆ°ä¸åŒå­ç©ºé—´çš„ä¿¡æ¯ï¼Œæ•æ‰åˆ°æ›´åŠ ä¸°å¯Œçš„ç‰¹å¾ä¿¡æ¯</strong>ã€‚å…¶å®æœ¬è´¨ä¸Šæ˜¯è®ºæ–‡åŸä½œè€…å‘ç°è¿™æ ·æ•ˆæœç¡®å®å¥½ã€‚</p>\n<h1 id=\"ä¹-position-embedding\"><a class=\"anchor\" href=\"#ä¹-position-embedding\">#</a> ä¹ã€Position Embedding</h1>\n<p>åœ¨ Attention å’Œ RNNã€LSTM çš„å¯¹æ¯”ä¸­ï¼Œæˆ‘ä»¬è¯´åˆ° Attention è§£å†³äº†é•¿è·ç¦»ä¾èµ–é—®é¢˜ï¼Œå¹¶ä¸”å¯ä»¥æ”¯æŒå¹¶è¡ŒåŒ–ï¼Œä½†æ˜¯å®ƒå°±çœŸçš„ç™¾åˆ©è€Œæ— ä¸€å®³äº†å—ï¼Ÿ</p>\n<p>å…¶å®ä¸ç„¶ï¼Œæˆ‘ä»¬å¾€å‰å›é¡¾ï¼ŒSelf Attention çš„ Qã€Kã€V ä¸‰ä¸ªçŸ©é˜µæ˜¯ç”±åŒä¸€ä¸ªè¾“å…¥ <span class=\"katex\"><span class=\"katex-mathml\"><math xmlns=\"http://www.w3.org/1998/Math/MathML\"><semantics><mrow><msub><mi>X</mi><mn>1</mn></msub><mo>=</mo><mo stretchy=\"false\">(</mo><msub><mi>x</mi><mn>1</mn></msub><mo separator=\"true\">,</mo><msub><mi>x</mi><mn>2</mn></msub><mo separator=\"true\">,</mo><mo>â‹¯</mo><mtext>â€‰</mtext><mo separator=\"true\">,</mo><msub><mi>x</mi><mi>n</mi></msub><mo stretchy=\"false\">)</mo></mrow><annotation encoding=\"application/x-tex\">X_1=(x_1,x_2,\\cdots,x_n)</annotation></semantics></math></span><span class=\"katex-html\" aria-hidden=\"true\"><span class=\"base\"><span class=\"strut\" style=\"height:0.83333em;vertical-align:-0.15em;\"></span><span class=\"mord\"><span class=\"mord mathnormal\" style=\"margin-right:0.07847em;\">X</span><span class=\"msupsub\"><span class=\"vlist-t vlist-t2\"><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.30110799999999993em;\"><span style=\"top:-2.5500000000000003em;margin-left:-0.07847em;margin-right:0.05em;\"><span class=\"pstrut\" style=\"height:2.7em;\"></span><span class=\"sizing reset-size6 size3 mtight\"><span class=\"mord mtight\">1</span></span></span></span><span class=\"vlist-s\">â€‹</span></span><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.15em;\"><span></span></span></span></span></span></span><span class=\"mspace\" style=\"margin-right:0.2777777777777778em;\"></span><span class=\"mrel\">=</span><span class=\"mspace\" style=\"margin-right:0.2777777777777778em;\"></span></span><span class=\"base\"><span class=\"strut\" style=\"height:1em;vertical-align:-0.25em;\"></span><span class=\"mopen\">(</span><span class=\"mord\"><span class=\"mord mathnormal\">x</span><span class=\"msupsub\"><span class=\"vlist-t vlist-t2\"><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.30110799999999993em;\"><span style=\"top:-2.5500000000000003em;margin-left:0em;margin-right:0.05em;\"><span class=\"pstrut\" style=\"height:2.7em;\"></span><span class=\"sizing reset-size6 size3 mtight\"><span class=\"mord mtight\">1</span></span></span></span><span class=\"vlist-s\">â€‹</span></span><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.15em;\"><span></span></span></span></span></span></span><span class=\"mpunct\">,</span><span class=\"mspace\" style=\"margin-right:0.16666666666666666em;\"></span><span class=\"mord\"><span class=\"mord mathnormal\">x</span><span class=\"msupsub\"><span class=\"vlist-t vlist-t2\"><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.30110799999999993em;\"><span style=\"top:-2.5500000000000003em;margin-left:0em;margin-right:0.05em;\"><span class=\"pstrut\" style=\"height:2.7em;\"></span><span class=\"sizing reset-size6 size3 mtight\"><span class=\"mord mtight\">2</span></span></span></span><span class=\"vlist-s\">â€‹</span></span><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.15em;\"><span></span></span></span></span></span></span><span class=\"mpunct\">,</span><span class=\"mspace\" style=\"margin-right:0.16666666666666666em;\"></span><span class=\"minner\">â‹¯</span><span class=\"mspace\" style=\"margin-right:0.16666666666666666em;\"></span><span class=\"mspace\" style=\"margin-right:0.16666666666666666em;\"></span><span class=\"mpunct\">,</span><span class=\"mspace\" style=\"margin-right:0.16666666666666666em;\"></span><span class=\"mord\"><span class=\"mord mathnormal\">x</span><span class=\"msupsub\"><span class=\"vlist-t vlist-t2\"><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.151392em;\"><span style=\"top:-2.5500000000000003em;margin-left:0em;margin-right:0.05em;\"><span class=\"pstrut\" style=\"height:2.7em;\"></span><span class=\"sizing reset-size6 size3 mtight\"><span class=\"mord mathnormal mtight\">n</span></span></span></span><span class=\"vlist-s\">â€‹</span></span><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.15em;\"><span></span></span></span></span></span></span><span class=\"mclose\">)</span></span></span></span> çº¿æ€§è½¬æ¢è€Œæ¥ï¼Œä¹Ÿå°±æ˜¯è¯´å¯¹äºè¿™æ ·çš„ä¸€ä¸ªè¢«æ‰“ä¹±åºåˆ—é¡ºåºçš„ <span class=\"katex\"><span class=\"katex-mathml\"><math xmlns=\"http://www.w3.org/1998/Math/MathML\"><semantics><mrow><msub><mi>X</mi><mn>2</mn></msub><mo>=</mo><mo stretchy=\"false\">(</mo><msub><mi>x</mi><mn>2</mn></msub><mo separator=\"true\">,</mo><msub><mi>x</mi><mn>1</mn></msub><mo separator=\"true\">,</mo><mo>â‹¯</mo><mtext>â€‰</mtext><mo separator=\"true\">,</mo><msub><mi>x</mi><mi>n</mi></msub><mo stretchy=\"false\">)</mo></mrow><annotation encoding=\"application/x-tex\">X_2=(x_2,x_1,\\cdots,x_n)</annotation></semantics></math></span><span class=\"katex-html\" aria-hidden=\"true\"><span class=\"base\"><span class=\"strut\" style=\"height:0.83333em;vertical-align:-0.15em;\"></span><span class=\"mord\"><span class=\"mord mathnormal\" style=\"margin-right:0.07847em;\">X</span><span class=\"msupsub\"><span class=\"vlist-t vlist-t2\"><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.30110799999999993em;\"><span style=\"top:-2.5500000000000003em;margin-left:-0.07847em;margin-right:0.05em;\"><span class=\"pstrut\" style=\"height:2.7em;\"></span><span class=\"sizing reset-size6 size3 mtight\"><span class=\"mord mtight\">2</span></span></span></span><span class=\"vlist-s\">â€‹</span></span><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.15em;\"><span></span></span></span></span></span></span><span class=\"mspace\" style=\"margin-right:0.2777777777777778em;\"></span><span class=\"mrel\">=</span><span class=\"mspace\" style=\"margin-right:0.2777777777777778em;\"></span></span><span class=\"base\"><span class=\"strut\" style=\"height:1em;vertical-align:-0.25em;\"></span><span class=\"mopen\">(</span><span class=\"mord\"><span class=\"mord mathnormal\">x</span><span class=\"msupsub\"><span class=\"vlist-t vlist-t2\"><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.30110799999999993em;\"><span style=\"top:-2.5500000000000003em;margin-left:0em;margin-right:0.05em;\"><span class=\"pstrut\" style=\"height:2.7em;\"></span><span class=\"sizing reset-size6 size3 mtight\"><span class=\"mord mtight\">2</span></span></span></span><span class=\"vlist-s\">â€‹</span></span><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.15em;\"><span></span></span></span></span></span></span><span class=\"mpunct\">,</span><span class=\"mspace\" style=\"margin-right:0.16666666666666666em;\"></span><span class=\"mord\"><span class=\"mord mathnormal\">x</span><span class=\"msupsub\"><span class=\"vlist-t vlist-t2\"><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.30110799999999993em;\"><span style=\"top:-2.5500000000000003em;margin-left:0em;margin-right:0.05em;\"><span class=\"pstrut\" style=\"height:2.7em;\"></span><span class=\"sizing reset-size6 size3 mtight\"><span class=\"mord mtight\">1</span></span></span></span><span class=\"vlist-s\">â€‹</span></span><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.15em;\"><span></span></span></span></span></span></span><span class=\"mpunct\">,</span><span class=\"mspace\" style=\"margin-right:0.16666666666666666em;\"></span><span class=\"minner\">â‹¯</span><span class=\"mspace\" style=\"margin-right:0.16666666666666666em;\"></span><span class=\"mspace\" style=\"margin-right:0.16666666666666666em;\"></span><span class=\"mpunct\">,</span><span class=\"mspace\" style=\"margin-right:0.16666666666666666em;\"></span><span class=\"mord\"><span class=\"mord mathnormal\">x</span><span class=\"msupsub\"><span class=\"vlist-t vlist-t2\"><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.151392em;\"><span style=\"top:-2.5500000000000003em;margin-left:0em;margin-right:0.05em;\"><span class=\"pstrut\" style=\"height:2.7em;\"></span><span class=\"sizing reset-size6 size3 mtight\"><span class=\"mord mathnormal mtight\">n</span></span></span></span><span class=\"vlist-s\">â€‹</span></span><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.15em;\"><span></span></span></span></span></span></span><span class=\"mclose\">)</span></span></span></span> è€Œè¨€ï¼Œ<strong>ç”±äº Attention å€¼çš„è®¡ç®—æœ€ç»ˆä¼šè¢«åŠ æƒæ±‚å’Œï¼Œä¹Ÿå°±æ˜¯è¯´ä¸¤è€…æœ€ç»ˆè®¡ç®—çš„ Attention å€¼éƒ½æ˜¯ä¸€æ ·çš„ï¼Œè¿›è€Œä¹Ÿå°±è¡¨æ˜äº† Attention ä¸¢æ‰äº† <span class=\"katex\"><span class=\"katex-mathml\"><math xmlns=\"http://www.w3.org/1998/Math/MathML\"><semantics><mrow><msub><mi>X</mi><mn>1</mn></msub></mrow><annotation encoding=\"application/x-tex\">X_1</annotation></semantics></math></span><span class=\"katex-html\" aria-hidden=\"true\"><span class=\"base\"><span class=\"strut\" style=\"height:0.83333em;vertical-align:-0.15em;\"></span><span class=\"mord\"><span class=\"mord mathnormal\" style=\"margin-right:0.07847em;\">X</span><span class=\"msupsub\"><span class=\"vlist-t vlist-t2\"><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.30110799999999993em;\"><span style=\"top:-2.5500000000000003em;margin-left:-0.07847em;margin-right:0.05em;\"><span class=\"pstrut\" style=\"height:2.7em;\"></span><span class=\"sizing reset-size6 size3 mtight\"><span class=\"mord mtight\">1</span></span></span></span><span class=\"vlist-s\">â€‹</span></span><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.15em;\"><span></span></span></span></span></span></span></span></span></span> çš„åºåˆ—é¡ºåºä¿¡æ¯ã€‚</strong></p>\n<p>&lt;img src=&quot;<span class=\"exturl\" data-url=\"aHR0cHM6Ly9pbWdtZC5vc3MtY24tc2hhbmdoYWkuYWxpeXVuY3MuY29tL0JFUlRfSU1HLyVFNCVCRCU4RCVFNyVCRCVBRSVFNSU5MCU5MSVFOSU4NyU4Ri5qcGc=\">https://imgmd.oss-cn-shanghai.aliyuncs.com/BERT_IMG/ ä½ç½®å‘é‡.jpg</span>&quot; style=&quot;zoom:50%;&quot; /&gt;</p>\n<p>å¦‚ä¸Šå›¾æ‰€ç¤ºï¼Œä¸ºäº†è§£å†³ Attention ä¸¢å¤±çš„åºåˆ—é¡ºåºä¿¡æ¯ï¼ŒTransformer çš„æå‡ºè€…æå‡ºäº† Position Embeddingï¼Œä¹Ÿå°±æ˜¯å¯¹äºè¾“å…¥ <span class=\"katex\"><span class=\"katex-mathml\"><math xmlns=\"http://www.w3.org/1998/Math/MathML\"><semantics><mrow><mi>X</mi></mrow><annotation encoding=\"application/x-tex\">X</annotation></semantics></math></span><span class=\"katex-html\" aria-hidden=\"true\"><span class=\"base\"><span class=\"strut\" style=\"height:0.68333em;vertical-align:0em;\"></span><span class=\"mord mathnormal\" style=\"margin-right:0.07847em;\">X</span></span></span></span> è¿›è¡Œ Attention è®¡ç®—ä¹‹å‰ï¼Œåœ¨ <span class=\"katex\"><span class=\"katex-mathml\"><math xmlns=\"http://www.w3.org/1998/Math/MathML\"><semantics><mrow><mi>X</mi></mrow><annotation encoding=\"application/x-tex\">X</annotation></semantics></math></span><span class=\"katex-html\" aria-hidden=\"true\"><span class=\"base\"><span class=\"strut\" style=\"height:0.68333em;vertical-align:0em;\"></span><span class=\"mord mathnormal\" style=\"margin-right:0.07847em;\">X</span></span></span></span> çš„è¯å‘é‡ä¸­åŠ ä¸Šä½ç½®ä¿¡æ¯ï¼Œä¹Ÿå°±æ˜¯è¯´ <span class=\"katex\"><span class=\"katex-mathml\"><math xmlns=\"http://www.w3.org/1998/Math/MathML\"><semantics><mrow><mi>X</mi></mrow><annotation encoding=\"application/x-tex\">X</annotation></semantics></math></span><span class=\"katex-html\" aria-hidden=\"true\"><span class=\"base\"><span class=\"strut\" style=\"height:0.68333em;vertical-align:0em;\"></span><span class=\"mord mathnormal\" style=\"margin-right:0.07847em;\">X</span></span></span></span> çš„è¯å‘é‡ä¸º <span class=\"katex\"><span class=\"katex-mathml\"><math xmlns=\"http://www.w3.org/1998/Math/MathML\"><semantics><mrow><msub><mi>X</mi><mrow><mi>f</mi><mi>i</mi><mi>n</mi><mi>a</mi><mi>l</mi><mi mathvariant=\"normal\">_</mi><mi>e</mi><mi>m</mi><mi>b</mi><mi>e</mi><mi>d</mi><mi>d</mi><mi>i</mi><mi>n</mi><mi>g</mi></mrow></msub><mo>=</mo><mi>E</mi><mi>m</mi><mi>b</mi><mi>e</mi><mi>d</mi><mi>d</mi><mi>i</mi><mi>n</mi><mi>g</mi><mo>+</mo><mi>P</mi><mi>o</mi><mi>s</mi><mi>i</mi><mi>t</mi><mi>i</mi><mi>o</mi><mi>n</mi><mi>a</mi><mi>l</mi><mtext>â€‰</mtext><mi>E</mi><mi>m</mi><mi>b</mi><mi>e</mi><mi>d</mi><mi>d</mi><mi>i</mi><mi>n</mi><mi>g</mi></mrow><annotation encoding=\"application/x-tex\">X_{final\\_embedding} = Embedding + Positional\\, Embedding</annotation></semantics></math></span><span class=\"katex-html\" aria-hidden=\"true\"><span class=\"base\"><span class=\"strut\" style=\"height:1.05033em;vertical-align:-0.367em;\"></span><span class=\"mord\"><span class=\"mord mathnormal\" style=\"margin-right:0.07847em;\">X</span><span class=\"msupsub\"><span class=\"vlist-t vlist-t2\"><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.33610799999999996em;\"><span style=\"top:-2.5500000000000003em;margin-left:-0.07847em;margin-right:0.05em;\"><span class=\"pstrut\" style=\"height:2.7em;\"></span><span class=\"sizing reset-size6 size3 mtight\"><span class=\"mord mtight\"><span class=\"mord mathnormal mtight\" style=\"margin-right:0.10764em;\">f</span><span class=\"mord mathnormal mtight\">i</span><span class=\"mord mathnormal mtight\">n</span><span class=\"mord mathnormal mtight\">a</span><span class=\"mord mathnormal mtight\" style=\"margin-right:0.01968em;\">l</span><span class=\"mord mtight\" style=\"margin-right:0.02778em;\">_</span><span class=\"mord mathnormal mtight\">e</span><span class=\"mord mathnormal mtight\">m</span><span class=\"mord mathnormal mtight\">b</span><span class=\"mord mathnormal mtight\">e</span><span class=\"mord mathnormal mtight\">d</span><span class=\"mord mathnormal mtight\">d</span><span class=\"mord mathnormal mtight\">i</span><span class=\"mord mathnormal mtight\">n</span><span class=\"mord mathnormal mtight\" style=\"margin-right:0.03588em;\">g</span></span></span></span></span><span class=\"vlist-s\">â€‹</span></span><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.367em;\"><span></span></span></span></span></span></span><span class=\"mspace\" style=\"margin-right:0.2777777777777778em;\"></span><span class=\"mrel\">=</span><span class=\"mspace\" style=\"margin-right:0.2777777777777778em;\"></span></span><span class=\"base\"><span class=\"strut\" style=\"height:0.8888799999999999em;vertical-align:-0.19444em;\"></span><span class=\"mord mathnormal\" style=\"margin-right:0.05764em;\">E</span><span class=\"mord mathnormal\">m</span><span class=\"mord mathnormal\">b</span><span class=\"mord mathnormal\">e</span><span class=\"mord mathnormal\">d</span><span class=\"mord mathnormal\">d</span><span class=\"mord mathnormal\">i</span><span class=\"mord mathnormal\">n</span><span class=\"mord mathnormal\" style=\"margin-right:0.03588em;\">g</span><span class=\"mspace\" style=\"margin-right:0.2222222222222222em;\"></span><span class=\"mbin\">+</span><span class=\"mspace\" style=\"margin-right:0.2222222222222222em;\"></span></span><span class=\"base\"><span class=\"strut\" style=\"height:0.8888799999999999em;vertical-align:-0.19444em;\"></span><span class=\"mord mathnormal\" style=\"margin-right:0.13889em;\">P</span><span class=\"mord mathnormal\">o</span><span class=\"mord mathnormal\">s</span><span class=\"mord mathnormal\">i</span><span class=\"mord mathnormal\">t</span><span class=\"mord mathnormal\">i</span><span class=\"mord mathnormal\">o</span><span class=\"mord mathnormal\">n</span><span class=\"mord mathnormal\">a</span><span class=\"mord mathnormal\" style=\"margin-right:0.01968em;\">l</span><span class=\"mspace\" style=\"margin-right:0.16666666666666666em;\"></span><span class=\"mord mathnormal\" style=\"margin-right:0.05764em;\">E</span><span class=\"mord mathnormal\">m</span><span class=\"mord mathnormal\">b</span><span class=\"mord mathnormal\">e</span><span class=\"mord mathnormal\">d</span><span class=\"mord mathnormal\">d</span><span class=\"mord mathnormal\">i</span><span class=\"mord mathnormal\">n</span><span class=\"mord mathnormal\" style=\"margin-right:0.03588em;\">g</span></span></span></span></p>\n<p>ä½†æ˜¯å¦‚ä½•å¾—åˆ° <span class=\"katex\"><span class=\"katex-mathml\"><math xmlns=\"http://www.w3.org/1998/Math/MathML\"><semantics><mrow><mi>X</mi></mrow><annotation encoding=\"application/x-tex\">X</annotation></semantics></math></span><span class=\"katex-html\" aria-hidden=\"true\"><span class=\"base\"><span class=\"strut\" style=\"height:0.68333em;vertical-align:0em;\"></span><span class=\"mord mathnormal\" style=\"margin-right:0.07847em;\">X</span></span></span></span> çš„ä½ç½®å‘é‡å‘¢ï¼Ÿ</p>\n<p>å…¶ä¸­ä½ç½®ç¼–ç å…¬å¼å¦‚ä¸‹å›¾æ‰€ç¤ºï¼š</p>\n<p>&lt;img src=&quot;<span class=\"exturl\" data-url=\"aHR0cHM6Ly9pbWdtZC5vc3MtY24tc2hhbmdoYWkuYWxpeXVuY3MuY29tL0JFUlRfSU1HLyVFNCVCRCU4RCVFNyVCRCVBRSVFNyVCQyU5NiVFNyVBMCU4MSVFNSU4NSVBQyVFNSVCQyU4Ri5wbmc=\">https://imgmd.oss-cn-shanghai.aliyuncs.com/BERT_IMG/ ä½ç½®ç¼–ç å…¬å¼.png</span>&quot; style=&quot;zoom:33%;&quot; /&gt;</p>\n<p>å…¶ä¸­ pos è¡¨ç¤ºä½ç½®ã€i è¡¨ç¤ºç»´åº¦ã€<span class=\"katex\"><span class=\"katex-mathml\"><math xmlns=\"http://www.w3.org/1998/Math/MathML\"><semantics><mrow><msub><mi>d</mi><mrow><mi>m</mi><mi>o</mi><mi>d</mi><mi>e</mi><mi>l</mi></mrow></msub></mrow><annotation encoding=\"application/x-tex\">d_{model}</annotation></semantics></math></span><span class=\"katex-html\" aria-hidden=\"true\"><span class=\"base\"><span class=\"strut\" style=\"height:0.84444em;vertical-align:-0.15em;\"></span><span class=\"mord\"><span class=\"mord mathnormal\">d</span><span class=\"msupsub\"><span class=\"vlist-t vlist-t2\"><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.33610799999999996em;\"><span style=\"top:-2.5500000000000003em;margin-left:0em;margin-right:0.05em;\"><span class=\"pstrut\" style=\"height:2.7em;\"></span><span class=\"sizing reset-size6 size3 mtight\"><span class=\"mord mtight\"><span class=\"mord mathnormal mtight\">m</span><span class=\"mord mathnormal mtight\">o</span><span class=\"mord mathnormal mtight\">d</span><span class=\"mord mathnormal mtight\">e</span><span class=\"mord mathnormal mtight\" style=\"margin-right:0.01968em;\">l</span></span></span></span></span><span class=\"vlist-s\">â€‹</span></span><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.15em;\"><span></span></span></span></span></span></span></span></span></span> è¡¨ç¤ºä½ç½®å‘é‡çš„å‘é‡ç»´åº¦ ã€<span class=\"katex\"><span class=\"katex-mathml\"><math xmlns=\"http://www.w3.org/1998/Math/MathML\"><semantics><mrow><mn>2</mn><mi>i</mi><mtext>ã€</mtext><mn>2</mn><mi>i</mi><mo>+</mo><mn>1</mn></mrow><annotation encoding=\"application/x-tex\">2iã€2i+1</annotation></semantics></math></span><span class=\"katex-html\" aria-hidden=\"true\"><span class=\"base\"><span class=\"strut\" style=\"height:0.76666em;vertical-align:-0.08333em;\"></span><span class=\"mord\">2</span><span class=\"mord mathnormal\">i</span><span class=\"mord cjk_fallback\">ã€</span><span class=\"mord\">2</span><span class=\"mord mathnormal\">i</span><span class=\"mspace\" style=\"margin-right:0.2222222222222222em;\"></span><span class=\"mbin\">+</span><span class=\"mspace\" style=\"margin-right:0.2222222222222222em;\"></span></span><span class=\"base\"><span class=\"strut\" style=\"height:0.64444em;vertical-align:0em;\"></span><span class=\"mord\">1</span></span></span></span> è¡¨ç¤ºçš„æ˜¯å¥‡å¶æ•°ï¼ˆå¥‡å¶ç»´åº¦ï¼‰ï¼Œä¸Šå›¾æ‰€ç¤ºå°±æ˜¯å¶æ•°ä½ç½®ä½¿ç”¨ <span class=\"katex\"><span class=\"katex-mathml\"><math xmlns=\"http://www.w3.org/1998/Math/MathML\"><semantics><mrow><mi>sin</mi><mo>â¡</mo></mrow><annotation encoding=\"application/x-tex\">\\sin</annotation></semantics></math></span><span class=\"katex-html\" aria-hidden=\"true\"><span class=\"base\"><span class=\"strut\" style=\"height:0.66786em;vertical-align:0em;\"></span><span class=\"mop\">sin</span></span></span></span> å‡½æ•°ï¼Œå¥‡æ•°ä½ç½®ä½¿ç”¨ <span class=\"katex\"><span class=\"katex-mathml\"><math xmlns=\"http://www.w3.org/1998/Math/MathML\"><semantics><mrow><mi>cos</mi><mo>â¡</mo></mrow><annotation encoding=\"application/x-tex\">\\cos</annotation></semantics></math></span><span class=\"katex-html\" aria-hidden=\"true\"><span class=\"base\"><span class=\"strut\" style=\"height:0.43056em;vertical-align:0em;\"></span><span class=\"mop\">cos</span></span></span></span> å‡½æ•°ã€‚</p>\n<p>æœ‰äº†ä½ç½®ç¼–ç ï¼Œæˆ‘ä»¬å†æ¥çœ‹çœ‹ä½ç½®ç¼–ç æ˜¯å¦‚ä½•åµŒå…¥å•è¯ç¼–ç çš„ï¼ˆå…¶ä¸­ 512 è¡¨ç¤ºç¼–ç ç»´åº¦ï¼‰ï¼Œ<strong>é€šè¿‡æŠŠå•è¯çš„è¯å‘é‡å’Œä½ç½®å‘é‡è¿›è¡Œå åŠ ï¼Œè¿™ç§æ–¹å¼å°±ç§°ä½œä½ç½®åµŒå…¥</strong>ï¼Œå¦‚ä¸‹å›¾æ‰€ç¤ºï¼š</p>\n<p>&lt;img src=&quot;<span class=\"exturl\" data-url=\"aHR0cHM6Ly9pbWdtZC5vc3MtY24tc2hhbmdoYWkuYWxpeXVuY3MuY29tL0JFUlRfSU1HLyVFNCVCRCU4RCVFNyVCRCVBRSVFNyVCQyU5NiVFNyVBMCU4MSVFNSU5MiU4QyVFOCVBRiU4RCVFNSU5MCU5MSVFOSU4NyU4RiVFNCVCOSU4QiVFNSU5MiU4Qy5wbmc=\">https://imgmd.oss-cn-shanghai.aliyuncs.com/BERT_IMG/ ä½ç½®ç¼–ç å’Œè¯å‘é‡ä¹‹å’Œ.png</span>&quot; style=&quot;zoom:50%;&quot; /&gt;</p>\n<p><strong>Position Embedding æœ¬èº«æ˜¯ä¸€ä¸ªç»å¯¹ä½ç½®çš„ä¿¡æ¯</strong>ï¼Œä½†åœ¨è¯­è¨€æ¨¡å‹ä¸­ï¼Œç›¸å¯¹ä½ç½®ä¹Ÿå¾ˆé‡è¦ã€‚é‚£ä¹ˆä¸ºä»€ä¹ˆä½ç½®åµŒå…¥æœºåˆ¶æœ‰ç”¨å‘¢ï¼Ÿ</p>\n<p>æˆ‘ä»¬ä¸è¦å»å…³å¿ƒä¸‰è§’å‡½æ•°å…¬å¼ï¼Œå¯ä»¥çœ‹çœ‹ä¸‹å›¾å…¬å¼ï¼ˆ3ï¼‰ä¸­çš„ç¬¬ä¸€è¡Œï¼Œæˆ‘ä»¬åšå¦‚ä¸‹çš„è§£é‡Šï¼Œå¯¹äº â€œæˆ‘çˆ±åƒè‹¹æœâ€ è¿™ä¸€å¥è¯ï¼Œæœ‰ 5 ä¸ªå•è¯ï¼Œå‡è®¾åºå·åˆ†åˆ«ä¸º 1ã€2ã€3ã€4ã€5ã€‚</p>\n<p>&lt;img src=&quot;<span class=\"exturl\" data-url=\"aHR0cHM6Ly9pbWdtZC5vc3MtY24tc2hhbmdoYWkuYWxpeXVuY3MuY29tL0JFUlRfSU1HLyVFNCVCRCU4RCVFNyVCRCVBRSVFNSVCNSU4QyVFNSU4NSVBNSVFOCVBNyVBMyVFOSU4NyU4QS5wbmc=\">https://imgmd.oss-cn-shanghai.aliyuncs.com/BERT_IMG/ ä½ç½®åµŒå…¥è§£é‡Š.png</span>&quot; style=&quot;zoom:50%;&quot; /&gt;</p>\n<p>å‡è®¾ <span class=\"katex\"><span class=\"katex-mathml\"><math xmlns=\"http://www.w3.org/1998/Math/MathML\"><semantics><mrow><mi>p</mi><mi>o</mi><mi>s</mi><mo>=</mo><mn>1</mn><mo>=</mo><mtext>æˆ‘ã€</mtext><mi>k</mi><mo>=</mo><mn>2</mn><mo>=</mo><mtext>çˆ±ã€</mtext><mi>p</mi><mi>o</mi><mi>s</mi><mo>+</mo><mi>k</mi><mo>=</mo><mn>3</mn><mo>=</mo><mtext>åƒ</mtext></mrow><annotation encoding=\"application/x-tex\">pos=1=æˆ‘ã€k=2=çˆ±ã€pos+k=3=åƒ</annotation></semantics></math></span><span class=\"katex-html\" aria-hidden=\"true\"><span class=\"base\"><span class=\"strut\" style=\"height:0.625em;vertical-align:-0.19444em;\"></span><span class=\"mord mathnormal\">p</span><span class=\"mord mathnormal\">o</span><span class=\"mord mathnormal\">s</span><span class=\"mspace\" style=\"margin-right:0.2777777777777778em;\"></span><span class=\"mrel\">=</span><span class=\"mspace\" style=\"margin-right:0.2777777777777778em;\"></span></span><span class=\"base\"><span class=\"strut\" style=\"height:0.64444em;vertical-align:0em;\"></span><span class=\"mord\">1</span><span class=\"mspace\" style=\"margin-right:0.2777777777777778em;\"></span><span class=\"mrel\">=</span><span class=\"mspace\" style=\"margin-right:0.2777777777777778em;\"></span></span><span class=\"base\"><span class=\"strut\" style=\"height:0.69444em;vertical-align:0em;\"></span><span class=\"mord cjk_fallback\">æˆ‘</span><span class=\"mord cjk_fallback\">ã€</span><span class=\"mord mathnormal\" style=\"margin-right:0.03148em;\">k</span><span class=\"mspace\" style=\"margin-right:0.2777777777777778em;\"></span><span class=\"mrel\">=</span><span class=\"mspace\" style=\"margin-right:0.2777777777777778em;\"></span></span><span class=\"base\"><span class=\"strut\" style=\"height:0.64444em;vertical-align:0em;\"></span><span class=\"mord\">2</span><span class=\"mspace\" style=\"margin-right:0.2777777777777778em;\"></span><span class=\"mrel\">=</span><span class=\"mspace\" style=\"margin-right:0.2777777777777778em;\"></span></span><span class=\"base\"><span class=\"strut\" style=\"height:0.8777699999999999em;vertical-align:-0.19444em;\"></span><span class=\"mord cjk_fallback\">çˆ±</span><span class=\"mord cjk_fallback\">ã€</span><span class=\"mord mathnormal\">p</span><span class=\"mord mathnormal\">o</span><span class=\"mord mathnormal\">s</span><span class=\"mspace\" style=\"margin-right:0.2222222222222222em;\"></span><span class=\"mbin\">+</span><span class=\"mspace\" style=\"margin-right:0.2222222222222222em;\"></span></span><span class=\"base\"><span class=\"strut\" style=\"height:0.69444em;vertical-align:0em;\"></span><span class=\"mord mathnormal\" style=\"margin-right:0.03148em;\">k</span><span class=\"mspace\" style=\"margin-right:0.2777777777777778em;\"></span><span class=\"mrel\">=</span><span class=\"mspace\" style=\"margin-right:0.2777777777777778em;\"></span></span><span class=\"base\"><span class=\"strut\" style=\"height:0.64444em;vertical-align:0em;\"></span><span class=\"mord\">3</span><span class=\"mspace\" style=\"margin-right:0.2777777777777778em;\"></span><span class=\"mrel\">=</span><span class=\"mspace\" style=\"margin-right:0.2777777777777778em;\"></span></span><span class=\"base\"><span class=\"strut\" style=\"height:0.68333em;vertical-align:0em;\"></span><span class=\"mord cjk_fallback\">åƒ</span></span></span></span>ï¼Œä¹Ÿå°±æ˜¯è¯´ <span class=\"katex\"><span class=\"katex-mathml\"><math xmlns=\"http://www.w3.org/1998/Math/MathML\"><semantics><mrow><mi>p</mi><mi>o</mi><mi>s</mi><mo>+</mo><mi>k</mi><mo>=</mo><mn>3</mn></mrow><annotation encoding=\"application/x-tex\">pos+k=3</annotation></semantics></math></span><span class=\"katex-html\" aria-hidden=\"true\"><span class=\"base\"><span class=\"strut\" style=\"height:0.7777700000000001em;vertical-align:-0.19444em;\"></span><span class=\"mord mathnormal\">p</span><span class=\"mord mathnormal\">o</span><span class=\"mord mathnormal\">s</span><span class=\"mspace\" style=\"margin-right:0.2222222222222222em;\"></span><span class=\"mbin\">+</span><span class=\"mspace\" style=\"margin-right:0.2222222222222222em;\"></span></span><span class=\"base\"><span class=\"strut\" style=\"height:0.69444em;vertical-align:0em;\"></span><span class=\"mord mathnormal\" style=\"margin-right:0.03148em;\">k</span><span class=\"mspace\" style=\"margin-right:0.2777777777777778em;\"></span><span class=\"mrel\">=</span><span class=\"mspace\" style=\"margin-right:0.2777777777777778em;\"></span></span><span class=\"base\"><span class=\"strut\" style=\"height:0.64444em;vertical-align:0em;\"></span><span class=\"mord\">3</span></span></span></span> ä½ç½®çš„ä½ç½®å‘é‡çš„æŸä¸€ç»´å¯ä»¥é€šè¿‡ <span class=\"katex\"><span class=\"katex-mathml\"><math xmlns=\"http://www.w3.org/1998/Math/MathML\"><semantics><mrow><mi>p</mi><mi>o</mi><mi>s</mi><mo>=</mo><mn>1</mn></mrow><annotation encoding=\"application/x-tex\">pos=1</annotation></semantics></math></span><span class=\"katex-html\" aria-hidden=\"true\"><span class=\"base\"><span class=\"strut\" style=\"height:0.625em;vertical-align:-0.19444em;\"></span><span class=\"mord mathnormal\">p</span><span class=\"mord mathnormal\">o</span><span class=\"mord mathnormal\">s</span><span class=\"mspace\" style=\"margin-right:0.2777777777777778em;\"></span><span class=\"mrel\">=</span><span class=\"mspace\" style=\"margin-right:0.2777777777777778em;\"></span></span><span class=\"base\"><span class=\"strut\" style=\"height:0.64444em;vertical-align:0em;\"></span><span class=\"mord\">1</span></span></span></span> ä½ç½®çš„ä½ç½®å‘é‡çš„æŸä¸€ç»´çº¿æ€§ç»„åˆåŠ ä»¥çº¿æ€§è¡¨ç¤ºï¼Œé€šè¿‡è¯¥çº¿æ€§è¡¨ç¤ºå¯ä»¥å¾—å‡º â€œåƒâ€ çš„ä½ç½®ç¼–ç ä¿¡æ¯è•´å«äº†ç›¸å¯¹äºå‰ä¸¤ä¸ªå­— â€œæˆ‘â€ çš„ä½ç½®ç¼–ç ä¿¡æ¯ã€‚</p>\n<p>æ€»è€Œè¨€ä¹‹å°±æ˜¯ï¼Œ<strong>æŸä¸ªå•è¯çš„ä½ç½®ä¿¡æ¯æ˜¯å…¶ä»–å•è¯ä½ç½®ä¿¡æ¯çš„çº¿æ€§ç»„åˆï¼Œè¿™ç§çº¿æ€§ç»„åˆå°±æ„å‘³ç€ä½ç½®å‘é‡ä¸­è•´å«äº†ç›¸å¯¹ä½ç½®ä¿¡æ¯ã€‚</strong></p>\n<h1 id=\"å-transformer\"><a class=\"anchor\" href=\"#å-transformer\">#</a> åã€Transformer</h1>\n<h2 id=\"101-transformer-çš„ç»“æ„\"><a class=\"anchor\" href=\"#101-transformer-çš„ç»“æ„\">#</a> 10.1 Transformer çš„ç»“æ„</h2>\n<p>ä¸‡äº‹ä¿±å¤‡ï¼Œåªæ¬ ä¸œé£ï¼Œä¸‹é¢æˆ‘ä»¬æ¥è®²è®²æˆ‘ä»¬çš„é‡ç‚¹ä¹‹ä¸€ï¼ŒTransformerï¼Œä½ å¯ä»¥å…ˆè®°ä½è¿™ä¸€å¥è¯ï¼š<strong>Transformer ç®€å•ç‚¹çœ‹å…¶å®å°±æ˜¯ self-attention æ¨¡å‹çš„å åŠ </strong>ï¼Œé¦–å…ˆæˆ‘ä»¬æ¥çœ‹çœ‹ Transformer çš„æ•´ä½“æ¡†æ¶ã€‚</p>\n<p>Transformer çš„æ•´ä½“æ¡†æ¶å¦‚ä¸‹å›¾æ‰€ç¤ºï¼š</p>\n<p>&lt;img src=&quot;<span class=\"exturl\" data-url=\"aHR0cHM6Ly9pbWdtZC5vc3MtY24tc2hhbmdoYWkuYWxpeXVuY3MuY29tL0JFUlRfSU1HL3RmLSVFNiU5NSVCNCVFNCVCRCU5MyVFNiVBMSU4NiVFNiU5RSVCNi5qcGc=\">https://imgmd.oss-cn-shanghai.aliyuncs.com/BERT_IMG/tf - æ•´ä½“æ¡†æ¶.jpg</span>&quot; style=&quot;zoom:50%;&quot; /&gt;</p>\n<p>ä¸Šå›¾æ‰€ç¤ºçš„æ•´ä½“æ¡†æ¶ä¹ä¸€çœ¼ä¸€çœ‹éå¸¸å¤æ‚ï¼Œç”±äº Transformer èµ·åˆæ˜¯ä½œä¸ºç¿»è¯‘æ¨¡å‹ï¼Œå› æ­¤æˆ‘ä»¬ä»¥ç¿»è¯‘ä¸¾ä¾‹ï¼Œç®€åŒ–ä¸€ä¸‹ä¸Šè¿°çš„æ•´ä½“æ¡†æ¶ï¼š</p>\n<p>&lt;img src=&quot;<span class=\"exturl\" data-url=\"aHR0cHM6Ly9pbWdtZC5vc3MtY24tc2hhbmdoYWkuYWxpeXVuY3MuY29tL0JFUlRfSU1HL3RmLSVFNiVBMSU4NiVFNiU5RSVCNiVFNyVBRSU4MCVFNSU4QyU5Ni5qcGc=\">https://imgmd.oss-cn-shanghai.aliyuncs.com/BERT_IMG/tf - æ¡†æ¶ç®€åŒ–.jpg</span>&quot; style=&quot;zoom:50%;&quot; /&gt;</p>\n<p>ä»ä¸Šå›¾å¯ä»¥çœ‹å‡º Transformer ç›¸å½“äºä¸€ä¸ªé»‘ç®±ï¼Œå·¦è¾¹è¾“å…¥ â€œJe suis etudiantâ€ï¼Œå³è¾¹ä¼šå¾—åˆ°ä¸€ä¸ªç¿»è¯‘ç»“æœ â€œI am a studentâ€ã€‚</p>\n<p>å†å¾€ç»†é‡Œè®²ï¼ŒTransformer ä¹Ÿæ˜¯ä¸€ä¸ª Seq2Seq æ¨¡å‹ï¼ˆEncoder-Decoder æ¡†æ¶çš„æ¨¡å‹ï¼‰ï¼Œå·¦è¾¹ä¸€ä¸ª Encoders æŠŠè¾“å…¥è¯»è¿›å»ï¼Œå³è¾¹ä¸€ä¸ª Decoders å¾—åˆ°è¾“å‡ºï¼Œå¦‚ä¸‹æ‰€ç¤ºï¼š</p>\n<p>&lt;img src=&quot;<span class=\"exturl\" data-url=\"aHR0cHM6Ly9pbWdtZC5vc3MtY24tc2hhbmdoYWkuYWxpeXVuY3MuY29tL0JFUlRfSU1HL3RmLWVkLSVFNiVBMSU4NiVFNiU5RSVCNi5qcGc=\">https://imgmd.oss-cn-shanghai.aliyuncs.com/BERT_IMG/tf-ed - æ¡†æ¶.jpg</span>&quot; style=&quot;zoom:50%;&quot; /&gt;</p>\n<blockquote>\n<p>åœ¨è¿™é‡Œï¼Œæˆ‘ä»¬ç©¿æ’æè¿°ä¸‹ Encoder-Decoder æ¡†æ¶çš„æ¨¡å‹æ˜¯å¦‚ä½•è¿›è¡Œæ–‡æœ¬ç¿»è¯‘çš„ï¼š</p>\n<ol>\n<li>å°†åºåˆ— <span class=\"katex\"><span class=\"katex-mathml\"><math xmlns=\"http://www.w3.org/1998/Math/MathML\"><semantics><mrow><mo stretchy=\"false\">(</mo><msub><mi>x</mi><mn>1</mn></msub><mo separator=\"true\">,</mo><msub><mi>x</mi><mn>2</mn></msub><mo separator=\"true\">,</mo><mo>â‹¯</mo><mtext>â€‰</mtext><mo separator=\"true\">,</mo><msub><mi>x</mi><mi>n</mi></msub><mo stretchy=\"false\">)</mo></mrow><annotation encoding=\"application/x-tex\">(x_1,x_2,\\cdots,x_n)</annotation></semantics></math></span><span class=\"katex-html\" aria-hidden=\"true\"><span class=\"base\"><span class=\"strut\" style=\"height:1em;vertical-align:-0.25em;\"></span><span class=\"mopen\">(</span><span class=\"mord\"><span class=\"mord mathnormal\">x</span><span class=\"msupsub\"><span class=\"vlist-t vlist-t2\"><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.30110799999999993em;\"><span style=\"top:-2.5500000000000003em;margin-left:0em;margin-right:0.05em;\"><span class=\"pstrut\" style=\"height:2.7em;\"></span><span class=\"sizing reset-size6 size3 mtight\"><span class=\"mord mtight\">1</span></span></span></span><span class=\"vlist-s\">â€‹</span></span><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.15em;\"><span></span></span></span></span></span></span><span class=\"mpunct\">,</span><span class=\"mspace\" style=\"margin-right:0.16666666666666666em;\"></span><span class=\"mord\"><span class=\"mord mathnormal\">x</span><span class=\"msupsub\"><span class=\"vlist-t vlist-t2\"><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.30110799999999993em;\"><span style=\"top:-2.5500000000000003em;margin-left:0em;margin-right:0.05em;\"><span class=\"pstrut\" style=\"height:2.7em;\"></span><span class=\"sizing reset-size6 size3 mtight\"><span class=\"mord mtight\">2</span></span></span></span><span class=\"vlist-s\">â€‹</span></span><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.15em;\"><span></span></span></span></span></span></span><span class=\"mpunct\">,</span><span class=\"mspace\" style=\"margin-right:0.16666666666666666em;\"></span><span class=\"minner\">â‹¯</span><span class=\"mspace\" style=\"margin-right:0.16666666666666666em;\"></span><span class=\"mspace\" style=\"margin-right:0.16666666666666666em;\"></span><span class=\"mpunct\">,</span><span class=\"mspace\" style=\"margin-right:0.16666666666666666em;\"></span><span class=\"mord\"><span class=\"mord mathnormal\">x</span><span class=\"msupsub\"><span class=\"vlist-t vlist-t2\"><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.151392em;\"><span style=\"top:-2.5500000000000003em;margin-left:0em;margin-right:0.05em;\"><span class=\"pstrut\" style=\"height:2.7em;\"></span><span class=\"sizing reset-size6 size3 mtight\"><span class=\"mord mathnormal mtight\">n</span></span></span></span><span class=\"vlist-s\">â€‹</span></span><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.15em;\"><span></span></span></span></span></span></span><span class=\"mclose\">)</span></span></span></span> ä½œä¸º Encoders çš„è¾“å…¥ï¼Œå¾—åˆ°è¾“å‡ºåºåˆ— <span class=\"katex\"><span class=\"katex-mathml\"><math xmlns=\"http://www.w3.org/1998/Math/MathML\"><semantics><mrow><mo stretchy=\"false\">(</mo><msub><mi>z</mi><mn>1</mn></msub><mo separator=\"true\">,</mo><msub><mi>z</mi><mn>2</mn></msub><mo separator=\"true\">,</mo><mo>â‹¯</mo><mtext>â€‰</mtext><mo separator=\"true\">,</mo><msub><mi>z</mi><mi>n</mi></msub><mo stretchy=\"false\">)</mo></mrow><annotation encoding=\"application/x-tex\">(z_1,z_2,\\cdots,z_n)</annotation></semantics></math></span><span class=\"katex-html\" aria-hidden=\"true\"><span class=\"base\"><span class=\"strut\" style=\"height:1em;vertical-align:-0.25em;\"></span><span class=\"mopen\">(</span><span class=\"mord\"><span class=\"mord mathnormal\" style=\"margin-right:0.04398em;\">z</span><span class=\"msupsub\"><span class=\"vlist-t vlist-t2\"><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.30110799999999993em;\"><span style=\"top:-2.5500000000000003em;margin-left:-0.04398em;margin-right:0.05em;\"><span class=\"pstrut\" style=\"height:2.7em;\"></span><span class=\"sizing reset-size6 size3 mtight\"><span class=\"mord mtight\">1</span></span></span></span><span class=\"vlist-s\">â€‹</span></span><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.15em;\"><span></span></span></span></span></span></span><span class=\"mpunct\">,</span><span class=\"mspace\" style=\"margin-right:0.16666666666666666em;\"></span><span class=\"mord\"><span class=\"mord mathnormal\" style=\"margin-right:0.04398em;\">z</span><span class=\"msupsub\"><span class=\"vlist-t vlist-t2\"><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.30110799999999993em;\"><span style=\"top:-2.5500000000000003em;margin-left:-0.04398em;margin-right:0.05em;\"><span class=\"pstrut\" style=\"height:2.7em;\"></span><span class=\"sizing reset-size6 size3 mtight\"><span class=\"mord mtight\">2</span></span></span></span><span class=\"vlist-s\">â€‹</span></span><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.15em;\"><span></span></span></span></span></span></span><span class=\"mpunct\">,</span><span class=\"mspace\" style=\"margin-right:0.16666666666666666em;\"></span><span class=\"minner\">â‹¯</span><span class=\"mspace\" style=\"margin-right:0.16666666666666666em;\"></span><span class=\"mspace\" style=\"margin-right:0.16666666666666666em;\"></span><span class=\"mpunct\">,</span><span class=\"mspace\" style=\"margin-right:0.16666666666666666em;\"></span><span class=\"mord\"><span class=\"mord mathnormal\" style=\"margin-right:0.04398em;\">z</span><span class=\"msupsub\"><span class=\"vlist-t vlist-t2\"><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.151392em;\"><span style=\"top:-2.5500000000000003em;margin-left:-0.04398em;margin-right:0.05em;\"><span class=\"pstrut\" style=\"height:2.7em;\"></span><span class=\"sizing reset-size6 size3 mtight\"><span class=\"mord mathnormal mtight\">n</span></span></span></span><span class=\"vlist-s\">â€‹</span></span><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.15em;\"><span></span></span></span></span></span></span><span class=\"mclose\">)</span></span></span></span></li>\n<li>æŠŠ Encoders çš„è¾“å‡ºåºåˆ— <span class=\"katex\"><span class=\"katex-mathml\"><math xmlns=\"http://www.w3.org/1998/Math/MathML\"><semantics><mrow><mo stretchy=\"false\">(</mo><msub><mi>z</mi><mn>1</mn></msub><mo separator=\"true\">,</mo><msub><mi>z</mi><mn>2</mn></msub><mo separator=\"true\">,</mo><mo>â‹¯</mo><mtext>â€‰</mtext><mo separator=\"true\">,</mo><msub><mi>z</mi><mi>n</mi></msub><mo stretchy=\"false\">)</mo></mrow><annotation encoding=\"application/x-tex\">(z_1,z_2,\\cdots,z_n)</annotation></semantics></math></span><span class=\"katex-html\" aria-hidden=\"true\"><span class=\"base\"><span class=\"strut\" style=\"height:1em;vertical-align:-0.25em;\"></span><span class=\"mopen\">(</span><span class=\"mord\"><span class=\"mord mathnormal\" style=\"margin-right:0.04398em;\">z</span><span class=\"msupsub\"><span class=\"vlist-t vlist-t2\"><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.30110799999999993em;\"><span style=\"top:-2.5500000000000003em;margin-left:-0.04398em;margin-right:0.05em;\"><span class=\"pstrut\" style=\"height:2.7em;\"></span><span class=\"sizing reset-size6 size3 mtight\"><span class=\"mord mtight\">1</span></span></span></span><span class=\"vlist-s\">â€‹</span></span><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.15em;\"><span></span></span></span></span></span></span><span class=\"mpunct\">,</span><span class=\"mspace\" style=\"margin-right:0.16666666666666666em;\"></span><span class=\"mord\"><span class=\"mord mathnormal\" style=\"margin-right:0.04398em;\">z</span><span class=\"msupsub\"><span class=\"vlist-t vlist-t2\"><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.30110799999999993em;\"><span style=\"top:-2.5500000000000003em;margin-left:-0.04398em;margin-right:0.05em;\"><span class=\"pstrut\" style=\"height:2.7em;\"></span><span class=\"sizing reset-size6 size3 mtight\"><span class=\"mord mtight\">2</span></span></span></span><span class=\"vlist-s\">â€‹</span></span><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.15em;\"><span></span></span></span></span></span></span><span class=\"mpunct\">,</span><span class=\"mspace\" style=\"margin-right:0.16666666666666666em;\"></span><span class=\"minner\">â‹¯</span><span class=\"mspace\" style=\"margin-right:0.16666666666666666em;\"></span><span class=\"mspace\" style=\"margin-right:0.16666666666666666em;\"></span><span class=\"mpunct\">,</span><span class=\"mspace\" style=\"margin-right:0.16666666666666666em;\"></span><span class=\"mord\"><span class=\"mord mathnormal\" style=\"margin-right:0.04398em;\">z</span><span class=\"msupsub\"><span class=\"vlist-t vlist-t2\"><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.151392em;\"><span style=\"top:-2.5500000000000003em;margin-left:-0.04398em;margin-right:0.05em;\"><span class=\"pstrut\" style=\"height:2.7em;\"></span><span class=\"sizing reset-size6 size3 mtight\"><span class=\"mord mathnormal mtight\">n</span></span></span></span><span class=\"vlist-s\">â€‹</span></span><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.15em;\"><span></span></span></span></span></span></span><span class=\"mclose\">)</span></span></span></span> ä½œä¸º Decoders çš„è¾“å…¥ï¼Œç”Ÿæˆä¸€ä¸ªè¾“å‡ºåºåˆ— <span class=\"katex\"><span class=\"katex-mathml\"><math xmlns=\"http://www.w3.org/1998/Math/MathML\"><semantics><mrow><mo stretchy=\"false\">(</mo><msub><mi>y</mi><mn>1</mn></msub><mo separator=\"true\">,</mo><msub><mi>y</mi><mn>2</mn></msub><mo separator=\"true\">,</mo><mo>â‹¯</mo><mtext>â€‰</mtext><mo separator=\"true\">,</mo><msub><mi>y</mi><mi>m</mi></msub><mo stretchy=\"false\">)</mo></mrow><annotation encoding=\"application/x-tex\">(y_1,y_2,\\cdots,y_m)</annotation></semantics></math></span><span class=\"katex-html\" aria-hidden=\"true\"><span class=\"base\"><span class=\"strut\" style=\"height:1em;vertical-align:-0.25em;\"></span><span class=\"mopen\">(</span><span class=\"mord\"><span class=\"mord mathnormal\" style=\"margin-right:0.03588em;\">y</span><span class=\"msupsub\"><span class=\"vlist-t vlist-t2\"><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.30110799999999993em;\"><span style=\"top:-2.5500000000000003em;margin-left:-0.03588em;margin-right:0.05em;\"><span class=\"pstrut\" style=\"height:2.7em;\"></span><span class=\"sizing reset-size6 size3 mtight\"><span class=\"mord mtight\">1</span></span></span></span><span class=\"vlist-s\">â€‹</span></span><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.15em;\"><span></span></span></span></span></span></span><span class=\"mpunct\">,</span><span class=\"mspace\" style=\"margin-right:0.16666666666666666em;\"></span><span class=\"mord\"><span class=\"mord mathnormal\" style=\"margin-right:0.03588em;\">y</span><span class=\"msupsub\"><span class=\"vlist-t vlist-t2\"><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.30110799999999993em;\"><span style=\"top:-2.5500000000000003em;margin-left:-0.03588em;margin-right:0.05em;\"><span class=\"pstrut\" style=\"height:2.7em;\"></span><span class=\"sizing reset-size6 size3 mtight\"><span class=\"mord mtight\">2</span></span></span></span><span class=\"vlist-s\">â€‹</span></span><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.15em;\"><span></span></span></span></span></span></span><span class=\"mpunct\">,</span><span class=\"mspace\" style=\"margin-right:0.16666666666666666em;\"></span><span class=\"minner\">â‹¯</span><span class=\"mspace\" style=\"margin-right:0.16666666666666666em;\"></span><span class=\"mspace\" style=\"margin-right:0.16666666666666666em;\"></span><span class=\"mpunct\">,</span><span class=\"mspace\" style=\"margin-right:0.16666666666666666em;\"></span><span class=\"mord\"><span class=\"mord mathnormal\" style=\"margin-right:0.03588em;\">y</span><span class=\"msupsub\"><span class=\"vlist-t vlist-t2\"><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.151392em;\"><span style=\"top:-2.5500000000000003em;margin-left:-0.03588em;margin-right:0.05em;\"><span class=\"pstrut\" style=\"height:2.7em;\"></span><span class=\"sizing reset-size6 size3 mtight\"><span class=\"mord mathnormal mtight\">m</span></span></span></span><span class=\"vlist-s\">â€‹</span></span><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.15em;\"><span></span></span></span></span></span></span><span class=\"mclose\">)</span></span></span></span>ã€‚æ³¨ï¼š<strong>Decoders æ¯ä¸ªæ—¶åˆ»è¾“å‡ºä¸€ä¸ªç»“æœ</strong></li>\n</ol>\n</blockquote>\n<p>ç¬¬ä¸€çœ¼çœ‹åˆ°ä¸Šè¿°çš„ Encodes-Decoders æ¡†æ¶å›¾ï¼Œéšä¹‹äº§ç”Ÿé—®é¢˜å°±æ˜¯ Transformer ä¸­ å·¦è¾¹ Encoders çš„è¾“å‡ºæ˜¯æ€ä¹ˆå’Œå³è¾¹ Decoders ç»“åˆçš„ã€‚å› ä¸º decoders é‡Œé¢æ˜¯æœ‰ N å±‚çš„ï¼Œå†ç”»å¼ å›¾ç›´è§‚çš„çœ‹å°±æ˜¯è¿™æ ·ï¼š</p>\n<p>&lt;img src=&quot;<span class=\"exturl\" data-url=\"aHR0cHM6Ly9pbWdtZC5vc3MtY24tc2hhbmdoYWkuYWxpeXVuY3MuY29tL0JFUlRfSU1HL3RmLWVkLSVFNSVBNCU4RCVFNiU5RCU4Mi5qcGc=\">https://imgmd.oss-cn-shanghai.aliyuncs.com/BERT_IMG/tf-ed - å¤æ‚.jpg</span>&quot; style=&quot;zoom:50%;&quot; /&gt;</p>\n<p>ä¹Ÿå°±æ˜¯è¯´ï¼ŒEncoders çš„è¾“å‡ºï¼Œä¼šå’Œ<strong>æ¯ä¸€å±‚çš„ Decoder è¿›è¡Œç»“åˆ</strong>ã€‚</p>\n<p>ç°åœ¨æˆ‘ä»¬å–å…¶ä¸­ä¸€å±‚è¿›è¡Œè¯¦ç»†çš„å±•ç¤ºï¼š</p>\n<p>&lt;img src=&quot;<span class=\"exturl\" data-url=\"aHR0cHM6Ly9pbWdtZC5vc3MtY24tc2hhbmdoYWkuYWxpeXVuY3MuY29tL0JFUlRfSU1HL2VkLSVFNyVCQiU4NiVFNSU4OCU4Ni5qcGc=\">https://imgmd.oss-cn-shanghai.aliyuncs.com/BERT_IMG/ed - ç»†åˆ†.jpg</span>&quot; style=&quot;zoom:50%;&quot; /&gt;</p>\n<p>é€šè¿‡ä¸Šè¿°åˆ†æï¼Œå‘ç°æˆ‘ä»¬æƒ³è¦è¯¦ç»†äº†è§£ Transformerï¼Œåªè¦äº†è§£ Transformer ä¸­çš„ Encoder å’Œ Decoder å•å…ƒå³å¯ï¼Œæ¥ä¸‹æ¥æˆ‘ä»¬å°†è¯¦ç»†é˜è¿°è¿™ä¸¤ä¸ªå•å…ƒã€‚</p>\n<h2 id=\"102-encoder\"><a class=\"anchor\" href=\"#102-encoder\">#</a> 10.2 Encoder</h2>\n<p>&lt;img src=&quot;<span class=\"exturl\" data-url=\"aHR0cHM6Ly9pbWdtZC5vc3MtY24tc2hhbmdoYWkuYWxpeXVuY3MuY29tL0JFUlRfSU1HL2VkLSVFNyVCQiU4NiVFNSU4OCU4Ni5qcGc=\">https://imgmd.oss-cn-shanghai.aliyuncs.com/BERT_IMG/ed - ç»†åˆ†.jpg</span>&quot; style=&quot;zoom:50%;&quot; /&gt;</p>\n<p>æœ‰äº†ä¸Šè¿°é‚£ä¹ˆå¤šçŸ¥è¯†çš„é“ºå«ï¼Œæˆ‘ä»¬çŸ¥é“ Eecoders æ˜¯ N=6 å±‚ï¼Œé€šè¿‡ä¸Šå›¾æˆ‘ä»¬å¯ä»¥çœ‹åˆ°æ¯å±‚ Encoder åŒ…æ‹¬ä¸¤ä¸ª sub-layersï¼š</p>\n<ul>\n<li>ç¬¬ä¸€ä¸ª sub-layer æ˜¯ multi-head self-attentionï¼Œç”¨æ¥è®¡ç®—è¾“å…¥çš„ self-attentionï¼›</li>\n<li>ç¬¬äºŒä¸ª sub-layer æ˜¯ç®€å•çš„å‰é¦ˆç¥ç»ç½‘ç»œå±‚ Feed Forwardï¼›</li>\n</ul>\n<p>æ³¨æ„ï¼šåœ¨æ¯ä¸ª sub-layer æˆ‘ä»¬éƒ½æ¨¡æ‹Ÿäº†æ®‹å·®ç½‘ç»œï¼ˆåœ¨ä¸‹é¢çš„æ•°æ®æµç¤ºæ„å›¾ä¸­ä¼šç»†è®²ï¼‰ï¼Œæ¯ä¸ª sub-layer çš„è¾“å‡ºéƒ½æ˜¯ <span class=\"katex\"><span class=\"katex-mathml\"><math xmlns=\"http://www.w3.org/1998/Math/MathML\"><semantics><mrow><mi>L</mi><mi>a</mi><mi>y</mi><mi>e</mi><mi>r</mi><mi>N</mi><mi>o</mi><mi>r</mi><mi>m</mi><mo stretchy=\"false\">(</mo><mi>x</mi><mo>+</mo><mi>S</mi><mi>u</mi><mi>b</mi><mi mathvariant=\"normal\">_</mi><mi>l</mi><mi>a</mi><mi>y</mi><mi>e</mi><mi>r</mi><mo stretchy=\"false\">(</mo><mi>x</mi><mo stretchy=\"false\">)</mo><mo stretchy=\"false\">)</mo></mrow><annotation encoding=\"application/x-tex\">LayerNorm(x+Sub\\_layer(x))</annotation></semantics></math></span><span class=\"katex-html\" aria-hidden=\"true\"><span class=\"base\"><span class=\"strut\" style=\"height:1em;vertical-align:-0.25em;\"></span><span class=\"mord mathnormal\">L</span><span class=\"mord mathnormal\">a</span><span class=\"mord mathnormal\" style=\"margin-right:0.03588em;\">y</span><span class=\"mord mathnormal\">e</span><span class=\"mord mathnormal\" style=\"margin-right:0.02778em;\">r</span><span class=\"mord mathnormal\" style=\"margin-right:0.10903em;\">N</span><span class=\"mord mathnormal\">o</span><span class=\"mord mathnormal\" style=\"margin-right:0.02778em;\">r</span><span class=\"mord mathnormal\">m</span><span class=\"mopen\">(</span><span class=\"mord mathnormal\">x</span><span class=\"mspace\" style=\"margin-right:0.2222222222222222em;\"></span><span class=\"mbin\">+</span><span class=\"mspace\" style=\"margin-right:0.2222222222222222em;\"></span></span><span class=\"base\"><span class=\"strut\" style=\"height:1.06em;vertical-align:-0.31em;\"></span><span class=\"mord mathnormal\" style=\"margin-right:0.05764em;\">S</span><span class=\"mord mathnormal\">u</span><span class=\"mord mathnormal\">b</span><span class=\"mord\" style=\"margin-right:0.02778em;\">_</span><span class=\"mord mathnormal\" style=\"margin-right:0.01968em;\">l</span><span class=\"mord mathnormal\">a</span><span class=\"mord mathnormal\" style=\"margin-right:0.03588em;\">y</span><span class=\"mord mathnormal\">e</span><span class=\"mord mathnormal\" style=\"margin-right:0.02778em;\">r</span><span class=\"mopen\">(</span><span class=\"mord mathnormal\">x</span><span class=\"mclose\">)</span><span class=\"mclose\">)</span></span></span></span>ï¼Œå…¶ä¸­ <span class=\"katex\"><span class=\"katex-mathml\"><math xmlns=\"http://www.w3.org/1998/Math/MathML\"><semantics><mrow><mi>s</mi><mi>u</mi><mi>b</mi><mi mathvariant=\"normal\">_</mi><mi>l</mi><mi>a</mi><mi>y</mi><mi>e</mi><mi>r</mi></mrow><annotation encoding=\"application/x-tex\">sub\\_layer</annotation></semantics></math></span><span class=\"katex-html\" aria-hidden=\"true\"><span class=\"base\"><span class=\"strut\" style=\"height:1.00444em;vertical-align:-0.31em;\"></span><span class=\"mord mathnormal\">s</span><span class=\"mord mathnormal\">u</span><span class=\"mord mathnormal\">b</span><span class=\"mord\" style=\"margin-right:0.02778em;\">_</span><span class=\"mord mathnormal\" style=\"margin-right:0.01968em;\">l</span><span class=\"mord mathnormal\">a</span><span class=\"mord mathnormal\" style=\"margin-right:0.03588em;\">y</span><span class=\"mord mathnormal\">e</span><span class=\"mord mathnormal\" style=\"margin-right:0.02778em;\">r</span></span></span></span> è¡¨ç¤ºçš„æ˜¯è¯¥å±‚çš„ä¸Šä¸€å±‚çš„è¾“å‡º</p>\n<p>ç°åœ¨æˆ‘ä»¬ç»™å‡º Encoder çš„æ•°æ®æµç¤ºæ„å›¾ï¼Œä¸€æ­¥ä¸€æ­¥å»å‰–æ</p>\n<p>&lt;img src=&quot;<span class=\"exturl\" data-url=\"aHR0cHM6Ly9pbWdtZC5vc3MtY24tc2hhbmdoYWkuYWxpeXVuY3MuY29tL0JFUlRfSU1HL2VuY29kZXItJUU4JUFGJUE2JUU3JUJCJTg2JUU1JTlCJUJFLnBuZw==\">https://imgmd.oss-cn-shanghai.aliyuncs.com/BERT_IMG/encoder - è¯¦ç»†å›¾.png</span>&quot; style=&quot;zoom:50%;&quot; /&gt;</p>\n<ol>\n<li>æ·±ç»¿è‰²çš„ <span class=\"katex\"><span class=\"katex-mathml\"><math xmlns=\"http://www.w3.org/1998/Math/MathML\"><semantics><mrow><msub><mi>x</mi><mn>1</mn></msub></mrow><annotation encoding=\"application/x-tex\">x_1</annotation></semantics></math></span><span class=\"katex-html\" aria-hidden=\"true\"><span class=\"base\"><span class=\"strut\" style=\"height:0.58056em;vertical-align:-0.15em;\"></span><span class=\"mord\"><span class=\"mord mathnormal\">x</span><span class=\"msupsub\"><span class=\"vlist-t vlist-t2\"><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.30110799999999993em;\"><span style=\"top:-2.5500000000000003em;margin-left:0em;margin-right:0.05em;\"><span class=\"pstrut\" style=\"height:2.7em;\"></span><span class=\"sizing reset-size6 size3 mtight\"><span class=\"mord mtight\">1</span></span></span></span><span class=\"vlist-s\">â€‹</span></span><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.15em;\"><span></span></span></span></span></span></span></span></span></span> è¡¨ç¤º Embedding å±‚çš„è¾“å‡ºï¼ŒåŠ ä¸Šä»£è¡¨ Positional Embedding çš„å‘é‡ä¹‹åï¼Œå¾—åˆ°æœ€åè¾“å…¥ Encoder ä¸­çš„ç‰¹å¾å‘é‡ï¼Œä¹Ÿå°±æ˜¯æµ…ç»¿è‰²å‘é‡ <span class=\"katex\"><span class=\"katex-mathml\"><math xmlns=\"http://www.w3.org/1998/Math/MathML\"><semantics><mrow><msub><mi>x</mi><mn>1</mn></msub></mrow><annotation encoding=\"application/x-tex\">x_1</annotation></semantics></math></span><span class=\"katex-html\" aria-hidden=\"true\"><span class=\"base\"><span class=\"strut\" style=\"height:0.58056em;vertical-align:-0.15em;\"></span><span class=\"mord\"><span class=\"mord mathnormal\">x</span><span class=\"msupsub\"><span class=\"vlist-t vlist-t2\"><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.30110799999999993em;\"><span style=\"top:-2.5500000000000003em;margin-left:0em;margin-right:0.05em;\"><span class=\"pstrut\" style=\"height:2.7em;\"></span><span class=\"sizing reset-size6 size3 mtight\"><span class=\"mord mtight\">1</span></span></span></span><span class=\"vlist-s\">â€‹</span></span><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.15em;\"><span></span></span></span></span></span></span></span></span></span>ï¼›</li>\n<li>æµ…ç»¿è‰²å‘é‡ <span class=\"katex\"><span class=\"katex-mathml\"><math xmlns=\"http://www.w3.org/1998/Math/MathML\"><semantics><mrow><msub><mi>x</mi><mn>1</mn></msub></mrow><annotation encoding=\"application/x-tex\">x_1</annotation></semantics></math></span><span class=\"katex-html\" aria-hidden=\"true\"><span class=\"base\"><span class=\"strut\" style=\"height:0.58056em;vertical-align:-0.15em;\"></span><span class=\"mord\"><span class=\"mord mathnormal\">x</span><span class=\"msupsub\"><span class=\"vlist-t vlist-t2\"><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.30110799999999993em;\"><span style=\"top:-2.5500000000000003em;margin-left:0em;margin-right:0.05em;\"><span class=\"pstrut\" style=\"height:2.7em;\"></span><span class=\"sizing reset-size6 size3 mtight\"><span class=\"mord mtight\">1</span></span></span></span><span class=\"vlist-s\">â€‹</span></span><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.15em;\"><span></span></span></span></span></span></span></span></span></span> è¡¨ç¤ºå•è¯ â€œThinkingâ€ çš„ç‰¹å¾å‘é‡ï¼Œå…¶ä¸­ <span class=\"katex\"><span class=\"katex-mathml\"><math xmlns=\"http://www.w3.org/1998/Math/MathML\"><semantics><mrow><msub><mi>x</mi><mn>1</mn></msub></mrow><annotation encoding=\"application/x-tex\">x_1</annotation></semantics></math></span><span class=\"katex-html\" aria-hidden=\"true\"><span class=\"base\"><span class=\"strut\" style=\"height:0.58056em;vertical-align:-0.15em;\"></span><span class=\"mord\"><span class=\"mord mathnormal\">x</span><span class=\"msupsub\"><span class=\"vlist-t vlist-t2\"><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.30110799999999993em;\"><span style=\"top:-2.5500000000000003em;margin-left:0em;margin-right:0.05em;\"><span class=\"pstrut\" style=\"height:2.7em;\"></span><span class=\"sizing reset-size6 size3 mtight\"><span class=\"mord mtight\">1</span></span></span></span><span class=\"vlist-s\">â€‹</span></span><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.15em;\"><span></span></span></span></span></span></span></span></span></span> ç»è¿‡ Self-Attention å±‚ï¼Œå˜æˆæµ…ç²‰è‰²å‘é‡ <span class=\"katex\"><span class=\"katex-mathml\"><math xmlns=\"http://www.w3.org/1998/Math/MathML\"><semantics><mrow><msub><mi>z</mi><mn>1</mn></msub></mrow><annotation encoding=\"application/x-tex\">z_1</annotation></semantics></math></span><span class=\"katex-html\" aria-hidden=\"true\"><span class=\"base\"><span class=\"strut\" style=\"height:0.58056em;vertical-align:-0.15em;\"></span><span class=\"mord\"><span class=\"mord mathnormal\" style=\"margin-right:0.04398em;\">z</span><span class=\"msupsub\"><span class=\"vlist-t vlist-t2\"><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.30110799999999993em;\"><span style=\"top:-2.5500000000000003em;margin-left:-0.04398em;margin-right:0.05em;\"><span class=\"pstrut\" style=\"height:2.7em;\"></span><span class=\"sizing reset-size6 size3 mtight\"><span class=\"mord mtight\">1</span></span></span></span><span class=\"vlist-s\">â€‹</span></span><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.15em;\"><span></span></span></span></span></span></span></span></span></span>ï¼›</li>\n<li><span class=\"katex\"><span class=\"katex-mathml\"><math xmlns=\"http://www.w3.org/1998/Math/MathML\"><semantics><mrow><msub><mi>x</mi><mn>1</mn></msub></mrow><annotation encoding=\"application/x-tex\">x_1</annotation></semantics></math></span><span class=\"katex-html\" aria-hidden=\"true\"><span class=\"base\"><span class=\"strut\" style=\"height:0.58056em;vertical-align:-0.15em;\"></span><span class=\"mord\"><span class=\"mord mathnormal\">x</span><span class=\"msupsub\"><span class=\"vlist-t vlist-t2\"><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.30110799999999993em;\"><span style=\"top:-2.5500000000000003em;margin-left:0em;margin-right:0.05em;\"><span class=\"pstrut\" style=\"height:2.7em;\"></span><span class=\"sizing reset-size6 size3 mtight\"><span class=\"mord mtight\">1</span></span></span></span><span class=\"vlist-s\">â€‹</span></span><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.15em;\"><span></span></span></span></span></span></span></span></span></span> ä½œä¸ºæ®‹å·®ç»“æ„çš„ç›´è¿å‘é‡ï¼Œç›´æ¥å’Œ <span class=\"katex\"><span class=\"katex-mathml\"><math xmlns=\"http://www.w3.org/1998/Math/MathML\"><semantics><mrow><msub><mi>z</mi><mn>1</mn></msub></mrow><annotation encoding=\"application/x-tex\">z_1</annotation></semantics></math></span><span class=\"katex-html\" aria-hidden=\"true\"><span class=\"base\"><span class=\"strut\" style=\"height:0.58056em;vertical-align:-0.15em;\"></span><span class=\"mord\"><span class=\"mord mathnormal\" style=\"margin-right:0.04398em;\">z</span><span class=\"msupsub\"><span class=\"vlist-t vlist-t2\"><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.30110799999999993em;\"><span style=\"top:-2.5500000000000003em;margin-left:-0.04398em;margin-right:0.05em;\"><span class=\"pstrut\" style=\"height:2.7em;\"></span><span class=\"sizing reset-size6 size3 mtight\"><span class=\"mord mtight\">1</span></span></span></span><span class=\"vlist-s\">â€‹</span></span><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.15em;\"><span></span></span></span></span></span></span></span></span></span> ç›¸åŠ ï¼Œä¹‹åè¿›è¡Œ Layer Norm æ“ä½œï¼Œå¾—åˆ°ç²‰è‰²å‘é‡ <span class=\"katex\"><span class=\"katex-mathml\"><math xmlns=\"http://www.w3.org/1998/Math/MathML\"><semantics><mrow><msub><mi>z</mi><mn>1</mn></msub></mrow><annotation encoding=\"application/x-tex\">z_1</annotation></semantics></math></span><span class=\"katex-html\" aria-hidden=\"true\"><span class=\"base\"><span class=\"strut\" style=\"height:0.58056em;vertical-align:-0.15em;\"></span><span class=\"mord\"><span class=\"mord mathnormal\" style=\"margin-right:0.04398em;\">z</span><span class=\"msupsub\"><span class=\"vlist-t vlist-t2\"><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.30110799999999993em;\"><span style=\"top:-2.5500000000000003em;margin-left:-0.04398em;margin-right:0.05em;\"><span class=\"pstrut\" style=\"height:2.7em;\"></span><span class=\"sizing reset-size6 size3 mtight\"><span class=\"mord mtight\">1</span></span></span></span><span class=\"vlist-s\">â€‹</span></span><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.15em;\"><span></span></span></span></span></span></span></span></span></span>ï¼›\n<ol>\n<li>æ®‹å·®ç»“æ„çš„ä½œç”¨ï¼šé¿å…å‡ºç°æ¢¯åº¦æ¶ˆå¤±çš„æƒ…å†µ</li>\n<li>Layer Norm çš„ä½œç”¨ï¼šä¸ºäº†ä¿è¯æ•°æ®ç‰¹å¾åˆ†å¸ƒçš„ç¨³å®šæ€§ï¼Œå¹¶ä¸”å¯ä»¥åŠ é€Ÿæ¨¡å‹çš„æ”¶æ•›</li>\n</ol>\n</li>\n<li><span class=\"katex\"><span class=\"katex-mathml\"><math xmlns=\"http://www.w3.org/1998/Math/MathML\"><semantics><mrow><msub><mi>z</mi><mn>1</mn></msub></mrow><annotation encoding=\"application/x-tex\">z_1</annotation></semantics></math></span><span class=\"katex-html\" aria-hidden=\"true\"><span class=\"base\"><span class=\"strut\" style=\"height:0.58056em;vertical-align:-0.15em;\"></span><span class=\"mord\"><span class=\"mord mathnormal\" style=\"margin-right:0.04398em;\">z</span><span class=\"msupsub\"><span class=\"vlist-t vlist-t2\"><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.30110799999999993em;\"><span style=\"top:-2.5500000000000003em;margin-left:-0.04398em;margin-right:0.05em;\"><span class=\"pstrut\" style=\"height:2.7em;\"></span><span class=\"sizing reset-size6 size3 mtight\"><span class=\"mord mtight\">1</span></span></span></span><span class=\"vlist-s\">â€‹</span></span><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.15em;\"><span></span></span></span></span></span></span></span></span></span> ç»è¿‡å‰é¦ˆç¥ç»ç½‘ç»œï¼ˆFeed Forwardï¼‰å±‚ï¼Œç»è¿‡æ®‹å·®ç»“æ„ä¸è‡ªèº«ç›¸åŠ ï¼Œä¹‹åç»è¿‡ LN å±‚ï¼Œå¾—åˆ°ä¸€ä¸ªè¾“å‡ºå‘é‡ <span class=\"katex\"><span class=\"katex-mathml\"><math xmlns=\"http://www.w3.org/1998/Math/MathML\"><semantics><mrow><msub><mi>r</mi><mn>1</mn></msub></mrow><annotation encoding=\"application/x-tex\">r_1</annotation></semantics></math></span><span class=\"katex-html\" aria-hidden=\"true\"><span class=\"base\"><span class=\"strut\" style=\"height:0.58056em;vertical-align:-0.15em;\"></span><span class=\"mord\"><span class=\"mord mathnormal\" style=\"margin-right:0.02778em;\">r</span><span class=\"msupsub\"><span class=\"vlist-t vlist-t2\"><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.30110799999999993em;\"><span style=\"top:-2.5500000000000003em;margin-left:-0.02778em;margin-right:0.05em;\"><span class=\"pstrut\" style=\"height:2.7em;\"></span><span class=\"sizing reset-size6 size3 mtight\"><span class=\"mord mtight\">1</span></span></span></span><span class=\"vlist-s\">â€‹</span></span><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.15em;\"><span></span></span></span></span></span></span></span></span></span>ï¼›\n<ol>\n<li>è¯¥å‰é¦ˆç¥ç»ç½‘ç»œåŒ…æ‹¬ä¸¤ä¸ªçº¿æ€§å˜æ¢å’Œä¸€ä¸ª ReLU æ¿€æ´»å‡½æ•°ï¼š<span class=\"katex\"><span class=\"katex-mathml\"><math xmlns=\"http://www.w3.org/1998/Math/MathML\"><semantics><mrow><mi>F</mi><mi>F</mi><mi>N</mi><mo stretchy=\"false\">(</mo><mi>x</mi><mo stretchy=\"false\">)</mo><mo>=</mo><mi>m</mi><mi>a</mi><mi>x</mi><mo stretchy=\"false\">(</mo><mn>0</mn><mo separator=\"true\">,</mo><mi>x</mi><msub><mi>W</mi><mn>1</mn></msub><mo>+</mo><msub><mi>b</mi><mn>1</mn></msub><mo stretchy=\"false\">)</mo><msub><mi>W</mi><mn>2</mn></msub><mo>+</mo><mi>b</mi><mn>2</mn></mrow><annotation encoding=\"application/x-tex\">FFN(x) = max(0,xW_1+b_1)W_2+b2</annotation></semantics></math></span><span class=\"katex-html\" aria-hidden=\"true\"><span class=\"base\"><span class=\"strut\" style=\"height:1em;vertical-align:-0.25em;\"></span><span class=\"mord mathnormal\" style=\"margin-right:0.13889em;\">F</span><span class=\"mord mathnormal\" style=\"margin-right:0.13889em;\">F</span><span class=\"mord mathnormal\" style=\"margin-right:0.10903em;\">N</span><span class=\"mopen\">(</span><span class=\"mord mathnormal\">x</span><span class=\"mclose\">)</span><span class=\"mspace\" style=\"margin-right:0.2777777777777778em;\"></span><span class=\"mrel\">=</span><span class=\"mspace\" style=\"margin-right:0.2777777777777778em;\"></span></span><span class=\"base\"><span class=\"strut\" style=\"height:1em;vertical-align:-0.25em;\"></span><span class=\"mord mathnormal\">m</span><span class=\"mord mathnormal\">a</span><span class=\"mord mathnormal\">x</span><span class=\"mopen\">(</span><span class=\"mord\">0</span><span class=\"mpunct\">,</span><span class=\"mspace\" style=\"margin-right:0.16666666666666666em;\"></span><span class=\"mord mathnormal\">x</span><span class=\"mord\"><span class=\"mord mathnormal\" style=\"margin-right:0.13889em;\">W</span><span class=\"msupsub\"><span class=\"vlist-t vlist-t2\"><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.30110799999999993em;\"><span style=\"top:-2.5500000000000003em;margin-left:-0.13889em;margin-right:0.05em;\"><span class=\"pstrut\" style=\"height:2.7em;\"></span><span class=\"sizing reset-size6 size3 mtight\"><span class=\"mord mtight\">1</span></span></span></span><span class=\"vlist-s\">â€‹</span></span><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.15em;\"><span></span></span></span></span></span></span><span class=\"mspace\" style=\"margin-right:0.2222222222222222em;\"></span><span class=\"mbin\">+</span><span class=\"mspace\" style=\"margin-right:0.2222222222222222em;\"></span></span><span class=\"base\"><span class=\"strut\" style=\"height:1em;vertical-align:-0.25em;\"></span><span class=\"mord\"><span class=\"mord mathnormal\">b</span><span class=\"msupsub\"><span class=\"vlist-t vlist-t2\"><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.30110799999999993em;\"><span style=\"top:-2.5500000000000003em;margin-left:0em;margin-right:0.05em;\"><span class=\"pstrut\" style=\"height:2.7em;\"></span><span class=\"sizing reset-size6 size3 mtight\"><span class=\"mord mtight\">1</span></span></span></span><span class=\"vlist-s\">â€‹</span></span><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.15em;\"><span></span></span></span></span></span></span><span class=\"mclose\">)</span><span class=\"mord\"><span class=\"mord mathnormal\" style=\"margin-right:0.13889em;\">W</span><span class=\"msupsub\"><span class=\"vlist-t vlist-t2\"><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.30110799999999993em;\"><span style=\"top:-2.5500000000000003em;margin-left:-0.13889em;margin-right:0.05em;\"><span class=\"pstrut\" style=\"height:2.7em;\"></span><span class=\"sizing reset-size6 size3 mtight\"><span class=\"mord mtight\">2</span></span></span></span><span class=\"vlist-s\">â€‹</span></span><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.15em;\"><span></span></span></span></span></span></span><span class=\"mspace\" style=\"margin-right:0.2222222222222222em;\"></span><span class=\"mbin\">+</span><span class=\"mspace\" style=\"margin-right:0.2222222222222222em;\"></span></span><span class=\"base\"><span class=\"strut\" style=\"height:0.69444em;vertical-align:0em;\"></span><span class=\"mord mathnormal\">b</span><span class=\"mord\">2</span></span></span></span></li>\n</ol>\n</li>\n<li>ç”±äº Transformer çš„ Encoders å…·æœ‰ 6 ä¸ª Encoderï¼Œ<strong><span class=\"katex\"><span class=\"katex-mathml\"><math xmlns=\"http://www.w3.org/1998/Math/MathML\"><semantics><mrow><msub><mi>r</mi><mn>1</mn></msub></mrow><annotation encoding=\"application/x-tex\">r_1</annotation></semantics></math></span><span class=\"katex-html\" aria-hidden=\"true\"><span class=\"base\"><span class=\"strut\" style=\"height:0.58056em;vertical-align:-0.15em;\"></span><span class=\"mord\"><span class=\"mord mathnormal\" style=\"margin-right:0.02778em;\">r</span><span class=\"msupsub\"><span class=\"vlist-t vlist-t2\"><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.30110799999999993em;\"><span style=\"top:-2.5500000000000003em;margin-left:-0.02778em;margin-right:0.05em;\"><span class=\"pstrut\" style=\"height:2.7em;\"></span><span class=\"sizing reset-size6 size3 mtight\"><span class=\"mord mtight\">1</span></span></span></span><span class=\"vlist-s\">â€‹</span></span><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.15em;\"><span></span></span></span></span></span></span></span></span></span> ä¹Ÿå°†ä¼šä½œä¸ºä¸‹ä¸€å±‚ Encoder çš„è¾“å…¥ï¼Œä»£æ›¿ <span class=\"katex\"><span class=\"katex-mathml\"><math xmlns=\"http://www.w3.org/1998/Math/MathML\"><semantics><mrow><msub><mi>x</mi><mn>1</mn></msub></mrow><annotation encoding=\"application/x-tex\">x_1</annotation></semantics></math></span><span class=\"katex-html\" aria-hidden=\"true\"><span class=\"base\"><span class=\"strut\" style=\"height:0.58056em;vertical-align:-0.15em;\"></span><span class=\"mord\"><span class=\"mord mathnormal\">x</span><span class=\"msupsub\"><span class=\"vlist-t vlist-t2\"><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.30110799999999993em;\"><span style=\"top:-2.5500000000000003em;margin-left:0em;margin-right:0.05em;\"><span class=\"pstrut\" style=\"height:2.7em;\"></span><span class=\"sizing reset-size6 size3 mtight\"><span class=\"mord mtight\">1</span></span></span></span><span class=\"vlist-s\">â€‹</span></span><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.15em;\"><span></span></span></span></span></span></span></span></span></span> çš„è§’è‰²</strong>ï¼Œå¦‚æ­¤å¾ªç¯ï¼Œç›´è‡³æœ€åä¸€å±‚ Encoderã€‚</li>\n</ol>\n<p>éœ€è¦æ³¨æ„çš„æ˜¯ï¼Œ<strong>ä¸Šè¿°çš„ <span class=\"katex\"><span class=\"katex-mathml\"><math xmlns=\"http://www.w3.org/1998/Math/MathML\"><semantics><mrow><mi>x</mi><mtext>ã€</mtext><mi>z</mi><mtext>ã€</mtext><mi>r</mi></mrow><annotation encoding=\"application/x-tex\">xã€zã€r</annotation></semantics></math></span><span class=\"katex-html\" aria-hidden=\"true\"><span class=\"base\"><span class=\"strut\" style=\"height:0.68333em;vertical-align:0em;\"></span><span class=\"mord mathnormal\">x</span><span class=\"mord cjk_fallback\">ã€</span><span class=\"mord mathnormal\" style=\"margin-right:0.04398em;\">z</span><span class=\"mord cjk_fallback\">ã€</span><span class=\"mord mathnormal\" style=\"margin-right:0.02778em;\">r</span></span></span></span> éƒ½å…·æœ‰ç›¸åŒçš„ç»´æ•°</strong>ï¼Œè®ºæ–‡ä¸­ä¸º 512 ç»´ã€‚</p>\n<h2 id=\"103-decoder\"><a class=\"anchor\" href=\"#103-decoder\">#</a> 10.3 Decoder</h2>\n<p>&lt;img src=&quot;<span class=\"exturl\" data-url=\"aHR0cHM6Ly9pbWdtZC5vc3MtY24tc2hhbmdoYWkuYWxpeXVuY3MuY29tL0JFUlRfSU1HL2VkLSVFNyVCQiU4NiVFNSU4OCU4Ni5qcGc=\">https://imgmd.oss-cn-shanghai.aliyuncs.com/BERT_IMG/ed - ç»†åˆ†.jpg</span>&quot; style=&quot;zoom:50%;&quot; /&gt;</p>\n<p>Decoders ä¹Ÿæ˜¯ N=6 å±‚ï¼Œé€šè¿‡ä¸Šå›¾æˆ‘ä»¬å¯ä»¥çœ‹åˆ°æ¯å±‚ Decoder åŒ…æ‹¬ 3 ä¸ª sub-layersï¼š</p>\n<ul>\n<li>ç¬¬ä¸€ä¸ª sub-layer æ˜¯ Masked multi-head self-attentionï¼Œä¹Ÿæ˜¯è®¡ç®—è¾“å…¥çš„ self-attentionï¼›\n<ul>\n<li>åœ¨è¿™é‡Œï¼Œå…ˆä¸è§£é‡Šä¸ºä»€ä¹ˆè¦åš Maskedï¼Œåé¢åœ¨ â€œTransformer åŠ¨æ€æµç¨‹å±•ç¤ºâ€ è¿™ä¸€å°èŠ‚ä¼šè§£é‡Š</li>\n</ul>\n</li>\n<li>ç¬¬äºŒä¸ª sub-layer æ˜¯ Encoder-Decoder Attention è®¡ç®—ï¼Œå¯¹ Encoder çš„è¾“å…¥å’Œ Decoder çš„ Masked multi-head self-attention çš„è¾“å‡ºè¿›è¡Œ attention è®¡ç®—ï¼›\n<ul>\n<li>åœ¨è¿™é‡Œï¼ŒåŒæ ·ä¸è§£é‡Šä¸ºä»€ä¹ˆè¦å¯¹ Encoder å’Œ Decoder çš„è¾“å‡ºä¸€åŒåš attention è®¡ç®—ï¼Œåé¢åœ¨ â€œTransformer åŠ¨æ€æµç¨‹å±•ç¤ºâ€ è¿™ä¸€å°èŠ‚ä¼šè§£é‡Š</li>\n</ul>\n</li>\n<li>ç¬¬ä¸‰ä¸ª sub-layer æ˜¯å‰é¦ˆç¥ç»ç½‘ç»œå±‚ï¼Œä¸ Encoder ç›¸åŒã€‚</li>\n</ul>\n<h2 id=\"104-transformer-è¾“å‡ºç»“æœ\"><a class=\"anchor\" href=\"#104-transformer-è¾“å‡ºç»“æœ\">#</a> 10.4 Transformer è¾“å‡ºç»“æœ</h2>\n<p>ä»¥ä¸Šï¼Œå°±è®²å®Œäº† Transformer ç¼–ç å’Œè§£ç ä¸¤å¤§æ¨¡å—ï¼Œé‚£ä¹ˆæˆ‘ä»¬å›å½’æœ€åˆçš„é—®é¢˜ï¼Œå°† â€œæœºå™¨å­¦ä¹ â€ ç¿»è¯‘æˆ â€œmachine learingâ€ï¼Œè§£ç å™¨çš„è¾“å‡ºæ˜¯ä¸€ä¸ªæµ®ç‚¹å‹çš„å‘é‡ï¼Œæ€ä¹ˆè½¬åŒ–æˆ â€œmachine learingâ€ è¿™ä¸¤ä¸ªè¯å‘¢ï¼Ÿè®©æˆ‘ä»¬æ¥çœ‹çœ‹ Encoders å’Œ Decoders äº¤äº’çš„è¿‡ç¨‹å¯»æ‰¾ç­”æ¡ˆï¼š</p>\n<p>&lt;img src=&quot;<span class=\"exturl\" data-url=\"aHR0cHM6Ly9pbWdtZC5vc3MtY24tc2hhbmdoYWkuYWxpeXVuY3MuY29tL0JFUlRfSU1HL2VkLSVFNCVCQSVBNCVFNCVCQSU5Mi5qcGc=\">https://imgmd.oss-cn-shanghai.aliyuncs.com/BERT_IMG/ed - äº¤äº’.jpg</span>&quot; style=&quot;zoom:50%;&quot; /&gt;</p>\n<p>ä»ä¸Šå›¾å¯ä»¥çœ‹å‡ºï¼ŒTransformer æœ€åçš„å·¥ä½œæ˜¯è®©è§£ç å™¨çš„è¾“å‡ºé€šè¿‡çº¿æ€§å±‚ Linear åæ¥ä¸Šä¸€ä¸ª softmax</p>\n<ul>\n<li>å…¶ä¸­çº¿æ€§å±‚æ˜¯ä¸€ä¸ªç®€å•çš„å…¨è¿æ¥ç¥ç»ç½‘ç»œï¼Œå®ƒå°†è§£ç å™¨äº§ç”Ÿçš„å‘é‡ A æŠ•å½±åˆ°ä¸€ä¸ªæ›´é«˜ç»´åº¦çš„å‘é‡ B ä¸Šï¼Œå‡è®¾æˆ‘ä»¬æ¨¡å‹çš„è¯æ±‡è¡¨æ˜¯ 10000 ä¸ªè¯ï¼Œé‚£ä¹ˆå‘é‡ B å°±æœ‰ 10000 ä¸ªç»´åº¦ï¼Œæ¯ä¸ªç»´åº¦å¯¹åº”ä¸€ä¸ªæƒŸä¸€çš„è¯çš„å¾—åˆ†ã€‚</li>\n<li>ä¹‹åçš„ softmax å±‚å°†è¿™äº›åˆ†æ•°è½¬æ¢ä¸ºæ¦‚ç‡ã€‚é€‰æ‹©æ¦‚ç‡æœ€å¤§çš„ç»´åº¦ï¼Œå¹¶å¯¹åº”åœ°ç”Ÿæˆä¸ä¹‹å…³è”çš„å•è¯ä½œä¸ºæ­¤æ—¶é—´æ­¥çš„è¾“å‡ºå°±æ˜¯æœ€ç»ˆçš„è¾“å‡ºå•¦ï¼</li>\n</ul>\n<p>&lt;img src=&quot;<span class=\"exturl\" data-url=\"aHR0cHM6Ly9pbWdtZC5vc3MtY24tc2hhbmdoYWkuYWxpeXVuY3MuY29tL0JFUlRfSU1HL3RmLSVFNiU5QyU4MCVFNSU5MCU4RSVFOCVCRSU5MyVFNSU4NyVCQS5qcGc=\">https://imgmd.oss-cn-shanghai.aliyuncs.com/BERT_IMG/tf - æœ€åè¾“å‡º.jpg</span>&quot; style=&quot;zoom:50%;&quot; /&gt;</p>\n<p>å‡è®¾è¯æ±‡è¡¨ç»´åº¦æ˜¯ 6ï¼Œé‚£ä¹ˆè¾“å‡ºæœ€å¤§æ¦‚ç‡è¯æ±‡çš„è¿‡ç¨‹å¦‚ä¸‹ï¼š</p>\n<p>&lt;img src=&quot;<span class=\"exturl\" data-url=\"aHR0cHM6Ly9pbWdtZC5vc3MtY24tc2hhbmdoYWkuYWxpeXVuY3MuY29tL0JFUlRfSU1HL3RmLSVFNiU5QyU4MCVFNyVCQiU4OCVFOCVCRSU5MyVFNSU4NyVCQSVFNyVCQiU5MyVFNiU5RSU5Qy5qcGc=\">https://imgmd.oss-cn-shanghai.aliyuncs.com/BERT_IMG/tf - æœ€ç»ˆè¾“å‡ºç»“æœ.jpg</span>&quot; style=&quot;zoom:50%;&quot; /&gt;</p>\n<h1 id=\"åä¸€-transformer-åŠ¨æ€æµç¨‹å±•ç¤º\"><a class=\"anchor\" href=\"#åä¸€-transformer-åŠ¨æ€æµç¨‹å±•ç¤º\">#</a> åä¸€ã€Transformer åŠ¨æ€æµç¨‹å±•ç¤º</h1>\n<p>é¦–å…ˆæˆ‘ä»¬æ¥çœ‹çœ‹æ‹¿ Transformer ä½œç¿»è¯‘æ—¶ï¼Œå¦‚ä½•ç”Ÿæˆç¿»è¯‘ç»“æœçš„ï¼š</p>\n<p>&lt;img src=&quot;<span class=\"exturl\" data-url=\"aHR0cHM6Ly9pbWdtZC5vc3MtY24tc2hhbmdoYWkuYWxpeXVuY3MuY29tL0JFUlRfSU1HL3RmLSVFNSU4QSVBOCVFNiU4MCU4MSVFNyU5NCU5RiVFNiU4OCU5MC5naWY=\">https://imgmd.oss-cn-shanghai.aliyuncs.com/BERT_IMG/tf - åŠ¨æ€ç”Ÿæˆ.gif</span>&quot; style=&quot;zoom:50%;&quot; /&gt;</p>\n<p>ç»§ç»­è¿›è¡Œï¼š</p>\n<p>&lt;img src=&quot;<span class=\"exturl\" data-url=\"aHR0cHM6Ly9pbWdtZC5vc3MtY24tc2hhbmdoYWkuYWxpeXVuY3MuY29tL0JFUlRfSU1HL3RmLSVFNSU4QSVBOCVFNiU4MCU4MSVFNyVCQiU5MyVFNiU5RSU5Qy0yLmdpZg==\">https://imgmd.oss-cn-shanghai.aliyuncs.com/BERT_IMG/tf - åŠ¨æ€ç»“æœ - 2.gif</span>&quot; style=&quot;zoom:50%;&quot; /&gt;</p>\n<p>&lt;img src=&quot;<span class=\"exturl\" data-url=\"aHR0cHM6Ly9pbWdtZC5vc3MtY24tc2hhbmdoYWkuYWxpeXVuY3MuY29tL0JFUlRfSU1HL3RmLSVFNiU5NSVCNCVFNCVCRCU5MyVFNiVBMSU4NiVFNiU5RSVCNi5qcGc=\">https://imgmd.oss-cn-shanghai.aliyuncs.com/BERT_IMG/tf - æ•´ä½“æ¡†æ¶.jpg</span>&quot; style=&quot;zoom:33%;&quot; /&gt;</p>\n<p>å‡è®¾ä¸Šå›¾æ˜¯è®­ç»ƒæ¨¡å‹çš„æŸä¸€ä¸ªé˜¶æ®µï¼Œæˆ‘ä»¬æ¥ç»“åˆ Transformer çš„å®Œæ•´æ¡†æ¶æè¿°ä¸‹è¿™ä¸ªåŠ¨æ€çš„æµç¨‹å›¾ï¼š</p>\n<ol>\n<li>è¾“å…¥ â€œje suis etudiantâ€ åˆ° Encodersï¼Œç„¶åå¾—åˆ°ä¸€ä¸ª <span class=\"katex\"><span class=\"katex-mathml\"><math xmlns=\"http://www.w3.org/1998/Math/MathML\"><semantics><mrow><msub><mi>K</mi><mi>e</mi></msub></mrow><annotation encoding=\"application/x-tex\">K_e</annotation></semantics></math></span><span class=\"katex-html\" aria-hidden=\"true\"><span class=\"base\"><span class=\"strut\" style=\"height:0.83333em;vertical-align:-0.15em;\"></span><span class=\"mord\"><span class=\"mord mathnormal\" style=\"margin-right:0.07153em;\">K</span><span class=\"msupsub\"><span class=\"vlist-t vlist-t2\"><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.151392em;\"><span style=\"top:-2.5500000000000003em;margin-left:-0.07153em;margin-right:0.05em;\"><span class=\"pstrut\" style=\"height:2.7em;\"></span><span class=\"sizing reset-size6 size3 mtight\"><span class=\"mord mathnormal mtight\">e</span></span></span></span><span class=\"vlist-s\">â€‹</span></span><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.15em;\"><span></span></span></span></span></span></span></span></span></span>ã€<span class=\"katex\"><span class=\"katex-mathml\"><math xmlns=\"http://www.w3.org/1998/Math/MathML\"><semantics><mrow><msub><mi>V</mi><mi>e</mi></msub></mrow><annotation encoding=\"application/x-tex\">V_e</annotation></semantics></math></span><span class=\"katex-html\" aria-hidden=\"true\"><span class=\"base\"><span class=\"strut\" style=\"height:0.83333em;vertical-align:-0.15em;\"></span><span class=\"mord\"><span class=\"mord mathnormal\" style=\"margin-right:0.22222em;\">V</span><span class=\"msupsub\"><span class=\"vlist-t vlist-t2\"><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.151392em;\"><span style=\"top:-2.5500000000000003em;margin-left:-0.22222em;margin-right:0.05em;\"><span class=\"pstrut\" style=\"height:2.7em;\"></span><span class=\"sizing reset-size6 size3 mtight\"><span class=\"mord mathnormal mtight\">e</span></span></span></span><span class=\"vlist-s\">â€‹</span></span><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.15em;\"><span></span></span></span></span></span></span></span></span></span> çŸ©é˜µï¼›</li>\n<li>è¾“å…¥ â€œI am a studentâ€ åˆ° Decoders ï¼Œé¦–å…ˆé€šè¿‡ Masked Multi-head Attention å±‚å¾—åˆ° â€œI am a studentâ€ çš„ attention å€¼ <span class=\"katex\"><span class=\"katex-mathml\"><math xmlns=\"http://www.w3.org/1998/Math/MathML\"><semantics><mrow><msub><mi>Q</mi><mi>d</mi></msub></mrow><annotation encoding=\"application/x-tex\">Q_d</annotation></semantics></math></span><span class=\"katex-html\" aria-hidden=\"true\"><span class=\"base\"><span class=\"strut\" style=\"height:0.8777699999999999em;vertical-align:-0.19444em;\"></span><span class=\"mord\"><span class=\"mord mathnormal\">Q</span><span class=\"msupsub\"><span class=\"vlist-t vlist-t2\"><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.33610799999999996em;\"><span style=\"top:-2.5500000000000003em;margin-left:0em;margin-right:0.05em;\"><span class=\"pstrut\" style=\"height:2.7em;\"></span><span class=\"sizing reset-size6 size3 mtight\"><span class=\"mord mathnormal mtight\">d</span></span></span></span><span class=\"vlist-s\">â€‹</span></span><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.15em;\"><span></span></span></span></span></span></span></span></span></span>ï¼Œç„¶åç”¨ attention å€¼ <span class=\"katex\"><span class=\"katex-mathml\"><math xmlns=\"http://www.w3.org/1998/Math/MathML\"><semantics><mrow><msub><mi>Q</mi><mi>d</mi></msub></mrow><annotation encoding=\"application/x-tex\">Q_d</annotation></semantics></math></span><span class=\"katex-html\" aria-hidden=\"true\"><span class=\"base\"><span class=\"strut\" style=\"height:0.8777699999999999em;vertical-align:-0.19444em;\"></span><span class=\"mord\"><span class=\"mord mathnormal\">Q</span><span class=\"msupsub\"><span class=\"vlist-t vlist-t2\"><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.33610799999999996em;\"><span style=\"top:-2.5500000000000003em;margin-left:0em;margin-right:0.05em;\"><span class=\"pstrut\" style=\"height:2.7em;\"></span><span class=\"sizing reset-size6 size3 mtight\"><span class=\"mord mathnormal mtight\">d</span></span></span></span><span class=\"vlist-s\">â€‹</span></span><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.15em;\"><span></span></span></span></span></span></span></span></span></span> å’Œ Encoders çš„è¾“å‡º <span class=\"katex\"><span class=\"katex-mathml\"><math xmlns=\"http://www.w3.org/1998/Math/MathML\"><semantics><mrow><msub><mi>K</mi><mi>e</mi></msub></mrow><annotation encoding=\"application/x-tex\">K_e</annotation></semantics></math></span><span class=\"katex-html\" aria-hidden=\"true\"><span class=\"base\"><span class=\"strut\" style=\"height:0.83333em;vertical-align:-0.15em;\"></span><span class=\"mord\"><span class=\"mord mathnormal\" style=\"margin-right:0.07153em;\">K</span><span class=\"msupsub\"><span class=\"vlist-t vlist-t2\"><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.151392em;\"><span style=\"top:-2.5500000000000003em;margin-left:-0.07153em;margin-right:0.05em;\"><span class=\"pstrut\" style=\"height:2.7em;\"></span><span class=\"sizing reset-size6 size3 mtight\"><span class=\"mord mathnormal mtight\">e</span></span></span></span><span class=\"vlist-s\">â€‹</span></span><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.15em;\"><span></span></span></span></span></span></span></span></span></span>ã€<span class=\"katex\"><span class=\"katex-mathml\"><math xmlns=\"http://www.w3.org/1998/Math/MathML\"><semantics><mrow><msub><mi>V</mi><mi>e</mi></msub></mrow><annotation encoding=\"application/x-tex\">V_e</annotation></semantics></math></span><span class=\"katex-html\" aria-hidden=\"true\"><span class=\"base\"><span class=\"strut\" style=\"height:0.83333em;vertical-align:-0.15em;\"></span><span class=\"mord\"><span class=\"mord mathnormal\" style=\"margin-right:0.22222em;\">V</span><span class=\"msupsub\"><span class=\"vlist-t vlist-t2\"><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.151392em;\"><span style=\"top:-2.5500000000000003em;margin-left:-0.22222em;margin-right:0.05em;\"><span class=\"pstrut\" style=\"height:2.7em;\"></span><span class=\"sizing reset-size6 size3 mtight\"><span class=\"mord mathnormal mtight\">e</span></span></span></span><span class=\"vlist-s\">â€‹</span></span><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.15em;\"><span></span></span></span></span></span></span></span></span></span> çŸ©é˜µè¿›è¡Œ attention è®¡ç®—ï¼Œå¾—åˆ°ç¬¬ 1 ä¸ªè¾“å‡º â€œIâ€ï¼›</li>\n<li>è¾“å…¥ â€œI am a studentâ€ åˆ° Decoders ï¼Œé¦–å…ˆé€šè¿‡ Masked Multi-head Attention å±‚å¾—åˆ° â€œI am a studentâ€ çš„ attention å€¼ <span class=\"katex\"><span class=\"katex-mathml\"><math xmlns=\"http://www.w3.org/1998/Math/MathML\"><semantics><mrow><msub><mi>Q</mi><mi>d</mi></msub></mrow><annotation encoding=\"application/x-tex\">Q_d</annotation></semantics></math></span><span class=\"katex-html\" aria-hidden=\"true\"><span class=\"base\"><span class=\"strut\" style=\"height:0.8777699999999999em;vertical-align:-0.19444em;\"></span><span class=\"mord\"><span class=\"mord mathnormal\">Q</span><span class=\"msupsub\"><span class=\"vlist-t vlist-t2\"><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.33610799999999996em;\"><span style=\"top:-2.5500000000000003em;margin-left:0em;margin-right:0.05em;\"><span class=\"pstrut\" style=\"height:2.7em;\"></span><span class=\"sizing reset-size6 size3 mtight\"><span class=\"mord mathnormal mtight\">d</span></span></span></span><span class=\"vlist-s\">â€‹</span></span><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.15em;\"><span></span></span></span></span></span></span></span></span></span>ï¼Œç„¶åç”¨ attention å€¼ <span class=\"katex\"><span class=\"katex-mathml\"><math xmlns=\"http://www.w3.org/1998/Math/MathML\"><semantics><mrow><msub><mi>Q</mi><mi>d</mi></msub></mrow><annotation encoding=\"application/x-tex\">Q_d</annotation></semantics></math></span><span class=\"katex-html\" aria-hidden=\"true\"><span class=\"base\"><span class=\"strut\" style=\"height:0.8777699999999999em;vertical-align:-0.19444em;\"></span><span class=\"mord\"><span class=\"mord mathnormal\">Q</span><span class=\"msupsub\"><span class=\"vlist-t vlist-t2\"><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.33610799999999996em;\"><span style=\"top:-2.5500000000000003em;margin-left:0em;margin-right:0.05em;\"><span class=\"pstrut\" style=\"height:2.7em;\"></span><span class=\"sizing reset-size6 size3 mtight\"><span class=\"mord mathnormal mtight\">d</span></span></span></span><span class=\"vlist-s\">â€‹</span></span><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.15em;\"><span></span></span></span></span></span></span></span></span></span> å’Œ Encoders çš„è¾“å‡º <span class=\"katex\"><span class=\"katex-mathml\"><math xmlns=\"http://www.w3.org/1998/Math/MathML\"><semantics><mrow><msub><mi>K</mi><mi>e</mi></msub></mrow><annotation encoding=\"application/x-tex\">K_e</annotation></semantics></math></span><span class=\"katex-html\" aria-hidden=\"true\"><span class=\"base\"><span class=\"strut\" style=\"height:0.83333em;vertical-align:-0.15em;\"></span><span class=\"mord\"><span class=\"mord mathnormal\" style=\"margin-right:0.07153em;\">K</span><span class=\"msupsub\"><span class=\"vlist-t vlist-t2\"><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.151392em;\"><span style=\"top:-2.5500000000000003em;margin-left:-0.07153em;margin-right:0.05em;\"><span class=\"pstrut\" style=\"height:2.7em;\"></span><span class=\"sizing reset-size6 size3 mtight\"><span class=\"mord mathnormal mtight\">e</span></span></span></span><span class=\"vlist-s\">â€‹</span></span><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.15em;\"><span></span></span></span></span></span></span></span></span></span>ã€<span class=\"katex\"><span class=\"katex-mathml\"><math xmlns=\"http://www.w3.org/1998/Math/MathML\"><semantics><mrow><msub><mi>V</mi><mi>e</mi></msub></mrow><annotation encoding=\"application/x-tex\">V_e</annotation></semantics></math></span><span class=\"katex-html\" aria-hidden=\"true\"><span class=\"base\"><span class=\"strut\" style=\"height:0.83333em;vertical-align:-0.15em;\"></span><span class=\"mord\"><span class=\"mord mathnormal\" style=\"margin-right:0.22222em;\">V</span><span class=\"msupsub\"><span class=\"vlist-t vlist-t2\"><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.151392em;\"><span style=\"top:-2.5500000000000003em;margin-left:-0.22222em;margin-right:0.05em;\"><span class=\"pstrut\" style=\"height:2.7em;\"></span><span class=\"sizing reset-size6 size3 mtight\"><span class=\"mord mathnormal mtight\">e</span></span></span></span><span class=\"vlist-s\">â€‹</span></span><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.15em;\"><span></span></span></span></span></span></span></span></span></span> çŸ©é˜µè¿›è¡Œ attention è®¡ç®—ï¼Œå¾—åˆ°ç¬¬ 2 ä¸ªè¾“å‡º â€œamâ€ï¼›</li>\n<li>â€¦â€¦</li>\n</ol>\n<p>ç°åœ¨æˆ‘ä»¬æ¥è§£é‡Šæˆ‘ä»¬ä¹‹å‰é—ç•™çš„ä¸¤ä¸ªé—®é¢˜ã€‚</p>\n<h2 id=\"111-ä¸ºä»€ä¹ˆ-decoder-éœ€è¦åš-mask\"><a class=\"anchor\" href=\"#111-ä¸ºä»€ä¹ˆ-decoder-éœ€è¦åš-mask\">#</a> 11.1 ä¸ºä»€ä¹ˆ Decoder éœ€è¦åš Mask</h2>\n<ul>\n<li>\n<p>è®­ç»ƒé˜¶æ®µï¼šæˆ‘ä»¬çŸ¥é“ â€œje suis etudiantâ€ çš„ç¿»è¯‘ç»“æœä¸º â€œI am a studentâ€ï¼Œæˆ‘ä»¬æŠŠ â€œI am a studentâ€ çš„ Embedding è¾“å…¥åˆ° Decoders é‡Œé¢ï¼Œç¿»è¯‘ç¬¬ä¸€ä¸ªè¯ â€œIâ€ æ—¶</p>\n<ul>\n<li>å¦‚æœå¯¹ â€œI am a studentâ€ attention è®¡ç®—ä¸åš maskï¼Œâ€œamï¼Œaï¼Œstudentâ€ å¯¹ â€œIâ€ çš„ç¿»è¯‘å°†ä¼šæœ‰ä¸€å®šçš„è´¡çŒ®</li>\n<li>å¦‚æœå¯¹ â€œI am a studentâ€ attention è®¡ç®—åš maskï¼Œâ€œamï¼Œaï¼Œstudentâ€ å¯¹ â€œIâ€ çš„ç¿»è¯‘å°†æ²¡æœ‰è´¡çŒ®</li>\n</ul>\n</li>\n<li>\n<p>æµ‹è¯•é˜¶æ®µï¼šæˆ‘ä»¬ä¸çŸ¥é“ â€œæˆ‘çˆ±ä¸­å›½â€ çš„ç¿»è¯‘ç»“æœä¸º â€œI love Chinaâ€ï¼Œæˆ‘ä»¬åªèƒ½éšæœºåˆå§‹åŒ–ä¸€ä¸ª Embedding è¾“å…¥åˆ° Decoders é‡Œé¢ï¼Œç¿»è¯‘ç¬¬ä¸€ä¸ªè¯ â€œIâ€ æ—¶ï¼š</p>\n<ul>\n<li>æ— è®ºæ˜¯å¦åš maskï¼Œâ€œloveï¼ŒChinaâ€ å¯¹ â€œIâ€ çš„ç¿»è¯‘éƒ½ä¸ä¼šäº§ç”Ÿè´¡çŒ®</li>\n<li>ä½†æ˜¯ç¿»è¯‘äº†ç¬¬ä¸€ä¸ªè¯ â€œIâ€ åï¼Œéšæœºåˆå§‹åŒ–çš„ Embedding æœ‰äº† â€œIâ€ çš„ Embeddingï¼Œä¹Ÿå°±æ˜¯è¯´åœ¨ç¿»è¯‘ç¬¬äºŒè¯ â€œloveâ€ çš„æ—¶å€™ï¼Œâ€œIâ€ çš„ Embedding å°†æœ‰ä¸€å®šçš„è´¡çŒ®ï¼Œä½†æ˜¯ â€œChinaâ€ å¯¹ â€œloveâ€ çš„ç¿»è¯‘æ¯«æ— è´¡çŒ®ï¼Œéšä¹‹ç¿»è¯‘çš„è¿›è¡Œï¼Œ<strong>å·²ç»ç¿»è¯‘çš„ç»“æœå°†ä¼šå¯¹ä¸‹ä¸€ä¸ªè¦ç¿»è¯‘çš„è¯éƒ½ä¼šæœ‰ä¸€å®šçš„è´¡çŒ®ï¼Œè¿™å°±å’Œåšäº† mask çš„è®­ç»ƒé˜¶æ®µåšåˆ°äº†ä¸€ç§åŒ¹é…</strong></li>\n</ul>\n</li>\n</ul>\n<p>æ€»ç»“ä¸‹å°±æ˜¯ï¼šDecoder åš Maskï¼Œæ˜¯ä¸ºäº†è®©è®­ç»ƒé˜¶æ®µå’Œæµ‹è¯•é˜¶æ®µè¡Œä¸ºä¸€è‡´ï¼Œä¸ä¼šå‡ºç°é—´éš™ï¼Œé¿å…è¿‡æ‹Ÿåˆ</p>\n<h2 id=\"112-ä¸ºä»€ä¹ˆ-encoder-ç»™äºˆ-decoders-çš„æ˜¯-k-v-çŸ©é˜µ\"><a class=\"anchor\" href=\"#112-ä¸ºä»€ä¹ˆ-encoder-ç»™äºˆ-decoders-çš„æ˜¯-k-v-çŸ©é˜µ\">#</a> 11.2 ä¸ºä»€ä¹ˆ Encoder ç»™äºˆ Decoders çš„æ˜¯ Kã€V çŸ©é˜µ</h2>\n<p>æˆ‘ä»¬åœ¨è®²è§£ Attention æœºåˆ¶ä¸­æ›¾æåˆ°ï¼ŒQuery çš„ç›®çš„æ˜¯å€ŸåŠ©å®ƒä»ä¸€å †ä¿¡æ¯ä¸­æ‰¾åˆ°é‡è¦çš„ä¿¡æ¯ã€‚</p>\n<p>ç°åœ¨ Encoder æä¾›äº† <span class=\"katex\"><span class=\"katex-mathml\"><math xmlns=\"http://www.w3.org/1998/Math/MathML\"><semantics><mrow><msub><mi>K</mi><mi>e</mi></msub><mtext>ã€</mtext><msub><mi>V</mi><mi>e</mi></msub></mrow><annotation encoding=\"application/x-tex\">K_eã€V_e</annotation></semantics></math></span><span class=\"katex-html\" aria-hidden=\"true\"><span class=\"base\"><span class=\"strut\" style=\"height:0.83333em;vertical-align:-0.15em;\"></span><span class=\"mord\"><span class=\"mord mathnormal\" style=\"margin-right:0.07153em;\">K</span><span class=\"msupsub\"><span class=\"vlist-t vlist-t2\"><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.151392em;\"><span style=\"top:-2.5500000000000003em;margin-left:-0.07153em;margin-right:0.05em;\"><span class=\"pstrut\" style=\"height:2.7em;\"></span><span class=\"sizing reset-size6 size3 mtight\"><span class=\"mord mathnormal mtight\">e</span></span></span></span><span class=\"vlist-s\">â€‹</span></span><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.15em;\"><span></span></span></span></span></span></span><span class=\"mord cjk_fallback\">ã€</span><span class=\"mord\"><span class=\"mord mathnormal\" style=\"margin-right:0.22222em;\">V</span><span class=\"msupsub\"><span class=\"vlist-t vlist-t2\"><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.151392em;\"><span style=\"top:-2.5500000000000003em;margin-left:-0.22222em;margin-right:0.05em;\"><span class=\"pstrut\" style=\"height:2.7em;\"></span><span class=\"sizing reset-size6 size3 mtight\"><span class=\"mord mathnormal mtight\">e</span></span></span></span><span class=\"vlist-s\">â€‹</span></span><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.15em;\"><span></span></span></span></span></span></span></span></span></span> çŸ©é˜µï¼ŒDecoder æä¾›äº† <span class=\"katex\"><span class=\"katex-mathml\"><math xmlns=\"http://www.w3.org/1998/Math/MathML\"><semantics><mrow><msub><mi>Q</mi><mi>d</mi></msub></mrow><annotation encoding=\"application/x-tex\">Q_d</annotation></semantics></math></span><span class=\"katex-html\" aria-hidden=\"true\"><span class=\"base\"><span class=\"strut\" style=\"height:0.8777699999999999em;vertical-align:-0.19444em;\"></span><span class=\"mord\"><span class=\"mord mathnormal\">Q</span><span class=\"msupsub\"><span class=\"vlist-t vlist-t2\"><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.33610799999999996em;\"><span style=\"top:-2.5500000000000003em;margin-left:0em;margin-right:0.05em;\"><span class=\"pstrut\" style=\"height:2.7em;\"></span><span class=\"sizing reset-size6 size3 mtight\"><span class=\"mord mathnormal mtight\">d</span></span></span></span><span class=\"vlist-s\">â€‹</span></span><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.15em;\"><span></span></span></span></span></span></span></span></span></span> çŸ©é˜µï¼Œé€šè¿‡ â€œæˆ‘çˆ±ä¸­å›½â€ ç¿»è¯‘ä¸º â€œI love Chinaâ€ è¿™å¥è¯è¯¦ç»†è§£é‡Šä¸‹ã€‚</p>\n<p>å½“æˆ‘ä»¬ç¿»è¯‘ â€œIâ€ çš„æ—¶å€™ï¼Œç”±äº Decoder æä¾›äº† <span class=\"katex\"><span class=\"katex-mathml\"><math xmlns=\"http://www.w3.org/1998/Math/MathML\"><semantics><mrow><msub><mi>Q</mi><mi>d</mi></msub></mrow><annotation encoding=\"application/x-tex\">Q_d</annotation></semantics></math></span><span class=\"katex-html\" aria-hidden=\"true\"><span class=\"base\"><span class=\"strut\" style=\"height:0.8777699999999999em;vertical-align:-0.19444em;\"></span><span class=\"mord\"><span class=\"mord mathnormal\">Q</span><span class=\"msupsub\"><span class=\"vlist-t vlist-t2\"><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.33610799999999996em;\"><span style=\"top:-2.5500000000000003em;margin-left:0em;margin-right:0.05em;\"><span class=\"pstrut\" style=\"height:2.7em;\"></span><span class=\"sizing reset-size6 size3 mtight\"><span class=\"mord mathnormal mtight\">d</span></span></span></span><span class=\"vlist-s\">â€‹</span></span><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.15em;\"><span></span></span></span></span></span></span></span></span></span> çŸ©é˜µï¼Œé€šè¿‡ä¸ <span class=\"katex\"><span class=\"katex-mathml\"><math xmlns=\"http://www.w3.org/1998/Math/MathML\"><semantics><mrow><msub><mi>K</mi><mi>e</mi></msub><mtext>ã€</mtext><msub><mi>V</mi><mi>e</mi></msub></mrow><annotation encoding=\"application/x-tex\">K_eã€V_e</annotation></semantics></math></span><span class=\"katex-html\" aria-hidden=\"true\"><span class=\"base\"><span class=\"strut\" style=\"height:0.83333em;vertical-align:-0.15em;\"></span><span class=\"mord\"><span class=\"mord mathnormal\" style=\"margin-right:0.07153em;\">K</span><span class=\"msupsub\"><span class=\"vlist-t vlist-t2\"><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.151392em;\"><span style=\"top:-2.5500000000000003em;margin-left:-0.07153em;margin-right:0.05em;\"><span class=\"pstrut\" style=\"height:2.7em;\"></span><span class=\"sizing reset-size6 size3 mtight\"><span class=\"mord mathnormal mtight\">e</span></span></span></span><span class=\"vlist-s\">â€‹</span></span><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.15em;\"><span></span></span></span></span></span></span><span class=\"mord cjk_fallback\">ã€</span><span class=\"mord\"><span class=\"mord mathnormal\" style=\"margin-right:0.22222em;\">V</span><span class=\"msupsub\"><span class=\"vlist-t vlist-t2\"><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.151392em;\"><span style=\"top:-2.5500000000000003em;margin-left:-0.22222em;margin-right:0.05em;\"><span class=\"pstrut\" style=\"height:2.7em;\"></span><span class=\"sizing reset-size6 size3 mtight\"><span class=\"mord mathnormal mtight\">e</span></span></span></span><span class=\"vlist-s\">â€‹</span></span><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.15em;\"><span></span></span></span></span></span></span></span></span></span> çŸ©é˜µçš„è®¡ç®—ï¼Œå®ƒå¯ä»¥åœ¨ â€œæˆ‘çˆ±ä¸­å›½â€ è¿™å››ä¸ªå­—ä¸­æ‰¾åˆ°å¯¹ â€œIâ€ ç¿»è¯‘æœ€æœ‰ç”¨çš„å•è¯æ˜¯å“ªå‡ ä¸ªï¼Œå¹¶ä»¥æ­¤ä¸ºä¾æ®ç¿»è¯‘å‡º â€œIâ€ è¿™ä¸ªå•è¯ï¼Œè¿™å°±å¾ˆå¥½çš„ä½“ç°äº†æ³¨æ„åŠ›æœºåˆ¶æƒ³è¦è¾¾åˆ°çš„ç›®çš„ï¼ŒæŠŠç„¦ç‚¹æ”¾åœ¨å¯¹è‡ªå·±è€Œè¨€æ›´ä¸ºé‡è¦çš„ä¿¡æ¯ä¸Šã€‚</p>\n<ul>\n<li>å…¶å®ä¸Šè¿°è¯´çš„å°±æ˜¯ Attention é‡Œçš„ soft attention æœºåˆ¶ï¼Œè§£å†³äº†æ›¾ç»çš„ Encoder-Decoder æ¡†æ¶çš„ä¸€ä¸ªé—®é¢˜ï¼Œåœ¨è¿™é‡Œä¸å¤šåšå™è¿°ï¼Œæœ‰å…´è¶£çš„å¯ä»¥å‚è€ƒç½‘ä¸Šçš„ä¸€äº›èµ„æ–™ã€‚\n<ul>\n<li>æ—©æœŸçš„ Encoder-Decoder æ¡†æ¶ä¸­çš„ Encoder é€šè¿‡ LSTM æå–å‡ºæºå¥ï¼ˆSourceï¼‰ â€œæˆ‘çˆ±ä¸­å›½â€ çš„ç‰¹å¾ä¿¡æ¯ Cï¼Œç„¶å Decoder åšç¿»è¯‘çš„æ—¶å€™ï¼Œç›®æ ‡å¥ï¼ˆTargetï¼‰â€œI love Chinaâ€ ä¸­çš„ä»»ä½•ä¸€ä¸ªå•è¯çš„ç¿»è¯‘éƒ½æ¥æºäºç›¸åŒç‰¹å¾ä¿¡æ¯ Cï¼Œè¿™ç§åšæ³•æ˜¯æå…¶ä¸åˆç†çš„ï¼Œä¾‹å¦‚ç¿»è¯‘ â€œIâ€ æ—¶åº”è¯¥ç€çœ¼äº â€œæˆ‘â€ï¼Œç¿»è¯‘ â€œChinaâ€ åº”è¯¥ç€çœ¼äº â€œä¸­å›½â€ï¼Œè€Œæ—©æœŸçš„è¿™ç§åšæ³•å¹¶æ²¡æœ‰ä½“ç°å‡ºï¼Œç„¶è€Œ Transformer å´é€šè¿‡ Attention çš„åšæ³•è§£å†³äº†è¿™ä¸ªé—®é¢˜ã€‚</li>\n</ul>\n</li>\n</ul>\n<h1 id=\"åäºŒ-gpt-æ¨¡å‹\"><a class=\"anchor\" href=\"#åäºŒ-gpt-æ¨¡å‹\">#</a> åäºŒã€GPT æ¨¡å‹</h1>\n<h2 id=\"121-gpt-æ¨¡å‹çš„é¢„è®­ç»ƒ\"><a class=\"anchor\" href=\"#121-gpt-æ¨¡å‹çš„é¢„è®­ç»ƒ\">#</a> 12.1 GPT æ¨¡å‹çš„é¢„è®­ç»ƒ</h2>\n<p>åœ¨è®²è§£ ELMo çš„æ—¶å€™ï¼Œæˆ‘ä»¬è¯´åˆ° ELMo è¿™ä¸€ç±»é¢„è®­ç»ƒçš„æ–¹æ³•è¢«ç§°ä¸º â€œFeature-based Pre-Trainingâ€ã€‚å¹¶ä¸”å¦‚æœæŠŠ ELMo è¿™ç§é¢„è®­ç»ƒæ–¹æ³•å’Œå›¾åƒé¢†åŸŸçš„é¢„è®­ç»ƒæ–¹æ³•å¯¹æ¯”ï¼Œå‘ç°ä¸¤è€…æ¨¡å¼çœ‹ä¸Šå»è¿˜æ˜¯æœ‰å¾ˆå¤§å·®å¼‚çš„ã€‚</p>\n<p>é™¤äº†ä»¥ ELMo ä¸ºä»£è¡¨çš„è¿™ç§åŸºäºç‰¹å¾èåˆçš„é¢„è®­ç»ƒæ–¹æ³•å¤–ï¼ŒNLP é‡Œè¿˜æœ‰ä¸€ç§å…¸å‹åšæ³•ï¼Œè¿™ç§åšæ³•å’Œå›¾åƒé¢†åŸŸçš„æ–¹å¼å°±æ˜¯çœ‹ä¸Šå»ä¸€è‡´çš„äº†ï¼Œä¸€èˆ¬å°†è¿™ç§æ–¹æ³•ç§°ä¸º â€œåŸºäº Fine-tuning çš„æ¨¡å¼â€ï¼Œè€Œ GPT å°±æ˜¯è¿™ä¸€æ¨¡å¼çš„å…¸å‹å¼€åˆ›è€…ï¼Œä¸‹é¢å…ˆè®©æˆ‘ä»¬çœ‹çœ‹ GPT çš„ç½‘ç»œç»“æ„ã€‚</p>\n<p>&lt;img src=&quot;<span class=\"exturl\" data-url=\"aHR0cHM6Ly9pbWdtZC5vc3MtY24tc2hhbmdoYWkuYWxpeXVuY3MuY29tL0JFUlRfSU1HL2dwdC0lRTYlQTglQTElRTUlOUUlOEIuanBn\">https://imgmd.oss-cn-shanghai.aliyuncs.com/BERT_IMG/gpt - æ¨¡å‹.jpg</span>&quot; style=&quot;zoom:50%;&quot; /&gt;</p>\n<p>GPT æ˜¯ â€œGenerative Pre-Trainingâ€ çš„ç®€ç§°ï¼Œä»åå­—çœ‹å…¶å«ä¹‰æ˜¯æŒ‡çš„ç”Ÿæˆå¼çš„é¢„è®­ç»ƒã€‚</p>\n<p>GPT ä¹Ÿé‡‡ç”¨ä¸¤é˜¶æ®µè¿‡ç¨‹ï¼š</p>\n<ol>\n<li>ç¬¬ä¸€ä¸ªé˜¶æ®µï¼šåˆ©ç”¨è¯­è¨€æ¨¡å‹è¿›è¡Œé¢„è®­ç»ƒï¼›</li>\n<li>ç¬¬äºŒä¸ªé˜¶æ®µï¼šé€šè¿‡ Fine-tuning çš„æ¨¡å¼è§£å†³ä¸‹æ¸¸ä»»åŠ¡ã€‚</li>\n</ol>\n<p>ä¸Šå›¾å±•ç¤ºäº† GPT çš„é¢„è®­ç»ƒè¿‡ç¨‹ï¼Œå…¶å®å’Œ ELMo æ˜¯ç±»ä¼¼çš„ï¼Œä¸»è¦ä¸åŒåœ¨äºä¸¤ç‚¹ï¼š</p>\n<ol>\n<li>é¦–å…ˆï¼Œç‰¹å¾æŠ½å–å™¨ç”¨çš„ä¸æ˜¯ RNNï¼Œè€Œæ˜¯ç”¨çš„ Transformerï¼Œå®ƒçš„ç‰¹å¾æŠ½å–èƒ½åŠ›è¦å¼ºäº RNNï¼Œè¿™ä¸ªé€‰æ‹©å¾ˆæ˜æ˜¾æ˜¯å¾ˆæ˜æ™ºçš„ï¼›</li>\n<li>å…¶æ¬¡ï¼Œ\n<ol>\n<li>GPT çš„é¢„è®­ç»ƒè™½ç„¶ä»ç„¶æ˜¯ä»¥è¯­è¨€æ¨¡å‹ä½œä¸ºç›®æ ‡ä»»åŠ¡ï¼Œä½†æ˜¯é‡‡ç”¨çš„æ˜¯å•å‘çš„è¯­è¨€æ¨¡å‹ï¼Œæ‰€è°“ â€œå•å‘â€ çš„å«ä¹‰æ˜¯æŒ‡ï¼šè¯­è¨€æ¨¡å‹è®­ç»ƒçš„ä»»åŠ¡ç›®æ ‡æ˜¯æ ¹æ® <span class=\"katex\"><span class=\"katex-mathml\"><math xmlns=\"http://www.w3.org/1998/Math/MathML\"><semantics><mrow><msub><mi>w</mi><mi>i</mi></msub></mrow><annotation encoding=\"application/x-tex\">w_i</annotation></semantics></math></span><span class=\"katex-html\" aria-hidden=\"true\"><span class=\"base\"><span class=\"strut\" style=\"height:0.58056em;vertical-align:-0.15em;\"></span><span class=\"mord\"><span class=\"mord mathnormal\" style=\"margin-right:0.02691em;\">w</span><span class=\"msupsub\"><span class=\"vlist-t vlist-t2\"><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.31166399999999994em;\"><span style=\"top:-2.5500000000000003em;margin-left:-0.02691em;margin-right:0.05em;\"><span class=\"pstrut\" style=\"height:2.7em;\"></span><span class=\"sizing reset-size6 size3 mtight\"><span class=\"mord mathnormal mtight\">i</span></span></span></span><span class=\"vlist-s\">â€‹</span></span><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.15em;\"><span></span></span></span></span></span></span></span></span></span> å•è¯çš„ä¸Šä¸‹æ–‡å»æ­£ç¡®é¢„æµ‹å•è¯ <span class=\"katex\"><span class=\"katex-mathml\"><math xmlns=\"http://www.w3.org/1998/Math/MathML\"><semantics><mrow><msub><mi>w</mi><mi>i</mi></msub></mrow><annotation encoding=\"application/x-tex\">w_i</annotation></semantics></math></span><span class=\"katex-html\" aria-hidden=\"true\"><span class=\"base\"><span class=\"strut\" style=\"height:0.58056em;vertical-align:-0.15em;\"></span><span class=\"mord\"><span class=\"mord mathnormal\" style=\"margin-right:0.02691em;\">w</span><span class=\"msupsub\"><span class=\"vlist-t vlist-t2\"><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.31166399999999994em;\"><span style=\"top:-2.5500000000000003em;margin-left:-0.02691em;margin-right:0.05em;\"><span class=\"pstrut\" style=\"height:2.7em;\"></span><span class=\"sizing reset-size6 size3 mtight\"><span class=\"mord mathnormal mtight\">i</span></span></span></span><span class=\"vlist-s\">â€‹</span></span><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.15em;\"><span></span></span></span></span></span></span></span></span></span> ï¼Œ <span class=\"katex\"><span class=\"katex-mathml\"><math xmlns=\"http://www.w3.org/1998/Math/MathML\"><semantics><mrow><msub><mi>w</mi><mi>i</mi></msub></mrow><annotation encoding=\"application/x-tex\">w_i</annotation></semantics></math></span><span class=\"katex-html\" aria-hidden=\"true\"><span class=\"base\"><span class=\"strut\" style=\"height:0.58056em;vertical-align:-0.15em;\"></span><span class=\"mord\"><span class=\"mord mathnormal\" style=\"margin-right:0.02691em;\">w</span><span class=\"msupsub\"><span class=\"vlist-t vlist-t2\"><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.31166399999999994em;\"><span style=\"top:-2.5500000000000003em;margin-left:-0.02691em;margin-right:0.05em;\"><span class=\"pstrut\" style=\"height:2.7em;\"></span><span class=\"sizing reset-size6 size3 mtight\"><span class=\"mord mathnormal mtight\">i</span></span></span></span><span class=\"vlist-s\">â€‹</span></span><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.15em;\"><span></span></span></span></span></span></span></span></span></span> ä¹‹å‰çš„å•è¯åºåˆ— Context-before ç§°ä¸ºä¸Šæ–‡ï¼Œä¹‹åçš„å•è¯åºåˆ— Context-after ç§°ä¸ºä¸‹æ–‡ã€‚</li>\n<li>ELMo åœ¨åšè¯­è¨€æ¨¡å‹é¢„è®­ç»ƒçš„æ—¶å€™ï¼Œé¢„æµ‹å•è¯ <span class=\"katex\"><span class=\"katex-mathml\"><math xmlns=\"http://www.w3.org/1998/Math/MathML\"><semantics><mrow><msub><mi>w</mi><mi>i</mi></msub></mrow><annotation encoding=\"application/x-tex\">w_i</annotation></semantics></math></span><span class=\"katex-html\" aria-hidden=\"true\"><span class=\"base\"><span class=\"strut\" style=\"height:0.58056em;vertical-align:-0.15em;\"></span><span class=\"mord\"><span class=\"mord mathnormal\" style=\"margin-right:0.02691em;\">w</span><span class=\"msupsub\"><span class=\"vlist-t vlist-t2\"><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.31166399999999994em;\"><span style=\"top:-2.5500000000000003em;margin-left:-0.02691em;margin-right:0.05em;\"><span class=\"pstrut\" style=\"height:2.7em;\"></span><span class=\"sizing reset-size6 size3 mtight\"><span class=\"mord mathnormal mtight\">i</span></span></span></span><span class=\"vlist-s\">â€‹</span></span><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.15em;\"><span></span></span></span></span></span></span></span></span></span> åŒæ—¶ä½¿ç”¨äº†ä¸Šæ–‡å’Œä¸‹æ–‡ï¼Œè€Œ GPT åˆ™åªé‡‡ç”¨ Context-before è¿™ä¸ªå•è¯çš„ä¸Šæ–‡æ¥è¿›è¡Œé¢„æµ‹ï¼Œè€ŒæŠ›å¼€äº†ä¸‹æ–‡ã€‚</li>\n<li>GPT è¿™ä¸ªé€‰æ‹©ç°åœ¨çœ‹ä¸æ˜¯ä¸ªå¤ªå¥½çš„é€‰æ‹©ï¼ŒåŸå› å¾ˆç®€å•ï¼Œå®ƒæ²¡æœ‰æŠŠå•è¯çš„ä¸‹æ–‡èåˆè¿›æ¥ï¼Œè¿™é™åˆ¶äº†å…¶åœ¨æ›´å¤šåº”ç”¨åœºæ™¯çš„æ•ˆæœï¼Œæ¯”å¦‚é˜…è¯»ç†è§£è¿™ç§ä»»åŠ¡ï¼Œåœ¨åšä»»åŠ¡çš„æ—¶å€™æ˜¯å¯ä»¥å…è®¸åŒæ—¶çœ‹åˆ°ä¸Šæ–‡å’Œä¸‹æ–‡ä¸€èµ·åšå†³ç­–çš„ã€‚å¦‚æœé¢„è®­ç»ƒæ—¶å€™ä¸æŠŠå•è¯çš„ä¸‹æ–‡åµŒå…¥åˆ° Word Embedding ä¸­ï¼Œæ˜¯å¾ˆåƒäºçš„ï¼Œç™½ç™½ä¸¢æ‰äº†å¾ˆå¤šä¿¡æ¯ã€‚</li>\n</ol>\n</li>\n</ol>\n<h2 id=\"122-gpt-æ¨¡å‹çš„-fine-tuning\"><a class=\"anchor\" href=\"#122-gpt-æ¨¡å‹çš„-fine-tuning\">#</a> 12.2 GPT æ¨¡å‹çš„ Fine-tuning</h2>\n<p>ä¸Šé¢è®²çš„æ˜¯ GPT å¦‚ä½•è¿›è¡Œç¬¬ä¸€é˜¶æ®µçš„é¢„è®­ç»ƒï¼Œé‚£ä¹ˆå‡è®¾é¢„è®­ç»ƒå¥½äº†ç½‘ç»œæ¨¡å‹ï¼Œåé¢ä¸‹æ¸¸ä»»åŠ¡æ€ä¹ˆç”¨ï¼Ÿå®ƒæœ‰è‡ªå·±çš„ä¸ªæ€§ï¼Œå’Œ ELMO çš„æ–¹å¼å¤§æœ‰ä¸åŒã€‚</p>\n<p>&lt;img src=&quot;<span class=\"exturl\" data-url=\"aHR0cHM6Ly9pbWdtZC5vc3MtY24tc2hhbmdoYWkuYWxpeXVuY3MuY29tL0JFUlRfSU1HL2dwdC1maW5lLmpwZw==\">https://imgmd.oss-cn-shanghai.aliyuncs.com/BERT_IMG/gpt-fine.jpg</span>&quot; style=&quot;zoom:50%;&quot; /&gt;</p>\n<p>ä¸Šå›¾å±•ç¤ºäº† GPT åœ¨ç¬¬äºŒé˜¶æ®µå¦‚ä½•ä½¿ç”¨ï¼š</p>\n<ol>\n<li>\n<p>é¦–å…ˆï¼Œå¯¹äºä¸åŒçš„ä¸‹æ¸¸ä»»åŠ¡æ¥è¯´ï¼Œæœ¬æ¥ä½ å¯ä»¥ä»»æ„è®¾è®¡è‡ªå·±çš„ç½‘ç»œç»“æ„ï¼Œç°åœ¨ä¸è¡Œäº†ï¼Œä½ è¦å‘ GPT çš„ç½‘ç»œç»“æ„çœ‹é½ï¼ŒæŠŠä»»åŠ¡çš„ç½‘ç»œç»“æ„æ”¹é€ æˆå’Œ GPT ä¸€æ ·çš„ç½‘ç»œç»“æ„ã€‚</p>\n</li>\n<li>\n<p>ç„¶åï¼Œåœ¨åšä¸‹æ¸¸ä»»åŠ¡çš„æ—¶å€™ï¼Œåˆ©ç”¨ç¬¬ä¸€æ­¥é¢„è®­ç»ƒå¥½çš„å‚æ•°åˆå§‹åŒ– GPT çš„ç½‘ç»œç»“æ„ï¼Œè¿™æ ·é€šè¿‡é¢„è®­ç»ƒå­¦åˆ°çš„è¯­è¨€å­¦çŸ¥è¯†å°±è¢«å¼•å…¥åˆ°ä½ æ‰‹å¤´çš„ä»»åŠ¡é‡Œæ¥äº†ã€‚</p>\n</li>\n<li>\n<p>å†æ¬¡ï¼Œä½ å¯ä»¥ç”¨æ‰‹å¤´çš„ä»»åŠ¡å»è®­ç»ƒè¿™ä¸ªç½‘ç»œï¼Œå¯¹ç½‘ç»œå‚æ•°è¿›è¡Œ Fine-tuningï¼Œä½¿å¾—è¿™ä¸ªç½‘ç»œæ›´é€‚åˆè§£å†³æ‰‹å¤´çš„é—®é¢˜ã€‚å°±æ˜¯è¿™æ ·ã€‚</p>\n</li>\n</ol>\n<p>è¿™æœ‰æ²¡æœ‰è®©ä½ æƒ³èµ·æœ€å¼€å§‹æåˆ°çš„å›¾åƒé¢†åŸŸå¦‚ä½•åšé¢„è®­ç»ƒçš„è¿‡ç¨‹ï¼Œå¯¹ï¼Œè¿™è·Ÿé‚£ä¸ªé¢„è®­ç»ƒçš„æ¨¡å¼æ˜¯ä¸€æ¨¡ä¸€æ ·çš„ã€‚</p>\n<p>å¯¹äº NLP å„ç§èŠ±æ ·çš„ä¸åŒä»»åŠ¡ï¼Œæ€ä¹ˆæ”¹é€ æ‰èƒ½é è¿‘ GPT çš„ç½‘ç»œç»“æ„å‘¢ï¼Ÿç”±äº GPT å¯¹ä¸‹æ¸¸ä»»åŠ¡çš„æ”¹é€ è¿‡ç¨‹å’Œ BERT å¯¹ä¸‹æ¸¸ä»»åŠ¡çš„æ”¹é€ æå…¶ç±»ä¼¼ï¼Œå¹¶ä¸”æˆ‘ä»¬ä¸»è¦ç›®çš„æ˜¯ä¸ºäº†è®²è§£ BERTï¼Œæ‰€ä»¥è¿™ä¸ªé—®é¢˜å°†ä¼šåœ¨ BERT é‚£é‡Œå¾—åˆ°å›ç­”ã€‚</p>\n<h1 id=\"åä¸‰-bert-æ¨¡å‹\"><a class=\"anchor\" href=\"#åä¸‰-bert-æ¨¡å‹\">#</a> åä¸‰ã€BERT æ¨¡å‹</h1>\n<h2 id=\"131-bertå…¬è®¤çš„é‡Œç¨‹ç¢‘\"><a class=\"anchor\" href=\"#131-bertå…¬è®¤çš„é‡Œç¨‹ç¢‘\">#</a> 13.1 BERTï¼šå…¬è®¤çš„é‡Œç¨‹ç¢‘</h2>\n<p>BERT æ¨¡å‹å¯ä»¥ä½œä¸ºå…¬è®¤çš„é‡Œç¨‹ç¢‘å¼çš„æ¨¡å‹ï¼Œä½†æ˜¯å®ƒæœ€å¤§çš„ä¼˜ç‚¹ä¸æ˜¯åˆ›æ–°ï¼Œè€Œæ˜¯é›†å¤§æˆè€…ï¼Œå¹¶ä¸”è¿™ä¸ªé›†å¤§æˆè€…æœ‰äº†å„é¡¹çªç ´ï¼Œä¸‹é¢è®©æˆ‘ä»¬çœ‹çœ‹ BERT æ˜¯æ€ä¹ˆé›†å¤§æˆè€…çš„ã€‚</p>\n<ul>\n<li>BERT çš„æ„ä¹‰åœ¨äºï¼šä»å¤§é‡æ— æ ‡è®°æ•°æ®é›†ä¸­è®­ç»ƒå¾—åˆ°çš„æ·±åº¦æ¨¡å‹ï¼Œå¯ä»¥æ˜¾è‘—æé«˜å„é¡¹è‡ªç„¶è¯­è¨€å¤„ç†ä»»åŠ¡çš„å‡†ç¡®ç‡ã€‚</li>\n<li>è¿‘å¹´æ¥ä¼˜ç§€é¢„è®­ç»ƒè¯­è¨€æ¨¡å‹çš„é›†å¤§æˆè€…ï¼šå‚è€ƒäº† ELMO æ¨¡å‹çš„åŒå‘ç¼–ç æ€æƒ³ã€å€Ÿé‰´äº† GPT ç”¨ Transformer ä½œä¸ºç‰¹å¾æå–å™¨çš„æ€è·¯ã€é‡‡ç”¨äº† word2vec æ‰€ä½¿ç”¨çš„ CBOW æ–¹æ³•</li>\n<li>BERT å’Œ GPT ä¹‹é—´çš„åŒºåˆ«ï¼š\n<ul>\n<li>GPTï¼š<strong>GPT ä½¿ç”¨ Transformer Decoder ä½œä¸ºç‰¹å¾æå–å™¨ã€å…·æœ‰è‰¯å¥½çš„æ–‡æœ¬ç”Ÿæˆèƒ½åŠ›</strong>ï¼Œç„¶è€Œå½“å‰è¯çš„è¯­ä¹‰åªèƒ½ç”±å…¶å‰åºè¯å†³å®šï¼Œå¹¶ä¸”åœ¨è¯­ä¹‰ç†è§£ä¸Šä¸è¶³</li>\n<li>BERTï¼šä½¿ç”¨äº† Transformer Encoder ä½œä¸ºç‰¹å¾æå–å™¨ï¼Œå¹¶ä½¿ç”¨äº†ä¸å…¶é…å¥—çš„æ©ç è®­ç»ƒæ–¹æ³•ã€‚<strong>è™½ç„¶ä½¿ç”¨åŒå‘ç¼–ç è®© BERT ä¸å†å…·æœ‰æ–‡æœ¬ç”Ÿæˆèƒ½åŠ›ï¼Œä½†æ˜¯ BERT çš„è¯­ä¹‰ä¿¡æ¯æå–èƒ½åŠ›æ›´å¼º</strong></li>\n</ul>\n</li>\n<li>å•å‘ç¼–ç å’ŒåŒå‘ç¼–ç çš„å·®å¼‚ï¼Œä»¥è¯¥å¥è¯ä¸¾ä¾‹ â€œä»Šå¤©å¤©æ°”å¾ˆ {}ï¼Œæˆ‘ä»¬ä¸å¾—ä¸å–æ¶ˆæˆ·å¤–è¿åŠ¨â€ï¼Œåˆ†åˆ«ä»å•å‘ç¼–ç å’ŒåŒå‘ç¼–ç çš„è§’åº¦å»è€ƒè™‘ {} ä¸­åº”è¯¥å¡«ä»€ä¹ˆè¯ï¼š\n<ul>\n<li>å•å‘ç¼–ç ï¼šå•å‘ç¼–ç åªä¼šè€ƒè™‘ â€œä»Šå¤©å¤©æ°”å¾ˆâ€ï¼Œä»¥äººç±»çš„ç»éªŒï¼Œå¤§æ¦‚ç‡ä¼šä» â€œå¥½â€ã€â€œä¸é”™â€ã€â€œå·®â€ã€â€œç³Ÿç³•â€ è¿™å‡ ä¸ªè¯ä¸­é€‰æ‹©ï¼Œè¿™äº›è¯å¯ä»¥è¢«åˆ’ä¸ºæˆªç„¶ä¸åŒçš„ä¸¤ç±»</li>\n<li>åŒå‘ç¼–ç ï¼š<strong>åŒå‘ç¼–ç ä¼šåŒæ—¶è€ƒè™‘ä¸Šä¸‹æ–‡çš„ä¿¡æ¯</strong>ï¼Œå³é™¤äº†ä¼šè€ƒè™‘ â€œä»Šå¤©å¤©æ°”å¾ˆâ€ è¿™äº”ä¸ªå­—ï¼Œè¿˜ä¼šè€ƒè™‘ â€œæˆ‘ä»¬ä¸å¾—ä¸å–æ¶ˆæˆ·å¤–è¿åŠ¨â€ æ¥å¸®åŠ©æ¨¡å‹åˆ¤æ–­ï¼Œåˆ™å¤§æ¦‚ç‡ä¼šä» â€œå·®â€ã€â€œç³Ÿç³•â€ è¿™ä¸€ç±»è¯ä¸­é€‰æ‹©</li>\n</ul>\n</li>\n</ul>\n<h2 id=\"132-bert-çš„ç»“æ„å¼ºå¤§çš„ç‰¹å¾æå–èƒ½åŠ›\"><a class=\"anchor\" href=\"#132-bert-çš„ç»“æ„å¼ºå¤§çš„ç‰¹å¾æå–èƒ½åŠ›\">#</a> 13.2 BERT çš„ç»“æ„ï¼šå¼ºå¤§çš„ç‰¹å¾æå–èƒ½åŠ›</h2>\n<ul>\n<li>\n<p>å¦‚ä¸‹å›¾æ‰€ç¤ºï¼Œæˆ‘ä»¬æ¥çœ‹çœ‹ ELMoã€GPT å’Œ BERT ä¸‰è€…çš„åŒºåˆ«</p>\n<ul>\n<li>&lt;img src=&quot;<span class=\"exturl\" data-url=\"aHR0cHM6Ly9pbWdtZC5vc3MtY24tc2hhbmdoYWkuYWxpeXVuY3MuY29tL0JFUlRfSU1HL0JFUlQtR1BULSVFNiVBRiU5NCVFOCVCRSU4My5wbmc=\">https://imgmd.oss-cn-shanghai.aliyuncs.com/BERT_IMG/BERT-GPT - æ¯”è¾ƒ.png</span>&quot; style=&quot;zoom:50%;&quot; /&gt;</li>\n<li>ELMo ä½¿ç”¨è‡ªå·¦å‘å³ç¼–ç å’Œè‡ªå³å‘å·¦ç¼–ç çš„ä¸¤ä¸ª LSTM ç½‘ç»œï¼Œåˆ†åˆ«ä»¥ <span class=\"katex\"><span class=\"katex-mathml\"><math xmlns=\"http://www.w3.org/1998/Math/MathML\"><semantics><mrow><mi>P</mi><mo stretchy=\"false\">(</mo><msub><mi>w</mi><mi>i</mi></msub><mi mathvariant=\"normal\">âˆ£</mi><msub><mi>w</mi><mn>1</mn></msub><mo separator=\"true\">,</mo><mo>â‹¯</mo><mtext>â€‰</mtext><mo separator=\"true\">,</mo><msub><mi>w</mi><mrow><mi>i</mi><mo>âˆ’</mo><mn>1</mn></mrow></msub><mo stretchy=\"false\">)</mo></mrow><annotation encoding=\"application/x-tex\">P(w_i|w_1,\\cdots,w_{i-1})</annotation></semantics></math></span><span class=\"katex-html\" aria-hidden=\"true\"><span class=\"base\"><span class=\"strut\" style=\"height:1em;vertical-align:-0.25em;\"></span><span class=\"mord mathnormal\" style=\"margin-right:0.13889em;\">P</span><span class=\"mopen\">(</span><span class=\"mord\"><span class=\"mord mathnormal\" style=\"margin-right:0.02691em;\">w</span><span class=\"msupsub\"><span class=\"vlist-t vlist-t2\"><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.31166399999999994em;\"><span style=\"top:-2.5500000000000003em;margin-left:-0.02691em;margin-right:0.05em;\"><span class=\"pstrut\" style=\"height:2.7em;\"></span><span class=\"sizing reset-size6 size3 mtight\"><span class=\"mord mathnormal mtight\">i</span></span></span></span><span class=\"vlist-s\">â€‹</span></span><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.15em;\"><span></span></span></span></span></span></span><span class=\"mord\">âˆ£</span><span class=\"mord\"><span class=\"mord mathnormal\" style=\"margin-right:0.02691em;\">w</span><span class=\"msupsub\"><span class=\"vlist-t vlist-t2\"><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.30110799999999993em;\"><span style=\"top:-2.5500000000000003em;margin-left:-0.02691em;margin-right:0.05em;\"><span class=\"pstrut\" style=\"height:2.7em;\"></span><span class=\"sizing reset-size6 size3 mtight\"><span class=\"mord mtight\">1</span></span></span></span><span class=\"vlist-s\">â€‹</span></span><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.15em;\"><span></span></span></span></span></span></span><span class=\"mpunct\">,</span><span class=\"mspace\" style=\"margin-right:0.16666666666666666em;\"></span><span class=\"minner\">â‹¯</span><span class=\"mspace\" style=\"margin-right:0.16666666666666666em;\"></span><span class=\"mspace\" style=\"margin-right:0.16666666666666666em;\"></span><span class=\"mpunct\">,</span><span class=\"mspace\" style=\"margin-right:0.16666666666666666em;\"></span><span class=\"mord\"><span class=\"mord mathnormal\" style=\"margin-right:0.02691em;\">w</span><span class=\"msupsub\"><span class=\"vlist-t vlist-t2\"><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.311664em;\"><span style=\"top:-2.5500000000000003em;margin-left:-0.02691em;margin-right:0.05em;\"><span class=\"pstrut\" style=\"height:2.7em;\"></span><span class=\"sizing reset-size6 size3 mtight\"><span class=\"mord mtight\"><span class=\"mord mathnormal mtight\">i</span><span class=\"mbin mtight\">âˆ’</span><span class=\"mord mtight\">1</span></span></span></span></span><span class=\"vlist-s\">â€‹</span></span><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.208331em;\"><span></span></span></span></span></span></span><span class=\"mclose\">)</span></span></span></span> å’Œ <span class=\"katex\"><span class=\"katex-mathml\"><math xmlns=\"http://www.w3.org/1998/Math/MathML\"><semantics><mrow><mi>P</mi><mo stretchy=\"false\">(</mo><msub><mi>w</mi><mi>i</mi></msub><mi mathvariant=\"normal\">âˆ£</mi><msub><mi>w</mi><mrow><mi>i</mi><mo>+</mo><mn>1</mn></mrow></msub><mo separator=\"true\">,</mo><mo>â‹¯</mo><mtext>â€‰</mtext><mo separator=\"true\">,</mo><msub><mi>w</mi><mi>n</mi></msub><mo stretchy=\"false\">)</mo></mrow><annotation encoding=\"application/x-tex\">P(w_i|w_{i+1},\\cdots,w_n)</annotation></semantics></math></span><span class=\"katex-html\" aria-hidden=\"true\"><span class=\"base\"><span class=\"strut\" style=\"height:1em;vertical-align:-0.25em;\"></span><span class=\"mord mathnormal\" style=\"margin-right:0.13889em;\">P</span><span class=\"mopen\">(</span><span class=\"mord\"><span class=\"mord mathnormal\" style=\"margin-right:0.02691em;\">w</span><span class=\"msupsub\"><span class=\"vlist-t vlist-t2\"><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.31166399999999994em;\"><span style=\"top:-2.5500000000000003em;margin-left:-0.02691em;margin-right:0.05em;\"><span class=\"pstrut\" style=\"height:2.7em;\"></span><span class=\"sizing reset-size6 size3 mtight\"><span class=\"mord mathnormal mtight\">i</span></span></span></span><span class=\"vlist-s\">â€‹</span></span><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.15em;\"><span></span></span></span></span></span></span><span class=\"mord\">âˆ£</span><span class=\"mord\"><span class=\"mord mathnormal\" style=\"margin-right:0.02691em;\">w</span><span class=\"msupsub\"><span class=\"vlist-t vlist-t2\"><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.311664em;\"><span style=\"top:-2.5500000000000003em;margin-left:-0.02691em;margin-right:0.05em;\"><span class=\"pstrut\" style=\"height:2.7em;\"></span><span class=\"sizing reset-size6 size3 mtight\"><span class=\"mord mtight\"><span class=\"mord mathnormal mtight\">i</span><span class=\"mbin mtight\">+</span><span class=\"mord mtight\">1</span></span></span></span></span><span class=\"vlist-s\">â€‹</span></span><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.208331em;\"><span></span></span></span></span></span></span><span class=\"mpunct\">,</span><span class=\"mspace\" style=\"margin-right:0.16666666666666666em;\"></span><span class=\"minner\">â‹¯</span><span class=\"mspace\" style=\"margin-right:0.16666666666666666em;\"></span><span class=\"mspace\" style=\"margin-right:0.16666666666666666em;\"></span><span class=\"mpunct\">,</span><span class=\"mspace\" style=\"margin-right:0.16666666666666666em;\"></span><span class=\"mord\"><span class=\"mord mathnormal\" style=\"margin-right:0.02691em;\">w</span><span class=\"msupsub\"><span class=\"vlist-t vlist-t2\"><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.151392em;\"><span style=\"top:-2.5500000000000003em;margin-left:-0.02691em;margin-right:0.05em;\"><span class=\"pstrut\" style=\"height:2.7em;\"></span><span class=\"sizing reset-size6 size3 mtight\"><span class=\"mord mathnormal mtight\">n</span></span></span></span><span class=\"vlist-s\">â€‹</span></span><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.15em;\"><span></span></span></span></span></span></span><span class=\"mclose\">)</span></span></span></span> ä¸ºç›®æ ‡å‡½æ•°ç‹¬ç«‹è®­ç»ƒï¼Œ<strong>å°†è®­ç»ƒå¾—åˆ°çš„ç‰¹å¾å‘é‡ä»¥æ‹¼æ¥çš„å½¢å¼å®ç°åŒå‘ç¼–ç ï¼Œæœ¬è´¨ä¸Šè¿˜æ˜¯å•å‘ç¼–ç ï¼Œåªä¸è¿‡æ˜¯ä¸¤ä¸ªæ–¹å‘ä¸Šçš„å•å‘ç¼–ç çš„æ‹¼æ¥è€Œæˆçš„åŒå‘ç¼–ç </strong>ã€‚</li>\n<li>GPT ä½¿ç”¨ Transformer Decoder ä½œä¸º Transformer Blockï¼Œä»¥ <span class=\"katex\"><span class=\"katex-mathml\"><math xmlns=\"http://www.w3.org/1998/Math/MathML\"><semantics><mrow><mi>P</mi><mo stretchy=\"false\">(</mo><msub><mi>w</mi><mi>i</mi></msub><mi mathvariant=\"normal\">âˆ£</mi><msub><mi>w</mi><mn>1</mn></msub><mo separator=\"true\">,</mo><mo>â‹¯</mo><mtext>â€‰</mtext><mo separator=\"true\">,</mo><msub><mi>w</mi><mrow><mi>i</mi><mo>âˆ’</mo><mn>1</mn></mrow></msub><mo stretchy=\"false\">)</mo></mrow><annotation encoding=\"application/x-tex\">P(w_i|w_1,\\cdots,w_{i-1})</annotation></semantics></math></span><span class=\"katex-html\" aria-hidden=\"true\"><span class=\"base\"><span class=\"strut\" style=\"height:1em;vertical-align:-0.25em;\"></span><span class=\"mord mathnormal\" style=\"margin-right:0.13889em;\">P</span><span class=\"mopen\">(</span><span class=\"mord\"><span class=\"mord mathnormal\" style=\"margin-right:0.02691em;\">w</span><span class=\"msupsub\"><span class=\"vlist-t vlist-t2\"><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.31166399999999994em;\"><span style=\"top:-2.5500000000000003em;margin-left:-0.02691em;margin-right:0.05em;\"><span class=\"pstrut\" style=\"height:2.7em;\"></span><span class=\"sizing reset-size6 size3 mtight\"><span class=\"mord mathnormal mtight\">i</span></span></span></span><span class=\"vlist-s\">â€‹</span></span><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.15em;\"><span></span></span></span></span></span></span><span class=\"mord\">âˆ£</span><span class=\"mord\"><span class=\"mord mathnormal\" style=\"margin-right:0.02691em;\">w</span><span class=\"msupsub\"><span class=\"vlist-t vlist-t2\"><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.30110799999999993em;\"><span style=\"top:-2.5500000000000003em;margin-left:-0.02691em;margin-right:0.05em;\"><span class=\"pstrut\" style=\"height:2.7em;\"></span><span class=\"sizing reset-size6 size3 mtight\"><span class=\"mord mtight\">1</span></span></span></span><span class=\"vlist-s\">â€‹</span></span><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.15em;\"><span></span></span></span></span></span></span><span class=\"mpunct\">,</span><span class=\"mspace\" style=\"margin-right:0.16666666666666666em;\"></span><span class=\"minner\">â‹¯</span><span class=\"mspace\" style=\"margin-right:0.16666666666666666em;\"></span><span class=\"mspace\" style=\"margin-right:0.16666666666666666em;\"></span><span class=\"mpunct\">,</span><span class=\"mspace\" style=\"margin-right:0.16666666666666666em;\"></span><span class=\"mord\"><span class=\"mord mathnormal\" style=\"margin-right:0.02691em;\">w</span><span class=\"msupsub\"><span class=\"vlist-t vlist-t2\"><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.311664em;\"><span style=\"top:-2.5500000000000003em;margin-left:-0.02691em;margin-right:0.05em;\"><span class=\"pstrut\" style=\"height:2.7em;\"></span><span class=\"sizing reset-size6 size3 mtight\"><span class=\"mord mtight\"><span class=\"mord mathnormal mtight\">i</span><span class=\"mbin mtight\">âˆ’</span><span class=\"mord mtight\">1</span></span></span></span></span><span class=\"vlist-s\">â€‹</span></span><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.208331em;\"><span></span></span></span></span></span></span><span class=\"mclose\">)</span></span></span></span> ä¸ºç›®æ ‡å‡½æ•°è¿›è¡Œè®­ç»ƒï¼Œ<strong>ç”¨ Transformer Block å–ä»£ LSTM ä½œä¸ºç‰¹å¾æå–å™¨ï¼Œå®ç°äº†å•å‘ç¼–ç ï¼Œæ˜¯ä¸€ä¸ªæ ‡å‡†çš„é¢„è®­ç»ƒè¯­è¨€æ¨¡å‹ï¼Œå³ä½¿ç”¨ Fine-Tuning æ¨¡å¼è§£å†³ä¸‹æ¸¸ä»»åŠ¡ã€‚</strong></li>\n<li>BERT ä¹Ÿæ˜¯ä¸€ä¸ªæ ‡å‡†çš„é¢„è®­ç»ƒè¯­è¨€æ¨¡å‹ï¼Œ<strong>å®ƒä»¥ <span class=\"katex\"><span class=\"katex-mathml\"><math xmlns=\"http://www.w3.org/1998/Math/MathML\"><semantics><mrow><mi>P</mi><mo stretchy=\"false\">(</mo><msub><mi>w</mi><mi>i</mi></msub><mi mathvariant=\"normal\">âˆ£</mi><msub><mi>w</mi><mn>1</mn></msub><mo separator=\"true\">,</mo><mo>â‹¯</mo><mtext>â€‰</mtext><mo separator=\"true\">,</mo><msub><mi>w</mi><mrow><mi>i</mi><mo>âˆ’</mo><mn>1</mn></mrow></msub><mo separator=\"true\">,</mo><msub><mi>w</mi><mrow><mi>i</mi><mo>+</mo><mn>1</mn></mrow></msub><mo separator=\"true\">,</mo><mo>â‹¯</mo><mtext>â€‰</mtext><mo separator=\"true\">,</mo><msub><mi>w</mi><mi>n</mi></msub><mo stretchy=\"false\">)</mo></mrow><annotation encoding=\"application/x-tex\">P(w_i|w_1,\\cdots,w_{i-1},w_{i+1},\\cdots,w_n)</annotation></semantics></math></span><span class=\"katex-html\" aria-hidden=\"true\"><span class=\"base\"><span class=\"strut\" style=\"height:1em;vertical-align:-0.25em;\"></span><span class=\"mord mathnormal\" style=\"margin-right:0.13889em;\">P</span><span class=\"mopen\">(</span><span class=\"mord\"><span class=\"mord mathnormal\" style=\"margin-right:0.02691em;\">w</span><span class=\"msupsub\"><span class=\"vlist-t vlist-t2\"><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.31166399999999994em;\"><span style=\"top:-2.5500000000000003em;margin-left:-0.02691em;margin-right:0.05em;\"><span class=\"pstrut\" style=\"height:2.7em;\"></span><span class=\"sizing reset-size6 size3 mtight\"><span class=\"mord mathnormal mtight\">i</span></span></span></span><span class=\"vlist-s\">â€‹</span></span><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.15em;\"><span></span></span></span></span></span></span><span class=\"mord\">âˆ£</span><span class=\"mord\"><span class=\"mord mathnormal\" style=\"margin-right:0.02691em;\">w</span><span class=\"msupsub\"><span class=\"vlist-t vlist-t2\"><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.30110799999999993em;\"><span style=\"top:-2.5500000000000003em;margin-left:-0.02691em;margin-right:0.05em;\"><span class=\"pstrut\" style=\"height:2.7em;\"></span><span class=\"sizing reset-size6 size3 mtight\"><span class=\"mord mtight\">1</span></span></span></span><span class=\"vlist-s\">â€‹</span></span><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.15em;\"><span></span></span></span></span></span></span><span class=\"mpunct\">,</span><span class=\"mspace\" style=\"margin-right:0.16666666666666666em;\"></span><span class=\"minner\">â‹¯</span><span class=\"mspace\" style=\"margin-right:0.16666666666666666em;\"></span><span class=\"mspace\" style=\"margin-right:0.16666666666666666em;\"></span><span class=\"mpunct\">,</span><span class=\"mspace\" style=\"margin-right:0.16666666666666666em;\"></span><span class=\"mord\"><span class=\"mord mathnormal\" style=\"margin-right:0.02691em;\">w</span><span class=\"msupsub\"><span class=\"vlist-t vlist-t2\"><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.311664em;\"><span style=\"top:-2.5500000000000003em;margin-left:-0.02691em;margin-right:0.05em;\"><span class=\"pstrut\" style=\"height:2.7em;\"></span><span class=\"sizing reset-size6 size3 mtight\"><span class=\"mord mtight\"><span class=\"mord mathnormal mtight\">i</span><span class=\"mbin mtight\">âˆ’</span><span class=\"mord mtight\">1</span></span></span></span></span><span class=\"vlist-s\">â€‹</span></span><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.208331em;\"><span></span></span></span></span></span></span><span class=\"mpunct\">,</span><span class=\"mspace\" style=\"margin-right:0.16666666666666666em;\"></span><span class=\"mord\"><span class=\"mord mathnormal\" style=\"margin-right:0.02691em;\">w</span><span class=\"msupsub\"><span class=\"vlist-t vlist-t2\"><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.311664em;\"><span style=\"top:-2.5500000000000003em;margin-left:-0.02691em;margin-right:0.05em;\"><span class=\"pstrut\" style=\"height:2.7em;\"></span><span class=\"sizing reset-size6 size3 mtight\"><span class=\"mord mtight\"><span class=\"mord mathnormal mtight\">i</span><span class=\"mbin mtight\">+</span><span class=\"mord mtight\">1</span></span></span></span></span><span class=\"vlist-s\">â€‹</span></span><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.208331em;\"><span></span></span></span></span></span></span><span class=\"mpunct\">,</span><span class=\"mspace\" style=\"margin-right:0.16666666666666666em;\"></span><span class=\"minner\">â‹¯</span><span class=\"mspace\" style=\"margin-right:0.16666666666666666em;\"></span><span class=\"mspace\" style=\"margin-right:0.16666666666666666em;\"></span><span class=\"mpunct\">,</span><span class=\"mspace\" style=\"margin-right:0.16666666666666666em;\"></span><span class=\"mord\"><span class=\"mord mathnormal\" style=\"margin-right:0.02691em;\">w</span><span class=\"msupsub\"><span class=\"vlist-t vlist-t2\"><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.151392em;\"><span style=\"top:-2.5500000000000003em;margin-left:-0.02691em;margin-right:0.05em;\"><span class=\"pstrut\" style=\"height:2.7em;\"></span><span class=\"sizing reset-size6 size3 mtight\"><span class=\"mord mathnormal mtight\">n</span></span></span></span><span class=\"vlist-s\">â€‹</span></span><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.15em;\"><span></span></span></span></span></span></span><span class=\"mclose\">)</span></span></span></span> ä¸ºç›®æ ‡å‡½æ•°è¿›è¡Œè®­ç»ƒï¼ŒBERT ä½¿ç”¨çš„ç¼–ç å™¨å±äºåŒå‘ç¼–ç å™¨</strong>ã€‚\n<ul>\n<li>BERT å’Œ ELMo çš„åŒºåˆ«åœ¨äºä½¿ç”¨ Transformer Block ä½œä¸ºç‰¹å¾æå–å™¨ï¼ŒåŠ å¼ºäº†è¯­ä¹‰ç‰¹å¾æå–çš„èƒ½åŠ›ï¼›</li>\n<li>BERT å’Œ GPT çš„åŒºåˆ«åœ¨äºä½¿ç”¨ Transformer Encoder ä½œä¸º Transformer Blockï¼Œå¹¶ä¸”å°† GPT çš„å•å‘ç¼–ç æ”¹æˆåŒå‘ç¼–ç ï¼Œä¹Ÿå°±æ˜¯è¯´ BERT èˆå¼ƒäº†æ–‡æœ¬ç”Ÿæˆèƒ½åŠ›ï¼Œæ¢æ¥äº†æ›´å¼ºçš„è¯­ä¹‰ç†è§£èƒ½åŠ›ã€‚</li>\n</ul>\n</li>\n</ul>\n</li>\n</ul>\n<p>BERT çš„æ¨¡å‹ç»“æ„å¦‚ä¸‹å›¾æ‰€ç¤ºï¼š</p>\n<p>&lt;img src=&quot;<span class=\"exturl\" data-url=\"aHR0cHM6Ly9pbWdtZC5vc3MtY24tc2hhbmdoYWkuYWxpeXVuY3MuY29tL0JFUlRfSU1HL2JlcnQtJUU2JUE4JUExJUU1JTlFJThCJUU3JUJCJTkzJUU2JTlFJTg0LmpwZw==\">https://imgmd.oss-cn-shanghai.aliyuncs.com/BERT_IMG/bert - æ¨¡å‹ç»“æ„.jpg</span>&quot; style=&quot;zoom:51%;&quot; /&gt;</p>\n<p>ä»ä¸Šå›¾å¯ä»¥å‘ç°ï¼ŒBERT çš„æ¨¡å‹ç»“æ„å…¶å®å°±æ˜¯ Transformer Encoder æ¨¡å—çš„å †å ã€‚åœ¨æ¨¡å‹å‚æ•°é€‰æ‹©ä¸Šï¼Œè®ºæ–‡ç»™å‡ºäº†ä¸¤å¥—å¤§å°ä¸ä¸€è‡´çš„æ¨¡å‹ã€‚</p>\n<blockquote>\n<p><span class=\"katex\"><span class=\"katex-mathml\"><math xmlns=\"http://www.w3.org/1998/Math/MathML\"><semantics><mrow><mi>B</mi><mi>E</mi><mi>R</mi><msub><mi>T</mi><mrow><mi>B</mi><mi>A</mi><mi>S</mi><mi>E</mi></mrow></msub></mrow><annotation encoding=\"application/x-tex\">BERT_{BASE}</annotation></semantics></math></span><span class=\"katex-html\" aria-hidden=\"true\"><span class=\"base\"><span class=\"strut\" style=\"height:0.83333em;vertical-align:-0.15em;\"></span><span class=\"mord mathnormal\" style=\"margin-right:0.05017em;\">B</span><span class=\"mord mathnormal\" style=\"margin-right:0.05764em;\">E</span><span class=\"mord mathnormal\" style=\"margin-right:0.00773em;\">R</span><span class=\"mord\"><span class=\"mord mathnormal\" style=\"margin-right:0.13889em;\">T</span><span class=\"msupsub\"><span class=\"vlist-t vlist-t2\"><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.32833099999999993em;\"><span style=\"top:-2.5500000000000003em;margin-left:-0.13889em;margin-right:0.05em;\"><span class=\"pstrut\" style=\"height:2.7em;\"></span><span class=\"sizing reset-size6 size3 mtight\"><span class=\"mord mtight\"><span class=\"mord mathnormal mtight\" style=\"margin-right:0.05017em;\">B</span><span class=\"mord mathnormal mtight\">A</span><span class=\"mord mathnormal mtight\" style=\"margin-right:0.05764em;\">S</span><span class=\"mord mathnormal mtight\" style=\"margin-right:0.05764em;\">E</span></span></span></span></span><span class=\"vlist-s\">â€‹</span></span><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.15em;\"><span></span></span></span></span></span></span></span></span></span> ï¼šL = 12ï¼ŒH = 768ï¼ŒA = 12ï¼Œæ€»å‚æ•°é‡ä¸º 1.1 äº¿</p>\n<p><span class=\"katex\"><span class=\"katex-mathml\"><math xmlns=\"http://www.w3.org/1998/Math/MathML\"><semantics><mrow><mi>B</mi><mi>E</mi><mi>R</mi><msub><mi>T</mi><mrow><mi>L</mi><mi>A</mi><mi>R</mi><mi>G</mi><mi>E</mi></mrow></msub></mrow><annotation encoding=\"application/x-tex\">BERT_{LARGE}</annotation></semantics></math></span><span class=\"katex-html\" aria-hidden=\"true\"><span class=\"base\"><span class=\"strut\" style=\"height:0.83333em;vertical-align:-0.15em;\"></span><span class=\"mord mathnormal\" style=\"margin-right:0.05017em;\">B</span><span class=\"mord mathnormal\" style=\"margin-right:0.05764em;\">E</span><span class=\"mord mathnormal\" style=\"margin-right:0.00773em;\">R</span><span class=\"mord\"><span class=\"mord mathnormal\" style=\"margin-right:0.13889em;\">T</span><span class=\"msupsub\"><span class=\"vlist-t vlist-t2\"><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.32833099999999993em;\"><span style=\"top:-2.5500000000000003em;margin-left:-0.13889em;margin-right:0.05em;\"><span class=\"pstrut\" style=\"height:2.7em;\"></span><span class=\"sizing reset-size6 size3 mtight\"><span class=\"mord mtight\"><span class=\"mord mathnormal mtight\">L</span><span class=\"mord mathnormal mtight\">A</span><span class=\"mord mathnormal mtight\" style=\"margin-right:0.00773em;\">R</span><span class=\"mord mathnormal mtight\">G</span><span class=\"mord mathnormal mtight\" style=\"margin-right:0.05764em;\">E</span></span></span></span></span><span class=\"vlist-s\">â€‹</span></span><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.15em;\"><span></span></span></span></span></span></span></span></span></span>ï¼šL = 24ï¼ŒH = 1024ï¼ŒA = 16ï¼Œæ€»å‚æ•°é‡ä¸º 3.4 äº¿</p>\n</blockquote>\n<p>å…¶ä¸­ L ä»£è¡¨ Transformer Block çš„å±‚æ•°ï¼›H ä»£è¡¨ç‰¹å¾å‘é‡çš„ç»´æ•°ï¼ˆæ­¤å¤„é»˜è®¤ Feed Forward å±‚ä¸­çš„ä¸­é—´éšå±‚çš„ç»´æ•°ä¸º 4Hï¼‰ï¼›A è¡¨ç¤º Self-Attention çš„å¤´æ•°ï¼Œä½¿ç”¨è¿™ä¸‰ä¸ªå‚æ•°åŸºæœ¬å¯ä»¥å®šä¹‰ BERT çš„é‡çº§ã€‚</p>\n<p>BERT å‚æ•°é‡çº§çš„è®¡ç®—å…¬å¼ï¼š</p>\n\\begin{align*}\n& è¯å‘é‡å‚æ•°+ 12 * ï¼ˆMulti-Headså‚æ•° + å…¨è¿æ¥å±‚å‚æ•° + layernormå‚æ•°ï¼‰\\\\ \n& = ï¼ˆ30522+512 + 2ï¼‰* 768 + 768 * 2 \\\\\n& + 12 * ï¼ˆ768 * 768 / 12 * 3 * 12 + 768 * 768 + 768 * 3072 * 2 + 768 * 2 * 2ï¼‰ \\\\ \n& = 108808704.0 \\\\ \n& \\approx 110M\n\\end{align*}\n\n<p>è®­ç»ƒè¿‡ç¨‹ä¹Ÿæ˜¯å¾ˆèŠ±è´¹è®¡ç®—èµ„æºå’Œæ—¶é—´çš„ï¼Œ<strong>æ€»ä¹‹è¡¨ç¤ºè†œæ‹œï¼Œæ™®é€šäººå³ä¾¿æœ‰ idea æ²¡æœ‰ç®—åŠ›ä¹Ÿåªèƒ½è·ªç€ã€‚</strong></p>\n<h2 id=\"133-bert-ä¹‹æ— ç›‘ç£è®­ç»ƒ\"><a class=\"anchor\" href=\"#133-bert-ä¹‹æ— ç›‘ç£è®­ç»ƒ\">#</a> 13.3 BERT ä¹‹æ— ç›‘ç£è®­ç»ƒ</h2>\n<p>å’Œ GPT ä¸€æ ·ï¼ŒBERT ä¹Ÿé‡‡ç”¨äºŒæ®µå¼è®­ç»ƒæ–¹æ³•ï¼š</p>\n<ol>\n<li>ç¬¬ä¸€é˜¶æ®µï¼šä½¿ç”¨æ˜“è·å–çš„å¤§è§„æ¨¡æ— æ ‡ç­¾ä½™æ–™ï¼Œæ¥è®­ç»ƒåŸºç¡€è¯­è¨€æ¨¡å‹ï¼›</li>\n<li>ç¬¬äºŒé˜¶æ®µï¼šæ ¹æ®æŒ‡å®šä»»åŠ¡çš„å°‘é‡å¸¦æ ‡ç­¾è®­ç»ƒæ•°æ®è¿›è¡Œå¾®è°ƒè®­ç»ƒã€‚</li>\n</ol>\n<p>ä¸åŒäº GPT ç­‰æ ‡å‡†è¯­è¨€æ¨¡å‹ä½¿ç”¨ <span class=\"katex\"><span class=\"katex-mathml\"><math xmlns=\"http://www.w3.org/1998/Math/MathML\"><semantics><mrow><mi>P</mi><mo stretchy=\"false\">(</mo><msub><mi>w</mi><mi>i</mi></msub><mi mathvariant=\"normal\">âˆ£</mi><msub><mi>w</mi><mn>1</mn></msub><mo separator=\"true\">,</mo><mo>â‹¯</mo><mtext>â€‰</mtext><mo separator=\"true\">,</mo><msub><mi>w</mi><mrow><mi>i</mi><mo>âˆ’</mo><mn>1</mn></mrow></msub><mo stretchy=\"false\">)</mo></mrow><annotation encoding=\"application/x-tex\">P(w_i|w_1,\\cdots,w_{i-1})</annotation></semantics></math></span><span class=\"katex-html\" aria-hidden=\"true\"><span class=\"base\"><span class=\"strut\" style=\"height:1em;vertical-align:-0.25em;\"></span><span class=\"mord mathnormal\" style=\"margin-right:0.13889em;\">P</span><span class=\"mopen\">(</span><span class=\"mord\"><span class=\"mord mathnormal\" style=\"margin-right:0.02691em;\">w</span><span class=\"msupsub\"><span class=\"vlist-t vlist-t2\"><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.31166399999999994em;\"><span style=\"top:-2.5500000000000003em;margin-left:-0.02691em;margin-right:0.05em;\"><span class=\"pstrut\" style=\"height:2.7em;\"></span><span class=\"sizing reset-size6 size3 mtight\"><span class=\"mord mathnormal mtight\">i</span></span></span></span><span class=\"vlist-s\">â€‹</span></span><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.15em;\"><span></span></span></span></span></span></span><span class=\"mord\">âˆ£</span><span class=\"mord\"><span class=\"mord mathnormal\" style=\"margin-right:0.02691em;\">w</span><span class=\"msupsub\"><span class=\"vlist-t vlist-t2\"><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.30110799999999993em;\"><span style=\"top:-2.5500000000000003em;margin-left:-0.02691em;margin-right:0.05em;\"><span class=\"pstrut\" style=\"height:2.7em;\"></span><span class=\"sizing reset-size6 size3 mtight\"><span class=\"mord mtight\">1</span></span></span></span><span class=\"vlist-s\">â€‹</span></span><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.15em;\"><span></span></span></span></span></span></span><span class=\"mpunct\">,</span><span class=\"mspace\" style=\"margin-right:0.16666666666666666em;\"></span><span class=\"minner\">â‹¯</span><span class=\"mspace\" style=\"margin-right:0.16666666666666666em;\"></span><span class=\"mspace\" style=\"margin-right:0.16666666666666666em;\"></span><span class=\"mpunct\">,</span><span class=\"mspace\" style=\"margin-right:0.16666666666666666em;\"></span><span class=\"mord\"><span class=\"mord mathnormal\" style=\"margin-right:0.02691em;\">w</span><span class=\"msupsub\"><span class=\"vlist-t vlist-t2\"><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.311664em;\"><span style=\"top:-2.5500000000000003em;margin-left:-0.02691em;margin-right:0.05em;\"><span class=\"pstrut\" style=\"height:2.7em;\"></span><span class=\"sizing reset-size6 size3 mtight\"><span class=\"mord mtight\"><span class=\"mord mathnormal mtight\">i</span><span class=\"mbin mtight\">âˆ’</span><span class=\"mord mtight\">1</span></span></span></span></span><span class=\"vlist-s\">â€‹</span></span><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.208331em;\"><span></span></span></span></span></span></span><span class=\"mclose\">)</span></span></span></span> ä¸ºç›®æ ‡å‡½æ•°è¿›è¡Œè®­ç»ƒï¼Œèƒ½çœ‹åˆ°å…¨å±€ä¿¡æ¯çš„ BERT ä½¿ç”¨ <span class=\"katex\"><span class=\"katex-mathml\"><math xmlns=\"http://www.w3.org/1998/Math/MathML\"><semantics><mrow><mi>P</mi><mo stretchy=\"false\">(</mo><msub><mi>w</mi><mi>i</mi></msub><mi mathvariant=\"normal\">âˆ£</mi><msub><mi>w</mi><mn>1</mn></msub><mo separator=\"true\">,</mo><mo>â‹¯</mo><mtext>â€‰</mtext><mo separator=\"true\">,</mo><msub><mi>w</mi><mrow><mi>i</mi><mo>âˆ’</mo><mn>1</mn></mrow></msub><mo separator=\"true\">,</mo><msub><mi>w</mi><mrow><mi>i</mi><mo>+</mo><mn>1</mn></mrow></msub><mo separator=\"true\">,</mo><mo>â‹¯</mo><mtext>â€‰</mtext><mo separator=\"true\">,</mo><msub><mi>w</mi><mi>n</mi></msub><mo stretchy=\"false\">)</mo></mrow><annotation encoding=\"application/x-tex\">P(w_i|w_1,\\cdots,w_{i-1},w_{i+1},\\cdots,w_n)</annotation></semantics></math></span><span class=\"katex-html\" aria-hidden=\"true\"><span class=\"base\"><span class=\"strut\" style=\"height:1em;vertical-align:-0.25em;\"></span><span class=\"mord mathnormal\" style=\"margin-right:0.13889em;\">P</span><span class=\"mopen\">(</span><span class=\"mord\"><span class=\"mord mathnormal\" style=\"margin-right:0.02691em;\">w</span><span class=\"msupsub\"><span class=\"vlist-t vlist-t2\"><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.31166399999999994em;\"><span style=\"top:-2.5500000000000003em;margin-left:-0.02691em;margin-right:0.05em;\"><span class=\"pstrut\" style=\"height:2.7em;\"></span><span class=\"sizing reset-size6 size3 mtight\"><span class=\"mord mathnormal mtight\">i</span></span></span></span><span class=\"vlist-s\">â€‹</span></span><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.15em;\"><span></span></span></span></span></span></span><span class=\"mord\">âˆ£</span><span class=\"mord\"><span class=\"mord mathnormal\" style=\"margin-right:0.02691em;\">w</span><span class=\"msupsub\"><span class=\"vlist-t vlist-t2\"><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.30110799999999993em;\"><span style=\"top:-2.5500000000000003em;margin-left:-0.02691em;margin-right:0.05em;\"><span class=\"pstrut\" style=\"height:2.7em;\"></span><span class=\"sizing reset-size6 size3 mtight\"><span class=\"mord mtight\">1</span></span></span></span><span class=\"vlist-s\">â€‹</span></span><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.15em;\"><span></span></span></span></span></span></span><span class=\"mpunct\">,</span><span class=\"mspace\" style=\"margin-right:0.16666666666666666em;\"></span><span class=\"minner\">â‹¯</span><span class=\"mspace\" style=\"margin-right:0.16666666666666666em;\"></span><span class=\"mspace\" style=\"margin-right:0.16666666666666666em;\"></span><span class=\"mpunct\">,</span><span class=\"mspace\" style=\"margin-right:0.16666666666666666em;\"></span><span class=\"mord\"><span class=\"mord mathnormal\" style=\"margin-right:0.02691em;\">w</span><span class=\"msupsub\"><span class=\"vlist-t vlist-t2\"><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.311664em;\"><span style=\"top:-2.5500000000000003em;margin-left:-0.02691em;margin-right:0.05em;\"><span class=\"pstrut\" style=\"height:2.7em;\"></span><span class=\"sizing reset-size6 size3 mtight\"><span class=\"mord mtight\"><span class=\"mord mathnormal mtight\">i</span><span class=\"mbin mtight\">âˆ’</span><span class=\"mord mtight\">1</span></span></span></span></span><span class=\"vlist-s\">â€‹</span></span><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.208331em;\"><span></span></span></span></span></span></span><span class=\"mpunct\">,</span><span class=\"mspace\" style=\"margin-right:0.16666666666666666em;\"></span><span class=\"mord\"><span class=\"mord mathnormal\" style=\"margin-right:0.02691em;\">w</span><span class=\"msupsub\"><span class=\"vlist-t vlist-t2\"><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.311664em;\"><span style=\"top:-2.5500000000000003em;margin-left:-0.02691em;margin-right:0.05em;\"><span class=\"pstrut\" style=\"height:2.7em;\"></span><span class=\"sizing reset-size6 size3 mtight\"><span class=\"mord mtight\"><span class=\"mord mathnormal mtight\">i</span><span class=\"mbin mtight\">+</span><span class=\"mord mtight\">1</span></span></span></span></span><span class=\"vlist-s\">â€‹</span></span><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.208331em;\"><span></span></span></span></span></span></span><span class=\"mpunct\">,</span><span class=\"mspace\" style=\"margin-right:0.16666666666666666em;\"></span><span class=\"minner\">â‹¯</span><span class=\"mspace\" style=\"margin-right:0.16666666666666666em;\"></span><span class=\"mspace\" style=\"margin-right:0.16666666666666666em;\"></span><span class=\"mpunct\">,</span><span class=\"mspace\" style=\"margin-right:0.16666666666666666em;\"></span><span class=\"mord\"><span class=\"mord mathnormal\" style=\"margin-right:0.02691em;\">w</span><span class=\"msupsub\"><span class=\"vlist-t vlist-t2\"><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.151392em;\"><span style=\"top:-2.5500000000000003em;margin-left:-0.02691em;margin-right:0.05em;\"><span class=\"pstrut\" style=\"height:2.7em;\"></span><span class=\"sizing reset-size6 size3 mtight\"><span class=\"mord mathnormal mtight\">n</span></span></span></span><span class=\"vlist-s\">â€‹</span></span><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.15em;\"><span></span></span></span></span></span></span><span class=\"mclose\">)</span></span></span></span> ä¸ºç›®æ ‡å‡½æ•°è¿›è¡Œè®­ç»ƒã€‚</p>\n<p>å¹¶ä¸” BERT ç”¨è¯­è¨€æ©ç æ¨¡å‹ï¼ˆMLMï¼‰æ–¹æ³•è®­ç»ƒè¯çš„è¯­ä¹‰ç†è§£èƒ½åŠ›ï¼›ç”¨ä¸‹å¥é¢„æµ‹ï¼ˆNSPï¼‰æ–¹æ³•è®­ç»ƒå¥å­ä¹‹é—´çš„ç†è§£èƒ½åŠ›ï¼Œä»è€Œæ›´å¥½åœ°æ”¯æŒä¸‹æ¸¸ä»»åŠ¡ã€‚</p>\n<h2 id=\"134-bertä¹‹è¯­è¨€æ©ç æ¨¡å‹mlm\"><a class=\"anchor\" href=\"#134-bertä¹‹è¯­è¨€æ©ç æ¨¡å‹mlm\">#</a> 13.4 BERT ä¹‹è¯­è¨€æ©ç æ¨¡å‹ï¼ˆMLMï¼‰</h2>\n<p>BERT ä½œè€…è®¤ä¸ºï¼Œ<strong>ä½¿ç”¨è‡ªå·¦å‘å³ç¼–ç å’Œè‡ªå³å‘å·¦ç¼–ç çš„å•å‘ç¼–ç å™¨æ‹¼æ¥è€Œæˆçš„åŒå‘ç¼–ç å™¨ï¼Œåœ¨æ€§èƒ½ã€å‚æ•°è§„æ¨¡å’Œæ•ˆç‡ç­‰æ–¹é¢ï¼Œéƒ½ä¸å¦‚ç›´æ¥ä½¿ç”¨æ·±åº¦åŒå‘ç¼–ç å™¨å¼ºå¤§</strong>ï¼Œè¿™ä¹Ÿæ˜¯ä¸ºä»€ä¹ˆ BERT ä½¿ç”¨ Transformer Encoder ä½œä¸ºç‰¹å¾æå–å™¨ï¼Œè€Œä¸ä½¿ç”¨è‡ªå·¦å‘å³ç¼–ç å’Œè‡ªå³å‘å·¦ç¼–ç çš„ä¸¤ä¸ª Transformer Decoder ä½œä¸ºç‰¹å¾æå–å™¨çš„åŸå› ã€‚</p>\n<p>ç”±äºæ— æ³•ä½¿ç”¨æ ‡å‡†è¯­è¨€æ¨¡å‹çš„è®­ç»ƒæ¨¡å¼ï¼Œ<strong>BERT å€Ÿé‰´å®Œå½¢å¡«ç©ºä»»åŠ¡å’Œ CBOW çš„æ€æƒ³</strong>ï¼Œä½¿ç”¨è¯­è¨€æ©ç æ¨¡å‹ï¼ˆMLM ï¼‰æ–¹æ³•è®­ç»ƒæ¨¡å‹ã€‚</p>\n<p>MLM æ–¹æ³•ä¹Ÿå°±æ˜¯éšæœºå»æ‰å¥å­ä¸­çš„éƒ¨åˆ† tokenï¼ˆå•è¯ï¼‰ï¼Œç„¶åæ¨¡å‹æ¥é¢„æµ‹è¢«å»æ‰çš„ token æ˜¯ä»€ä¹ˆã€‚<strong>è¿™æ ·å®é™…ä¸Šå·²ç»ä¸æ˜¯ä¼ ç»Ÿçš„ç¥ç»ç½‘ç»œè¯­è¨€æ¨¡å‹ (ç±»ä¼¼äºç”Ÿæˆæ¨¡å‹) äº†ï¼Œè€Œæ˜¯å•çº¯ä½œä¸ºåˆ†ç±»é—®é¢˜</strong>ï¼Œæ ¹æ®è¿™ä¸ªæ—¶åˆ»çš„ hidden state æ¥é¢„æµ‹è¿™ä¸ªæ—¶åˆ»çš„ token åº”è¯¥æ˜¯ä»€ä¹ˆï¼Œè€Œä¸æ˜¯é¢„æµ‹ä¸‹ä¸€ä¸ªæ—¶åˆ»çš„è¯çš„æ¦‚ç‡åˆ†å¸ƒäº†ã€‚</p>\n<p>éšæœºå»æ‰çš„ token è¢«ç§°ä½œæ©ç è¯ï¼Œåœ¨è®­ç»ƒä¸­ï¼Œæ©ç è¯å°†ä»¥ 15% çš„æ¦‚ç‡è¢«æ›¿æ¢æˆ [MASK]ï¼Œä¹Ÿå°±æ˜¯è¯´éšæœº mask è¯­æ–™ä¸­ 15% çš„ tokenï¼Œè¿™ä¸ªæ“ä½œåˆ™ç§°ä¸ºæ©ç æ“ä½œã€‚æ³¨æ„ï¼š<strong>åœ¨ CBOW æ¨¡å‹ä¸­ï¼Œæ¯ä¸ªè¯éƒ½ä¼šè¢«é¢„æµ‹ä¸€éã€‚</strong></p>\n<p>ä½†æ˜¯è¿™æ ·è®¾è®¡ MLM çš„è®­ç»ƒæ–¹æ³•ä¼šå¼•å…¥å¼Šç«¯ï¼š<strong>åœ¨æ¨¡å‹å¾®è°ƒè®­ç»ƒé˜¶æ®µæˆ–æ¨¡å‹æ¨ç†ï¼ˆæµ‹è¯•ï¼‰é˜¶æ®µï¼Œè¾“å…¥çš„æ–‡æœ¬ä¸­å°†æ²¡æœ‰ [MASK]ï¼Œè¿›è€Œå¯¼è‡´äº§ç”Ÿç”±è®­ç»ƒå’Œé¢„æµ‹æ•°æ®åå·®å¯¼è‡´çš„æ€§èƒ½æŸå¤±ã€‚</strong></p>\n<p>è€ƒè™‘åˆ°ä¸Šè¿°çš„å¼Šç«¯ï¼ŒBERT å¹¶æ²¡æœ‰æ€»ç”¨ [MASK] æ›¿æ¢æ©ç è¯ï¼Œè€Œæ˜¯æŒ‰ç…§ä¸€å®šæ¯”ä¾‹é€‰å–æ›¿æ¢è¯ã€‚åœ¨é€‰æ‹© 15% çš„è¯ä½œä¸ºæ©ç è¯åè¿™äº›æ©ç è¯æœ‰ä¸‰ç±»æ›¿æ¢é€‰é¡¹ï¼š</p>\n<ul>\n<li>80% ç»ƒæ ·æœ¬ä¸­ï¼šå°†é€‰ä¸­çš„è¯ç”¨ [MASK] æ¥ä»£æ›¿ï¼Œä¾‹å¦‚ï¼š</li>\n</ul>\n<figure class=\"highlight text\"><figcaption data-lang=\"text\"></figcaption><table><tr><td data-num=\"1\"></td><td><pre>â€œåœ°çƒæ˜¯[MASK]å…«å¤§è¡Œæ˜Ÿä¹‹ä¸€â€</pre></td></tr></table></figure><ul>\n<li>10% çš„è®­ç»ƒæ ·æœ¬ä¸­ï¼šé€‰ä¸­çš„è¯ä¸å‘ç”Ÿå˜åŒ–ï¼Œ<strong>è¯¥åšæ³•æ˜¯ä¸ºäº†ç¼“è§£è®­ç»ƒæ–‡æœ¬å’Œé¢„æµ‹æ–‡æœ¬çš„åå·®å¸¦æ¥çš„æ€§èƒ½æŸå¤±</strong>ï¼Œä¾‹å¦‚ï¼š</li>\n</ul>\n<figure class=\"highlight text\"><figcaption data-lang=\"text\"></figcaption><table><tr><td data-num=\"1\"></td><td><pre>â€œåœ°çƒæ˜¯å¤ªé˜³ç³»å…«å¤§è¡Œæ˜Ÿä¹‹ä¸€â€</pre></td></tr></table></figure><ul>\n<li>10% çš„è®­ç»ƒæ ·æœ¬ä¸­ï¼šå°†é€‰ä¸­çš„è¯ç”¨ä»»æ„çš„è¯æ¥è¿›è¡Œä»£æ›¿ï¼Œ<strong>è¯¥åšæ³•æ˜¯ä¸ºäº†è®© BERT å­¦ä¼šæ ¹æ®ä¸Šä¸‹æ–‡ä¿¡æ¯è‡ªåŠ¨çº é”™</strong>ï¼Œä¾‹å¦‚ï¼š</li>\n</ul>\n<figure class=\"highlight text\"><figcaption data-lang=\"text\"></figcaption><table><tr><td data-num=\"1\"></td><td><pre>â€œåœ°çƒæ˜¯è‹¹æœå…«å¤§è¡Œæ˜Ÿä¹‹ä¸€â€</pre></td></tr></table></figure><p>ä½œè€…åœ¨è®ºæ–‡ä¸­æåˆ°è¿™æ ·åšçš„å¥½å¤„æ˜¯ï¼Œç¼–ç å™¨ä¸çŸ¥é“å“ªäº›è¯éœ€è¦é¢„æµ‹çš„ï¼Œå“ªäº›è¯æ˜¯é”™è¯¯çš„ï¼Œå› æ­¤<strong>è¢«è¿«éœ€è¦å­¦ä¹ æ¯ä¸€ä¸ª token çš„è¡¨ç¤ºå‘é‡</strong>ï¼Œå¦å¤–ä½œè€…ä¹Ÿ<strong>è¡¨ç¤ºåŒå‘ç¼–ç å™¨æ¯”å•é¡¹ç¼–ç å™¨è®­ç»ƒè¦æ…¢</strong>ï¼Œè¿›è€Œå¯¼è‡´ BERT çš„è®­ç»ƒæ•ˆç‡ä½äº†å¾ˆå¤šï¼Œä½†æ˜¯å®éªŒä¹Ÿè¯æ˜ MLM è®­ç»ƒæ–¹æ³•å¯ä»¥è®© BERT è·å¾—è¶…å‡ºåŒæœŸæ‰€æœ‰é¢„è®­ç»ƒè¯­è¨€æ¨¡å‹çš„è¯­ä¹‰ç†è§£èƒ½åŠ›ï¼Œç‰ºç‰²è®­ç»ƒæ•ˆç‡æ˜¯å€¼å¾—çš„ã€‚</p>\n<h2 id=\"135-bert-ä¹‹ä¸‹å¥é¢„æµ‹nsp\"><a class=\"anchor\" href=\"#135-bert-ä¹‹ä¸‹å¥é¢„æµ‹nsp\">#</a> 13.5 BERT ä¹‹ä¸‹å¥é¢„æµ‹ï¼ˆNSPï¼‰</h2>\n<p>åœ¨å¾ˆå¤šè‡ªç„¶è¯­è¨€å¤„ç†çš„ä¸‹æ¸¸ä»»åŠ¡ä¸­ï¼Œå¦‚é—®ç­”å’Œè‡ªç„¶è¯­è¨€æ¨æ–­ï¼Œéƒ½åŸºäºä¸¤ä¸ªå¥å­åšé€»è¾‘æ¨ç†ï¼Œè€Œè¯­è¨€æ¨¡å‹å¹¶ä¸å…·å¤‡ç›´æ¥æ•è·å¥å­ä¹‹é—´çš„è¯­ä¹‰è”ç³»çš„èƒ½åŠ›ï¼Œæˆ–è€…å¯ä»¥è¯´æˆ<strong>å•è¯é¢„æµ‹ç²’åº¦çš„è®­ç»ƒåˆ°ä¸äº†å¥å­å…³ç³»è¿™ä¸ªå±‚çº§</strong>ï¼Œä¸ºäº†<strong>å­¦ä¼šæ•æ‰å¥å­ä¹‹é—´çš„è¯­ä¹‰è”ç³»</strong>ï¼ŒBERT é‡‡ç”¨äº†ä¸‹å¥é¢„æµ‹ï¼ˆNSP ï¼‰ä½œä¸ºæ— ç›‘ç£é¢„è®­ç»ƒçš„ä¸€éƒ¨åˆ†ã€‚</p>\n<p>NSP çš„å…·ä½“åšæ³•æ˜¯ï¼ŒBERT è¾“å…¥çš„è¯­å¥å°†ç”±ä¸¤ä¸ªå¥å­æ„æˆï¼Œå…¶ä¸­ï¼Œ50% çš„æ¦‚ç‡å°†è¯­ä¹‰è¿è´¯çš„ä¸¤ä¸ªè¿ç»­å¥å­ä½œä¸ºè®­ç»ƒæ–‡æœ¬ï¼ˆ<strong>è¿ç»­å¥å¯¹ä¸€èˆ¬é€‰è‡ªç¯‡ç« çº§åˆ«çš„è¯­æ–™ï¼Œä»¥æ­¤ç¡®ä¿å‰åè¯­å¥çš„è¯­ä¹‰å¼ºç›¸å…³</strong>ï¼‰ï¼Œå¦å¤– 50% çš„æ¦‚ç‡å°†å®Œå…¨éšæœºæŠ½å–ä¸¤ä¸ªå¥å­ä½œä¸ºè®­ç»ƒæ–‡æœ¬ã€‚</p>\n<blockquote>\n<p>è¿ç»­å¥å¯¹ï¼š[CLS] ä»Šå¤©å¤©æ°”å¾ˆç³Ÿç³• [SEP] ä¸‹åˆçš„ä½“è‚²è¯¾å–æ¶ˆäº† [SEP]</p>\n<p>éšæœºå¥å¯¹ï¼š[CLS] ä»Šå¤©å¤©æ°”å¾ˆç³Ÿç³• [SEP] é±¼å¿«è¢«çƒ¤ç„¦å•¦ [SEP]</p>\n</blockquote>\n<p>å…¶ä¸­ [SEP]  æ ‡ç­¾è¡¨ç¤ºåˆ†éš”ç¬¦ã€‚ [CLS] è¡¨ç¤ºæ ‡ç­¾ç”¨äºç±»åˆ«é¢„æµ‹ï¼Œç»“æœä¸º 1ï¼Œè¡¨ç¤ºè¾“å…¥ä¸ºè¿ç»­å¥å¯¹ï¼›ç»“æœä¸º 0ï¼Œè¡¨ç¤ºè¾“å…¥ä¸ºéšæœºå¥å¯¹ã€‚</p>\n<p>é€šè¿‡è®­ç»ƒ [CLS] ç¼–ç åçš„è¾“å‡ºæ ‡ç­¾ï¼Œ<strong>BERT å¯ä»¥å­¦ä¼šæ•æ‰ä¸¤ä¸ªè¾“å…¥å¥å¯¹çš„æ–‡æœ¬è¯­ä¹‰</strong>ï¼Œåœ¨è¿ç»­å¥å¯¹çš„é¢„æµ‹ä»»åŠ¡ä¸­ï¼ŒBERT çš„æ­£ç¡®ç‡å¯ä»¥è¾¾åˆ° 97%-98%ã€‚</p>\n<h2 id=\"136-bert-ä¹‹è¾“å…¥è¡¨ç¤º\"><a class=\"anchor\" href=\"#136-bert-ä¹‹è¾“å…¥è¡¨ç¤º\">#</a> 13.6 BERT ä¹‹è¾“å…¥è¡¨ç¤º</h2>\n<p>BERT åœ¨é¢„è®­ç»ƒé˜¶æ®µä½¿ç”¨äº†å‰æ–‡æ‰€è¿°çš„ä¸¤ç§è®­ç»ƒæ–¹æ³•ï¼Œ<strong>åœ¨çœŸå®è®­ç»ƒä¸­ä¸€èˆ¬æ˜¯ä¸¤ç§æ–¹æ³•æ··åˆä½¿ç”¨</strong>ã€‚</p>\n<p>ç”±äº BERT é€šè¿‡ Transformer æ¨¡å‹å †å è€Œæˆï¼Œæ‰€ä»¥ BERT çš„è¾“å…¥éœ€è¦ä¸¤å¥— Embedding æ“ä½œï¼š</p>\n<ol>\n<li>ä¸€å¥—ä¸º One-hot è¯è¡¨æ˜ å°„ç¼–ç ï¼ˆå¯¹åº”ä¸‹å›¾çš„ Token Embeddingsï¼‰ï¼›</li>\n<li>å¦ä¸€å¥—ä¸ºä½ç½®ç¼–ç ï¼ˆå¯¹åº”ä¸‹å›¾çš„ Position Embeddingsï¼‰ï¼Œ<strong>ä¸åŒäº Transformer çš„ä½ç½®ç¼–ç ç”¨ä¸‰è§’å‡½æ•°è¡¨ç¤ºï¼ŒBERT çš„ä½ç½®ç¼–ç å°†åœ¨é¢„è®­ç»ƒè¿‡ç¨‹ä¸­è®­ç»ƒå¾—åˆ°ï¼ˆè®­ç»ƒæ€æƒ³ç±»ä¼¼äº Word Embedding çš„ Q çŸ©é˜µï¼‰</strong></li>\n<li>ç”±äºåœ¨ MLM çš„è®­ç»ƒè¿‡ç¨‹ä¸­ï¼Œå­˜åœ¨å•å¥è¾“å…¥å’ŒåŒå¥è¾“å…¥çš„æƒ…å†µï¼Œå› æ­¤ BERT è¿˜éœ€è¦ä¸€å¥—åŒºåˆ†è¾“å…¥è¯­å¥çš„åˆ†å‰²ç¼–ç ï¼ˆå¯¹åº”ä¸‹å›¾çš„ Segment Embeddingsï¼‰ï¼ŒBERT çš„åˆ†å‰²ç¼–ç ä¹Ÿå°†åœ¨é¢„è®­ç»ƒè¿‡ç¨‹ä¸­è®­ç»ƒå¾—åˆ°</li>\n</ol>\n<p>&lt;img src=&quot;<span class=\"exturl\" data-url=\"aHR0cHM6Ly9pbWdtZC5vc3MtY24tc2hhbmdoYWkuYWxpeXVuY3MuY29tL0JFUlRfSU1HL0JFUlQtJUU4JUJFJTkzJUU1JTg1JUE1LmpwZw==\">https://imgmd.oss-cn-shanghai.aliyuncs.com/BERT_IMG/BERT - è¾“å…¥.jpg</span>&quot; style=&quot;zoom:51%;&quot; /&gt;</p>\n<p>å¯¹äºåˆ†å‰²ç¼–ç ï¼ŒSegment Embeddings å±‚åªæœ‰ä¸¤ç§å‘é‡è¡¨ç¤ºã€‚å‰ä¸€ä¸ªå‘é‡æ˜¯æŠŠ 0 èµ‹ç»™ç¬¬ä¸€ä¸ªå¥å­ä¸­çš„å„ä¸ª tokenï¼Œåä¸€ä¸ªå‘é‡æ˜¯æŠŠ 1 èµ‹ç»™ç¬¬äºŒä¸ªå¥å­ä¸­çš„å„ä¸ª token ï¼›å¦‚æœè¾“å…¥ä»…ä»…åªæœ‰ä¸€ä¸ªå¥å­ï¼Œé‚£ä¹ˆå®ƒçš„ segment embedding å°±æ˜¯å…¨ 0ï¼Œä¸‹é¢æˆ‘ä»¬ç®€å•ä¸¾ä¸ªä¾‹å­æè¿°ä¸‹ï¼š</p>\n<blockquote>\n<p>[CLS] I like dogs [SEP] I like cats [SEP] å¯¹åº”ç¼–ç  0 0 0 0 0 1 1 1 1</p>\n<p>[SEP] I Iike dogs and cats [SEP] å¯¹åº”ç¼–ç  0 0 0 0 0 0 0</p>\n</blockquote>\n<p>&lt;img src=&quot;<span class=\"exturl\" data-url=\"aHR0cHM6Ly9pbWdtZC5vc3MtY24tc2hhbmdoYWkuYWxpeXVuY3MuY29tL0JFUlRfSU1HL3NlZ21lbnQtZW1iZWRkaW5ncy5qcGc=\">https://imgmd.oss-cn-shanghai.aliyuncs.com/BERT_IMG/segment-embeddings.jpg</span>&quot; style=&quot;zoom:50%;&quot; /&gt;</p>\n<h1 id=\"åå››-bert-ä¸‹æ¸¸ä»»åŠ¡æ”¹é€ \"><a class=\"anchor\" href=\"#åå››-bert-ä¸‹æ¸¸ä»»åŠ¡æ”¹é€ \">#</a> åå››ã€BERT ä¸‹æ¸¸ä»»åŠ¡æ”¹é€ </h1>\n<p>BERT æ ¹æ®è‡ªç„¶è¯­è¨€å¤„ç†ä¸‹æ¸¸ä»»åŠ¡çš„è¾“å…¥å’Œè¾“å‡ºçš„å½¢å¼ï¼Œå°†å¾®è°ƒè®­ç»ƒæ”¯æŒçš„ä»»åŠ¡åˆ†ä¸ºå››ç±»ï¼Œåˆ†åˆ«æ˜¯å¥å¯¹åˆ†ç±»ã€å•å¥åˆ†ç±»ã€æ–‡æœ¬é—®ç­”å’Œå•å¥æ ‡æ³¨ï¼Œæ¥ä¸‹æ¥æˆ‘ä»¬å°†ç®€è¦çš„ä»‹ç»ä¸‹ BERT å¦‚ä½•é€šè¿‡å¾®è°ƒè®­ç»ƒé€‚åº”è¿™å››ç±»ä»»åŠ¡çš„è¦æ±‚ã€‚</p>\n<h2 id=\"141-å¥å¯¹åˆ†ç±»\"><a class=\"anchor\" href=\"#141-å¥å¯¹åˆ†ç±»\">#</a> 14.1 å¥å¯¹åˆ†ç±»</h2>\n<p>ç»™å®šä¸¤ä¸ªå¥å­ï¼Œåˆ¤æ–­å®ƒä»¬çš„å…³ç³»ï¼Œç§°ä¸ºå¥å¯¹åˆ†ç±»ï¼Œä¾‹å¦‚åˆ¤æ–­å¥å¯¹æ˜¯å¦ç›¸ä¼¼ã€åˆ¤æ–­åè€…æ˜¯å¦ä¸ºå‰è€…çš„ç­”æ¡ˆã€‚</p>\n<p>é’ˆå¯¹å¥å¯¹åˆ†ç±»ä»»åŠ¡ï¼ŒBERT åœ¨é¢„è®­ç»ƒè¿‡ç¨‹ä¸­å°±ä½¿ç”¨äº† NSP è®­ç»ƒæ–¹æ³•è·å¾—äº†ç›´æ¥æ•è·å¥å¯¹è¯­ä¹‰å…³ç³»çš„èƒ½åŠ›ã€‚</p>\n<p><strong>å¦‚ä¸‹å›¾æ‰€ç¤ºï¼Œå¥å¯¹ç”¨ [SEP] åˆ†éš”ç¬¦æ‹¼æ¥æˆæ–‡æœ¬åºåˆ—ï¼Œåœ¨å¥é¦–åŠ å…¥æ ‡ç­¾ [CLS]ï¼Œå°†å¥é¦–æ ‡ç­¾æ‰€å¯¹åº”çš„è¾“å‡ºå€¼ä½œä¸ºåˆ†ç±»æ ‡ç­¾ï¼Œè®¡ç®—é¢„æµ‹åˆ†ç±»æ ‡ç­¾ä¸çœŸå®åˆ†ç±»æ ‡ç­¾çš„äº¤å‰ç†µï¼Œå°†å…¶ä½œä¸ºä¼˜åŒ–ç›®æ ‡ï¼Œåœ¨ä»»åŠ¡æ•°æ®ä¸Šè¿›è¡Œå¾®è°ƒè®­ç»ƒã€‚</strong></p>\n<p>&lt;img src=&quot;<span class=\"exturl\" data-url=\"aHR0cHM6Ly9pbWdtZC5vc3MtY24tc2hhbmdoYWkuYWxpeXVuY3MuY29tL0JFUlRfSU1HLyVFNSU4RiVBNSVFNSVBRiVCOSVFNSU4OCU4NiVFNyVCMSVCQi5qcGc=\">https://imgmd.oss-cn-shanghai.aliyuncs.com/BERT_IMG/ å¥å¯¹åˆ†ç±».jpg</span>&quot; style=&quot;zoom:80%;&quot; /&gt;</p>\n<p>é’ˆå¯¹äºŒåˆ†ç±»ä»»åŠ¡ï¼ŒBERT ä¸éœ€è¦å¯¹è¾“å…¥æ•°æ®å’Œè¾“å‡ºæ•°æ®çš„ç»“æ„åšä»»ä½•æ”¹åŠ¨ï¼Œç›´æ¥ä½¿ç”¨ä¸ NSP è®­ç»ƒæ–¹æ³•ä¸€æ ·çš„è¾“å…¥å’Œè¾“å‡ºç»“æ„å°±è¡Œã€‚</p>\n<p>é’ˆå¯¹å¤šåˆ†ç±»ä»»åŠ¡ï¼Œéœ€è¦åœ¨å¥é¦–æ ‡ç­¾ [CLS] çš„è¾“å‡ºç‰¹å¾å‘é‡åæ¥ä¸€ä¸ªå…¨è¿æ¥å±‚å’Œ Softmax å±‚ï¼Œä¿è¯è¾“å‡ºç»´æ•°ä¸ç±»åˆ«æ•°ç›®ä¸€è‡´ï¼Œæœ€åé€šè¿‡ arg max æ“ä½œï¼ˆå–æœ€å¤§å€¼æ—¶å¯¹åº”çš„ç´¢å¼•åºå·ï¼‰å¾—åˆ°ç›¸å¯¹åº”çš„ç±»åˆ«ç»“æœã€‚</p>\n<p>ä¸‹é¢ç»™å‡ºå¥å¯¹åˆ†ç›¸ä¼¼æ€§ä»»åŠ¡çš„å®ä¾‹ï¼š</p>\n<blockquote>\n<p>ä»»åŠ¡ï¼šåˆ¤æ–­å¥å­ â€œæˆ‘å¾ˆå–œæ¬¢ä½ â€ å’Œå¥å­ â€œæˆ‘å¾ˆä¸­æ„ä½ â€ æ˜¯å¦ç›¸ä¼¼</p>\n<p>è¾“å…¥æ”¹å†™ï¼šâ€œ[CLS] æˆ‘å¾ˆå–œæ¬¢ä½  [SEP] æˆ‘å¾ˆä¸­æ„ä½ â€</p>\n<p>å– â€œ[CLS]â€ æ ‡ç­¾å¯¹åº”è¾“å‡ºï¼š[0.02, 0.98]</p>\n<p>é€šè¿‡ arg max æ“ä½œå¾—åˆ°ç›¸ä¼¼ç±»åˆ«ä¸º 1ï¼ˆç±»åˆ«ç´¢å¼•ä» 0 å¼€å§‹ï¼‰ï¼Œå³ä¸¤ä¸ªå¥å­ç›¸ä¼¼</p>\n</blockquote>\n<h2 id=\"142-å•å¥åˆ†ç±»\"><a class=\"anchor\" href=\"#142-å•å¥åˆ†ç±»\">#</a> 14.2 å•å¥åˆ†ç±»</h2>\n<p>ç»™å®šä¸€ä¸ªå¥å­ï¼Œåˆ¤æ–­è¯¥å¥å­çš„ç±»åˆ«ï¼Œç»Ÿç§°ä¸ºå•å¥åˆ†ç±»ï¼Œä¾‹å¦‚åˆ¤æ–­æƒ…æ„Ÿç±»åˆ«ã€åˆ¤æ–­æ˜¯å¦ä¸ºè¯­ä¹‰è¿è´¯çš„å¥å­ã€‚</p>\n<p>é’ˆå¯¹å•å¥äºŒåˆ†ç±»ä»»åŠ¡ï¼Œä¹Ÿæ— é¡»å¯¹ BERT çš„è¾“å…¥æ•°æ®å’Œè¾“å‡ºæ•°æ®çš„ç»“æ„åšä»»ä½•æ”¹åŠ¨ã€‚</p>\n<p><strong>å¦‚ä¸‹å›¾æ‰€ç¤ºï¼Œå•å¥åˆ†ç±»åœ¨å¥é¦–åŠ å…¥æ ‡ç­¾ [CLS]ï¼Œå°†å¥é¦–æ ‡ç­¾æ‰€å¯¹åº”çš„è¾“å‡ºå€¼ä½œä¸ºåˆ†ç±»æ ‡ç­¾ï¼Œè®¡ç®—é¢„æµ‹åˆ†ç±»æ ‡ç­¾ä¸çœŸå®åˆ†ç±»æ ‡ç­¾çš„äº¤å‰ç†µï¼Œå°†å…¶ä½œä¸ºä¼˜åŒ–ç›®æ ‡ï¼Œåœ¨ä»»åŠ¡æ•°æ®ä¸Šè¿›è¡Œå¾®è°ƒè®­ç»ƒã€‚</strong></p>\n<p>&lt;img src=&quot;<span class=\"exturl\" data-url=\"aHR0cHM6Ly9pbWdtZC5vc3MtY24tc2hhbmdoYWkuYWxpeXVuY3MuY29tL0JFUlRfSU1HLyVFNSU4RCU5NSVFNSU4RiVBNSVFNSU4OCU4NiVFNyVCMSVCQi5qcGc=\">https://imgmd.oss-cn-shanghai.aliyuncs.com/BERT_IMG/ å•å¥åˆ†ç±».jpg</span>&quot; style=&quot;zoom:80%;&quot; /&gt;</p>\n<p>åŒæ ·ï¼Œé’ˆå¯¹å¤šåˆ†ç±»ä»»åŠ¡ï¼Œéœ€è¦åœ¨å¥é¦–æ ‡ç­¾ [CLS] çš„è¾“å‡ºç‰¹å¾å‘é‡åæ¥ä¸€ä¸ªå…¨è¿æ¥å±‚å’Œ Softmax å±‚ï¼Œä¿è¯è¾“å‡ºç»´æ•°ä¸ç±»åˆ«æ•°ç›®ä¸€è‡´ï¼Œæœ€åé€šè¿‡ argmax æ“ä½œå¾—åˆ°ç›¸å¯¹åº”çš„ç±»åˆ«ç»“æœã€‚</p>\n<p>ä¸‹é¢ç»™å‡ºè¯­ä¹‰è¿è´¯æ€§åˆ¤æ–­ä»»åŠ¡çš„å®ä¾‹ï¼š</p>\n<blockquote>\n<p>ä»»åŠ¡ï¼šåˆ¤æ–­å¥å­ â€œæµ·å¤§çƒæ˜Ÿé¥­èŒ¶åƒâ€ æ˜¯å¦ä¸ºä¸€å¥è¯</p>\n<p>è¾“å…¥æ”¹å†™ï¼šâ€œ[CLS] æµ·å¤§çƒæ˜Ÿé¥­èŒ¶åƒâ€</p>\n<p>å– â€œ[CLS]â€ æ ‡ç­¾å¯¹åº”è¾“å‡ºï¼š[0.99, 0.01]</p>\n<p>é€šè¿‡ arg max æ“ä½œå¾—åˆ°ç›¸ä¼¼ç±»åˆ«ä¸º 0ï¼Œå³è¿™ä¸ªå¥å­ä¸æ˜¯ä¸€ä¸ªè¯­ä¹‰è¿è´¯çš„å¥å­</p>\n</blockquote>\n<h2 id=\"143-æ–‡æœ¬é—®ç­”\"><a class=\"anchor\" href=\"#143-æ–‡æœ¬é—®ç­”\">#</a> 14.3 æ–‡æœ¬é—®ç­”</h2>\n<p>ç»™å®šä¸€ä¸ªé—®å¥å’Œä¸€ä¸ªè•´å«ç­”æ¡ˆçš„å¥å­ï¼Œæ‰¾å‡ºç­”æ¡ˆåœ¨åè¿™ç§çš„ä½ç½®ï¼Œç§°ä¸ºæ–‡æœ¬é—®ç­”ï¼Œä¾‹å¦‚ç»™å®šä¸€ä¸ªé—®é¢˜ï¼ˆå¥å­ Aï¼‰ï¼Œåœ¨ç»™å®šçš„æ®µè½ï¼ˆå¥å­ Bï¼‰ä¸­æ ‡æ³¨ç­”æ¡ˆçš„å…¶å®ä½ç½®å’Œç»ˆæ­¢ä½ç½®ã€‚</p>\n<p><strong>æ–‡æœ¬é—®ç­”ä»»ä½•å’Œå‰é¢è®²çš„å…¶ä»–ä»»åŠ¡æœ‰è¾ƒå¤§çš„å·®åˆ«ï¼Œæ— è®ºæ˜¯åœ¨ä¼˜åŒ–ç›®æ ‡ä¸Šï¼Œè¿˜æ˜¯åœ¨è¾“å…¥æ•°æ®å’Œè¾“å‡ºæ•°æ®çš„å½¢å¼ä¸Šï¼Œéƒ½éœ€è¦åšä¸€äº›ç‰¹æ®Šçš„å¤„ç†ã€‚</strong></p>\n<p>ä¸ºäº†æ ‡æ³¨ç­”æ¡ˆçš„èµ·å§‹ä½ç½®å’Œç»ˆæ­¢ä½ç½®ï¼ŒBERT å¼•å…¥ä¸¤ä¸ªè¾…åŠ©å‘é‡ sï¼ˆstartï¼Œåˆ¤æ–­ç­”æ¡ˆçš„èµ·å§‹ä½ç½®ï¼‰ å’Œ eï¼ˆendï¼Œåˆ¤æ–­ç­”æ¡ˆçš„ç»ˆæ­¢ä½ç½®ï¼‰ã€‚</p>\n<p><strong>å¦‚ä¸‹å›¾æ‰€ç¤ºï¼ŒBERT åˆ¤æ–­å¥å­ B ä¸­ç­”æ¡ˆä½ç½®çš„åšæ³•æ˜¯ï¼Œå°†å¥å­ B ä¸­çš„æ¯ä¸€ä¸ªæ¬¡å¾—åˆ°çš„æœ€ç»ˆç‰¹å¾å‘é‡ <span class=\"katex\"><span class=\"katex-mathml\"><math xmlns=\"http://www.w3.org/1998/Math/MathML\"><semantics><mrow><msubsup><mi>T</mi><mi>i</mi><mo mathvariant=\"normal\" lspace=\"0em\" rspace=\"0em\">â€²</mo></msubsup></mrow><annotation encoding=\"application/x-tex\">T_i&#x27;</annotation></semantics></math></span><span class=\"katex-html\" aria-hidden=\"true\"><span class=\"base\"><span class=\"strut\" style=\"height:1.010556em;vertical-align:-0.258664em;\"></span><span class=\"mord\"><span class=\"mord mathnormal\" style=\"margin-right:0.13889em;\">T</span><span class=\"msupsub\"><span class=\"vlist-t vlist-t2\"><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.751892em;\"><span style=\"top:-2.441336em;margin-left:-0.13889em;margin-right:0.05em;\"><span class=\"pstrut\" style=\"height:2.7em;\"></span><span class=\"sizing reset-size6 size3 mtight\"><span class=\"mord mathnormal mtight\">i</span></span></span><span style=\"top:-3.063em;margin-right:0.05em;\"><span class=\"pstrut\" style=\"height:2.7em;\"></span><span class=\"sizing reset-size6 size3 mtight\"><span class=\"mord mtight\"><span class=\"mord mtight\">â€²</span></span></span></span></span><span class=\"vlist-s\">â€‹</span></span><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.258664em;\"><span></span></span></span></span></span></span></span></span></span> ç»è¿‡å…¨è¿æ¥å±‚ï¼ˆåˆ©ç”¨å…¨è¿æ¥å±‚å°†è¯çš„æŠ½è±¡è¯­ä¹‰ç‰¹å¾è½¬åŒ–ä¸ºä»»åŠ¡æŒ‡å‘çš„ç‰¹å¾ï¼‰åï¼Œåˆ†åˆ«ä¸å‘é‡ s å’Œ e æ±‚å†…ç§¯ï¼Œå¯¹æ‰€æœ‰å†…ç§¯åˆ†åˆ«è¿›è¡Œ softmax æ“ä½œï¼Œå³å¯å¾—åˆ°è¯ Tok mï¼ˆ<span class=\"katex\"><span class=\"katex-mathml\"><math xmlns=\"http://www.w3.org/1998/Math/MathML\"><semantics><mrow><mi>m</mi><mo>âˆˆ</mo><mo stretchy=\"false\">[</mo><mn>1</mn><mo separator=\"true\">,</mo><mi>M</mi><mo stretchy=\"false\">]</mo></mrow><annotation encoding=\"application/x-tex\">m\\in [1,M]</annotation></semantics></math></span><span class=\"katex-html\" aria-hidden=\"true\"><span class=\"base\"><span class=\"strut\" style=\"height:0.5782em;vertical-align:-0.0391em;\"></span><span class=\"mord mathnormal\">m</span><span class=\"mspace\" style=\"margin-right:0.2777777777777778em;\"></span><span class=\"mrel\">âˆˆ</span><span class=\"mspace\" style=\"margin-right:0.2777777777777778em;\"></span></span><span class=\"base\"><span class=\"strut\" style=\"height:1em;vertical-align:-0.25em;\"></span><span class=\"mopen\">[</span><span class=\"mord\">1</span><span class=\"mpunct\">,</span><span class=\"mspace\" style=\"margin-right:0.16666666666666666em;\"></span><span class=\"mord mathnormal\" style=\"margin-right:0.10903em;\">M</span><span class=\"mclose\">]</span></span></span></span>ï¼‰ä½œä¸ºç­”æ¡ˆå…¶å®ä½ç½®å’Œç»ˆæ­¢ä½ç½®çš„æ¦‚ç‡ã€‚æœ€åï¼Œå»æ¦‚ç‡æœ€å¤§çš„ç‰‡æ®µä½œä¸ºæœ€ç»ˆçš„ç­”æ¡ˆ</strong>ã€‚</p>\n<p>&lt;img src=&quot;<span class=\"exturl\" data-url=\"aHR0cHM6Ly9pbWdtZC5vc3MtY24tc2hhbmdoYWkuYWxpeXVuY3MuY29tL0JFUlRfSU1HLyVFNiU5NiU4NyVFNiU5QyVBQyVFOSU5NyVBRSVFNyVBRCU5NC5qcGc=\">https://imgmd.oss-cn-shanghai.aliyuncs.com/BERT_IMG/ æ–‡æœ¬é—®ç­”.jpg</span>&quot; style=&quot;zoom:80%;&quot; /&gt;</p>\n<p>æ–‡æœ¬å›ç­”ä»»åŠ¡çš„å¾®è°ƒè®­ç»ƒä½¿ç”¨äº†ä¸¤ä¸ªæŠ€å·§ï¼š</p>\n<ol>\n<li>ç”¨å…¨è¿æ¥å±‚æŠŠ BERT æå–åçš„æ·±å±‚ç‰¹å¾å‘é‡è½¬åŒ–ä¸ºç”¨äºåˆ¤æ–­ç­”æ¡ˆä½ç½®çš„ç‰¹å¾å‘é‡</li>\n<li>å¼•å…¥è¾…åŠ©å‘é‡ s å’Œ e ä½œä¸ºç­”æ¡ˆå…¶å®ä½ç½®å’Œç»ˆæ­¢ä½ç½®çš„åŸºå‡†å‘é‡ï¼Œæ˜ç¡®ä¼˜åŒ–ç›®æ ‡çš„æ–¹å‘å’Œåº¦é‡æ–¹æ³•</li>\n</ol>\n<p>ä¸‹é¢ç»™å‡ºæ–‡æœ¬é—®ç­”ä»»åŠ¡çš„å®ä¾‹ï¼š</p>\n<blockquote>\n<p>ä»»åŠ¡ï¼šç»™å®šé—®å¥ â€œä»Šå¤©çš„æœ€é«˜æ¸©åº¦æ˜¯å¤šå°‘â€ï¼Œåœ¨æ–‡æœ¬ â€œå¤©æ°”é¢„æŠ¥æ˜¾ç¤ºä»Šå¤©æœ€é«˜æ¸©åº¦ 37 æ‘„æ°åº¦â€ ä¸­æ ‡æ³¨ç­”æ¡ˆçš„èµ·å§‹ä½ç½®å’Œç»ˆæ­¢ä½ç½®</p>\n<p>è¾“å…¥æ”¹å†™ï¼šâ€œ[CLS] ä»Šå¤©çš„æœ€é«˜æ¸©åº¦æ˜¯å¤šå°‘ [SEP] å¤©æ°”é¢„æŠ¥æ˜¾ç¤ºä»Šå¤©æœ€é«˜æ¸©åº¦ 37 æ‘„æ°åº¦â€</p>\n<p>BERT Softmax ç»“æœï¼š</p>\n<table>\n<thead>\n<tr>\n<th style=\"text-align:center\">ç¯‡ç« æ–‡æœ¬</th>\n<th style=\"text-align:center\">å¤©æ°”</th>\n<th style=\"text-align:center\">é¢„æŠ¥</th>\n<th style=\"text-align:center\">æ˜¾ç¤º</th>\n<th style=\"text-align:center\">ä»Šå¤©</th>\n<th style=\"text-align:center\">æœ€é«˜æ¸©</th>\n<th style=\"text-align:center\">37</th>\n<th style=\"text-align:center\">æ‘„æ°åº¦</th>\n</tr>\n</thead>\n<tbody>\n<tr>\n<td style=\"text-align:center\">èµ·å§‹ä½ç½®æ¦‚ç‡</td>\n<td style=\"text-align:center\">0.01</td>\n<td style=\"text-align:center\">0.01</td>\n<td style=\"text-align:center\">0.01</td>\n<td style=\"text-align:center\">0.04</td>\n<td style=\"text-align:center\">0.10</td>\n<td style=\"text-align:center\">0.80</td>\n<td style=\"text-align:center\">0.03</td>\n</tr>\n<tr>\n<td style=\"text-align:center\">ç»ˆæ­¢ä½ç½®æ¦‚ç‡</td>\n<td style=\"text-align:center\">0.01</td>\n<td style=\"text-align:center\">0.01</td>\n<td style=\"text-align:center\">0.01</td>\n<td style=\"text-align:center\">0.03</td>\n<td style=\"text-align:center\">0.04</td>\n<td style=\"text-align:center\">0.10</td>\n<td style=\"text-align:center\">0.80</td>\n</tr>\n</tbody>\n</table>\n<p>å¯¹ Softmax çš„ç»“æœå– arg maxï¼Œå¾—åˆ°ç­”æ¡ˆçš„èµ·å§‹ä½ç½®ä¸º 6ï¼Œç»ˆæ­¢ä½ç½®ä¸º 7ï¼Œå³ç­”æ¡ˆä¸º â€œ37 æ‘„æ°åº¦â€</p>\n</blockquote>\n<h2 id=\"144-å•å¥æ ‡æ³¨\"><a class=\"anchor\" href=\"#144-å•å¥æ ‡æ³¨\">#</a> 14.4 å•å¥æ ‡æ³¨</h2>\n<p>ç»™å®šä¸€ä¸ªå¥å­ï¼Œæ ‡æ³¨æ¯ä¸ªæ¬¡çš„æ ‡ç­¾ï¼Œç§°ä¸ºå•å¥æ ‡æ³¨ã€‚ä¾‹å¦‚ç»™å®šä¸€ä¸ªå¥å­ï¼Œæ ‡æ³¨å¥å­ä¸­çš„äººåã€åœ°åå’Œæœºæ„åã€‚</p>\n<p>å•å¥æ ‡æ³¨ä»»åŠ¡å’Œ BERT é¢„è®­ç»ƒä»»åŠ¡å…·æœ‰è¾ƒå¤§å·®å¼‚ï¼Œä½†ä¸æ–‡æœ¬é—®ç­”ä»»åŠ¡è¾ƒä¸ºç›¸ä¼¼ã€‚</p>\n<p><strong>å¦‚ä¸‹å›¾æ‰€ç¤ºï¼Œåœ¨è¿›è¡Œå•å¥æ ‡æ³¨ä»»åŠ¡æ—¶ï¼Œéœ€è¦åœ¨æ¯ä¸ªè¯çš„æœ€ç»ˆè¯­ä¹‰ç‰¹å¾å‘é‡ä¹‹åæ·»åŠ å…¨è¿æ¥å±‚ï¼Œå°†è¯­ä¹‰ç‰¹å¾è½¬åŒ–ä¸ºåºåˆ—æ ‡æ³¨ä»»åŠ¡æ‰€éœ€çš„ç‰¹å¾ï¼Œå•å¥æ ‡æ³¨ä»»åŠ¡éœ€è¦å¯¹æ¯ä¸ªè¯éƒ½åšæ ‡æ³¨ï¼Œå› æ­¤ä¸éœ€è¦å¼•å…¥è¾…åŠ©å‘é‡ï¼Œç›´æ¥å¯¹ç»è¿‡å…¨è¿æ¥å±‚åçš„ç»“æœåš Softmax æ“ä½œï¼Œå³å¯å¾—åˆ°å„ç±»æ ‡ç­¾çš„æ¦‚ç‡åˆ†å¸ƒã€‚</strong></p>\n<p>&lt;img src=&quot;<span class=\"exturl\" data-url=\"aHR0cHM6Ly9pbWdtZC5vc3MtY24tc2hhbmdoYWkuYWxpeXVuY3MuY29tL0JFUlRfSU1HLyVFNSU4RCU5NSVFNSU4RiVBNSVFNiVBMCU4NyVFNiVCMyVBOC5qcGc=\">https://imgmd.oss-cn-shanghai.aliyuncs.com/BERT_IMG/ å•å¥æ ‡æ³¨.jpg</span>&quot; style=&quot;zoom:50%;&quot; /&gt;</p>\n<p>ç”±äº BERT éœ€è¦å¯¹è¾“å…¥æ–‡æœ¬è¿›è¡Œåˆ†è¯æ“ä½œï¼Œç‹¬ç«‹è¯å°†ä¼šè¢«åˆ†æˆè‹¥å¹²å­è¯ï¼Œå› æ­¤ BERT é¢„æµ‹çš„ç»“æœå°†ä¼šæ˜¯ 5 ç±»ï¼ˆç»†åˆ†ä¸º 13 å°ç±»ï¼‰ï¼š</p>\n<ul>\n<li>Oï¼ˆéäººååœ°åæœºæ„åï¼ŒO è¡¨ç¤º Otherï¼‰</li>\n<li>B-PER/LOC/ORGï¼ˆäººå / åœ°å / æœºæ„ååˆå§‹å•è¯ï¼ŒB è¡¨ç¤º Beginï¼‰</li>\n<li>I-PER/LOC/ORGï¼ˆäººå / åœ°å / æœºæ„åä¸­é—´å•è¯ï¼ŒI è¡¨ç¤º Intermediateï¼‰</li>\n<li>E-PER/LOC/ORGï¼ˆäººå / åœ°å / æœºæ„åç»ˆæ­¢å•è¯ï¼ŒE è¡¨ç¤º Endï¼‰</li>\n<li>S-PER/LOC/ORGï¼ˆäººå / åœ°å / æœºæ„åç‹¬ç«‹å•è¯ï¼ŒS è¡¨ç¤º Singleï¼‰</li>\n</ul>\n<p>å°† 5 å¤§ç±»çš„é¦–å­—æ¯ç»“åˆï¼Œå¯å¾— IOBESï¼Œè¿™æ˜¯åºåˆ—æ ‡æ³¨æœ€å¸¸ç”¨çš„æ ‡æ³¨æ–¹æ³•ã€‚</p>\n<p>ä¸‹é¢ç»™å‡ºå‘½åå®ä½“è¯†åˆ«ï¼ˆNERï¼‰ä»»åŠ¡çš„ç¤ºä¾‹ï¼š</p>\n<blockquote>\n<p>ä»»åŠ¡ï¼šç»™å®šå¥å­ â€œçˆ±å› æ–¯å¦åœ¨æŸæ—å‘è¡¨æ¼”è®²â€ï¼Œæ ¹æ® IOBES æ ‡æ³¨ NER ç»“æœ</p>\n<p>è¾“å…¥æ”¹å†™ï¼šâ€œ[CLS] çˆ± å›  æ–¯å¦ åœ¨ æŸæ— å‘è¡¨ æ¼”è®²â€</p>\n<p>BERT Softmax ç»“æœï¼š</p>\n<table>\n<thead>\n<tr>\n<th style=\"text-align:center\">BOBES</th>\n<th style=\"text-align:center\">çˆ±</th>\n<th style=\"text-align:center\">å› </th>\n<th style=\"text-align:center\">æ–¯å¦</th>\n<th style=\"text-align:center\">åœ¨</th>\n<th style=\"text-align:center\">æŸæ—</th>\n<th style=\"text-align:center\">å‘è¡¨</th>\n<th style=\"text-align:center\">æ¼”è®²</th>\n</tr>\n</thead>\n<tbody>\n<tr>\n<td style=\"text-align:center\">O</td>\n<td style=\"text-align:center\">0.01</td>\n<td style=\"text-align:center\">0.01</td>\n<td style=\"text-align:center\">0.01</td>\n<td style=\"text-align:center\">0.90</td>\n<td style=\"text-align:center\">0.01</td>\n<td style=\"text-align:center\">0.90</td>\n<td style=\"text-align:center\">0.90</td>\n</tr>\n<tr>\n<td style=\"text-align:center\">B-PER</td>\n<td style=\"text-align:center\">0.90</td>\n<td style=\"text-align:center\">0.01</td>\n<td style=\"text-align:center\">0.01</td>\n<td style=\"text-align:center\">0.01</td>\n<td style=\"text-align:center\">0.01</td>\n<td style=\"text-align:center\">0.01</td>\n<td style=\"text-align:center\">0.01</td>\n</tr>\n<tr>\n<td style=\"text-align:center\">I-PER</td>\n<td style=\"text-align:center\">0.01</td>\n<td style=\"text-align:center\">0.90</td>\n<td style=\"text-align:center\">0.01</td>\n<td style=\"text-align:center\">0.01</td>\n<td style=\"text-align:center\">0.01</td>\n<td style=\"text-align:center\">0.01</td>\n<td style=\"text-align:center\">0.01</td>\n</tr>\n<tr>\n<td style=\"text-align:center\">E-PER</td>\n<td style=\"text-align:center\">0.01</td>\n<td style=\"text-align:center\">0.01</td>\n<td style=\"text-align:center\">0.90</td>\n<td style=\"text-align:center\">0.01</td>\n<td style=\"text-align:center\">0.01</td>\n<td style=\"text-align:center\">0.01</td>\n<td style=\"text-align:center\">0.01</td>\n</tr>\n<tr>\n<td style=\"text-align:center\">S-LOC</td>\n<td style=\"text-align:center\">0.01</td>\n<td style=\"text-align:center\">0.01</td>\n<td style=\"text-align:center\">0.01</td>\n<td style=\"text-align:center\">0.01</td>\n<td style=\"text-align:center\">0.01</td>\n<td style=\"text-align:center\">0.01</td>\n<td style=\"text-align:center\">0.01</td>\n</tr>\n</tbody>\n</table>\n<p>å¯¹ Softmax çš„ç»“æœå– arg maxï¼Œå¾—åˆ°æœ€ç»ˆåœ° NER æ ‡æ³¨ç»“æœä¸ºï¼šâ€œçˆ±å› æ–¯å¦â€ æ˜¯äººåï¼›â€œæŸæ—â€ æ˜¯åœ°å</p>\n</blockquote>\n<h2 id=\"145-bertæ•ˆæœå±•ç¤º\"><a class=\"anchor\" href=\"#145-bertæ•ˆæœå±•ç¤º\">#</a> 14.5 BERT æ•ˆæœå±•ç¤º</h2>\n<p>æ— è®ºå¦‚ä½•ï¼Œä»ä¸Šè¿°è®²è§£å¯ä»¥çœ‹å‡ºï¼ŒNLP å››å¤§ç±»ä»»åŠ¡éƒ½å¯ä»¥æ¯”è¾ƒæ–¹ä¾¿åœ°æ”¹é€ æˆ Bert èƒ½å¤Ÿæ¥å—çš„æ–¹å¼ï¼Œæ€»ä¹‹ä¸åŒç±»å‹çš„ä»»åŠ¡éœ€è¦å¯¹æ¨¡å‹åšä¸åŒçš„ä¿®æ”¹ï¼Œä½†æ˜¯ä¿®æ”¹éƒ½æ˜¯éå¸¸ç®€å•çš„ï¼Œæœ€å¤šåŠ ä¸€å±‚ç¥ç»ç½‘ç»œå³å¯ã€‚è¿™å…¶å®æ˜¯ Bert çš„éå¸¸å¤§çš„ä¼˜ç‚¹ï¼Œè¿™æ„å‘³ç€å®ƒå‡ ä¹å¯ä»¥åšä»»ä½• NLP çš„ä¸‹æ¸¸ä»»åŠ¡ï¼Œå…·å¤‡æ™®é€‚æ€§ï¼Œè¿™æ˜¯å¾ˆå¼ºçš„ã€‚</p>\n<p>ä½†æ˜¯è®²äº†è¿™ä¹ˆå¤šï¼Œ** ä¸€ä¸ªæ–°æ¨¡å‹å¥½ä¸å¥½ï¼Œæ•ˆæœæ‰æ˜¯ç‹é“ã€‚** é‚£ä¹ˆ Bert é‡‡ç”¨è¿™ç§ä¸¤é˜¶æ®µæ–¹å¼è§£å†³å„ç§ NLP ä»»åŠ¡æ•ˆæœå¦‚ä½•ï¼Ÿ</p>\n<p>åœ¨ 11 ä¸ªå„ç§ç±»å‹çš„ NLP ä»»åŠ¡ä¸­è¾¾åˆ°ç›®å‰æœ€å¥½çš„æ•ˆæœï¼ŒæŸäº›ä»»åŠ¡æ€§èƒ½æœ‰æå¤§çš„æå‡ã€‚</p>\n<p>&lt;img src=&quot;<span class=\"exturl\" data-url=\"aHR0cHM6Ly9pbWdtZC5vc3MtY24tc2hhbmdoYWkuYWxpeXVuY3MuY29tL0JFUlRfSU1HL2JlcnQtJUU2JTk1JTg4JUU2JTlFJTlDLmpwZw==\">https://imgmd.oss-cn-shanghai.aliyuncs.com/BERT_IMG/bert - æ•ˆæœ.jpg</span>&quot; style=&quot;zoom:50%;&quot; /&gt;</p>\n<h1 id=\"åäº”-é¢„è®­ç»ƒè¯­è¨€æ¨¡å‹æ€»ç»“\"><a class=\"anchor\" href=\"#åäº”-é¢„è®­ç»ƒè¯­è¨€æ¨¡å‹æ€»ç»“\">#</a> åäº”ã€é¢„è®­ç»ƒè¯­è¨€æ¨¡å‹æ€»ç»“</h1>\n<p>&lt;img src=&quot;<span class=\"exturl\" data-url=\"aHR0cHM6Ly9pbWdtZC5vc3MtY24tc2hhbmdoYWkuYWxpeXVuY3MuY29tL0JFUlRfSU1HLyVFNiU4MCVCQiVFNyVCQiU5My5qcGc=\">https://imgmd.oss-cn-shanghai.aliyuncs.com/BERT_IMG/ æ€»ç»“.jpg</span>&quot; style=&quot;zoom:50%;&quot; /&gt;</p>\n<p>åˆ°è¿™é‡Œæˆ‘ä»¬å¯ä»¥å†æ¢³ç†ä¸‹å‡ ä¸ªæ¨¡å‹ä¹‹é—´çš„æ¼”è¿›å…³ç³»ã€‚</p>\n<p>ä»ä¸Šå›¾å¯è§ï¼ŒBert å…¶å®å’Œ ELMO åŠ GPT å­˜åœ¨åƒä¸ä¸‡ç¼•çš„å…³ç³»ï¼Œæ¯”å¦‚å¦‚æœæˆ‘ä»¬æŠŠ GPT é¢„è®­ç»ƒé˜¶æ®µæ¢æˆåŒå‘è¯­è¨€æ¨¡å‹ï¼Œé‚£ä¹ˆå°±å¾—åˆ°äº† Bertï¼›è€Œå¦‚æœæˆ‘ä»¬æŠŠ ELMO çš„ç‰¹å¾æŠ½å–å™¨æ¢æˆ Transformerï¼Œé‚£ä¹ˆæˆ‘ä»¬ä¹Ÿä¼šå¾—åˆ° Bertã€‚</p>\n<p>æ‰€ä»¥ä½ å¯ä»¥çœ‹å‡ºï¼šBert æœ€å…³é”®ä¸¤ç‚¹ï¼Œä¸€ç‚¹æ˜¯ç‰¹å¾æŠ½å–å™¨é‡‡ç”¨ Transformerï¼›ç¬¬äºŒç‚¹æ˜¯é¢„è®­ç»ƒçš„æ—¶å€™é‡‡ç”¨åŒå‘è¯­è¨€æ¨¡å‹ã€‚</p>\n<p>é‚£ä¹ˆæ–°é—®é¢˜æ¥äº†ï¼šå¯¹äº Transformer æ¥è¯´ï¼Œæ€ä¹ˆæ‰èƒ½åœ¨è¿™ä¸ªç»“æ„ä¸ŠåšåŒå‘è¯­è¨€æ¨¡å‹ä»»åŠ¡å‘¢ï¼Ÿä¹ä¸€çœ‹ä¸Šå»å¥½åƒä¸å¤ªå¥½æã€‚æˆ‘è§‰å¾—å§ï¼Œå…¶å®æœ‰ä¸€ç§å¾ˆç›´è§‚çš„æ€è·¯ï¼Œæ€ä¹ˆåŠï¼Ÿçœ‹çœ‹ ELMO çš„ç½‘ç»œç»“æ„å›¾ï¼Œåªéœ€è¦æŠŠä¸¤ä¸ª LSTM æ›¿æ¢æˆä¸¤ä¸ª Transformerï¼Œä¸€ä¸ªè´Ÿè´£æ­£å‘ï¼Œä¸€ä¸ªè´Ÿè´£åå‘ç‰¹å¾æå–ï¼Œå…¶å®åº”è¯¥å°±å¯ä»¥ã€‚</p>\n<p>å½“ç„¶è¿™æ˜¯æˆ‘è‡ªå·±çš„æ”¹é€ ï¼ŒBert æ²¡è¿™ä¹ˆåšã€‚é‚£ä¹ˆ Bert æ˜¯æ€ä¹ˆåšçš„å‘¢ï¼Ÿæˆ‘ä»¬å‰é¢ä¸æ˜¯æè¿‡ Word2Vec å—ï¼Ÿæˆ‘å‰é¢è‚¯å®šä¸æ˜¯æ¼«æ— ç›®çš„åœ°æåˆ°å®ƒï¼Œæå®ƒæ˜¯ä¸ºäº†åœ¨è¿™é‡Œå¼•å‡ºé‚£ä¸ª CBOW è®­ç»ƒæ–¹æ³•ï¼Œæ‰€è°“å†™ä½œæ—¶å€™åŸ‹ä¼ç¬”çš„ â€œè‰è›‡ç°çº¿ï¼Œä¼è„‰åƒé‡Œâ€ï¼Œå¤§æ¦‚å°±æ˜¯è¿™ä¸ªæ„æ€å§ï¼Ÿ</p>\n<p>å‰é¢æåˆ°äº† CBOW æ–¹æ³•ï¼Œå®ƒçš„æ ¸å¿ƒæ€æƒ³æ˜¯ï¼šåœ¨åšè¯­è¨€æ¨¡å‹ä»»åŠ¡çš„æ—¶å€™ï¼Œæˆ‘æŠŠè¦é¢„æµ‹çš„å•è¯æŠ æ‰ï¼Œç„¶åæ ¹æ®å®ƒçš„ä¸Šæ–‡ Context-Before å’Œä¸‹æ–‡ Context-afte r å»é¢„æµ‹å•è¯ã€‚</p>\n<p>å…¶å® Bert æ€ä¹ˆåšçš„ï¼ŸBert å°±æ˜¯è¿™ä¹ˆåšçš„ã€‚ä»è¿™é‡Œå¯ä»¥çœ‹åˆ°æ–¹æ³•é—´çš„ç»§æ‰¿å…³ç³»ã€‚å½“ç„¶ Bert ä½œè€…æ²¡æ Word2Vec åŠ CBOW æ–¹æ³•ï¼Œè¿™æ˜¯æˆ‘çš„åˆ¤æ–­ï¼ŒBert ä½œè€…è¯´æ˜¯å—åˆ°å®Œå½¢å¡«ç©ºä»»åŠ¡çš„å¯å‘ï¼Œè¿™ä¹Ÿå¾ˆå¯èƒ½ï¼Œä½†æ˜¯æˆ‘è§‰å¾—ä»–ä»¬è¦æ˜¯æ²¡æƒ³åˆ°è¿‡ CBOW ä¼°è®¡æ˜¯ä¸å¤ªå¯èƒ½çš„ã€‚</p>\n<p>ä»è¿™é‡Œå¯ä»¥çœ‹å‡ºï¼Œåœ¨æ–‡ç« å¼€å§‹æˆ‘è¯´è¿‡ Bert åœ¨æ¨¡å‹æ–¹é¢å…¶å®æ²¡æœ‰å¤ªå¤§åˆ›æ–°ï¼Œæ›´åƒä¸€ä¸ªæœ€è¿‘å‡ å¹´ NLP é‡è¦æŠ€æœ¯çš„é›†å¤§æˆè€…ï¼ŒåŸå› åœ¨äºæ­¤ï¼Œå½“ç„¶æˆ‘ä¸ç¡®å®šä½ æ€ä¹ˆçœ‹ï¼Œæ˜¯å¦è®¤åŒè¿™ç§çœ‹æ³•ï¼Œè€Œä¸”æˆ‘ä¹Ÿä¸å…³å¿ƒä½ æ€ä¹ˆçœ‹ã€‚å…¶å® Bert æœ¬èº«çš„æ•ˆæœå¥½å’Œæ™®é€‚æ€§å¼ºæ‰æ˜¯æœ€å¤§çš„äº®ç‚¹ã€‚</p>\n<p><strong>æœ€åï¼Œæˆ‘è®²è®²æˆ‘å¯¹ Bert çš„è¯„ä»·å’Œçœ‹æ³•</strong>ï¼Œæˆ‘è§‰å¾— Bert æ˜¯ NLP é‡Œé‡Œç¨‹ç¢‘å¼çš„å·¥ä½œï¼Œå¯¹äºåé¢ NLP çš„ç ”ç©¶å’Œå·¥ä¸šåº”ç”¨ä¼šäº§ç”Ÿé•¿ä¹…çš„å½±å“ï¼Œè¿™ç‚¹æ¯«æ— ç–‘é—®ã€‚ä½†æ˜¯ä»ä¸Šæ–‡ä»‹ç»ä¹Ÿå¯ä»¥çœ‹å‡ºï¼Œä»æ¨¡å‹æˆ–è€…æ–¹æ³•è§’åº¦çœ‹ï¼ŒBert å€Ÿé‰´äº† ELMOï¼ŒGPT åŠ CBOWï¼Œä¸»è¦æå‡ºäº† Masked è¯­è¨€æ¨¡å‹åŠ Next Sentence Predictionï¼Œä½†æ˜¯è¿™é‡Œ Next Sentence Prediction åŸºæœ¬ä¸å½±å“å¤§å±€ï¼Œè€Œ Masked LM æ˜æ˜¾å€Ÿé‰´äº† CBOW çš„æ€æƒ³ã€‚æ‰€ä»¥è¯´ Bert çš„æ¨¡å‹æ²¡ä»€ä¹ˆå¤§çš„åˆ›æ–°ï¼Œæ›´åƒæœ€è¿‘å‡ å¹´ NLP é‡è¦è¿›å±•çš„é›†å¤§æˆè€…ï¼Œè¿™ç‚¹å¦‚æœä½ çœ‹æ‡‚äº†ä¸Šæ–‡ä¼°è®¡ä¹Ÿæ²¡æœ‰å¤ªå¤§å¼‚è®®ï¼Œå¦‚æœä½ æœ‰å¤§çš„å¼‚è®®ï¼Œæ ç²¾è¿™ä¸ªå¤§å¸½å­æˆ‘éšæ—¶å‡†å¤‡æˆ´ç»™ä½ ã€‚</p>\n<p>å¦‚æœå½’çº³ä¸€ä¸‹è¿™äº›è¿›å±•å°±æ˜¯ï¼šé¦–å…ˆæ˜¯ä¸¤é˜¶æ®µæ¨¡å‹ï¼Œç¬¬ä¸€é˜¶æ®µåŒå‘è¯­è¨€æ¨¡å‹é¢„è®­ç»ƒï¼Œè¿™é‡Œæ³¨æ„è¦ç”¨åŒå‘è€Œä¸æ˜¯å•å‘ï¼Œç¬¬äºŒé˜¶æ®µé‡‡ç”¨å…·ä½“ä»»åŠ¡ Fine-tuning æˆ–è€…åšç‰¹å¾é›†æˆï¼›ç¬¬äºŒæ˜¯ç‰¹å¾æŠ½å–è¦ç”¨ Transformer ä½œä¸ºç‰¹å¾æå–å™¨è€Œä¸æ˜¯ RNN æˆ–è€… CNNï¼›ç¬¬ä¸‰ï¼ŒåŒå‘è¯­è¨€æ¨¡å‹å¯ä»¥é‡‡å– CBOW çš„æ–¹æ³•å»åšï¼ˆå½“ç„¶æˆ‘è§‰å¾—è¿™ä¸ªæ˜¯ä¸ªç»†èŠ‚é—®é¢˜ï¼Œä¸ç®—å¤ªå…³é”®ï¼Œå‰ä¸¤ä¸ªå› ç´ æ¯”è¾ƒå…³é”®ï¼‰ã€‚Bert æœ€å¤§çš„äº®ç‚¹åœ¨äºæ•ˆæœå¥½åŠæ™®é€‚æ€§å¼ºï¼Œå‡ ä¹æ‰€æœ‰ NLP ä»»åŠ¡éƒ½å¯ä»¥å¥—ç”¨ Bert è¿™ç§ä¸¤é˜¶æ®µè§£å†³æ€è·¯ï¼Œè€Œä¸”æ•ˆæœåº”è¯¥ä¼šæœ‰æ˜æ˜¾æå‡ã€‚å¯ä»¥é¢„è§çš„æ˜¯ï¼Œæœªæ¥ä¸€æ®µæ—¶é—´åœ¨ NLP åº”ç”¨é¢†åŸŸï¼ŒTransformer å°†å æ®ä¸»å¯¼åœ°ä½ï¼Œè€Œä¸”è¿™ç§ä¸¤é˜¶æ®µé¢„è®­ç»ƒæ–¹æ³•ä¹Ÿä¼šä¸»å¯¼å„ç§åº”ç”¨ã€‚</p>\n<p>å¦å¤–ï¼Œæˆ‘ä»¬åº”è¯¥å¼„æ¸…æ¥šé¢„è®­ç»ƒè¿™ä¸ªè¿‡ç¨‹æœ¬è´¨ä¸Šæ˜¯åœ¨åšä»€ä¹ˆäº‹æƒ…ï¼Œæœ¬è´¨ä¸Šé¢„è®­ç»ƒæ˜¯é€šè¿‡è®¾è®¡å¥½ä¸€ä¸ªç½‘ç»œç»“æ„æ¥åšè¯­è¨€æ¨¡å‹ä»»åŠ¡ï¼Œç„¶åæŠŠå¤§é‡ç”šè‡³æ˜¯æ— ç©·å°½çš„æ— æ ‡æ³¨çš„è‡ªç„¶è¯­è¨€æ–‡æœ¬åˆ©ç”¨èµ·æ¥ï¼Œé¢„è®­ç»ƒä»»åŠ¡æŠŠå¤§é‡è¯­è¨€å­¦çŸ¥è¯†æŠ½å–å‡ºæ¥ç¼–ç åˆ°ç½‘ç»œç»“æ„ä¸­ï¼Œå½“æ‰‹å¤´ä»»åŠ¡å¸¦æœ‰æ ‡æ³¨ä¿¡æ¯çš„æ•°æ®æœ‰é™æ—¶ï¼Œè¿™äº›å…ˆéªŒçš„è¯­è¨€å­¦ç‰¹å¾å½“ç„¶ä¼šå¯¹æ‰‹å¤´ä»»åŠ¡æœ‰æå¤§çš„ç‰¹å¾è¡¥å……ä½œç”¨ï¼Œå› ä¸ºå½“æ•°æ®æœ‰é™çš„æ—¶å€™ï¼Œå¾ˆå¤šè¯­è¨€å­¦ç°è±¡æ˜¯è¦†ç›–ä¸åˆ°çš„ï¼Œæ³›åŒ–èƒ½åŠ›å°±å¼±ï¼Œé›†æˆå°½é‡é€šç”¨çš„è¯­è¨€å­¦çŸ¥è¯†è‡ªç„¶ä¼šåŠ å¼ºæ¨¡å‹çš„æ³›åŒ–èƒ½åŠ›ã€‚å¦‚ä½•å¼•å…¥å…ˆéªŒçš„è¯­è¨€å­¦çŸ¥è¯†å…¶å®ä¸€ç›´æ˜¯ NLP å°¤å…¶æ˜¯æ·±åº¦å­¦ä¹ åœºæ™¯ä¸‹çš„ NLP çš„ä¸»è¦ç›®æ ‡ä¹‹ä¸€ï¼Œä¸è¿‡ä¸€ç›´æ²¡æœ‰å¤ªå¥½çš„è§£å†³åŠæ³•ï¼Œè€Œ ELMO/GPT/Bert çš„è¿™ç§ä¸¤é˜¶æ®µæ¨¡å¼çœ‹èµ·æ¥æ— ç–‘æ˜¯è§£å†³è¿™ä¸ªé—®é¢˜è‡ªç„¶åˆç®€æ´çš„æ–¹æ³•ï¼Œè¿™ä¹Ÿæ˜¯è¿™äº›æ–¹æ³•çš„ä¸»è¦ä»·å€¼æ‰€åœ¨ã€‚</p>\n<p>å¯¹äºå½“å‰ NLP çš„å‘å±•æ–¹å‘ï¼Œæˆ‘ä¸ªäººè§‰å¾—æœ‰ä¸¤ç‚¹éå¸¸é‡è¦ï¼š</p>\n<ol>\n<li>ä¸€ä¸ªæ˜¯éœ€è¦æ›´å¼ºçš„ç‰¹å¾æŠ½å–å™¨ï¼Œç›®å‰çœ‹ Transformer ä¼šé€æ¸æ‹…å½“å¤§ä»»ï¼Œä½†æ˜¯è‚¯å®šè¿˜æ˜¯ä¸å¤Ÿå¼ºçš„ï¼Œéœ€è¦å‘å±•æ›´å¼ºçš„ç‰¹å¾æŠ½å–å™¨ï¼›</li>\n<li>ç¬¬äºŒä¸ªå°±æ˜¯å¦‚ä½•ä¼˜é›…åœ°å¼•å…¥å¤§é‡æ— ç›‘ç£æ•°æ®ä¸­åŒ…å«çš„è¯­è¨€å­¦çŸ¥è¯†ï¼Œæ³¨æ„æˆ‘è¿™é‡Œå¼ºè°ƒåœ°æ˜¯ä¼˜é›…ï¼Œè€Œä¸æ˜¯å¼•å…¥ï¼Œæ­¤å‰ç›¸å½“å¤šçš„å·¥ä½œè¯•å›¾åšå„ç§è¯­è¨€å­¦çŸ¥è¯†çš„å«æ¥æˆ–è€…å¼•å…¥ï¼Œä½†æ˜¯å¾ˆå¤šæ–¹æ³•çœ‹ç€è®©äººç‰™ç–¼ï¼Œå°±æ˜¯æˆ‘è¯´çš„ä¸ä¼˜é›…ã€‚</li>\n</ol>\n<p>ç›®å‰çœ‹é¢„è®­ç»ƒè¿™ç§ä¸¤é˜¶æ®µæ–¹æ³•è¿˜æ˜¯å¾ˆæœ‰æ•ˆçš„ï¼Œä¹Ÿéå¸¸ç®€æ´ï¼Œå½“ç„¶åé¢è‚¯å®šè¿˜ä¼šæœ‰æ›´å¥½çš„æ¨¡å‹å‡ºç°ã€‚</p>\n<p>å®Œäº†ï¼Œè¿™å°±æ˜¯é¢„è®­ç»ƒè¯­è¨€æ¨¡å‹çš„å‰ä¸–ä»Šç”Ÿã€‚</p>\n<p>ç”±äºä¸ªäººåˆšå…¥é—¨ NLP æ–¹å‘ï¼Œå°±ä¸å¦„è‡ªæ€»ç»“ï¼Œä¸Šè¿°æ€»ç»“å…¨éƒ¨æ¥è‡ªçŸ¥ä¹æ–‡ç« ï¼š&lt;a href='<span class=\"exturl\" data-url=\"aHR0cHM6Ly96aHVhbmxhbi56aGlodS5jb20vcC80OTI3MTY5OQ==\">https://zhuanlan.zhihu.com/p/49271699</span>' target='_blank'&gt; ä» Word Embedding åˆ° Bert æ¨¡å‹ â€” è‡ªç„¶è¯­è¨€å¤„ç†ä¸­çš„é¢„è®­ç»ƒæŠ€æœ¯å‘å±•å² -<span class=\"exturl\" data-url=\"aHR0cHM6Ly93d3cuemhpaHUuY29tL3Blb3BsZS96aGFuZy1qdW4tbGluLTc2\"> å¼ ä¿Šæ—</span> &lt;/a&gt;</p>\n<h1 id=\"åå…­-å‚è€ƒèµ„æ–™\"><a class=\"anchor\" href=\"#åå…­-å‚è€ƒèµ„æ–™\">#</a> åå…­ã€å‚è€ƒèµ„æ–™</h1>\n<p>æˆ‘åªæ˜¯çŸ¥è¯†çš„æ¬è¿å·¥ï¼Œæƒ³è¯¦ç»†äº†è§£å„ä¸ªçŸ¥è¯†ç‚¹çš„è¯»è€…å¯ä»¥è‡ªè¡Œé€‰æ‹©å‚è€ƒä¸‹åˆ—èµ„æ–™ã€‚</p>\n<blockquote>\n<ul>\n<li>\n<p>å‚è€ƒä¹¦ç±ï¼š</p>\n<ul>\n<li>\n<p>ã€Šé¢„è®­ç»ƒè¯­è¨€æ¨¡å‹ã€‹- å²æµ©ã€åˆ˜ä¸€çƒ½</p>\n</li>\n<li>\n<p>ã€ŠåŸºäº BERT æ¨¡å‹çš„è‡ªç„¶è¯­è¨€å¤„ç†å®æˆ˜ã€‹- æé‡‘æ´ª</p>\n</li>\n</ul>\n</li>\n<li>\n<p>å‚è€ƒè®ºæ–‡ï¼š</p>\n<ul>\n<li>&lt;a href='<span class=\"exturl\" data-url=\"aHR0cHM6Ly9hcnhpdi5vcmcvYWJzLzE3MDYuMDM3NjI=\">https://arxiv.org/abs/1706.03762</span>' target='_blank'&gt;Attention Is All You Need&lt;/a&gt;</li>\n<li>&lt;a href='<span class=\"exturl\" data-url=\"aHR0cHM6Ly90b29vYi5jb20vYXBpL29ianMvcmVhZC9ub3RlaWQvMjg3MTc5OTUv\">https://tooob.com/api/objs/read/noteid/28717995/</span>' target='_blank'&gt;BERT: Pre-training of Deep Bidirectional Transformers for Language Understanding&lt;/a&gt;</li>\n</ul>\n</li>\n<li>\n<p>å‚è€ƒåšå®¢ï¼š</p>\n<ul>\n<li>&lt;a href='<span class=\"exturl\" data-url=\"aHR0cHM6Ly96aHVhbmxhbi56aGlodS5jb20vcC8zNzYwMTE2MQ==\">https://zhuanlan.zhihu.com/p/37601161</span>' target='_blank'&gt; æ·±åº¦å­¦ä¹ ä¸­çš„æ³¨æ„åŠ›æ¨¡å‹ï¼ˆ2017 ç‰ˆï¼‰&lt;/a&gt;</li>\n<li>&lt;a href='<span class=\"exturl\" data-url=\"aHR0cHM6Ly9tcC53ZWl4aW4ucXEuY29tL3MvUkx4V2V2VldIWGdYLVVjb3hEUzcwdw==\">https://mp.weixin.qq.com/s/RLxWevVWHXgX-UcoxDS70w</span>' target='_blank'&gt; ç»†è®² | Attention Is All You Need&lt;/a&gt;</li>\n<li>&lt;a href='<span class=\"exturl\" data-url=\"aHR0cHM6Ly96aHVhbmxhbi56aGlodS5jb20vcC80OTI3MTY5OQ==\">https://zhuanlan.zhihu.com/p/49271699</span>' target='_blank'&gt; ä» Word Embedding åˆ° Bert æ¨¡å‹ â€” è‡ªç„¶è¯­è¨€å¤„ç†ä¸­çš„é¢„è®­ç»ƒæŠ€æœ¯å‘å±•å² &lt;/a&gt;</li>\n<li>&lt;a href='<span class=\"exturl\" data-url=\"aHR0cHM6Ly93d3cuY25ibG9ncy5jb20vbmlja2NoZW4xMjEvcC8xNTA3MTg0NC5odG1s\">https://www.cnblogs.com/nickchen121/p/15071844.html</span>' target='_blank'&gt;Attention å’Œ Transformer è¯¦è§£ &lt;/a&gt;</li>\n<li>&lt;a href='<span class=\"exturl\" data-url=\"aHR0cHM6Ly96aHVhbmxhbi56aGlodS5jb20vcC80NDEyMTM3OA==\">https://zhuanlan.zhihu.com/p/44121378</span>' target='_blank'&gt;ã€NLPã€‘Transformer æ¨¡å‹åŸç†è¯¦è§£ &lt;/a&gt;</li>\n<li>&lt;a href='<span class=\"exturl\" data-url=\"aHR0cHM6Ly96aHVhbmxhbi56aGlodS5jb20vcC8xMzYyMjM1NTA=\">https://zhuanlan.zhihu.com/p/136223550</span>' target='_blank'&gt;LSTM å¦‚ä½•è§£å†³ RNN å¸¦æ¥çš„æ¢¯åº¦æ¶ˆå¤±é—®é¢˜ &lt;/a&gt;</li>\n<li>&lt;a href='<span class=\"exturl\" data-url=\"aHR0cDovL2phbGFtbWFyLmdpdGh1Yi5pby9pbGx1c3RyYXRlZC10cmFuc2Zvcm1lci8=\">http://jalammar.github.io/illustrated-transformer/</span>' target='_blank'&gt;The Illustrated Transformer&lt;/a&gt;</li>\n</ul>\n</li>\n</ul>\n</blockquote>\n",
            "tags": [
                "NER"
            ]
        },
        {
            "id": "http://qiji5211.com/2024/02/07/NER/Pre-training-language-model-main/%E7%AC%AC%E4%B8%80%E7%AF%87%20Transformer%E3%80%81GPT%E3%80%81BERT%EF%BC%8C%E9%A2%84%E8%AE%AD%E7%BB%83%E8%AF%AD%E8%A8%80%E6%A8%A1%E5%9E%8B%E7%9A%84%E5%89%8D%E4%B8%96%E4%BB%8A%E7%94%9F%EF%BC%88%E7%90%86%E8%AE%BA%EF%BC%89/07%20%E9%A2%84%E8%AE%AD%E7%BB%83%E8%AF%AD%E8%A8%80%E6%A8%A1%E5%9E%8B%E7%9A%84%E4%B8%8B%E6%B8%B8%E4%BB%BB%E5%8A%A1%E6%94%B9%E9%80%A0%E7%AE%80%E4%BB%8B%EF%BC%88%E5%A6%82%E4%BD%95%E4%BD%BF%E7%94%A8%E8%AF%8D%E5%90%91%E9%87%8F%EF%BC%89/",
            "url": "http://qiji5211.com/2024/02/07/NER/Pre-training-language-model-main/%E7%AC%AC%E4%B8%80%E7%AF%87%20Transformer%E3%80%81GPT%E3%80%81BERT%EF%BC%8C%E9%A2%84%E8%AE%AD%E7%BB%83%E8%AF%AD%E8%A8%80%E6%A8%A1%E5%9E%8B%E7%9A%84%E5%89%8D%E4%B8%96%E4%BB%8A%E7%94%9F%EF%BC%88%E7%90%86%E8%AE%BA%EF%BC%89/07%20%E9%A2%84%E8%AE%AD%E7%BB%83%E8%AF%AD%E8%A8%80%E6%A8%A1%E5%9E%8B%E7%9A%84%E4%B8%8B%E6%B8%B8%E4%BB%BB%E5%8A%A1%E6%94%B9%E9%80%A0%E7%AE%80%E4%BB%8B%EF%BC%88%E5%A6%82%E4%BD%95%E4%BD%BF%E7%94%A8%E8%AF%8D%E5%90%91%E9%87%8F%EF%BC%89/",
            "title": "é¢„è®­ç»ƒè¯­è¨€æ¨¡å‹çš„ä¸‹æ¸¸ä»»åŠ¡æ”¹é€ ç®€ä»‹ï¼ˆå¦‚ä½•ä½¿ç”¨è¯å‘é‡ï¼‰",
            "date_published": "2024-02-07T09:30:58.000Z",
            "content_html": "<h1 id=\"word2vec-æ˜¯ä¸€ä¸ªç¥ç»ç½‘ç»œè¯­è¨€æ¨¡å‹å…¶æ¬¡ä»–çš„ä¸»è¦ä»»åŠ¡æ˜¯åšç”Ÿæˆè¯å‘é‡q\"><a class=\"anchor\" href=\"#word2vec-æ˜¯ä¸€ä¸ªç¥ç»ç½‘ç»œè¯­è¨€æ¨¡å‹å…¶æ¬¡ä»–çš„ä¸»è¦ä»»åŠ¡æ˜¯åšç”Ÿæˆè¯å‘é‡q\">#</a> Word2Vec --ã€‹ æ˜¯ä¸€ä¸ªç¥ç»ç½‘ç»œè¯­è¨€æ¨¡å‹ï¼Œå…¶æ¬¡ä»–çš„ä¸»è¦ä»»åŠ¡æ˜¯åšï¼ˆç”Ÿæˆè¯å‘é‡ï¼ŒQï¼‰</h1>\n<p>![image-20220614194418918](../../Library/Application Support/typora-user-images/image-20220614194418918.png)</p>\n<p>Word2Vec æ¨¡å‹æ˜¯ä¸æ˜¯é¢„è®­ç»ƒæ¨¡å‹ï¼Ÿï¼ˆæ˜¯ï¼‰</p>\n<p>ä¸€å®šæ˜¯</p>\n<p>ä»€ä¹ˆæ˜¯é¢„è®­ç»ƒï¼Ÿ</p>\n<p>ç»™å‡ºä¸¤ä¸ªä»»åŠ¡ A å’Œ Bï¼Œä»»åŠ¡ A å·²ç»åšå‡ºäº†æ¨¡å‹ Aï¼Œä»»åŠ¡ B æ— æ³•è§£å†³ï¼ˆé€šè¿‡ä½¿ç”¨æ¨¡å‹ Aï¼ŒåŠ å¿«ä»»åŠ¡çš„è§£å†³ï¼‰</p>\n<p>ç»™ä½ ä¸€ä¸ª NLP é‡Œé¢çš„ä»»åŠ¡ï¼Œç»™ä¸€ä¸ªé—®é¢˜ Xï¼ˆNi+ckï¼‰ï¼Œç»™å‡ºä¸€ä¸ªå›ç­” Yï¼ˆhandsomeï¼‰</p>\n<p><img data-src=\"https://imgmd.oss-cn-shanghai.aliyuncs.com/BERT_IMG/we%E6%A8%A1%E5%BC%8F%E4%B8%8B%E7%9A%84%E9%A2%84%E8%AE%AD%E7%BB%83.jpg\" alt=\"img\" /></p>\n<p>é¢„è®­ç»ƒè¯­è¨€æ¨¡å‹ç»ˆäºå‡ºæ¥ï¼ˆç»™å‡ºä¸€å¥è¯ï¼Œæˆ‘ä»¬å…ˆä½¿ç”¨ç‹¬çƒ­ç¼–ç ï¼ˆä¸€ä¸€å¯¹åº”çš„ä¸€ç§è¡¨æŸ¥è¯¢ï¼‰ï¼Œå†ä½¿ç”¨ Word2Vec é¢„è®­ç»ƒå¥½çš„ Q çŸ©é˜µç›´æ¥å¾—åˆ°è¯å‘é‡ï¼Œç„¶åè¿›è¡Œæ¥ä¸‹æ¥çš„ä»»åŠ¡ï¼‰</p>\n<ol>\n<li>å†»ç»“ï¼šå¯ä»¥ä¸æ”¹å˜ Q çŸ©é˜µ</li>\n<li>å¾®è°ƒï¼šéšç€ä»»åŠ¡çš„æ”¹å˜ï¼Œæ”¹å˜ Q çŸ©é˜µ</li>\n</ol>\n",
            "tags": [
                "NER"
            ]
        },
        {
            "id": "http://qiji5211.com/2024/02/07/NER/Pre-training-language-model-main/%E7%AC%AC%E4%B8%80%E7%AF%87%20Transformer%E3%80%81GPT%E3%80%81BERT%EF%BC%8C%E9%A2%84%E8%AE%AD%E7%BB%83%E8%AF%AD%E8%A8%80%E6%A8%A1%E5%9E%8B%E7%9A%84%E5%89%8D%E4%B8%96%E4%BB%8A%E7%94%9F%EF%BC%88%E7%90%86%E8%AE%BA%EF%BC%89/Transformer/",
            "url": "http://qiji5211.com/2024/02/07/NER/Pre-training-language-model-main/%E7%AC%AC%E4%B8%80%E7%AF%87%20Transformer%E3%80%81GPT%E3%80%81BERT%EF%BC%8C%E9%A2%84%E8%AE%AD%E7%BB%83%E8%AF%AD%E8%A8%80%E6%A8%A1%E5%9E%8B%E7%9A%84%E5%89%8D%E4%B8%96%E4%BB%8A%E7%94%9F%EF%BC%88%E7%90%86%E8%AE%BA%EF%BC%89/Transformer/",
            "title": "Transformer",
            "date_published": "2024-02-07T09:30:58.000Z",
            "content_html": "<h1 id=\"æ¡†æ¶æ¦‚è¿°\"><a class=\"anchor\" href=\"#æ¡†æ¶æ¦‚è¿°\">#</a> æ¡†æ¶æ¦‚è¿°</h1>\n<p>1000*0.04=40--&gt;10</p>\n<p>5000*0.04=200--&gt;20</p>\n<p>é¢„è®­ç»ƒ --ã€‹NNLM--ã€‹word2Vec--ã€‹ELMo--ã€‹Attention</p>\n<p>NLP ä¸­é¢„è®­ç»ƒçš„ç›®çš„ï¼Œå…¶å®å°±æ˜¯ä¸ºäº†ç”Ÿæˆè¯å‘é‡</p>\n<p>é¡ºæ°´æ¨èˆŸï¼Œtransformer å…¶å®å°±æ˜¯ attention çš„ä¸€ä¸ªå †å </p>\n<p>ä»ä¸€ä¸ªå®è§‚çš„è§’åº¦ï¼Œå»çœ‹ transformer åˆ°åº•åœ¨å¹²å˜›ï¼Œç„¶ååœ¨ç»†åˆ†ï¼Œå†ä½œæ€»ç»“</p>\n<p>æ€»åˆ†æ€»</p>\n<p>seq2seq</p>\n<p>ä¸€å¥è¯ï¼Œä¸€ä¸ªè§†é¢‘</p>\n<p>åºåˆ—ï¼ˆç¼–ç å™¨ï¼‰åˆ°åºåˆ—ï¼ˆè§£ç å™¨ï¼‰</p>\n<p>åˆ†æˆä¸¤éƒ¨åˆ†ï¼Œç¼–ç å™¨å’Œè§£ç å™¨</p>\n<h2 id=\"æ•´ä½“æ¡†æ¶\"><a class=\"anchor\" href=\"#æ•´ä½“æ¡†æ¶\">#</a> æ•´ä½“æ¡†æ¶</h2>\n<p>&lt;img src=&quot;<span class=\"exturl\" data-url=\"aHR0cHM6Ly9pbWdtZC5vc3MtY24tc2hhbmdoYWkuYWxpeXVuY3MuY29tL0JFUlRfSU1HL3RmLSVFNiU5NSVCNCVFNCVCRCU5MyVFNiVBMSU4NiVFNiU5RSVCNi5qcGc=\">https://imgmd.oss-cn-shanghai.aliyuncs.com/BERT_IMG/tf - æ•´ä½“æ¡†æ¶.jpg</span>&quot; alt=&quot;img&quot; style=&quot;zoom:33%;&quot; /&gt;</p>\n<h2 id=\"æœºå™¨ç¿»è¯‘æµç¨‹transformer\"><a class=\"anchor\" href=\"#æœºå™¨ç¿»è¯‘æµç¨‹transformer\">#</a> æœºå™¨ç¿»è¯‘æµç¨‹ï¼ˆTransformerï¼‰</h2>\n<p>é€šè¿‡æœºå™¨ç¿»è¯‘æ¥åšè§£é‡Š</p>\n<p>ç»™ä¸€ä¸ªè¾“å…¥ï¼Œç»™å‡ºä¸€ä¸ªè¾“å‡ºï¼ˆè¾“å‡ºæ˜¯è¾“å…¥çš„ç¿»è¯‘çš„ç»“æœï¼‰</p>\n<p>â€œæˆ‘æ˜¯ä¸€ä¸ªå­¦ç”Ÿâ€  --ã€‹ï¼ˆé€šè¿‡ Transformerï¼‰ I am a student</p>\n<p>æµç¨‹ 1</p>\n<p><img data-src=\"https://imgmd.oss-cn-shanghai.aliyuncs.com/BERT_IMG/tf-%E6%A1%86%E6%9E%B6%E7%AE%80%E5%8C%96.jpg\" alt=\"img\" /></p>\n<p>ç¼–ç å™¨å’Œè§£ç å™¨</p>\n<p>ç¼–ç å™¨ï¼šæŠŠè¾“å…¥å˜æˆä¸€ä¸ªè¯å‘é‡ï¼ˆSelf-Attetionï¼‰</p>\n<p>è§£ç å™¨ï¼šå¾—åˆ°ç¼–ç å™¨è¾“å‡ºçš„è¯å‘é‡åï¼Œç”Ÿæˆç¿»è¯‘çš„ç»“æœ</p>\n<p>æµç¨‹ 2</p>\n<p>&lt;img src=&quot;<span class=\"exturl\" data-url=\"aHR0cHM6Ly9pbWdtZC5vc3MtY24tc2hhbmdoYWkuYWxpeXVuY3MuY29tL0JFUlRfSU1HL3RmLWVkLSVFNiVBMSU4NiVFNiU5RSVCNi5qcGc=\">https://imgmd.oss-cn-shanghai.aliyuncs.com/BERT_IMG/tf-ed - æ¡†æ¶.jpg</span>&quot; alt=&quot;img&quot; style=&quot;zoom:80%;&quot; /&gt;</p>\n<p>Nx çš„æ„æ€æ˜¯ï¼Œç¼–ç å™¨é‡Œé¢åˆæœ‰ N ä¸ªå°ç¼–ç å™¨ï¼ˆé»˜è®¤ N=6ï¼‰</p>\n<p>é€šè¿‡ 6 ä¸ªç¼–ç å™¨ï¼Œå¯¹è¯å‘é‡ä¸€æ­¥åˆä¸€æ­¥çš„å¼ºåŒ–ï¼ˆå¢å¼ºï¼‰</p>\n<p>æµç¨‹ 3</p>\n<p>&lt;img src=&quot;<span class=\"exturl\" data-url=\"aHR0cHM6Ly9pbWdtZC5vc3MtY24tc2hhbmdoYWkuYWxpeXVuY3MuY29tL0JFUlRfSU1HL3RmLWVkLSVFNSVBNCU4RCVFNiU5RCU4Mi5qcGc=\">https://imgmd.oss-cn-shanghai.aliyuncs.com/BERT_IMG/tf-ed - å¤æ‚.jpg</span>&quot; alt=&quot;img&quot; style=&quot;zoom:80%;&quot; /&gt;</p>\n<p>è¯´äº†è¿™ä¹ˆå¤šï¼Œäº†è§£ Transformer å°±æ˜¯äº†è§£ Transformer é‡Œçš„å°çš„ç¼–ç å™¨ï¼ˆEncoderï¼‰å’Œå°çš„è§£ç å™¨ï¼ˆDecoderï¼‰</p>\n<p>FFNï¼ˆFeed Forwardï¼‰ï¼šw2(ï¼ˆw1x+b1ï¼‰)+b2</p>\n<p>æµç¨‹ 4</p>\n<p>&lt;img src=&quot;<span class=\"exturl\" data-url=\"aHR0cHM6Ly9pbWdtZC5vc3MtY24tc2hhbmdoYWkuYWxpeXVuY3MuY29tL0JFUlRfSU1HL2VkLSVFNyVCQiU4NiVFNSU4OCU4Ni5qcGc=\">https://imgmd.oss-cn-shanghai.aliyuncs.com/BERT_IMG/ed - ç»†åˆ†.jpg</span>&quot; alt=&quot;img&quot; style=&quot;zoom:80%;&quot; /&gt;</p>\n<h1 id=\"transformer-çš„ç¼–ç å™¨encodesæˆ‘åœ¨åšæ›´ä¼˜ç§€çš„è¯å‘é‡\"><a class=\"anchor\" href=\"#transformer-çš„ç¼–ç å™¨encodesæˆ‘åœ¨åšæ›´ä¼˜ç§€çš„è¯å‘é‡\">#</a> Transformer çš„ç¼–ç å™¨ï¼ˆEncodesï¼‰â€”â€” æˆ‘åœ¨åšæ›´ä¼˜ç§€çš„è¯å‘é‡</h1>\n<h2 id=\"transformer-æ¡†æ¶\"><a class=\"anchor\" href=\"#transformer-æ¡†æ¶\">#</a> Transformer æ¡†æ¶</h2>\n<p>seqï¼ˆç¼–ç å™¨ï¼‰2seqï¼ˆè§£ç å™¨ï¼‰</p>\n<ol>\n<li>é€šè¿‡ç¼–ç å™¨å¯¹åºåˆ—è¿›è¡Œå‘é‡åŒ–ï¼ˆè¯å‘é‡ï¼‰</li>\n<li>æŠŠè¯å‘é‡è¾“å…¥åˆ°è§£ç å™¨ï¼Œå¾—åˆ°ç»“æœï¼ˆç”Ÿæˆå•è¯ï¼‰</li>\n</ol>\n<h2 id=\"ç¼–ç å™¨æ¦‚ç•¥å›¾\"><a class=\"anchor\" href=\"#ç¼–ç å™¨æ¦‚ç•¥å›¾\">#</a> ç¼–ç å™¨æ¦‚ç•¥å›¾</h2>\n<p>&lt;img src=&quot;<span class=\"exturl\" data-url=\"aHR0cHM6Ly9pbWdtZC5vc3MtY24tc2hhbmdoYWkuYWxpeXVuY3MuY29tL0JFUlRfSU1HL2VkLSVFNyVCQiU4NiVFNSU4OCU4Ni5qcGc=\">https://imgmd.oss-cn-shanghai.aliyuncs.com/BERT_IMG/ed - ç»†åˆ†.jpg</span>&quot; alt=&quot;img&quot; style=&quot;zoom:80%;&quot; /&gt;</p>\n<p>ç¼–ç å™¨åŒ…æ‹¬ä¸¤ä¸ªå­å±‚ï¼ŒSelf-Attentionã€Feed Forward</p>\n<p>æ¯ä¸€ä¸ªå­å±‚çš„ä¼ è¾“è¿‡ç¨‹ä¸­éƒ½ä¼šæœ‰ä¸€ä¸ªï¼ˆæ®‹å·®ç½‘ç»œ + å½’ä¸€åŒ–ï¼‰</p>\n<h2 id=\"ç¼–ç å™¨è¯¦ç»†å›¾\"><a class=\"anchor\" href=\"#ç¼–ç å™¨è¯¦ç»†å›¾\">#</a> ç¼–ç å™¨è¯¦ç»†å›¾</h2>\n<p>&lt;img src=&quot;<span class=\"exturl\" data-url=\"aHR0cHM6Ly9pbWdtZC5vc3MtY24tc2hhbmdoYWkuYWxpeXVuY3MuY29tL0JFUlRfSU1HL2VuY29kZXItJUU4JUFGJUE2JUU3JUJCJTg2JUU1JTlCJUJFLnBuZw==\">https://imgmd.oss-cn-shanghai.aliyuncs.com/BERT_IMG/encoder - è¯¦ç»†å›¾.png</span>&quot; alt=&quot;img&quot; style=&quot;zoom:80%;&quot; /&gt;</p>\n<p>Thinking</p>\n<p>--ã€‹å¾—åˆ°ç»¿è‰²çš„ x1ï¼ˆè¯å‘é‡ï¼Œå¯ä»¥é€šè¿‡ one-hotã€word2vec å¾—åˆ°ï¼‰+ å åŠ ä½ç½®ç¼–ç ï¼ˆç»™ x1 èµ‹äºˆä½ç½®å±æ€§ï¼‰å¾—åˆ°é»„è‰²çš„ x1</p>\n<p>--ã€‹è¾“å…¥åˆ° Self-Attention å­å±‚ä¸­ï¼Œåšæ³¨æ„åŠ›æœºåˆ¶ï¼ˆx1ã€x2 æ‹¼æ¥èµ·æ¥çš„ä¸€å¥è¯åšï¼‰ï¼Œå¾—åˆ° z1ï¼ˆx1 ä¸ x1ï¼Œx2 æ‹¼æ¥èµ·æ¥çš„å¥å­åšäº†è‡ªæ³¨æ„åŠ›æœºåˆ¶çš„è¯å‘é‡ï¼Œè¡¨å¾çš„ä»ç„¶æ˜¯ thinkingï¼‰ï¼Œä¹Ÿå°±æ˜¯è¯´ z1 æ‹¥æœ‰äº†ä½ç½®ç‰¹å¾ã€å¥æ³•ç‰¹å¾ã€è¯­ä¹‰ç‰¹å¾çš„è¯å‘é‡</p>\n<p>--ã€‹æ®‹å·®ç½‘ç»œï¼ˆé¿å…æ¢¯åº¦æ¶ˆå¤±ï¼Œw3 (w2 (w1x+b1)+b2)+b3ï¼Œå¦‚æœ w1ï¼Œw2ï¼Œw3 ç‰¹åˆ«å°ï¼Œ0.0000000000000000â€¦â€¦1ï¼Œx å°±æ²¡äº†ï¼Œã€w3 (w2 (w1x+b1)+b2)+b3+xã€‘ï¼‰ï¼Œå½’ä¸€åŒ–ï¼ˆLayerNormï¼‰ï¼Œåšæ ‡å‡†åŒ–ï¼ˆé¿å…æ¢¯åº¦çˆ†ç‚¸ï¼‰ï¼Œå¾—åˆ°äº†æ·±ç²‰è‰²çš„ z1</p>\n<p>--ã€‹Feed Forwardï¼ŒReluï¼ˆw2 (w1x+b1)+b2ï¼‰ï¼Œï¼ˆå‰é¢æ¯ä¸€æ­¥éƒ½åœ¨åšçº¿æ€§å˜æ¢ï¼Œwx+bï¼Œçº¿æ€§å˜åŒ–çš„å åŠ æ°¸è¿œéƒ½æ˜¯çº¿æ€§å˜åŒ–ï¼ˆçº¿æ€§å˜åŒ–å°±æ˜¯ç©ºé—´ä¸­å¹³ç§»å’Œæ‰©å¤§ç¼©å°ï¼‰ï¼Œé€šè¿‡ Feed Forward ä¸­çš„ Relu åšä¸€æ¬¡éçº¿æ€§å˜æ¢ï¼Œè¿™æ ·çš„ç©ºé—´å˜æ¢å¯ä»¥æ— é™æ‹Ÿåˆä»»ä½•ä¸€ç§çŠ¶æ€äº†ï¼‰ï¼Œå¾—åˆ° r1ï¼ˆæ˜¯ thinking çš„æ–°çš„è¡¨å¾ï¼‰</p>\n<p>æ€»ç»“ä¸‹ï¼ˆè¿™æ˜¯é‡ç‚¹ï¼Œä¸Šé¢å¬ä¸æ‡‚éƒ½æ²¡å…³ç³»ï¼‰ï¼šåšè¯å‘é‡ï¼Œåªä¸è¿‡è¿™ä¸ªè¯å‘é‡æ›´åŠ ä¼˜ç§€ï¼Œè®©è¿™ä¸ªè¯å‘é‡èƒ½å¤Ÿæ›´åŠ ç²¾å‡†çš„è¡¨ç¤ºè¿™ä¸ªå•è¯ã€è¿™å¥è¯ã€‚</p>\n<h1 id=\"transformer-çš„è§£ç å™¨decodersæˆ‘è¦ç”Ÿæˆä¸€ä¸ªåˆä¸€ä¸ªå•è¯\"><a class=\"anchor\" href=\"#transformer-çš„è§£ç å™¨decodersæˆ‘è¦ç”Ÿæˆä¸€ä¸ªåˆä¸€ä¸ªå•è¯\">#</a> Transformer çš„è§£ç å™¨ï¼ˆDecodersï¼‰â€”â€” æˆ‘è¦ç”Ÿæˆä¸€ä¸ªåˆä¸€ä¸ªå•è¯</h1>\n<h2 id=\"transformer-ç¼–ç å™¨\"><a class=\"anchor\" href=\"#transformer-ç¼–ç å™¨\">#</a> Transformer ç¼–ç å™¨</h2>\n<p>ç¼–ç å™¨åœ¨å¹²å—ï¼šè¯å‘é‡ã€å›¾ç‰‡å‘é‡ï¼Œæ€»è€Œè¨€ä¹‹ï¼Œç¼–ç å™¨å°±æ˜¯è®©è®¡ç®—æœºèƒ½å¤Ÿæ›´åˆç†åœ°ï¼ˆä¸ç¡®å®šæ€§çš„ï¼‰è®¤è¯†äººç±»ä¸–ç•Œå®¢è§‚å­˜åœ¨çš„ä¸€äº›ä¸œè¥¿</p>\n<h2 id=\"transformer-è§£ç å™¨\"><a class=\"anchor\" href=\"#transformer-è§£ç å™¨\">#</a> Transformer è§£ç å™¨</h2>\n<p>è§£ç å™¨ä¼šæ¥æ”¶ç¼–ç å™¨ç”Ÿæˆçš„è¯å‘é‡ï¼Œç„¶åé€šè¿‡è¿™ä¸ªè¯å‘é‡å»ç”Ÿæˆç¿»è¯‘çš„ç»“æœã€‚</p>\n<p>&lt;img src=&quot;<span class=\"exturl\" data-url=\"aHR0cHM6Ly9pbWdtZC5vc3MtY24tc2hhbmdoYWkuYWxpeXVuY3MuY29tL0JFUlRfSU1HL2VkLSVFNyVCQiU4NiVFNSU4OCU4Ni5qcGc=\">https://imgmd.oss-cn-shanghai.aliyuncs.com/BERT_IMG/ed - ç»†åˆ†.jpg</span>&quot; alt=&quot;img&quot; style=&quot;zoom:80%;&quot; /&gt;</p>\n<p>è§£ç å™¨çš„ Self-Attention åœ¨ç¼–ç å·²ç»ç”Ÿæˆçš„å•è¯</p>\n<p>å‡å¦‚ç›®æ ‡è¯ â€œæˆ‘æ˜¯ä¸€ä¸ªå­¦ç”Ÿâ€---ã€‹masked Self-Attention</p>\n<p>è®­ç»ƒé˜¶æ®µï¼šç›®æ ‡è¯ â€œæˆ‘æ˜¯ä¸€ä¸ªå­¦ç”Ÿâ€ æ˜¯å·²çŸ¥çš„ï¼Œç„¶å Self-Attention æ˜¯å¯¹ â€œæˆ‘æ˜¯ä¸€ä¸ªå­¦ç”Ÿâ€ åšè®¡ç®—</p>\n<p>å¦‚æœä¸åš maskedï¼Œæ¯æ¬¡è®­ç»ƒé˜¶æ®µï¼Œéƒ½ä¼šè·å¾—å…¨éƒ¨çš„ä¿¡æ¯</p>\n<p>å¦‚æœåš maskedï¼ŒSelf-Attention ç¬¬ä¸€æ¬¡å¯¹ â€œæˆ‘â€ åšè®¡ç®—</p>\n<p>Self-Attention ç¬¬äºŒæ¬¡å¯¹ â€œæˆ‘æ˜¯â€ åšè®¡ç®—</p>\n<p>â€¦â€¦</p>\n<p>æµ‹è¯•é˜¶æ®µï¼š</p>\n<ol>\n<li>ç›®æ ‡è¯æœªçŸ¥ï¼Œå‡è®¾ç›®æ ‡è¯æ˜¯ â€œæˆ‘æ˜¯ä¸€ä¸ªå­¦ç”Ÿâ€ï¼ˆæœªçŸ¥ï¼‰ï¼ŒSelf-Attention ç¬¬ä¸€æ¬¡å¯¹ â€œæˆ‘â€ åšè®¡ç®—</li>\n<li>ç¬¬äºŒæ¬¡å¯¹ â€œæˆ‘æ˜¯â€ åšè®¡ç®—</li>\n<li>â€¦â€¦</li>\n</ol>\n<p>è€Œæµ‹è¯•é˜¶æ®µï¼Œæ²¡ç”Ÿæˆä¸€ç‚¹ï¼Œè·å¾—ä¸€ç‚¹</p>\n<h2 id=\"ç”Ÿæˆè¯\"><a class=\"anchor\" href=\"#ç”Ÿæˆè¯\">#</a> ç”Ÿæˆè¯</h2>\n<p>&lt;img src=&quot;../../ed - äº¤äº’.jpg&quot; alt=&quot;img&quot; style=&quot;zoom:80%;&quot; /&gt;</p>\n<p>Linear å±‚è½¬æ¢æˆè¯è¡¨çš„ç»´åº¦</p>\n<p>softmax å¾—åˆ°æœ€å¤§è¯çš„æ¦‚ç‡</p>\n<p>softmax ç»†è¯</p>\n<p>&lt;img src=&quot;<span class=\"exturl\" data-url=\"aHR0cHM6Ly9pbWdtZC5vc3MtY24tc2hhbmdoYWkuYWxpeXVuY3MuY29tL0JFUlRfSU1HL3RmLSVFNiU5QyU4MCVFNSU5MCU4RSVFOCVCRSU5MyVFNSU4NyVCQS5qcGc=\">https://imgmd.oss-cn-shanghai.aliyuncs.com/BERT_IMG/tf - æœ€åè¾“å‡º.jpg</span>&quot; alt=&quot;img&quot; style=&quot;zoom:80%;&quot; /&gt;</p>\n<p>å•è¯è¡¨</p>\n<p>&lt;img src=&quot;<span class=\"exturl\" data-url=\"aHR0cHM6Ly9pbWdtZC5vc3MtY24tc2hhbmdoYWkuYWxpeXVuY3MuY29tL0JFUlRfSU1HL3RmLSVFNiU5QyU4MCVFNyVCQiU4OCVFOCVCRSU5MyVFNSU4NyVCQSVFNyVCQiU5MyVFNiU5RSU5Qy5qcGc=\">https://imgmd.oss-cn-shanghai.aliyuncs.com/BERT_IMG/tf - æœ€ç»ˆè¾“å‡ºç»“æœ.jpg</span>&quot; alt=&quot;img&quot; style=&quot;zoom:80%;&quot; /&gt;</p>\n<h1 id=\"transformer-çš„åŠ¨æ€æµç¨‹\"><a class=\"anchor\" href=\"#transformer-çš„åŠ¨æ€æµç¨‹\">#</a> Transformer çš„åŠ¨æ€æµç¨‹</h1>\n<p>æœºå™¨ç¿»è¯‘ï¼šå¾·è¯­ï¼ˆä¸­æ–‡ï¼‰ç¿»è¯‘æˆè‹±æ–‡</p>\n<h2 id=\"ç”Ÿæˆä¸€ä¸ªè¯\"><a class=\"anchor\" href=\"#ç”Ÿæˆä¸€ä¸ªè¯\">#</a> ç”Ÿæˆä¸€ä¸ªè¯</h2>\n<p><img data-src=\"https://imgmd.oss-cn-shanghai.aliyuncs.com/BERT_IMG/tf-%E5%8A%A8%E6%80%81%E7%94%9F%E6%88%90.gif\" alt=\"img\" /></p>\n<h2 id=\"ç”Ÿæˆæ‰€æœ‰è¯\"><a class=\"anchor\" href=\"#ç”Ÿæˆæ‰€æœ‰è¯\">#</a> ç”Ÿæˆæ‰€æœ‰è¯</h2>\n<p><img data-src=\"https://imgmd.oss-cn-shanghai.aliyuncs.com/BERT_IMG/tf-%E5%8A%A8%E6%80%81%E7%BB%93%E6%9E%9C-2.gif\" alt=\"img\" /></p>\n<h2 id=\"transformer-æ¡†æ¶-2\"><a class=\"anchor\" href=\"#transformer-æ¡†æ¶-2\">#</a> Transformer æ¡†æ¶</h2>\n<p><img data-src=\"https://imgmd.oss-cn-shanghai.aliyuncs.com/BERT_IMG/tf-%E6%95%B4%E4%BD%93%E6%A1%86%E6%9E%B6.jpg\" alt=\"img\" /></p>\n<h1 id=\"transformer-è§£ç å™¨çš„ä¸¤ä¸ªä¸ºä»€ä¹ˆä¸ºä»€ä¹ˆåšæ©ç -ä¸ºä»€ä¹ˆç”¨ç¼–ç å™¨-è§£ç å™¨æ³¨æ„åŠ›\"><a class=\"anchor\" href=\"#transformer-è§£ç å™¨çš„ä¸¤ä¸ªä¸ºä»€ä¹ˆä¸ºä»€ä¹ˆåšæ©ç -ä¸ºä»€ä¹ˆç”¨ç¼–ç å™¨-è§£ç å™¨æ³¨æ„åŠ›\">#</a> Transformer è§£ç å™¨çš„ä¸¤ä¸ªä¸ºä»€ä¹ˆï¼ˆä¸ºä»€ä¹ˆåšæ©ç ã€ä¸ºä»€ä¹ˆç”¨ç¼–ç å™¨ - è§£ç å™¨æ³¨æ„åŠ›ï¼‰</h1>\n<h2 id=\"transformer-çš„ç¼–ç å™¨å’Œè§£ç å™¨\"><a class=\"anchor\" href=\"#transformer-çš„ç¼–ç å™¨å’Œè§£ç å™¨\">#</a> Transformer çš„ç¼–ç å™¨å’Œè§£ç å™¨</h2>\n<p>&lt;img src=&quot;<span class=\"exturl\" data-url=\"aHR0cHM6Ly9pbWdtZC5vc3MtY24tc2hhbmdoYWkuYWxpeXVuY3MuY29tL0JFUlRfSU1HL3RmLSVFNiU5NSVCNCVFNCVCRCU5MyVFNiVBMSU4NiVFNiU5RSVCNi5qcGc=\">https://imgmd.oss-cn-shanghai.aliyuncs.com/BERT_IMG/tf - æ•´ä½“æ¡†æ¶.jpg</span>&quot; alt=&quot;img&quot; style=&quot;zoom:50%;&quot; /&gt;</p>\n<h2 id=\"é—®é¢˜ä¸€ä¸ºä»€ä¹ˆ-decoder-éœ€è¦åš-mask\"><a class=\"anchor\" href=\"#é—®é¢˜ä¸€ä¸ºä»€ä¹ˆ-decoder-éœ€è¦åš-mask\">#</a> é—®é¢˜ä¸€ï¼šä¸ºä»€ä¹ˆ Decoder éœ€è¦åš Mask</h2>\n<p>æœºå™¨ç¿»è¯‘ï¼šæºè¯­å¥ï¼ˆæˆ‘çˆ±ä¸­å›½ï¼‰ï¼Œç›®æ ‡è¯­å¥ï¼ˆI love Chinaï¼‰</p>\n<p>ä¸ºäº†è§£å†³è®­ç»ƒé˜¶æ®µå’Œæµ‹è¯•é˜¶æ®µçš„ gapï¼ˆä¸åŒ¹é…ï¼‰</p>\n<p>è®­ç»ƒé˜¶æ®µï¼šè§£ç å™¨ä¼šæœ‰è¾“å…¥ï¼Œè¿™ä¸ªè¾“å…¥æ˜¯ç›®æ ‡è¯­å¥ï¼Œå°±æ˜¯ I love Chinaï¼Œé€šè¿‡å·²ç»ç”Ÿæˆçš„è¯ï¼Œå»è®©è§£ç å™¨æ›´å¥½çš„ç”Ÿæˆï¼ˆæ¯ä¸€æ¬¡éƒ½ä¼šæŠŠæ‰€æœ‰ä¿¡æ¯å‘Šè¯‰è§£ç å™¨ï¼‰</p>\n<p>æµ‹è¯•é˜¶æ®µï¼šè§£ç å™¨ä¹Ÿä¼šæœ‰è¾“å…¥ï¼Œä½†æ˜¯æ­¤æ—¶ï¼Œæµ‹è¯•çš„æ—¶å€™æ˜¯ä¸çŸ¥é“ç›®æ ‡è¯­å¥æ˜¯ä»€ä¹ˆçš„ï¼Œè¿™ä¸ªæ—¶å€™ï¼Œä½ æ¯ç”Ÿæˆä¸€ä¸ªè¯ï¼Œå°±ä¼šæœ‰å¤šä¸€ä¸ªè¯æ”¾å…¥ç›®æ ‡è¯­å¥ä¸­ï¼Œæ¯æ¬¡ç”Ÿæˆçš„æ—¶å€™ï¼Œéƒ½æ˜¯å·²ç»ç”Ÿæˆçš„è¯ï¼ˆæµ‹è¯•é˜¶æ®µåªä¼šæŠŠå·²ç»ç”Ÿæˆçš„è¯å‘Šè¯‰è§£ç å™¨ï¼‰</p>\n<p>ä¸ºäº†åŒ¹é…ï¼Œä¸ºäº†è§£å†³è¿™ä¸ª gapï¼Œmasked Self-Attention å°±ç™»åœºäº†ï¼Œæˆ‘åœ¨è®­ç»ƒé˜¶æ®µï¼Œæˆ‘å°±åšä¸€ä¸ª maskedï¼Œå½“ä½ ç”Ÿæˆç¬¬ä¸€ä¸ªè¯ï¼Œæˆ‘å•¥ä¹Ÿä¸å‘Šè¯‰ä½ ï¼Œå½“ä½ ç”Ÿæˆç¬¬äºŒä¸ªè¯ï¼Œæˆ‘å‘Šè¯‰ç¬¬ä¸€ä¸ªè¯</p>\n<p>&lt;img src=&quot;<span class=\"exturl\" data-url=\"aHR0cHM6Ly9pbWdtZC5vc3MtY24tc2hhbmdoYWkuYWxpeXVuY3MuY29tL0JFUlRfSU1HL21hc2stYXR0ZW50aW9uLW1hcC5qcGc=\">https://imgmd.oss-cn-shanghai.aliyuncs.com/BERT_IMG/mask-attention-map.jpg</span>&quot; alt=&quot;img&quot; style=&quot;zoom:50%;&quot; /&gt;</p>\n<h2 id=\"é—®é¢˜äºŒä¸ºä»€ä¹ˆ-encoder-ç»™äºˆ-decoders-çš„æ˜¯-k-v-çŸ©é˜µ\"><a class=\"anchor\" href=\"#é—®é¢˜äºŒä¸ºä»€ä¹ˆ-encoder-ç»™äºˆ-decoders-çš„æ˜¯-k-v-çŸ©é˜µ\">#</a> é—®é¢˜äºŒï¼šä¸ºä»€ä¹ˆ Encoder ç»™äºˆ Decoders çš„æ˜¯ Kã€V çŸ©é˜µ</h2>\n<p>Q æ¥æºè§£ç å™¨ï¼ŒK=V æ¥æºäºç¼–ç å™¨</p>\n<p>Q æ˜¯æŸ¥è¯¢å˜é‡ï¼ŒQ æ˜¯å·²ç»ç”Ÿæˆçš„è¯</p>\n<p>K=V æ˜¯æºè¯­å¥</p>\n<p>å½“æˆ‘ä»¬ç”Ÿæˆè¿™ä¸ªè¯çš„æ—¶å€™ï¼Œé€šè¿‡å·²ç»ç”Ÿæˆçš„è¯å’Œæºè¯­å¥åšè‡ªæ³¨æ„åŠ›ï¼Œå°±æ˜¯ç¡®å®šæºè¯­å¥ä¸­å“ªäº›è¯å¯¹æ¥ä¸‹æ¥çš„è¯çš„ç”Ÿæˆæ›´æœ‰ä½œç”¨ï¼Œé¦–å…ˆä»–å°±èƒ½æ‰¾åˆ°å½“å‰ç”Ÿæˆè¯</p>\n<p>æˆ‘çˆ±ä¸­å›½</p>\n<p>é€šè¿‡éƒ¨åˆ†ï¼ˆç”Ÿæˆçš„è¯ï¼‰å»å…¨éƒ¨ï¼ˆæºè¯­å¥ï¼‰çš„é‡Œé¢æŒ‘é‡ç‚¹</p>\n<p>Q æ˜¯æºè¯­å¥ï¼ŒKï¼ŒV æ˜¯å·²ç»ç”Ÿæˆçš„è¯ï¼Œæºè¯­å¥å»å·²ç»ç”Ÿæˆçš„è¯é‡Œæ‰¾é‡ç‚¹ ï¼Œæ‰¾ä¿¡æ¯ï¼Œå·²ç»ç”Ÿæˆçš„è¯é‡Œé¢å‹æ ¹å°±æ²¡æœ‰ä¸‹ä¸€ä¸ªè¯</p>\n<p>è§£å†³äº†ä»¥å‰çš„ seq2seq æ¡†æ¶çš„é—®é¢˜</p>\n<p>lstm åšç¼–ç å™¨ï¼ˆå¾—åˆ°è¯å‘é‡ Cï¼‰ï¼Œå†ç”¨ lstm åšè§£ç å™¨åšç”Ÿæˆ</p>\n<p>ç”¨è¿™ç§æ–¹æ³•å»ç”Ÿæˆè¯ï¼Œæ¯ä¸€æ¬¡ç”Ÿæˆè¯ï¼Œéƒ½æ˜¯é€šè¿‡ C çš„å…¨éƒ¨ä¿¡æ¯å»ç”Ÿæˆ</p>\n<p>å¾ˆå¤šä¿¡æ¯å¯¹äºå½“å‰ç”Ÿæˆè¯è€Œè¨€éƒ½æ˜¯æ²¡æœ‰æ„ä¹‰çš„</p>\n<p>ç”¨ Pytorch å»æ„å»º Transformer çš„æºç ï¼ˆï¼‰</p>\n<h1 id=\"ä½ç½®ç¼–ç å…¬å¼è¯¦ç»†ç†è§£è¡¥å……\"><a class=\"anchor\" href=\"#ä½ç½®ç¼–ç å…¬å¼è¯¦ç»†ç†è§£è¡¥å……\">#</a> ä½ç½®ç¼–ç å…¬å¼è¯¦ç»†ç†è§£è¡¥å……</h1>\n<p>Self-Attentionï¼šå¯¹äºæ¯ä¸ªè¯è€Œè¨€éƒ½æ˜¯æ— ä½ç½®å…³ç³»ï¼ŒæŠŠæ¯ä¸ªè¯çš„é¡ºåºæ‰“ä¹±ï¼Œå¾—åˆ°çš„æ³¨æ„åŠ›å€¼ä¾ç„¶ä¸å˜</p>\n<p>é€šè¿‡ t1 å‘Šè¯‰ä½ ï¼Œx1 æ˜¯åœ¨å‰é¢ï¼Œx2 åœ¨ x1 çš„åé¢</p>\n<ul>\n<li>ä½ç½®ç¼–ç </li>\n</ul>\n<p>&lt;img src=&quot;<span class=\"exturl\" data-url=\"aHR0cHM6Ly9pbWdtZC5vc3MtY24tc2hhbmdoYWkuYWxpeXVuY3MuY29tL0JFUlRfSU1HLyVFNCVCRCU4RCVFNyVCRCVBRSVFNSU5MCU5MSVFOSU4NyU4Ri5qcGc=\">https://imgmd.oss-cn-shanghai.aliyuncs.com/BERT_IMG/ ä½ç½®å‘é‡.jpg</span>&quot; alt=&quot;img&quot; style=&quot;zoom:50%;&quot; /&gt;</p>\n<ul>\n<li>ä½ç½®ç¼–ç å…¬å¼</li>\n</ul>\n<p>&lt;img src=&quot;<span class=\"exturl\" data-url=\"aHR0cHM6Ly9pbWdtZC5vc3MtY24tc2hhbmdoYWkuYWxpeXVuY3MuY29tL0JFUlRfSU1HLyVFNCVCRCU4RCVFNyVCRCVBRSVFNyVCQyU5NiVFNyVBMCU4MSVFNSU4NSVBQyVFNSVCQyU4Ri5wbmc=\">https://imgmd.oss-cn-shanghai.aliyuncs.com/BERT_IMG/ ä½ç½®ç¼–ç å…¬å¼.png</span>&quot; alt=&quot;img&quot; style=&quot;zoom:50%;&quot; /&gt;</p>\n<p>ä½ç½®ç¼–ç æ€ä¹ˆç”¨</p>\n<p>&lt;img src=&quot;<span class=\"exturl\" data-url=\"aHR0cHM6Ly9pbWdtZC5vc3MtY24tc2hhbmdoYWkuYWxpeXVuY3MuY29tL0JFUlRfSU1HLyVFNCVCRCU4RCVFNyVCRCVBRSVFNyVCQyU5NiVFNyVBMCU4MSVFNSU5MiU4QyVFOCVBRiU4RCVFNSU5MCU5MSVFOSU4NyU4RiVFNCVCOSU4QiVFNSU5MiU4Qy5wbmc=\">https://imgmd.oss-cn-shanghai.aliyuncs.com/BERT_IMG/ ä½ç½®ç¼–ç å’Œè¯å‘é‡ä¹‹å’Œ.png</span>&quot; alt=&quot;img&quot; style=&quot;zoom:50%;&quot; /&gt;</p>\n<ul>\n<li>ä½ç½®ç¼–ç åº•å±‚è§£é‡Š</li>\n</ul>\n<p>&lt;img src=&quot;<span class=\"exturl\" data-url=\"aHR0cHM6Ly9pbWdtZC5vc3MtY24tc2hhbmdoYWkuYWxpeXVuY3MuY29tL0JFUlRfSU1HLyVFNCVCRCU4RCVFNyVCRCVBRSVFNSVCNSU4QyVFNSU4NSVBNSVFOCVBNyVBMyVFOSU4NyU4QS5wbmc=\">https://imgmd.oss-cn-shanghai.aliyuncs.com/BERT_IMG/ ä½ç½®åµŒå…¥è§£é‡Š.png</span>&quot; alt=&quot;img&quot; style=&quot;zoom:50%;&quot; /&gt;</p>\n<figure class=\"highlight raw\"><figcaption data-lang=\"\"></figcaption><table><tr><td data-num=\"1\"></td><td><pre>sin (pos+k) &#x3D; sin (pos)*cos (k) + cos (pos)*sin (k)  # sin è¡¨ç¤ºçš„æ˜¯å¶æ•°ç»´åº¦</pre></td></tr><tr><td data-num=\"2\"></td><td><pre>cos (pos+k) &#x3D; cos (pos) cos (k) - sin (pos)*sin (k)  # cos è¡¨ç¤ºçš„æ˜¯å¥‡æ•°ç»´åº¦</pre></td></tr><tr><td data-num=\"3\"></td><td><pre></pre></td></tr><tr><td data-num=\"4\"></td><td><pre>ä»–ç‰¹åˆ«åœ¨ pos+k æ˜¯ pos å’Œ k çš„çº¿æ€§ç»„åˆ</pre></td></tr><tr><td data-num=\"5\"></td><td><pre></pre></td></tr><tr><td data-num=\"6\"></td><td><pre>æˆ‘çˆ±ä½  ï¼Œç°åœ¨æˆ‘åšç¬¬ä¸‰ä¸ªè¯ â€œä½ â€ çš„ä½ç½®ç¼–ç </pre></td></tr><tr><td data-num=\"7\"></td><td><pre></pre></td></tr><tr><td data-num=\"8\"></td><td><pre>pos &#x3D; 3 &#x3D; 1+2</pre></td></tr><tr><td data-num=\"9\"></td><td><pre>pos + k &#x3D; 3 &#x3D;  1+2 &#x3D; 1*2+1*2</pre></td></tr><tr><td data-num=\"10\"></td><td><pre></pre></td></tr><tr><td data-num=\"11\"></td><td><pre>pos &#x3D; 10</pre></td></tr><tr><td data-num=\"12\"></td><td><pre>1+9ï¼Œ2+8ï¼Œ3+7</pre></td></tr><tr><td data-num=\"13\"></td><td><pre></pre></td></tr><tr><td data-num=\"14\"></td><td><pre>è¿™å¥è¯å˜æˆ â€œä½ çˆ±æˆ‘â€ï¼Œç°åœ¨æˆ‘ä»¬ä»ç„¶åšç¬¬ä¸‰ä¸ªè¯ â€œæˆ‘â€ çš„ä½ç½®ç¼–ç </pre></td></tr><tr><td data-num=\"15\"></td><td><pre></pre></td></tr><tr><td data-num=\"16\"></td><td><pre>pos &#x3D; 3 &#x3D; 1+2</pre></td></tr><tr><td data-num=\"17\"></td><td><pre>pos + k &#x3D; 3 &#x3D;  1+2 &#x3D; 1*2+1*2</pre></td></tr></table></figure>",
            "tags": [
                "NER"
            ]
        },
        {
            "id": "http://qiji5211.com/2024/02/07/NER/Pre-training-language-model-main/%E7%AC%AC%E4%B8%80%E7%AF%87%20Transformer%E3%80%81GPT%E3%80%81BERT%EF%BC%8C%E9%A2%84%E8%AE%AD%E7%BB%83%E8%AF%AD%E8%A8%80%E6%A8%A1%E5%9E%8B%E7%9A%84%E5%89%8D%E4%B8%96%E4%BB%8A%E7%94%9F%EF%BC%88%E7%90%86%E8%AE%BA%EF%BC%89/%E6%B3%A8%E6%84%8F%E5%8A%9B%E6%9C%BA%E5%88%B6%EF%BC%88Attention%20%EF%BC%89/",
            "url": "http://qiji5211.com/2024/02/07/NER/Pre-training-language-model-main/%E7%AC%AC%E4%B8%80%E7%AF%87%20Transformer%E3%80%81GPT%E3%80%81BERT%EF%BC%8C%E9%A2%84%E8%AE%AD%E7%BB%83%E8%AF%AD%E8%A8%80%E6%A8%A1%E5%9E%8B%E7%9A%84%E5%89%8D%E4%B8%96%E4%BB%8A%E7%94%9F%EF%BC%88%E7%90%86%E8%AE%BA%EF%BC%89/%E6%B3%A8%E6%84%8F%E5%8A%9B%E6%9C%BA%E5%88%B6%EF%BC%88Attention%20%EF%BC%89/",
            "title": "æ³¨æ„åŠ›æœºåˆ¶ï¼ˆAttention ï¼‰",
            "date_published": "2024-02-07T09:30:58.000Z",
            "content_html": "<h1 id=\"attentionæ³¨æ„åŠ›æœºåˆ¶\"><a class=\"anchor\" href=\"#attentionæ³¨æ„åŠ›æœºåˆ¶\">#</a> Attentionï¼ˆæ³¨æ„åŠ›æœºåˆ¶ï¼‰</h1>\n<p>ä½ ä¼šæ³¨æ„ä»€ä¹ˆï¼Ÿ</p>\n<p>å¤§æ•°æ®ï¼ˆä»€ä¹ˆæ•°æ®éƒ½æœ‰ï¼Œé‡è¦çš„ï¼Œä¸é‡è¦çš„ï¼‰</p>\n<p>å¯¹äºé‡è¦çš„æ•°æ®ï¼Œæˆ‘ä»¬è¦ä½¿ç”¨</p>\n<p>å¯¹äºä¸é‡è¦çš„æ•°æ®ï¼Œæˆ‘ä»¬ä¸å¤ªæƒ³ä½¿ç”¨</p>\n<p>ä½†æ˜¯ï¼Œå¯¹äºä¸€ä¸ªæ¨¡å‹è€Œè¨€ï¼ˆCNNã€LSTMï¼‰ï¼Œå¾ˆéš¾å†³å®šä»€ä¹ˆé‡è¦ï¼Œä»€ä¹ˆä¸é‡è¦</p>\n<p>ç”±æ­¤ï¼Œæ³¨æ„åŠ›æœºåˆ¶è¯ç”Ÿäº†ï¼ˆæœ‰äººå‘ç°äº†å¦‚ä½•å»åœ¨æ·±åº¦å­¦ä¹ çš„æ¨¡å‹ä¸Šåšæ³¨æ„åŠ›ï¼‰</p>\n<p><img data-src=\"https://imgmd.oss-cn-shanghai.aliyuncs.com/BERT_IMG/%E4%BA%BA%E7%B1%BB%E7%9A%84%E8%A7%86%E8%A7%89%E6%B3%A8%E6%84%8F%E5%8A%9B.jpg\" alt=\"img\" /></p>\n<p>çº¢è‰²çš„æ˜¯ç§‘å­¦å®¶ä»¬å‘ç°ï¼Œå¦‚æœç»™ä½ ä¸€å¼ è¿™ä¸ªå›¾ï¼Œä½ çœ¼ç›çš„é‡ç‚¹ä¼šèšç„¦åœ¨çº¢è‰²åŒºåŸŸ</p>\n<p>äºº --ã€‹çœ‹è„¸</p>\n<p>æ–‡ç« çœ‹æ ‡é¢˜</p>\n<p>æ®µè½çœ‹å¼€å¤´</p>\n<p>åé¢çš„è½æ¬¾</p>\n<p>è¿™äº›çº¢è‰²åŒºåŸŸå¯èƒ½åŒ…å«æ›´å¤šçš„ä¿¡æ¯ï¼Œæ›´é‡è¦çš„ä¿¡æ¯</p>\n<p>æ³¨æ„åŠ›æœºåˆ¶ï¼šæˆ‘ä»¬ä¼šæŠŠæˆ‘ä»¬çš„ç„¦ç‚¹èšç„¦åœ¨æ¯”è¾ƒé‡è¦çš„äº‹ç‰©ä¸Š</p>\n<h1 id=\"æ€ä¹ˆåšæ³¨æ„åŠ›\"><a class=\"anchor\" href=\"#æ€ä¹ˆåšæ³¨æ„åŠ›\">#</a> æ€ä¹ˆåšæ³¨æ„åŠ›</h1>\n<p>æˆ‘ï¼ˆæŸ¥è¯¢å¯¹è±¡ Qï¼‰ï¼Œè¿™å¼ å›¾ï¼ˆè¢«æŸ¥è¯¢å¯¹è±¡ Vï¼‰</p>\n<p>æˆ‘çœ‹è¿™å¼ å›¾ï¼Œç¬¬ä¸€çœ¼ï¼Œæˆ‘å°±ä¼šå»åˆ¤æ–­å“ªäº›ä¸œè¥¿å¯¹æˆ‘è€Œè¨€æ›´é‡è¦ï¼Œå“ªäº›å¯¹æˆ‘è€Œè¨€åˆæ›´ä¸é‡è¦ï¼ˆå»è®¡ç®— Q å’Œ V é‡Œçš„äº‹ç‰©çš„é‡è¦åº¦ï¼‰</p>\n<p>é‡è¦åº¦è®¡ç®—ï¼Œå…¶å®æ˜¯ä¸æ˜¯å°±æ˜¯ç›¸ä¼¼åº¦è®¡ç®—ï¼ˆæ›´æ¥è¿‘ï¼‰ï¼Œç‚¹ä¹˜å…¶å®æ˜¯æ±‚å†…ç§¯ï¼ˆä¸è¦å…³å¿ƒä¸ºä»€ä¹ˆå¯ä»¥ï¼‰</p>\n<p>Qï¼Œ<span class=\"katex\"><span class=\"katex-mathml\"><math xmlns=\"http://www.w3.org/1998/Math/MathML\"><semantics><mrow><mi>K</mi><mo>=</mo><msub><mi>k</mi><mn>1</mn></msub><mo separator=\"true\">,</mo><msub><mi>k</mi><mn>2</mn></msub><mo separator=\"true\">,</mo><mo>â‹¯</mo><mtext>â€‰</mtext><mo separator=\"true\">,</mo><msub><mi>k</mi><mi>n</mi></msub></mrow><annotation encoding=\"application/x-tex\">K =k_1,k_2,\\cdots,k_n</annotation></semantics></math></span><span class=\"katex-html\" aria-hidden=\"true\"><span class=\"base\"><span class=\"strut\" style=\"height:0.68333em;vertical-align:0em;\"></span><span class=\"mord mathnormal\" style=\"margin-right:0.07153em;\">K</span><span class=\"mspace\" style=\"margin-right:0.2777777777777778em;\"></span><span class=\"mrel\">=</span><span class=\"mspace\" style=\"margin-right:0.2777777777777778em;\"></span></span><span class=\"base\"><span class=\"strut\" style=\"height:0.8888799999999999em;vertical-align:-0.19444em;\"></span><span class=\"mord\"><span class=\"mord mathnormal\" style=\"margin-right:0.03148em;\">k</span><span class=\"msupsub\"><span class=\"vlist-t vlist-t2\"><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.30110799999999993em;\"><span style=\"top:-2.5500000000000003em;margin-left:-0.03148em;margin-right:0.05em;\"><span class=\"pstrut\" style=\"height:2.7em;\"></span><span class=\"sizing reset-size6 size3 mtight\"><span class=\"mord mtight\">1</span></span></span></span><span class=\"vlist-s\">â€‹</span></span><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.15em;\"><span></span></span></span></span></span></span><span class=\"mpunct\">,</span><span class=\"mspace\" style=\"margin-right:0.16666666666666666em;\"></span><span class=\"mord\"><span class=\"mord mathnormal\" style=\"margin-right:0.03148em;\">k</span><span class=\"msupsub\"><span class=\"vlist-t vlist-t2\"><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.30110799999999993em;\"><span style=\"top:-2.5500000000000003em;margin-left:-0.03148em;margin-right:0.05em;\"><span class=\"pstrut\" style=\"height:2.7em;\"></span><span class=\"sizing reset-size6 size3 mtight\"><span class=\"mord mtight\">2</span></span></span></span><span class=\"vlist-s\">â€‹</span></span><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.15em;\"><span></span></span></span></span></span></span><span class=\"mpunct\">,</span><span class=\"mspace\" style=\"margin-right:0.16666666666666666em;\"></span><span class=\"minner\">â‹¯</span><span class=\"mspace\" style=\"margin-right:0.16666666666666666em;\"></span><span class=\"mspace\" style=\"margin-right:0.16666666666666666em;\"></span><span class=\"mpunct\">,</span><span class=\"mspace\" style=\"margin-right:0.16666666666666666em;\"></span><span class=\"mord\"><span class=\"mord mathnormal\" style=\"margin-right:0.03148em;\">k</span><span class=\"msupsub\"><span class=\"vlist-t vlist-t2\"><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.151392em;\"><span style=\"top:-2.5500000000000003em;margin-left:-0.03148em;margin-right:0.05em;\"><span class=\"pstrut\" style=\"height:2.7em;\"></span><span class=\"sizing reset-size6 size3 mtight\"><span class=\"mord mathnormal mtight\">n</span></span></span></span><span class=\"vlist-s\">â€‹</span></span><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.15em;\"><span></span></span></span></span></span></span></span></span></span> ï¼Œæˆ‘ä»¬ä¸€èˆ¬ä½¿ç”¨ç‚¹ä¹˜çš„æ–¹å¼</p>\n<p>é€šè¿‡ç‚¹ä¹˜çš„æ–¹æ³•è®¡ç®— Q å’Œ K é‡Œçš„æ¯ä¸€ä¸ªäº‹ç‰©çš„ç›¸ä¼¼åº¦ï¼Œå°±å¯ä»¥æ‹¿åˆ° Q å’Œ<span class=\"katex\"><span class=\"katex-mathml\"><math xmlns=\"http://www.w3.org/1998/Math/MathML\"><semantics><mrow><msub><mi>k</mi><mn>1</mn></msub></mrow><annotation encoding=\"application/x-tex\">k_1</annotation></semantics></math></span><span class=\"katex-html\" aria-hidden=\"true\"><span class=\"base\"><span class=\"strut\" style=\"height:0.84444em;vertical-align:-0.15em;\"></span><span class=\"mord\"><span class=\"mord mathnormal\" style=\"margin-right:0.03148em;\">k</span><span class=\"msupsub\"><span class=\"vlist-t vlist-t2\"><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.30110799999999993em;\"><span style=\"top:-2.5500000000000003em;margin-left:-0.03148em;margin-right:0.05em;\"><span class=\"pstrut\" style=\"height:2.7em;\"></span><span class=\"sizing reset-size6 size3 mtight\"><span class=\"mord mtight\">1</span></span></span></span><span class=\"vlist-s\">â€‹</span></span><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.15em;\"><span></span></span></span></span></span></span></span></span></span> çš„ç›¸ä¼¼å€¼<span class=\"katex\"><span class=\"katex-mathml\"><math xmlns=\"http://www.w3.org/1998/Math/MathML\"><semantics><mrow><msub><mi>s</mi><mn>1</mn></msub></mrow><annotation encoding=\"application/x-tex\">s_1</annotation></semantics></math></span><span class=\"katex-html\" aria-hidden=\"true\"><span class=\"base\"><span class=\"strut\" style=\"height:0.58056em;vertical-align:-0.15em;\"></span><span class=\"mord\"><span class=\"mord mathnormal\">s</span><span class=\"msupsub\"><span class=\"vlist-t vlist-t2\"><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.30110799999999993em;\"><span style=\"top:-2.5500000000000003em;margin-left:0em;margin-right:0.05em;\"><span class=\"pstrut\" style=\"height:2.7em;\"></span><span class=\"sizing reset-size6 size3 mtight\"><span class=\"mord mtight\">1</span></span></span></span><span class=\"vlist-s\">â€‹</span></span><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.15em;\"><span></span></span></span></span></span></span></span></span></span>ï¼ŒQ å’Œ<span class=\"katex\"><span class=\"katex-mathml\"><math xmlns=\"http://www.w3.org/1998/Math/MathML\"><semantics><mrow><msub><mi>k</mi><mn>2</mn></msub></mrow><annotation encoding=\"application/x-tex\">k_2</annotation></semantics></math></span><span class=\"katex-html\" aria-hidden=\"true\"><span class=\"base\"><span class=\"strut\" style=\"height:0.84444em;vertical-align:-0.15em;\"></span><span class=\"mord\"><span class=\"mord mathnormal\" style=\"margin-right:0.03148em;\">k</span><span class=\"msupsub\"><span class=\"vlist-t vlist-t2\"><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.30110799999999993em;\"><span style=\"top:-2.5500000000000003em;margin-left:-0.03148em;margin-right:0.05em;\"><span class=\"pstrut\" style=\"height:2.7em;\"></span><span class=\"sizing reset-size6 size3 mtight\"><span class=\"mord mtight\">2</span></span></span></span><span class=\"vlist-s\">â€‹</span></span><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.15em;\"><span></span></span></span></span></span></span></span></span></span> çš„ç›¸ä¼¼å€¼<span class=\"katex\"><span class=\"katex-mathml\"><math xmlns=\"http://www.w3.org/1998/Math/MathML\"><semantics><mrow><msub><mi>s</mi><mn>2</mn></msub></mrow><annotation encoding=\"application/x-tex\">s_2</annotation></semantics></math></span><span class=\"katex-html\" aria-hidden=\"true\"><span class=\"base\"><span class=\"strut\" style=\"height:0.58056em;vertical-align:-0.15em;\"></span><span class=\"mord\"><span class=\"mord mathnormal\">s</span><span class=\"msupsub\"><span class=\"vlist-t vlist-t2\"><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.30110799999999993em;\"><span style=\"top:-2.5500000000000003em;margin-left:0em;margin-right:0.05em;\"><span class=\"pstrut\" style=\"height:2.7em;\"></span><span class=\"sizing reset-size6 size3 mtight\"><span class=\"mord mtight\">2</span></span></span></span><span class=\"vlist-s\">â€‹</span></span><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.15em;\"><span></span></span></span></span></span></span></span></span></span>ï¼ŒQ å’Œ<span class=\"katex\"><span class=\"katex-mathml\"><math xmlns=\"http://www.w3.org/1998/Math/MathML\"><semantics><mrow><msub><mi>k</mi><mi>n</mi></msub></mrow><annotation encoding=\"application/x-tex\">k_n</annotation></semantics></math></span><span class=\"katex-html\" aria-hidden=\"true\"><span class=\"base\"><span class=\"strut\" style=\"height:0.84444em;vertical-align:-0.15em;\"></span><span class=\"mord\"><span class=\"mord mathnormal\" style=\"margin-right:0.03148em;\">k</span><span class=\"msupsub\"><span class=\"vlist-t vlist-t2\"><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.151392em;\"><span style=\"top:-2.5500000000000003em;margin-left:-0.03148em;margin-right:0.05em;\"><span class=\"pstrut\" style=\"height:2.7em;\"></span><span class=\"sizing reset-size6 size3 mtight\"><span class=\"mord mathnormal mtight\">n</span></span></span></span><span class=\"vlist-s\">â€‹</span></span><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.15em;\"><span></span></span></span></span></span></span></span></span></span> çš„ç›¸ä¼¼å€¼ <span class=\"katex\"><span class=\"katex-mathml\"><math xmlns=\"http://www.w3.org/1998/Math/MathML\"><semantics><mrow><msub><mi>s</mi><mi>n</mi></msub></mrow><annotation encoding=\"application/x-tex\">s_n</annotation></semantics></math></span><span class=\"katex-html\" aria-hidden=\"true\"><span class=\"base\"><span class=\"strut\" style=\"height:0.58056em;vertical-align:-0.15em;\"></span><span class=\"mord\"><span class=\"mord mathnormal\">s</span><span class=\"msupsub\"><span class=\"vlist-t vlist-t2\"><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.151392em;\"><span style=\"top:-2.5500000000000003em;margin-left:0em;margin-right:0.05em;\"><span class=\"pstrut\" style=\"height:2.7em;\"></span><span class=\"sizing reset-size6 size3 mtight\"><span class=\"mord mathnormal mtight\">n</span></span></span></span><span class=\"vlist-s\">â€‹</span></span><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.15em;\"><span></span></span></span></span></span></span></span></span></span></p>\n<p>åšä¸€å±‚ <span class=\"katex\"><span class=\"katex-mathml\"><math xmlns=\"http://www.w3.org/1998/Math/MathML\"><semantics><mrow><mi>s</mi><mi>o</mi><mi>f</mi><mi>t</mi><mi>m</mi><mi>a</mi><mi>x</mi><mo stretchy=\"false\">(</mo><msub><mi>s</mi><mn>1</mn></msub><mo separator=\"true\">,</mo><msub><mi>s</mi><mn>2</mn></msub><mo separator=\"true\">,</mo><mo>â‹¯</mo><mtext>â€‰</mtext><mo separator=\"true\">,</mo><msub><mi>s</mi><mi>n</mi></msub><mo stretchy=\"false\">)</mo></mrow><annotation encoding=\"application/x-tex\">softmax(s_1,s_2,\\cdots,s_n)</annotation></semantics></math></span><span class=\"katex-html\" aria-hidden=\"true\"><span class=\"base\"><span class=\"strut\" style=\"height:1em;vertical-align:-0.25em;\"></span><span class=\"mord mathnormal\">s</span><span class=\"mord mathnormal\">o</span><span class=\"mord mathnormal\" style=\"margin-right:0.10764em;\">f</span><span class=\"mord mathnormal\">t</span><span class=\"mord mathnormal\">m</span><span class=\"mord mathnormal\">a</span><span class=\"mord mathnormal\">x</span><span class=\"mopen\">(</span><span class=\"mord\"><span class=\"mord mathnormal\">s</span><span class=\"msupsub\"><span class=\"vlist-t vlist-t2\"><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.30110799999999993em;\"><span style=\"top:-2.5500000000000003em;margin-left:0em;margin-right:0.05em;\"><span class=\"pstrut\" style=\"height:2.7em;\"></span><span class=\"sizing reset-size6 size3 mtight\"><span class=\"mord mtight\">1</span></span></span></span><span class=\"vlist-s\">â€‹</span></span><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.15em;\"><span></span></span></span></span></span></span><span class=\"mpunct\">,</span><span class=\"mspace\" style=\"margin-right:0.16666666666666666em;\"></span><span class=\"mord\"><span class=\"mord mathnormal\">s</span><span class=\"msupsub\"><span class=\"vlist-t vlist-t2\"><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.30110799999999993em;\"><span style=\"top:-2.5500000000000003em;margin-left:0em;margin-right:0.05em;\"><span class=\"pstrut\" style=\"height:2.7em;\"></span><span class=\"sizing reset-size6 size3 mtight\"><span class=\"mord mtight\">2</span></span></span></span><span class=\"vlist-s\">â€‹</span></span><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.15em;\"><span></span></span></span></span></span></span><span class=\"mpunct\">,</span><span class=\"mspace\" style=\"margin-right:0.16666666666666666em;\"></span><span class=\"minner\">â‹¯</span><span class=\"mspace\" style=\"margin-right:0.16666666666666666em;\"></span><span class=\"mspace\" style=\"margin-right:0.16666666666666666em;\"></span><span class=\"mpunct\">,</span><span class=\"mspace\" style=\"margin-right:0.16666666666666666em;\"></span><span class=\"mord\"><span class=\"mord mathnormal\">s</span><span class=\"msupsub\"><span class=\"vlist-t vlist-t2\"><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.151392em;\"><span style=\"top:-2.5500000000000003em;margin-left:0em;margin-right:0.05em;\"><span class=\"pstrut\" style=\"height:2.7em;\"></span><span class=\"sizing reset-size6 size3 mtight\"><span class=\"mord mathnormal mtight\">n</span></span></span></span><span class=\"vlist-s\">â€‹</span></span><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.15em;\"><span></span></span></span></span></span></span><span class=\"mclose\">)</span></span></span></span> å°±å¯ä»¥å¾—åˆ°æ¦‚ç‡<span class=\"katex\"><span class=\"katex-mathml\"><math xmlns=\"http://www.w3.org/1998/Math/MathML\"><semantics><mrow><mo stretchy=\"false\">(</mo><msub><mi>a</mi><mn>1</mn></msub><mo separator=\"true\">,</mo><msub><mi>a</mi><mn>2</mn></msub><mo separator=\"true\">,</mo><mo>â‹¯</mo><mtext>â€‰</mtext><mo separator=\"true\">,</mo><msub><mi>a</mi><mi>n</mi></msub><mo stretchy=\"false\">)</mo></mrow><annotation encoding=\"application/x-tex\">(a_1,a_2,\\cdots,a_n)</annotation></semantics></math></span><span class=\"katex-html\" aria-hidden=\"true\"><span class=\"base\"><span class=\"strut\" style=\"height:1em;vertical-align:-0.25em;\"></span><span class=\"mopen\">(</span><span class=\"mord\"><span class=\"mord mathnormal\">a</span><span class=\"msupsub\"><span class=\"vlist-t vlist-t2\"><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.30110799999999993em;\"><span style=\"top:-2.5500000000000003em;margin-left:0em;margin-right:0.05em;\"><span class=\"pstrut\" style=\"height:2.7em;\"></span><span class=\"sizing reset-size6 size3 mtight\"><span class=\"mord mtight\">1</span></span></span></span><span class=\"vlist-s\">â€‹</span></span><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.15em;\"><span></span></span></span></span></span></span><span class=\"mpunct\">,</span><span class=\"mspace\" style=\"margin-right:0.16666666666666666em;\"></span><span class=\"mord\"><span class=\"mord mathnormal\">a</span><span class=\"msupsub\"><span class=\"vlist-t vlist-t2\"><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.30110799999999993em;\"><span style=\"top:-2.5500000000000003em;margin-left:0em;margin-right:0.05em;\"><span class=\"pstrut\" style=\"height:2.7em;\"></span><span class=\"sizing reset-size6 size3 mtight\"><span class=\"mord mtight\">2</span></span></span></span><span class=\"vlist-s\">â€‹</span></span><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.15em;\"><span></span></span></span></span></span></span><span class=\"mpunct\">,</span><span class=\"mspace\" style=\"margin-right:0.16666666666666666em;\"></span><span class=\"minner\">â‹¯</span><span class=\"mspace\" style=\"margin-right:0.16666666666666666em;\"></span><span class=\"mspace\" style=\"margin-right:0.16666666666666666em;\"></span><span class=\"mpunct\">,</span><span class=\"mspace\" style=\"margin-right:0.16666666666666666em;\"></span><span class=\"mord\"><span class=\"mord mathnormal\">a</span><span class=\"msupsub\"><span class=\"vlist-t vlist-t2\"><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.151392em;\"><span style=\"top:-2.5500000000000003em;margin-left:0em;margin-right:0.05em;\"><span class=\"pstrut\" style=\"height:2.7em;\"></span><span class=\"sizing reset-size6 size3 mtight\"><span class=\"mord mathnormal mtight\">n</span></span></span></span><span class=\"vlist-s\">â€‹</span></span><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.15em;\"><span></span></span></span></span></span></span><span class=\"mclose\">)</span></span></span></span></p>\n<p>è¿›è€Œå°±å¯ä»¥æ‰¾å‡ºå“ªä¸ªå¯¹ Q è€Œè¨€æ›´é‡è¦äº†</p>\n<p><img data-src=\"https://imgmd.oss-cn-shanghai.aliyuncs.com/BERT_IMG/attention-%E8%AE%A1%E7%AE%97%E5%9B%BE.png\" alt=\"img\" /></p>\n<p>æˆ‘ä»¬è¿˜å¾—è¿›è¡Œä¸€ä¸ªæ±‡æ€»ï¼Œå½“ä½ ä½¿ç”¨ Q æŸ¥è¯¢ç»“æŸäº†åï¼ŒQ å·²ç»å¤±å»äº†å®ƒçš„ä½¿ç”¨ä»·å€¼äº†ï¼Œæˆ‘ä»¬æœ€ç»ˆè¿˜æ˜¯è¦æ‹¿åˆ°è¿™å¼ å›¾ç‰‡çš„ï¼Œåªä¸è¿‡ç°åœ¨çš„è¿™å¼ å›¾ç‰‡ï¼Œå®ƒå¤šäº†ä¸€äº›ä¿¡æ¯ï¼ˆå¤šäº†äºæˆ‘è€Œè¨€æ›´é‡è¦ï¼Œæ›´ä¸é‡è¦çš„ä¿¡æ¯åœ¨è¿™é‡Œï¼‰</p>\n<p>V = <span class=\"katex\"><span class=\"katex-mathml\"><math xmlns=\"http://www.w3.org/1998/Math/MathML\"><semantics><mrow><mo stretchy=\"false\">(</mo><msub><mi>v</mi><mn>1</mn></msub><mo separator=\"true\">,</mo><msub><mi>v</mi><mn>2</mn></msub><mo separator=\"true\">,</mo><mo>â‹¯</mo><mtext>â€‰</mtext><mo separator=\"true\">,</mo><msub><mi>v</mi><mi>n</mi></msub><mo stretchy=\"false\">)</mo></mrow><annotation encoding=\"application/x-tex\">(v_1,v_2,\\cdots,v_n)</annotation></semantics></math></span><span class=\"katex-html\" aria-hidden=\"true\"><span class=\"base\"><span class=\"strut\" style=\"height:1em;vertical-align:-0.25em;\"></span><span class=\"mopen\">(</span><span class=\"mord\"><span class=\"mord mathnormal\" style=\"margin-right:0.03588em;\">v</span><span class=\"msupsub\"><span class=\"vlist-t vlist-t2\"><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.30110799999999993em;\"><span style=\"top:-2.5500000000000003em;margin-left:-0.03588em;margin-right:0.05em;\"><span class=\"pstrut\" style=\"height:2.7em;\"></span><span class=\"sizing reset-size6 size3 mtight\"><span class=\"mord mtight\">1</span></span></span></span><span class=\"vlist-s\">â€‹</span></span><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.15em;\"><span></span></span></span></span></span></span><span class=\"mpunct\">,</span><span class=\"mspace\" style=\"margin-right:0.16666666666666666em;\"></span><span class=\"mord\"><span class=\"mord mathnormal\" style=\"margin-right:0.03588em;\">v</span><span class=\"msupsub\"><span class=\"vlist-t vlist-t2\"><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.30110799999999993em;\"><span style=\"top:-2.5500000000000003em;margin-left:-0.03588em;margin-right:0.05em;\"><span class=\"pstrut\" style=\"height:2.7em;\"></span><span class=\"sizing reset-size6 size3 mtight\"><span class=\"mord mtight\">2</span></span></span></span><span class=\"vlist-s\">â€‹</span></span><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.15em;\"><span></span></span></span></span></span></span><span class=\"mpunct\">,</span><span class=\"mspace\" style=\"margin-right:0.16666666666666666em;\"></span><span class=\"minner\">â‹¯</span><span class=\"mspace\" style=\"margin-right:0.16666666666666666em;\"></span><span class=\"mspace\" style=\"margin-right:0.16666666666666666em;\"></span><span class=\"mpunct\">,</span><span class=\"mspace\" style=\"margin-right:0.16666666666666666em;\"></span><span class=\"mord\"><span class=\"mord mathnormal\" style=\"margin-right:0.03588em;\">v</span><span class=\"msupsub\"><span class=\"vlist-t vlist-t2\"><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.151392em;\"><span style=\"top:-2.5500000000000003em;margin-left:-0.03588em;margin-right:0.05em;\"><span class=\"pstrut\" style=\"height:2.7em;\"></span><span class=\"sizing reset-size6 size3 mtight\"><span class=\"mord mathnormal mtight\">n</span></span></span></span><span class=\"vlist-s\">â€‹</span></span><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.15em;\"><span></span></span></span></span></span></span><span class=\"mclose\">)</span></span></span></span></p>\n<p><span class=\"katex\"><span class=\"katex-mathml\"><math xmlns=\"http://www.w3.org/1998/Math/MathML\"><semantics><mrow><mo stretchy=\"false\">(</mo><msub><mi>a</mi><mn>1</mn></msub><mo separator=\"true\">,</mo><msub><mi>a</mi><mn>2</mn></msub><mo separator=\"true\">,</mo><mo>â‹¯</mo><mtext>â€‰</mtext><mo separator=\"true\">,</mo><msub><mi>a</mi><mi>n</mi></msub><mo stretchy=\"false\">)</mo><mo>âˆ—</mo><mo>+</mo><mo stretchy=\"false\">(</mo><msub><mi>v</mi><mn>1</mn></msub><mo separator=\"true\">,</mo><msub><mi>v</mi><mn>2</mn></msub><mo separator=\"true\">,</mo><mo>â‹¯</mo><mtext>â€‰</mtext><mo separator=\"true\">,</mo><msub><mi>v</mi><mi>n</mi></msub><mo stretchy=\"false\">)</mo><mo>=</mo><mo stretchy=\"false\">(</mo><msub><mi>a</mi><mn>1</mn></msub><mo>âˆ—</mo><msub><mi>v</mi><mn>1</mn></msub><mo>+</mo><msub><mi>a</mi><mn>2</mn></msub><mo>âˆ—</mo><msub><mi>v</mi><mn>2</mn></msub><mo>+</mo><mo>â‹¯</mo><mo>+</mo><msub><mi>a</mi><mi>n</mi></msub><mo>âˆ—</mo><msub><mi>v</mi><mi>n</mi></msub><mo stretchy=\"false\">)</mo></mrow><annotation encoding=\"application/x-tex\">(a_1,a_2,\\cdots,a_n)*+(v_1,v_2,\\cdots,v_n)=(a_1*v_1+a_2*v_2+\\cdots+a_n*v_n)</annotation></semantics></math></span><span class=\"katex-html\" aria-hidden=\"true\"><span class=\"base\"><span class=\"strut\" style=\"height:1em;vertical-align:-0.25em;\"></span><span class=\"mopen\">(</span><span class=\"mord\"><span class=\"mord mathnormal\">a</span><span class=\"msupsub\"><span class=\"vlist-t vlist-t2\"><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.30110799999999993em;\"><span style=\"top:-2.5500000000000003em;margin-left:0em;margin-right:0.05em;\"><span class=\"pstrut\" style=\"height:2.7em;\"></span><span class=\"sizing reset-size6 size3 mtight\"><span class=\"mord mtight\">1</span></span></span></span><span class=\"vlist-s\">â€‹</span></span><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.15em;\"><span></span></span></span></span></span></span><span class=\"mpunct\">,</span><span class=\"mspace\" style=\"margin-right:0.16666666666666666em;\"></span><span class=\"mord\"><span class=\"mord mathnormal\">a</span><span class=\"msupsub\"><span class=\"vlist-t vlist-t2\"><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.30110799999999993em;\"><span style=\"top:-2.5500000000000003em;margin-left:0em;margin-right:0.05em;\"><span class=\"pstrut\" style=\"height:2.7em;\"></span><span class=\"sizing reset-size6 size3 mtight\"><span class=\"mord mtight\">2</span></span></span></span><span class=\"vlist-s\">â€‹</span></span><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.15em;\"><span></span></span></span></span></span></span><span class=\"mpunct\">,</span><span class=\"mspace\" style=\"margin-right:0.16666666666666666em;\"></span><span class=\"minner\">â‹¯</span><span class=\"mspace\" style=\"margin-right:0.16666666666666666em;\"></span><span class=\"mspace\" style=\"margin-right:0.16666666666666666em;\"></span><span class=\"mpunct\">,</span><span class=\"mspace\" style=\"margin-right:0.16666666666666666em;\"></span><span class=\"mord\"><span class=\"mord mathnormal\">a</span><span class=\"msupsub\"><span class=\"vlist-t vlist-t2\"><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.151392em;\"><span style=\"top:-2.5500000000000003em;margin-left:0em;margin-right:0.05em;\"><span class=\"pstrut\" style=\"height:2.7em;\"></span><span class=\"sizing reset-size6 size3 mtight\"><span class=\"mord mathnormal mtight\">n</span></span></span></span><span class=\"vlist-s\">â€‹</span></span><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.15em;\"><span></span></span></span></span></span></span><span class=\"mclose\">)</span><span class=\"mspace\" style=\"margin-right:0.2222222222222222em;\"></span><span class=\"mbin\">âˆ—</span><span class=\"mspace\" style=\"margin-right:0.2222222222222222em;\"></span></span><span class=\"base\"><span class=\"strut\" style=\"height:1em;vertical-align:-0.25em;\"></span><span class=\"mord\">+</span><span class=\"mopen\">(</span><span class=\"mord\"><span class=\"mord mathnormal\" style=\"margin-right:0.03588em;\">v</span><span class=\"msupsub\"><span class=\"vlist-t vlist-t2\"><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.30110799999999993em;\"><span style=\"top:-2.5500000000000003em;margin-left:-0.03588em;margin-right:0.05em;\"><span class=\"pstrut\" style=\"height:2.7em;\"></span><span class=\"sizing reset-size6 size3 mtight\"><span class=\"mord mtight\">1</span></span></span></span><span class=\"vlist-s\">â€‹</span></span><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.15em;\"><span></span></span></span></span></span></span><span class=\"mpunct\">,</span><span class=\"mspace\" style=\"margin-right:0.16666666666666666em;\"></span><span class=\"mord\"><span class=\"mord mathnormal\" style=\"margin-right:0.03588em;\">v</span><span class=\"msupsub\"><span class=\"vlist-t vlist-t2\"><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.30110799999999993em;\"><span style=\"top:-2.5500000000000003em;margin-left:-0.03588em;margin-right:0.05em;\"><span class=\"pstrut\" style=\"height:2.7em;\"></span><span class=\"sizing reset-size6 size3 mtight\"><span class=\"mord mtight\">2</span></span></span></span><span class=\"vlist-s\">â€‹</span></span><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.15em;\"><span></span></span></span></span></span></span><span class=\"mpunct\">,</span><span class=\"mspace\" style=\"margin-right:0.16666666666666666em;\"></span><span class=\"minner\">â‹¯</span><span class=\"mspace\" style=\"margin-right:0.16666666666666666em;\"></span><span class=\"mspace\" style=\"margin-right:0.16666666666666666em;\"></span><span class=\"mpunct\">,</span><span class=\"mspace\" style=\"margin-right:0.16666666666666666em;\"></span><span class=\"mord\"><span class=\"mord mathnormal\" style=\"margin-right:0.03588em;\">v</span><span class=\"msupsub\"><span class=\"vlist-t vlist-t2\"><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.151392em;\"><span style=\"top:-2.5500000000000003em;margin-left:-0.03588em;margin-right:0.05em;\"><span class=\"pstrut\" style=\"height:2.7em;\"></span><span class=\"sizing reset-size6 size3 mtight\"><span class=\"mord mathnormal mtight\">n</span></span></span></span><span class=\"vlist-s\">â€‹</span></span><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.15em;\"><span></span></span></span></span></span></span><span class=\"mclose\">)</span><span class=\"mspace\" style=\"margin-right:0.2777777777777778em;\"></span><span class=\"mrel\">=</span><span class=\"mspace\" style=\"margin-right:0.2777777777777778em;\"></span></span><span class=\"base\"><span class=\"strut\" style=\"height:1em;vertical-align:-0.25em;\"></span><span class=\"mopen\">(</span><span class=\"mord\"><span class=\"mord mathnormal\">a</span><span class=\"msupsub\"><span class=\"vlist-t vlist-t2\"><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.30110799999999993em;\"><span style=\"top:-2.5500000000000003em;margin-left:0em;margin-right:0.05em;\"><span class=\"pstrut\" style=\"height:2.7em;\"></span><span class=\"sizing reset-size6 size3 mtight\"><span class=\"mord mtight\">1</span></span></span></span><span class=\"vlist-s\">â€‹</span></span><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.15em;\"><span></span></span></span></span></span></span><span class=\"mspace\" style=\"margin-right:0.2222222222222222em;\"></span><span class=\"mbin\">âˆ—</span><span class=\"mspace\" style=\"margin-right:0.2222222222222222em;\"></span></span><span class=\"base\"><span class=\"strut\" style=\"height:0.73333em;vertical-align:-0.15em;\"></span><span class=\"mord\"><span class=\"mord mathnormal\" style=\"margin-right:0.03588em;\">v</span><span class=\"msupsub\"><span class=\"vlist-t vlist-t2\"><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.30110799999999993em;\"><span style=\"top:-2.5500000000000003em;margin-left:-0.03588em;margin-right:0.05em;\"><span class=\"pstrut\" style=\"height:2.7em;\"></span><span class=\"sizing reset-size6 size3 mtight\"><span class=\"mord mtight\">1</span></span></span></span><span class=\"vlist-s\">â€‹</span></span><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.15em;\"><span></span></span></span></span></span></span><span class=\"mspace\" style=\"margin-right:0.2222222222222222em;\"></span><span class=\"mbin\">+</span><span class=\"mspace\" style=\"margin-right:0.2222222222222222em;\"></span></span><span class=\"base\"><span class=\"strut\" style=\"height:0.61528em;vertical-align:-0.15em;\"></span><span class=\"mord\"><span class=\"mord mathnormal\">a</span><span class=\"msupsub\"><span class=\"vlist-t vlist-t2\"><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.30110799999999993em;\"><span style=\"top:-2.5500000000000003em;margin-left:0em;margin-right:0.05em;\"><span class=\"pstrut\" style=\"height:2.7em;\"></span><span class=\"sizing reset-size6 size3 mtight\"><span class=\"mord mtight\">2</span></span></span></span><span class=\"vlist-s\">â€‹</span></span><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.15em;\"><span></span></span></span></span></span></span><span class=\"mspace\" style=\"margin-right:0.2222222222222222em;\"></span><span class=\"mbin\">âˆ—</span><span class=\"mspace\" style=\"margin-right:0.2222222222222222em;\"></span></span><span class=\"base\"><span class=\"strut\" style=\"height:0.73333em;vertical-align:-0.15em;\"></span><span class=\"mord\"><span class=\"mord mathnormal\" style=\"margin-right:0.03588em;\">v</span><span class=\"msupsub\"><span class=\"vlist-t vlist-t2\"><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.30110799999999993em;\"><span style=\"top:-2.5500000000000003em;margin-left:-0.03588em;margin-right:0.05em;\"><span class=\"pstrut\" style=\"height:2.7em;\"></span><span class=\"sizing reset-size6 size3 mtight\"><span class=\"mord mtight\">2</span></span></span></span><span class=\"vlist-s\">â€‹</span></span><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.15em;\"><span></span></span></span></span></span></span><span class=\"mspace\" style=\"margin-right:0.2222222222222222em;\"></span><span class=\"mbin\">+</span><span class=\"mspace\" style=\"margin-right:0.2222222222222222em;\"></span></span><span class=\"base\"><span class=\"strut\" style=\"height:0.66666em;vertical-align:-0.08333em;\"></span><span class=\"minner\">â‹¯</span><span class=\"mspace\" style=\"margin-right:0.2222222222222222em;\"></span><span class=\"mbin\">+</span><span class=\"mspace\" style=\"margin-right:0.2222222222222222em;\"></span></span><span class=\"base\"><span class=\"strut\" style=\"height:0.61528em;vertical-align:-0.15em;\"></span><span class=\"mord\"><span class=\"mord mathnormal\">a</span><span class=\"msupsub\"><span class=\"vlist-t vlist-t2\"><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.151392em;\"><span style=\"top:-2.5500000000000003em;margin-left:0em;margin-right:0.05em;\"><span class=\"pstrut\" style=\"height:2.7em;\"></span><span class=\"sizing reset-size6 size3 mtight\"><span class=\"mord mathnormal mtight\">n</span></span></span></span><span class=\"vlist-s\">â€‹</span></span><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.15em;\"><span></span></span></span></span></span></span><span class=\"mspace\" style=\"margin-right:0.2222222222222222em;\"></span><span class=\"mbin\">âˆ—</span><span class=\"mspace\" style=\"margin-right:0.2222222222222222em;\"></span></span><span class=\"base\"><span class=\"strut\" style=\"height:1em;vertical-align:-0.25em;\"></span><span class=\"mord\"><span class=\"mord mathnormal\" style=\"margin-right:0.03588em;\">v</span><span class=\"msupsub\"><span class=\"vlist-t vlist-t2\"><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.151392em;\"><span style=\"top:-2.5500000000000003em;margin-left:-0.03588em;margin-right:0.05em;\"><span class=\"pstrut\" style=\"height:2.7em;\"></span><span class=\"sizing reset-size6 size3 mtight\"><span class=\"mord mathnormal mtight\">n</span></span></span></span><span class=\"vlist-s\">â€‹</span></span><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.15em;\"><span></span></span></span></span></span></span><span class=\"mclose\">)</span></span></span></span> = V'</p>\n<p>è¿™æ ·çš„è¯ï¼Œå°±å¾—åˆ°äº†ä¸€ä¸ªæ–°çš„ V'ï¼Œè¿™ä¸ªæ–°çš„ V' å°±åŒ…å«äº†ï¼Œå“ªäº›æ›´é‡è¦ï¼Œå“ªäº›ä¸é‡è¦çš„ä¿¡æ¯åœ¨é‡Œé¢ï¼Œç„¶åç”¨ V' ä»£æ›¿ V</p>\n<p>ä¸€èˆ¬ K=Vï¼Œåœ¨ Transformer é‡Œï¼ŒK!=V å¯ä¸å¯ä»¥ï¼Œå¯ä»¥çš„ï¼Œä½†æ˜¯ K å’Œ V ä¹‹é—´ä¸€å®šå…·æœ‰æŸç§è”ç³»ï¼Œè¿™æ ·çš„ QK ç‚¹ä¹˜æ‰èƒ½æŒ‡å¯¼ V å“ªäº›é‡è¦ï¼Œå“ªäº›ä¸é‡è¦</p>\n<p>51ï¼Œ 49---ã€‹ 0.51ï¼Œ0.49</p>\n<p>80/8ï¼Œ20/8 --ã€‹ 0.9999999999ï¼Œ 0.0000000001</p>\n<h3 id=\"10-3-09-01\"><a class=\"anchor\" href=\"#10-3-09-01\">#</a> 10 / 3 --&gt; 0.9, 0.1</h3>\n<p>a1 å’Œ a2 ä¹‹é—´çš„å·®é¢è¶Šå¤§ï¼Œè¿™ä¸ªæ¦‚ç‡å°±è¶Šç¦»è°±</p>\n<h1 id=\"self-attentionè‡ªæ³¨æ„åŠ›æœºåˆ¶\"><a class=\"anchor\" href=\"#self-attentionè‡ªæ³¨æ„åŠ›æœºåˆ¶\">#</a> Self-Attentionï¼ˆè‡ªæ³¨æ„åŠ›æœºåˆ¶ï¼‰</h1>\n<h2 id=\"æ³¨æ„åŠ›æœºåˆ¶\"><a class=\"anchor\" href=\"#æ³¨æ„åŠ›æœºåˆ¶\">#</a> æ³¨æ„åŠ›æœºåˆ¶</h2>\n<p>çœ‹ä¸€ä¸ªç‰©ä½“çš„æ—¶å€™ï¼Œæˆ‘ä»¬å€¾å‘äºä¸€äº›é‡ç‚¹ï¼ŒæŠŠæˆ‘ä»¬çš„ç„¦ç‚¹æ”¾åˆ°æ›´é‡è¦çš„ä¿¡æ¯ä¸Š</p>\n<p>&lt;img src=&quot;<span class=\"exturl\" data-url=\"aHR0cHM6Ly9pbWdtZC5vc3MtY24tc2hhbmdoYWkuYWxpeXVuY3MuY29tL0JFUlRfSU1HLyVFNCVCQSVCQSVFNyVCMSVCQiVFNyU5QSU4NCVFOCVBNyU4NiVFOCVBNyU4OSVFNiVCMyVBOCVFNiU4NCU4RiVFNSU4QSU5Qi5qcGc=\">https://imgmd.oss-cn-shanghai.aliyuncs.com/BERT_IMG/ äººç±»çš„è§†è§‰æ³¨æ„åŠ›.jpg</span>&quot; alt=&quot;img&quot; style=&quot;zoom:50%;&quot; /&gt;</p>\n<p>ç¬¬ä¸€çœ¼çœ‹åˆ°è¿™ä¸ªå›¾ï¼Œä¸ä¼šè¯´æŠŠæ‰€æœ‰çš„ä¿¡æ¯å…¨éƒ¨çœ‹å®Œ</p>\n<p>&lt;img src=&quot;<span class=\"exturl\" data-url=\"aHR0cHM6Ly9pbWdtZC5vc3MtY24tc2hhbmdoYWkuYWxpeXVuY3MuY29tL0JFUlRfSU1HL3NlbGYtYXR0ZW50aW9uLmpwZw==\">https://imgmd.oss-cn-shanghai.aliyuncs.com/BERT_IMG/self-attention.jpg</span>&quot; alt=&quot;img&quot; style=&quot;zoom:50%;&quot; /&gt;</p>\n<p>QK ç›¸ä¹˜æ±‚ç›¸ä¼¼åº¦ï¼Œåšä¸€ä¸ª scaleï¼ˆæœªæ¥åš softmax çš„æ—¶å€™é¿å…å‡ºç°æç«¯æƒ…å†µï¼‰</p>\n<p>ç„¶ååš Softmax å¾—åˆ°æ¦‚ç‡</p>\n<p>æ–°çš„å‘é‡è¡¨ç¤ºäº† K å’Œ Vï¼ˆK==Vï¼‰ï¼Œç„¶åè¿™ç§è¡¨ç¤ºè¿˜æš—å«äº† Q çš„ä¿¡æ¯ï¼ˆäº Q è€Œè¨€ï¼ŒK é‡Œé¢é‡è¦çš„ä¿¡æ¯ï¼‰ï¼Œä¹Ÿå°±æ˜¯è¯´ï¼ŒæŒ‘å‡ºäº† K é‡Œé¢çš„å…³é”®ç‚¹</p>\n<h2 id=\"è‡ª-æ³¨æ„åŠ›æœºåˆ¶self-attentionå‘é‡\"><a class=\"anchor\" href=\"#è‡ª-æ³¨æ„åŠ›æœºåˆ¶self-attentionå‘é‡\">#</a> è‡ª - æ³¨æ„åŠ›æœºåˆ¶ï¼ˆSelf-Attentionï¼‰ï¼ˆå‘é‡ï¼‰</h2>\n<p>Self-Attention çš„å…³é”®ç‚¹å†äºï¼Œä¸ä»…ä»…æ˜¯ K<span class=\"katex\"><span class=\"katex-mathml\"><math xmlns=\"http://www.w3.org/1998/Math/MathML\"><semantics><mrow><mo>â‰ˆ</mo></mrow><annotation encoding=\"application/x-tex\">\\approx</annotation></semantics></math></span><span class=\"katex-html\" aria-hidden=\"true\"><span class=\"base\"><span class=\"strut\" style=\"height:0.48312em;vertical-align:0em;\"></span><span class=\"mrel\">â‰ˆ</span></span></span></span>V<span class=\"katex\"><span class=\"katex-mathml\"><math xmlns=\"http://www.w3.org/1998/Math/MathML\"><semantics><mrow><mo>â‰ˆ</mo></mrow><annotation encoding=\"application/x-tex\">\\approx</annotation></semantics></math></span><span class=\"katex-html\" aria-hidden=\"true\"><span class=\"base\"><span class=\"strut\" style=\"height:0.48312em;vertical-align:0em;\"></span><span class=\"mrel\">â‰ˆ</span></span></span></span>Q æ¥æºäºåŒä¸€ä¸ª Xï¼Œè¿™ä¸‰è€…æ˜¯åŒæºçš„</p>\n<p>é€šè¿‡ X æ‰¾åˆ° X é‡Œé¢çš„å…³é”®ç‚¹</p>\n<p>å¹¶ä¸æ˜¯ K=V=Q=Xï¼Œè€Œæ˜¯é€šè¿‡ä¸‰ä¸ªå‚æ•° <span class=\"katex\"><span class=\"katex-mathml\"><math xmlns=\"http://www.w3.org/1998/Math/MathML\"><semantics><mrow><msub><mi>W</mi><mi>Q</mi></msub><mo separator=\"true\">,</mo><msub><mi>W</mi><mi>K</mi></msub><mo separator=\"true\">,</mo><msub><mi>W</mi><mi>V</mi></msub></mrow><annotation encoding=\"application/x-tex\">W_Q,W_K,W_V</annotation></semantics></math></span><span class=\"katex-html\" aria-hidden=\"true\"><span class=\"base\"><span class=\"strut\" style=\"height:0.969438em;vertical-align:-0.286108em;\"></span><span class=\"mord\"><span class=\"mord mathnormal\" style=\"margin-right:0.13889em;\">W</span><span class=\"msupsub\"><span class=\"vlist-t vlist-t2\"><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.328331em;\"><span style=\"top:-2.5500000000000003em;margin-left:-0.13889em;margin-right:0.05em;\"><span class=\"pstrut\" style=\"height:2.7em;\"></span><span class=\"sizing reset-size6 size3 mtight\"><span class=\"mord mathnormal mtight\">Q</span></span></span></span><span class=\"vlist-s\">â€‹</span></span><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.286108em;\"><span></span></span></span></span></span></span><span class=\"mpunct\">,</span><span class=\"mspace\" style=\"margin-right:0.16666666666666666em;\"></span><span class=\"mord\"><span class=\"mord mathnormal\" style=\"margin-right:0.13889em;\">W</span><span class=\"msupsub\"><span class=\"vlist-t vlist-t2\"><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.32833099999999993em;\"><span style=\"top:-2.5500000000000003em;margin-left:-0.13889em;margin-right:0.05em;\"><span class=\"pstrut\" style=\"height:2.7em;\"></span><span class=\"sizing reset-size6 size3 mtight\"><span class=\"mord mathnormal mtight\" style=\"margin-right:0.07153em;\">K</span></span></span></span><span class=\"vlist-s\">â€‹</span></span><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.15em;\"><span></span></span></span></span></span></span><span class=\"mpunct\">,</span><span class=\"mspace\" style=\"margin-right:0.16666666666666666em;\"></span><span class=\"mord\"><span class=\"mord mathnormal\" style=\"margin-right:0.13889em;\">W</span><span class=\"msupsub\"><span class=\"vlist-t vlist-t2\"><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.32833099999999993em;\"><span style=\"top:-2.5500000000000003em;margin-left:-0.13889em;margin-right:0.05em;\"><span class=\"pstrut\" style=\"height:2.7em;\"></span><span class=\"sizing reset-size6 size3 mtight\"><span class=\"mord mathnormal mtight\" style=\"margin-right:0.22222em;\">V</span></span></span></span><span class=\"vlist-s\">â€‹</span></span><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.15em;\"><span></span></span></span></span></span></span></span></span></span></p>\n<p>æ¥ä¸‹æ¥çš„æ­¥éª¤å’Œæ³¨æ„åŠ›æœºåˆ¶ä¸€æ¨¡ä¸€æ ·</p>\n<ol>\n<li>\n<p>Qã€Kã€V çš„è·å–</p>\n<ol>\n<li>&lt;img src=&quot;<span class=\"exturl\" data-url=\"aHR0cHM6Ly9pbWdtZC5vc3MtY24tc2hhbmdoYWkuYWxpeXVuY3MuY29tL0JFUlRfSU1HL3Frdi5qcGc=\">https://imgmd.oss-cn-shanghai.aliyuncs.com/BERT_IMG/qkv.jpg</span>&quot; alt=&quot;img&quot; style=&quot;zoom:50%;&quot; /&gt;</li>\n</ol>\n</li>\n<li>\n<p>Matmulï¼š</p>\n<ol>\n<li>&lt;img src=&quot;<span class=\"exturl\" data-url=\"aHR0cHM6Ly9pbWdtZC5vc3MtY24tc2hhbmdoYWkuYWxpeXVuY3MuY29tL0JFUlRfSU1HL1EtSyVFNCVCOSU5OCVFNyVBNyVBRi5qcGc=\">https://imgmd.oss-cn-shanghai.aliyuncs.com/BERT_IMG/Q-K ä¹˜ç§¯.jpg</span>&quot; alt=&quot;img&quot; style=&quot;zoom:50%;&quot; /&gt;</li>\n</ol>\n</li>\n<li>\n<p>Scale+Softmaxï¼š</p>\n<ol>\n<li>&lt;img src=&quot;<span class=\"exturl\" data-url=\"aHR0cHM6Ly9pbWdtZC5vc3MtY24tc2hhbmdoYWkuYWxpeXVuY3MuY29tL0JFUlRfSU1HL3FrLXNjYWxlLmpwZw==\">https://imgmd.oss-cn-shanghai.aliyuncs.com/BERT_IMG/qk-scale.jpg</span>&quot; alt=&quot;img&quot; style=&quot;zoom:50%;&quot; /&gt;</li>\n</ol>\n</li>\n<li>\n<h3 id=\"matmul\"><a class=\"anchor\" href=\"#matmul\">#</a> Matmulï¼š</h3>\n<ol>\n<li>&lt;img src=&quot;<span class=\"exturl\" data-url=\"aHR0cHM6Ly9pbWdtZC5vc3MtY24tc2hhbmdoYWkuYWxpeXVuY3MuY29tL0JFUlRfSU1HL3FrLXNvZnRtYXguanBn\">https://imgmd.oss-cn-shanghai.aliyuncs.com/BERT_IMG/qk-softmax.jpg</span>&quot; alt=&quot;img&quot; style=&quot;zoom:50%;&quot; /&gt;</li>\n</ol>\n</li>\n</ol>\n<p><span class=\"katex\"><span class=\"katex-mathml\"><math xmlns=\"http://www.w3.org/1998/Math/MathML\"><semantics><mrow><msub><mi>z</mi><mn>1</mn></msub></mrow><annotation encoding=\"application/x-tex\">z_1</annotation></semantics></math></span><span class=\"katex-html\" aria-hidden=\"true\"><span class=\"base\"><span class=\"strut\" style=\"height:0.58056em;vertical-align:-0.15em;\"></span><span class=\"mord\"><span class=\"mord mathnormal\" style=\"margin-right:0.04398em;\">z</span><span class=\"msupsub\"><span class=\"vlist-t vlist-t2\"><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.30110799999999993em;\"><span style=\"top:-2.5500000000000003em;margin-left:-0.04398em;margin-right:0.05em;\"><span class=\"pstrut\" style=\"height:2.7em;\"></span><span class=\"sizing reset-size6 size3 mtight\"><span class=\"mord mtight\">1</span></span></span></span><span class=\"vlist-s\">â€‹</span></span><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.15em;\"><span></span></span></span></span></span></span></span></span></span> è¡¨ç¤ºçš„å°±æ˜¯ thinking çš„æ–°çš„å‘é‡è¡¨ç¤º</p>\n<p>å¯¹äº thinkingï¼Œåˆå§‹è¯å‘é‡ä¸º<span class=\"katex\"><span class=\"katex-mathml\"><math xmlns=\"http://www.w3.org/1998/Math/MathML\"><semantics><mrow><msub><mi>x</mi><mn>1</mn></msub></mrow><annotation encoding=\"application/x-tex\">x_1</annotation></semantics></math></span><span class=\"katex-html\" aria-hidden=\"true\"><span class=\"base\"><span class=\"strut\" style=\"height:0.58056em;vertical-align:-0.15em;\"></span><span class=\"mord\"><span class=\"mord mathnormal\">x</span><span class=\"msupsub\"><span class=\"vlist-t vlist-t2\"><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.30110799999999993em;\"><span style=\"top:-2.5500000000000003em;margin-left:0em;margin-right:0.05em;\"><span class=\"pstrut\" style=\"height:2.7em;\"></span><span class=\"sizing reset-size6 size3 mtight\"><span class=\"mord mtight\">1</span></span></span></span><span class=\"vlist-s\">â€‹</span></span><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.15em;\"><span></span></span></span></span></span></span></span></span></span></p>\n<p>ç°åœ¨æˆ‘é€šè¿‡ thinking  machines è¿™å¥è¯å»æŸ¥è¯¢è¿™å¥è¯é‡Œçš„æ¯ä¸€ä¸ªå•è¯å’Œ thinking ä¹‹é—´çš„ç›¸ä¼¼åº¦</p>\n<p>æ–°çš„<span class=\"katex\"><span class=\"katex-mathml\"><math xmlns=\"http://www.w3.org/1998/Math/MathML\"><semantics><mrow><msub><mi>z</mi><mn>1</mn></msub></mrow><annotation encoding=\"application/x-tex\">z_1</annotation></semantics></math></span><span class=\"katex-html\" aria-hidden=\"true\"><span class=\"base\"><span class=\"strut\" style=\"height:0.58056em;vertical-align:-0.15em;\"></span><span class=\"mord\"><span class=\"mord mathnormal\" style=\"margin-right:0.04398em;\">z</span><span class=\"msupsub\"><span class=\"vlist-t vlist-t2\"><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.30110799999999993em;\"><span style=\"top:-2.5500000000000003em;margin-left:-0.04398em;margin-right:0.05em;\"><span class=\"pstrut\" style=\"height:2.7em;\"></span><span class=\"sizing reset-size6 size3 mtight\"><span class=\"mord mtight\">1</span></span></span></span><span class=\"vlist-s\">â€‹</span></span><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.15em;\"><span></span></span></span></span></span></span></span></span></span> ä¾ç„¶æ˜¯ thinking çš„è¯å‘é‡è¡¨ç¤ºï¼Œåªä¸è¿‡è¿™ä¸ªè¯å‘é‡çš„è¡¨ç¤ºè•´å«äº† thinking machines è¿™å¥è¯å¯¹äº thinking è€Œè¨€å“ªä¸ªæ›´é‡è¦çš„ä¿¡æ¯</p>\n<p>&lt;img src=&quot;<span class=\"exturl\" data-url=\"aHR0cHM6Ly9pbWdtZC5vc3MtY24tc2hhbmdoYWkuYWxpeXVuY3MuY29tL0JFUlRfSU1HL3NlbGYtYXR0ZW50aW9uLSVFNSVBNSVCRCVFNSVBNCU4NDIuanBn\">https://imgmd.oss-cn-shanghai.aliyuncs.com/BERT_IMG/self-attention - å¥½å¤„ 2.jpg</span>&quot; alt=&quot;img&quot; style=&quot;zoom:67%;&quot; /&gt;</p>\n<p>ä¸åšæ³¨æ„åŠ›ï¼Œits çš„è¯å‘é‡å°±æ˜¯å•çº¯çš„ itsï¼Œæ²¡æœ‰ä»»ä½•é™„åŠ ä¿¡æ¯</p>\n<blockquote>\n<p>ä¹Ÿå°±æ˜¯è¯´ its æœ‰ law è¿™å±‚æ„æ€ï¼Œè€Œé€šè¿‡è‡ªæ³¨æ„åŠ›æœºåˆ¶å¾—åˆ°æ–°çš„ its çš„è¯å‘é‡ï¼Œåˆ™ä¼šåŒ…å«ä¸€å®šçš„ laws å’Œ application çš„ä¿¡æ¯</p>\n</blockquote>\n<h2 id=\"è‡ªæ³¨æ„åŠ›æœºåˆ¶çŸ©é˜µ\"><a class=\"anchor\" href=\"#è‡ªæ³¨æ„åŠ›æœºåˆ¶çŸ©é˜µ\">#</a> è‡ªæ³¨æ„åŠ›æœºåˆ¶ï¼ˆçŸ©é˜µï¼‰</h2>\n<p>&lt;img src=&quot;<span class=\"exturl\" data-url=\"aHR0cHM6Ly9pbWdtZC5vc3MtY24tc2hhbmdoYWkuYWxpeXVuY3MuY29tL0JFUlRfSU1HL1FLVi0lRTclOUYlQTklRTklOTglQjUlRTglQTElQTglRTclQTQlQkEuanBn\">https://imgmd.oss-cn-shanghai.aliyuncs.com/BERT_IMG/QKV - çŸ©é˜µè¡¨ç¤º.jpg</span>&quot; alt=&quot;img&quot; style=&quot;zoom:50%;&quot; /&gt;</p>\n<p>&lt;img src=&quot;<span class=\"exturl\" data-url=\"aHR0cHM6Ly9pbWdtZC5vc3MtY24tc2hhbmdoYWkuYWxpeXVuY3MuY29tL0JFUlRfSU1HL1FLVlotJUU3JUJCJTkzJUU2JTlFJTlDLmpwZw==\">https://imgmd.oss-cn-shanghai.aliyuncs.com/BERT_IMG/QKVZ - ç»“æœ.jpg</span>&quot; alt=&quot;img&quot; style=&quot;zoom:50%;&quot; /&gt;</p>\n<p>&lt;img src=&quot;<span class=\"exturl\" data-url=\"aHR0cHM6Ly9pbWdtZC5vc3MtY24tc2hhbmdoYWkuYWxpeXVuY3MuY29tL0JFUlRfSU1HLyVFNiVCMyVBOCVFNiU4NCU4RiVFNSU4QSU5QiVFNiU5QyVCQSVFNSU4OCVCNiVFNyU5RiVBOSVFOSU5OCVCNSVFNSU5QiVCRS5qcGc=\">https://imgmd.oss-cn-shanghai.aliyuncs.com/BERT_IMG/ æ³¨æ„åŠ›æœºåˆ¶çŸ©é˜µå›¾.jpg</span>&quot; alt=&quot;img&quot; style=&quot;zoom:50%;&quot; /&gt;</p>\n<h1 id=\"self-attentionç›¸æ¯”è¾ƒ-rnnå’Œlstmçš„ä¼˜ç¼ºç‚¹\"><a class=\"anchor\" href=\"#self-attentionç›¸æ¯”è¾ƒ-rnnå’Œlstmçš„ä¼˜ç¼ºç‚¹\">#</a> Self-Attention ç›¸æ¯”è¾ƒ RNN å’Œ LSTM çš„ä¼˜ç¼ºç‚¹</h1>\n<h2 id=\"rnn\"><a class=\"anchor\" href=\"#rnn\">#</a> RNN</h2>\n<p><img data-src=\"https://imgmd.oss-cn-shanghai.aliyuncs.com/BERT_IMG/RNN-unrolled.png\" alt=\"img\" /></p>\n<p>æ— æ³•åšé•¿åºåˆ—ï¼Œå½“ä¸€æ®µè¯è¾¾åˆ° 50 ä¸ªå­—ï¼Œæ•ˆæœå¾ˆå·®äº†</p>\n<h2 id=\"lstm\"><a class=\"anchor\" href=\"#lstm\">#</a> LSTM</h2>\n<p><img data-src=\"https://imgmd.oss-cn-shanghai.aliyuncs.com/BERT_IMG/LSTM%E6%A8%A1%E5%9E%8B%E7%BB%93%E6%9E%84.jpg\" alt=\"img\" /></p>\n<p>LSTM é€šè¿‡å„ç§é—¨ï¼Œé—å¿˜é—¨ï¼Œé€‰æ‹©æ€§çš„å¯ä»¥è®°å¿†ä¹‹å‰çš„ä¿¡æ¯ï¼ˆ200 è¯ï¼‰</p>\n<h2 id=\"self-attention-å’Œ-rnns-çš„åŒºåˆ«\"><a class=\"anchor\" href=\"#self-attention-å’Œ-rnns-çš„åŒºåˆ«\">#</a> Self-Attention å’Œ RNNs çš„åŒºåˆ«</h2>\n<p>RNNs é•¿åºåˆ—ä¾èµ–é—®é¢˜ï¼Œæ— æ³•åšå¹¶è¡Œ</p>\n<p>Self-Attention å¾—åˆ°çš„æ–°çš„è¯å‘é‡å…·æœ‰å¥æ³•ç‰¹å¾å’Œè¯­ä¹‰ç‰¹å¾ï¼ˆè¯å‘é‡çš„è¡¨å¾æ›´å®Œå–„ï¼‰</p>\n<h3 id=\"å¥æ³•ç‰¹å¾\"><a class=\"anchor\" href=\"#å¥æ³•ç‰¹å¾\">#</a> å¥æ³•ç‰¹å¾</h3>\n<p>&lt;img src=&quot;<span class=\"exturl\" data-url=\"aHR0cHM6Ly9pbWdtZC5vc3MtY24tc2hhbmdoYWkuYWxpeXVuY3MuY29tL0JFUlRfSU1HL3NlbGYtYXR0ZW50aW9uLSVFNSVBNSVCRCVFNSVBNCU4NDEuanBn\">https://imgmd.oss-cn-shanghai.aliyuncs.com/BERT_IMG/self-attention - å¥½å¤„ 1.jpg</span>&quot; alt=&quot;img&quot; style=&quot;zoom:67%;&quot; /&gt;</p>\n<h3 id=\"è¯­ä¹‰ç‰¹å¾\"><a class=\"anchor\" href=\"#è¯­ä¹‰ç‰¹å¾\">#</a> è¯­ä¹‰ç‰¹å¾</h3>\n<p>&lt;img src=&quot;<span class=\"exturl\" data-url=\"aHR0cHM6Ly9pbWdtZC5vc3MtY24tc2hhbmdoYWkuYWxpeXVuY3MuY29tL0JFUlRfSU1HL3NlbGYtYXR0ZW50aW9uLSVFNSVBNSVCRCVFNSVBNCU4NDIuanBn\">https://imgmd.oss-cn-shanghai.aliyuncs.com/BERT_IMG/self-attention - å¥½å¤„ 2.jpg</span>&quot; alt=&quot;img&quot; style=&quot;zoom:50%;&quot; /&gt;</p>\n<h2 id=\"å¹¶è¡Œè®¡ç®—\"><a class=\"anchor\" href=\"#å¹¶è¡Œè®¡ç®—\">#</a> å¹¶è¡Œè®¡ç®—</h2>\n<p>&lt;img src=&quot;<span class=\"exturl\" data-url=\"aHR0cHM6Ly9pbWdtZC5vc3MtY24tc2hhbmdoYWkuYWxpeXVuY3MuY29tL0JFUlRfSU1HL3FrLXNvZnRtYXguanBn\">https://imgmd.oss-cn-shanghai.aliyuncs.com/BERT_IMG/qk-softmax.jpg</span>&quot; alt=&quot;img&quot; style=&quot;zoom:50%;&quot; /&gt;</p>\n<h1 id=\"masked-self-attentionæ©ç è‡ªæ³¨æ„åŠ›æœºåˆ¶\"><a class=\"anchor\" href=\"#masked-self-attentionæ©ç è‡ªæ³¨æ„åŠ›æœºåˆ¶\">#</a> Masked Self-Attentionï¼ˆæ©ç è‡ªæ³¨æ„åŠ›æœºåˆ¶ï¼‰</h1>\n<h2 id=\"maskedæ©ç -self-attention-åœ¨è‡ªæ³¨æ„åŠ›æ¨¡å‹ä¸Šé¢åšäº†æ”¹è¿›\"><a class=\"anchor\" href=\"#maskedæ©ç -self-attention-åœ¨è‡ªæ³¨æ„åŠ›æ¨¡å‹ä¸Šé¢åšäº†æ”¹è¿›\">#</a> Maskedï¼ˆæ©ç ï¼‰ Self-Attention--ã€‹åœ¨è‡ªæ³¨æ„åŠ›æ¨¡å‹ä¸Šé¢åšäº†æ”¹è¿›</h2>\n<p>ä¸ºä»€ä¹ˆè¦åšè¿™ä¸ªæ”¹è¿›ï¼šç”Ÿæˆæ¨¡å‹ï¼Œç”Ÿæˆå•è¯ï¼Œä¸€ä¸ªä¸€ä¸ªç”Ÿæˆçš„</p>\n<p>å½“æˆ‘ä»¬åšç”Ÿæˆä»»åŠ¡çš„æ—¶å€™ï¼Œæˆ‘ä»¬ä¹Ÿæƒ³å¯¹ç”Ÿæˆçš„è¿™ä¸ªå•è¯åšæ³¨æ„åŠ›è®¡ç®—ï¼Œä½†æ˜¯ï¼Œç”Ÿæˆçš„å¥å­æ˜¯ä¸€ä¸ªä¸€ä¸ªå•è¯ç”Ÿæˆçš„</p>\n<p>I have a dream</p>\n<ol>\n<li>\n<p>I  ç¬¬ä¸€æ¬¡æ³¨æ„åŠ›è®¡ç®—ï¼Œåªæœ‰ I</p>\n</li>\n<li>\n<p>I have ç¬¬äºŒæ¬¡ï¼Œåªæœ‰ I å’Œ have</p>\n</li>\n<li>\n<p>I have a</p>\n</li>\n<li>\n<p>I have a dream</p>\n</li>\n<li>\n<p>I have a dream &lt;eos&gt;</p>\n</li>\n</ol>\n<p>æ©ç è‡ªæ³¨æ„åŠ›æœºåˆ¶åº”è¿è€Œç”Ÿ</p>\n<p>æ©ç å 1</p>\n<p>&lt;img src=&quot;<span class=\"exturl\" data-url=\"aHR0cHM6Ly9pbWdtZC5vc3MtY24tc2hhbmdoYWkuYWxpeXVuY3MuY29tL0JFUlRfSU1HL21hc2stYXR0ZW50aW9uLW1hcC5qcGc=\">https://imgmd.oss-cn-shanghai.aliyuncs.com/BERT_IMG/mask-attention-map.jpg</span>&quot; alt=&quot;img&quot; style=&quot;zoom:50%;&quot; /&gt;</p>\n<p>æ©ç å 2</p>\n<p>&lt;img src=&quot;<span class=\"exturl\" data-url=\"aHR0cHM6Ly9pbWdtZC5vc3MtY24tc2hhbmdoYWkuYWxpeXVuY3MuY29tL0JFUlRfSU1HL21hc2stYXR0ZW50aW9uLW1hcC1zb2Z0bWF4LmpwZw==\">https://imgmd.oss-cn-shanghai.aliyuncs.com/BERT_IMG/mask-attention-map-softmax.jpg</span>&quot; alt=&quot;img&quot; style=&quot;zoom:50%;&quot; /&gt;</p>\n<p>æœªæ¥æˆ‘ä»¬è®² Transformer çš„æ—¶å€™ä¼šè¯¦ç»†è®²ï¼</p>\n<p>Multi-head Self-Attentionã€‚</p>\n<h1 id=\"multi-head-self-attentionä»ç©ºé—´è§’åº¦è§£é‡Šä¸ºä»€ä¹ˆåšå¤šå¤´\"><a class=\"anchor\" href=\"#multi-head-self-attentionä»ç©ºé—´è§’åº¦è§£é‡Šä¸ºä»€ä¹ˆåšå¤šå¤´\">#</a> Multi-Head Self-Attentionï¼ˆä»ç©ºé—´è§’åº¦è§£é‡Šä¸ºä»€ä¹ˆåšå¤šå¤´ï¼‰</h1>\n<h2 id=\"multi-head-self-attentionå¤šå¤´è‡ªæ³¨æ„åŠ›\"><a class=\"anchor\" href=\"#multi-head-self-attentionå¤šå¤´è‡ªæ³¨æ„åŠ›\">#</a> Multi-Head Self-Attentionï¼ˆå¤šå¤´è‡ªæ³¨æ„åŠ›ï¼‰</h2>\n<p>Z ç›¸æ¯”è¾ƒ X æœ‰äº†æå‡ï¼Œé€šè¿‡ Multi-Head Self-Attentionï¼Œå¾—åˆ°çš„ <span class=\"katex\"><span class=\"katex-mathml\"><math xmlns=\"http://www.w3.org/1998/Math/MathML\"><semantics><mrow><mi>Z</mi><msup><mrow></mrow><mo mathvariant=\"normal\" lspace=\"0em\" rspace=\"0em\">â€²</mo></msup></mrow><annotation encoding=\"application/x-tex\">Z{&#x27;}</annotation></semantics></math></span><span class=\"katex-html\" aria-hidden=\"true\"><span class=\"base\"><span class=\"strut\" style=\"height:0.751892em;vertical-align:0em;\"></span><span class=\"mord mathnormal\" style=\"margin-right:0.07153em;\">Z</span><span class=\"mord\"><span class=\"mord\"><span></span><span class=\"msupsub\"><span class=\"vlist-t\"><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.751892em;\"><span style=\"top:-3.063em;margin-right:0.05em;\"><span class=\"pstrut\" style=\"height:2.7em;\"></span><span class=\"sizing reset-size6 size3 mtight\"><span class=\"mord mtight\"><span class=\"mord mtight\">â€²</span></span></span></span></span></span></span></span></span></span></span></span></span> ç›¸æ¯”è¾ƒ Z åˆæœ‰äº†è¿›ä¸€æ­¥æå‡</p>\n<p>å¤šå¤´è‡ªæ³¨æ„åŠ›ï¼Œé—®é¢˜æ¥äº†ï¼Œå¤šå¤´æ˜¯ä»€ä¹ˆï¼Œå¤šå¤´çš„ä¸ªæ•°ç”¨ h è¡¨ç¤ºï¼Œä¸€èˆ¬<span class=\"katex\"><span class=\"katex-mathml\"><math xmlns=\"http://www.w3.org/1998/Math/MathML\"><semantics><mrow><mi>h</mi><mo>=</mo><mn>8</mn></mrow><annotation encoding=\"application/x-tex\">h=8</annotation></semantics></math></span><span class=\"katex-html\" aria-hidden=\"true\"><span class=\"base\"><span class=\"strut\" style=\"height:0.69444em;vertical-align:0em;\"></span><span class=\"mord mathnormal\">h</span><span class=\"mspace\" style=\"margin-right:0.2777777777777778em;\"></span><span class=\"mrel\">=</span><span class=\"mspace\" style=\"margin-right:0.2777777777777778em;\"></span></span><span class=\"base\"><span class=\"strut\" style=\"height:0.64444em;vertical-align:0em;\"></span><span class=\"mord\">8</span></span></span></span>ï¼Œæˆ‘ä»¬é€šå¸¸ä½¿ç”¨çš„æ˜¯ 8 å¤´è‡ªæ³¨æ„åŠ›</p>\n<p>ä»€ä¹ˆæ˜¯å¤šå¤´</p>\n<p>&lt;img src=&quot;<span class=\"exturl\" data-url=\"aHR0cHM6Ly9pbWdtZC5vc3MtY24tc2hhbmdoYWkuYWxpeXVuY3MuY29tL0JFUlRfSU1HL211bHRpLWhlYWQtYXR0ZW50aW9uLnBuZw==\">https://imgmd.oss-cn-shanghai.aliyuncs.com/BERT_IMG/multi-head-attention.png</span>&quot; alt=&quot;img&quot; style=&quot;zoom:50%;&quot; /&gt;</p>\n<p>å¦‚ä½•å¤šå¤´ 1</p>\n<p>&lt;img src=&quot;<span class=\"exturl\" data-url=\"aHR0cHM6Ly9pbWdtZC5vc3MtY24tc2hhbmdoYWkuYWxpeXVuY3MuY29tL0JFUlRfSU1HLzgtaGVhZC1hdHRlbnRpb24uanBn\">https://imgmd.oss-cn-shanghai.aliyuncs.com/BERT_IMG/8-head-attention.jpg</span>&quot; alt=&quot;img&quot; style=&quot;zoom:50%;&quot; /&gt;</p>\n<p>å¯¹äº Xï¼Œæˆ‘ä»¬ä¸æ˜¯è¯´ï¼Œç›´æ¥æ‹¿ X å»å¾—åˆ° Zï¼Œè€Œæ˜¯æŠŠ X åˆ†æˆäº† 8 å—ï¼ˆ8 å¤´ï¼‰ï¼Œå¾—åˆ° Z0-Z7</p>\n<p>å¦‚ä½•å¤šå¤´ 2</p>\n<p>ç„¶åæŠŠ Z0-Z7 æ‹¼æ¥èµ·æ¥ï¼Œå†åšä¸€æ¬¡çº¿æ€§å˜æ¢ï¼ˆæ”¹å˜ç»´åº¦ï¼‰å¾—åˆ° Z</p>\n<p><img data-src=\"https://imgmd.oss-cn-shanghai.aliyuncs.com/BERT_IMG/8-z-%E6%8B%BC%E6%8E%A5.jpg\" alt=\"img\" /></p>\n<p>æœ‰ä»€ä¹ˆä½œç”¨ï¼Ÿ</p>\n<p>æœºå™¨å­¦ä¹ çš„æœ¬è´¨æ˜¯ä»€ä¹ˆï¼šy=<span class=\"katex\"><span class=\"katex-mathml\"><math xmlns=\"http://www.w3.org/1998/Math/MathML\"><semantics><mrow><mi>Ïƒ</mi></mrow><annotation encoding=\"application/x-tex\">\\sigma</annotation></semantics></math></span><span class=\"katex-html\" aria-hidden=\"true\"><span class=\"base\"><span class=\"strut\" style=\"height:0.43056em;vertical-align:0em;\"></span><span class=\"mord mathnormal\" style=\"margin-right:0.03588em;\">Ïƒ</span></span></span></span> (wx+b)ï¼Œåœ¨åšä¸€ä»¶ä»€ä¹ˆäº‹æƒ…ï¼Œéçº¿æ€§å˜æ¢ï¼ˆæŠŠä¸€ä¸ªçœ‹èµ·æ¥ä¸åˆç†çš„ä¸œè¥¿ï¼Œé€šè¿‡æŸä¸ªæ‰‹æ®µï¼ˆè®­ç»ƒæ¨¡å‹ï¼‰ï¼Œè®©è¿™ä¸ªä¸œè¥¿å˜å¾—åˆç†ï¼‰</p>\n<p>éçº¿æ€§å˜æ¢çš„æœ¬è´¨åˆæ˜¯ä»€ä¹ˆï¼Ÿæ”¹å˜ç©ºé—´ä¸Šçš„ä½ç½®åæ ‡ï¼Œä»»ä½•ä¸€ä¸ªç‚¹éƒ½å¯ä»¥åœ¨ç»´åº¦ç©ºé—´ä¸Šæ‰¾åˆ°ï¼Œé€šè¿‡æŸä¸ªæ‰‹æ®µï¼Œè®©ä¸€ä¸ªä¸åˆç†çš„ç‚¹ï¼ˆä½ç½®ä¸åˆç†ï¼‰ï¼Œå˜å¾—åˆç†</p>\n<p>è¿™å°±æ˜¯è¯å‘é‡çš„æœ¬è´¨</p>\n<p>one-hot ç¼–ç ï¼ˆ0101010ï¼‰</p>\n<p>word2vecï¼ˆ11ï¼Œ222ï¼Œ33ï¼‰</p>\n<p>emloï¼ˆ15ï¼Œ3ï¼Œ2ï¼‰</p>\n<p>attentionï¼ˆ124ï¼Œ2ï¼Œ32ï¼‰</p>\n<p>multi-head attentionï¼ˆ1231ï¼Œ23ï¼Œ3ï¼‰ï¼ŒæŠŠ X åˆ‡åˆ†æˆ 8 å—ï¼ˆ8 ä¸ªå­ç©ºé—´ï¼‰ï¼Œè¿™æ ·ä¸€ä¸ªåŸå…ˆåœ¨ä¸€ä¸ªä½ç½®ä¸Šçš„ Xï¼Œå»äº†ç©ºé—´ä¸Š 8 ä¸ªä½ç½®ï¼Œé€šè¿‡å¯¹ 8 ä¸ªç‚¹è¿›è¡Œå¯»æ‰¾ï¼Œæ‰¾åˆ°æ›´åˆé€‚çš„ä½ç½®</p>\n<p>è¯å‘é‡çš„å¤§å°æ˜¯ 512</p>\n<p>å‡è®¾ä½ çš„ä»»åŠ¡ï¼Œè§†é¢‘å‘é‡æ˜¯ 5120ï¼Œ80</p>\n<p>å¯¹è®¡ç®—æœºçš„æ€§èƒ½æå‡ºäº†è¦æ±‚</p>\n<h2 id=\"å¤šå¤´æµç¨‹å›¾\"><a class=\"anchor\" href=\"#å¤šå¤´æµç¨‹å›¾\">#</a> å¤šå¤´æµç¨‹å›¾</h2>\n<p>&lt;img src=&quot;<span class=\"exturl\" data-url=\"aHR0cHM6Ly9pbWdtZC5vc3MtY24tc2hhbmdoYWkuYWxpeXVuY3MuY29tL0JFUlRfSU1HL211bHRpLWhlYWQtJUU2JThCJUJDJUU2JThFJUE1LmpwZw==\">https://imgmd.oss-cn-shanghai.aliyuncs.com/BERT_IMG/multi-head - æ‹¼æ¥.jpg</span>&quot; alt=&quot;img&quot; style=&quot;zoom:50%;&quot; /&gt;</p>\n<h1 id=\"positional-encoding-ä¸ºä»€ä¹ˆ-self-attention-éœ€è¦ä½ç½®ç¼–ç \"><a class=\"anchor\" href=\"#positional-encoding-ä¸ºä»€ä¹ˆ-self-attention-éœ€è¦ä½ç½®ç¼–ç \">#</a> Positional Encoding ï¼ˆä¸ºä»€ä¹ˆ Self-Attention éœ€è¦ä½ç½®ç¼–ç ï¼‰</h1>\n<h2 id=\"attention\"><a class=\"anchor\" href=\"#attention\">#</a> Attention</h2>\n<p>ä¼˜ç‚¹ï¼š</p>\n<ol>\n<li>è§£å†³äº†é•¿åºåˆ—ä¾èµ–é—®é¢˜</li>\n<li>å¯ä»¥å¹¶è¡Œ</li>\n</ol>\n<p>ç¼ºç‚¹ï¼š</p>\n<ol>\n<li>\n<p>å¼€é”€å˜å¤§äº†</p>\n</li>\n<li>\n<p>æ—¢ç„¶å¯ä»¥å¹¶è¡Œï¼Œä¹Ÿå°±æ˜¯è¯´ï¼Œè¯ä¸è¯ä¹‹é—´ä¸å­˜åœ¨é¡ºåºå…³ç³»ï¼ˆæ‰“ä¹±ä¸€å¥è¯ï¼Œè¿™å¥è¯é‡Œçš„æ¯ä¸ªè¯çš„è¯å‘é‡ä¾ç„¶ä¸ä¼šå˜ï¼‰ï¼Œå³æ— ä½ç½®å…³ç³»ï¼ˆæ—¢ç„¶æ²¡æœ‰ï¼Œæˆ‘å°±åŠ ä¸€ä¸ªï¼Œé€šè¿‡ä½ç½®ç¼–ç çš„å½¢å¼åŠ ï¼‰</p>\n</li>\n</ol>\n<p>ä½ç½®ç¼–ç çš„é—®é¢˜</p>\n<h2 id=\"ä¸ºä»€ä¹ˆéœ€è¦ä½ç½®ç¼–ç \"><a class=\"anchor\" href=\"#ä¸ºä»€ä¹ˆéœ€è¦ä½ç½®ç¼–ç \">#</a> ä¸ºä»€ä¹ˆéœ€è¦ä½ç½®ç¼–ç </h2>\n<h2 id=\"ä½ç½®ç¼–ç æ€ä¹ˆåšçš„\"><a class=\"anchor\" href=\"#ä½ç½®ç¼–ç æ€ä¹ˆåšçš„\">#</a> ä½ç½®ç¼–ç æ€ä¹ˆåšçš„</h2>\n<p>&lt;img src=&quot;<span class=\"exturl\" data-url=\"aHR0cHM6Ly9pbWdtZC5vc3MtY24tc2hhbmdoYWkuYWxpeXVuY3MuY29tL0JFUlRfSU1HLyVFNCVCRCU4RCVFNyVCRCVBRSVFNSU5MCU5MSVFOSU4NyU4Ri5qcGc=\">https://imgmd.oss-cn-shanghai.aliyuncs.com/BERT_IMG/ ä½ç½®å‘é‡.jpg</span>&quot; alt=&quot;img&quot; style=&quot;zoom:50%;&quot; /&gt;</p>\n<h2 id=\"å…·ä½“åšæ³•\"><a class=\"anchor\" href=\"#å…·ä½“åšæ³•\">#</a> å…·ä½“åšæ³•</h2>\n<ul>\n<li>åšæ³• 1</li>\n</ul>\n<p>&lt;img src=&quot;<span class=\"exturl\" data-url=\"aHR0cHM6Ly9pbWdtZC5vc3MtY24tc2hhbmdoYWkuYWxpeXVuY3MuY29tL0JFUlRfSU1HLyVFNCVCRCU4RCVFNyVCRCVBRSVFNyVCQyU5NiVFNyVBMCU4MSVFNSU4NSVBQyVFNSVCQyU4Ri5wbmc=\">https://imgmd.oss-cn-shanghai.aliyuncs.com/BERT_IMG/ ä½ç½®ç¼–ç å…¬å¼.png</span>&quot; alt=&quot;img&quot; style=&quot;zoom:50%;&quot; /&gt;</p>\n<ul>\n<li>åšæ³• 2</li>\n</ul>\n<p>&lt;img src=&quot;<span class=\"exturl\" data-url=\"aHR0cHM6Ly9pbWdtZC5vc3MtY24tc2hhbmdoYWkuYWxpeXVuY3MuY29tL0JFUlRfSU1HLyVFNCVCRCU4RCVFNyVCRCVBRSVFNyVCQyU5NiVFNyVBMCU4MSVFNSU5MiU4QyVFOCVBRiU4RCVFNSU5MCU5MSVFOSU4NyU4RiVFNCVCOSU4QiVFNSU5MiU4Qy5wbmc=\">https://imgmd.oss-cn-shanghai.aliyuncs.com/BERT_IMG/ ä½ç½®ç¼–ç å’Œè¯å‘é‡ä¹‹å’Œ.png</span>&quot; alt=&quot;img&quot; style=&quot;zoom:50%;&quot; /&gt;</p>\n<h2 id=\"ä¸ºä»€ä¹ˆè¿™ä¹ˆåšæœ‰ç”¨\"><a class=\"anchor\" href=\"#ä¸ºä»€ä¹ˆè¿™ä¹ˆåšæœ‰ç”¨\">#</a> ä¸ºä»€ä¹ˆè¿™ä¹ˆåšæœ‰ç”¨</h2>\n<p>pos+K=5ï¼Œæˆ‘åœ¨è®¡ç®—ç¬¬ 5 ä¸ªå•è¯çš„ä½ç½®ç¼–ç çš„æ—¶å€™</p>\n<p>pos=1ï¼Œk=4</p>\n<p>pos=2ï¼Œk=3</p>\n<p>&lt;img src=&quot;<span class=\"exturl\" data-url=\"aHR0cHM6Ly9pbWdtZC5vc3MtY24tc2hhbmdoYWkuYWxpeXVuY3MuY29tL0JFUlRfSU1HLyVFNCVCRCU4RCVFNyVCRCVBRSVFNSVCNSU4QyVFNSU4NSVBNSVFOCVBNyVBMyVFOSU4NyU4QS5wbmc=\">https://imgmd.oss-cn-shanghai.aliyuncs.com/BERT_IMG/ ä½ç½®åµŒå…¥è§£é‡Š.png</span>&quot; alt=&quot;img&quot; style=&quot;zoom:50%;&quot; /&gt;</p>\n",
            "tags": [
                "NER"
            ]
        },
        {
            "id": "http://qiji5211.com/2024/02/07/NER/Pre-training-language-model-main/%E7%AC%AC%E4%B8%80%E7%AF%87%20Transformer%E3%80%81GPT%E3%80%81BERT%EF%BC%8C%E9%A2%84%E8%AE%AD%E7%BB%83%E8%AF%AD%E8%A8%80%E6%A8%A1%E5%9E%8B%E7%9A%84%E5%89%8D%E4%B8%96%E4%BB%8A%E7%94%9F%EF%BC%88%E7%90%86%E8%AE%BA%EF%BC%89/08%20ELMo%E6%A8%A1%E5%9E%8B%EF%BC%88%E5%8F%8C%E5%90%91LSTM%E6%A8%A1%E5%9E%8B%E8%A7%A3%E5%86%B3%E8%AF%8D%E5%90%91%E9%87%8F%E5%A4%9A%E4%B9%89%E9%97%AE%E9%A2%98%EF%BC%89/",
            "url": "http://qiji5211.com/2024/02/07/NER/Pre-training-language-model-main/%E7%AC%AC%E4%B8%80%E7%AF%87%20Transformer%E3%80%81GPT%E3%80%81BERT%EF%BC%8C%E9%A2%84%E8%AE%AD%E7%BB%83%E8%AF%AD%E8%A8%80%E6%A8%A1%E5%9E%8B%E7%9A%84%E5%89%8D%E4%B8%96%E4%BB%8A%E7%94%9F%EF%BC%88%E7%90%86%E8%AE%BA%EF%BC%89/08%20ELMo%E6%A8%A1%E5%9E%8B%EF%BC%88%E5%8F%8C%E5%90%91LSTM%E6%A8%A1%E5%9E%8B%E8%A7%A3%E5%86%B3%E8%AF%8D%E5%90%91%E9%87%8F%E5%A4%9A%E4%B9%89%E9%97%AE%E9%A2%98%EF%BC%89/",
            "title": "ELMoæ¨¡å‹ï¼ˆåŒå‘LSTMæ¨¡å‹è§£å†³è¯å‘é‡å¤šä¹‰é—®é¢˜ï¼‰",
            "date_published": "2024-02-07T09:30:58.000Z",
            "content_html": "<h1 id=\"word2vec-æ¨¡å‹\"><a class=\"anchor\" href=\"#word2vec-æ¨¡å‹\">#</a> Word2Vec æ¨¡å‹</h1>\n<p>NNLM æ¨¡å‹ï¼ˆæ˜¯ä¸æ˜¯åœ¨é¢„æµ‹ä¸‹ä¸€ä¸ªè¯ï¼Œå‰¯äº§å“æ˜¯è¯å‘é‡ï¼‰</p>\n<p>Word2Vec æ¨¡å‹ï¼šä¸“é—¨åšè¯å‘é‡</p>\n<ol>\n<li>CBOW</li>\n<li>Skip-gram</li>\n</ol>\n<p>![image-20220614193540503](../../Library/Application Support/typora-user-images/image-20220614193540503.png)</p>\n<p>appleï¼Œè‹¹æœï¼Œï£¿</p>\n<h1 id=\"elmo\"><a class=\"anchor\" href=\"#elmo\">#</a> ELMo</h1>\n<p><img data-src=\"https://imgmd.oss-cn-shanghai.aliyuncs.com/BERT_IMG/we%E5%A4%9A%E4%B9%89%E8%AF%8D%E9%97%AE%E9%A2%98.jpg\" alt=\"img\" /></p>\n<p>elmo è§£å†³å¤šä¹‰è¯é—®é¢˜</p>\n<p><img data-src=\"https://imgmd.oss-cn-shanghai.aliyuncs.com/BERT_IMG/word2vec.jpg\" alt=\"img\" /></p>\n<p><img data-src=\"https://imgmd.oss-cn-shanghai.aliyuncs.com/BERT_IMG/%E5%9F%BA%E4%BA%8E%E4%B8%8A%E4%B8%8B%E6%96%87%E7%9A%84emedding.jpg\" alt=\"img\" /></p>\n<p>ELMoï¼ˆä¸“é—¨åšè¯å‘é‡ï¼Œé€šè¿‡é¢„è®­ç»ƒï¼‰</p>\n<p>ä¸åªæ˜¯è®­ç»ƒä¸€ä¸ª Q çŸ©é˜µï¼Œæˆ‘è¿˜å¯ä»¥æŠŠè¿™ä¸ªæ¬¡çš„ä¸Šä¸‹æ–‡ä¿¡æ¯èå…¥åˆ°è¿™ä¸ª Q çŸ©é˜µä¸­</p>\n<p>å·¦è¾¹çš„ LSTM è·å– E2 çš„ä¸Šæ–‡ä¿¡æ¯ï¼Œå³è¾¹å°±æ˜¯ä¸‹æ–‡ä¿¡æ¯</p>\n<p>x1,x2, x4,x5 --&gt; Word2Vec x1+x2+x4+x5 ---&gt; é¢„æµ‹é‚£ä¸€ä¸ªè¯</p>\n<p>è·å–ä¸Šä¸‹æ–‡ä¿¡æ¯åï¼ŒæŠŠä¸‰å±‚çš„ä¿¡æ¯è¿›è¡Œä¸€ä¸ªå åŠ </p>\n<p>E1+E2+E3 = K1 ä¸€ä¸ªæ–°çš„è¯å‘é‡ <span class=\"katex\"><span class=\"katex-mathml\"><math xmlns=\"http://www.w3.org/1998/Math/MathML\"><semantics><mrow><mo>â‰ˆ</mo></mrow><annotation encoding=\"application/x-tex\">\\approx</annotation></semantics></math></span><span class=\"katex-html\" aria-hidden=\"true\"><span class=\"base\"><span class=\"strut\" style=\"height:0.48312em;vertical-align:0em;\"></span><span class=\"mrel\">â‰ˆ</span></span></span></span> E1</p>\n<p>E2,E3 ç›¸å½“äºä¸¤ä¸ªä¸Šä¸‹æ–‡ä¿¡æ¯</p>\n<p>E1+E2+E3+E4</p>\n<p>K1 åŒ…å«äº†ç¬¬ä¸€ä¸ªè¯çš„è¯å‘é‡åŒ…å«å•è¯ç‰¹å¾ã€å¥æ³•ç‰¹å¾ã€è¯­ä¹‰ç‰¹å¾</p>\n<p>æ€ä¹ˆç”¨</p>\n<p>E2ï¼ŒE3 ä¸åŒï¼ŒE1+E2+E3 ä¸åŒ</p>\n<p>apple --ã€‹ æˆ‘åƒäº†ä¸€ä¸ª è‹¹æœ -- ã€‹ [1,20,10]</p>\n<p>apple --ã€‹æˆ‘åœ¨ç”¨è‹¹æœæ‰‹æœº --ã€‹[1,10,20]</p>\n<p><img data-src=\"https://imgmd.oss-cn-shanghai.aliyuncs.com/BERT_IMG/elmo%E8%AE%AD%E7%BB%83%E5%90%8E%E7%9A%84%E4%BD%BF%E7%94%A8.jpg\" alt=\"img\" /></p>\n<p>LSTM æ— æ³•å¹¶è¡Œï¼Œé•¿æœŸä¾èµ–</p>\n<p>Attention</p>\n",
            "tags": [
                "NER"
            ]
        }
    ]
}